diff -daurN samba3/docs-xml/smbdotconf/ldap/clientldapsaslwrapping.xml samba3/docs-xml/smbdotconf/ldap/clientldapsaslwrapping.xml
--- samba3/docs-xml/smbdotconf/ldap/clientldapsaslwrapping.xml	2015-02-22 15:11:32.000000000 +0100
+++ samba3/docs-xml/smbdotconf/ldap/clientldapsaslwrapping.xml	2024-08-04 17:52:52.000000000 +0200
@@ -34,11 +34,9 @@
 	</para>
 
 	<para>
-	The default value is <emphasis>plain</emphasis> which is not irritable 
-	to KRB5 clock skew errors. That implies synchronizing the time
-	with the KDC in the case of using <emphasis>sign</emphasis> or 
-	<emphasis>seal</emphasis>.
+	The default value is <emphasis>sign</emphasis>. That implies synchronizing the time
+	with the KDC in the case of using <emphasis>Kerberos</emphasis>.
 	</para>
 </description>
-<value type="default">plain</value>
+<value type="default">sign</value>
 </samba:parameter>
diff -daurN samba3/docs-xml/smbdotconf/protocol/clientusespnego.xml samba3/docs-xml/smbdotconf/protocol/clientusespnego.xml
--- samba3/docs-xml/smbdotconf/protocol/clientusespnego.xml	2015-02-22 15:11:32.000000000 +0100
+++ samba3/docs-xml/smbdotconf/protocol/clientusespnego.xml	2024-08-04 17:52:52.000000000 +0200
@@ -9,6 +9,11 @@
     supporting servers (including WindowsXP, Windows2000 and Samba
     3.0) to agree upon an authentication
     mechanism.  This enables Kerberos authentication in particular.</para>
+
+    <para>When <smbconfoption name="client NTLMv2 auth"/> is also set to
+    <constant>yes</constant> extended security (SPNEGO) is required
+    in order to use NTLMv2 only within NTLMSSP. This behavior was
+    introduced with the patches for CVE-2016-2111.</para>
 </description>
 
 <value type="default">yes</value>
diff -daurN samba3/docs-xml/smbdotconf/security/allowdcerpcauthlevelconnect.xml samba3/docs-xml/smbdotconf/security/allowdcerpcauthlevelconnect.xml
--- samba3/docs-xml/smbdotconf/security/allowdcerpcauthlevelconnect.xml	1970-01-01 01:00:00.000000000 +0100
+++ samba3/docs-xml/smbdotconf/security/allowdcerpcauthlevelconnect.xml	2024-08-04 17:52:52.000000000 +0200
@@ -0,0 +1,22 @@
+<samba:parameter name="allow dcerpc auth level connect"
+                 context="G"
+                 type="boolean"
+                 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
+<description>
+	<para>This option controls whether DCERPC services are allowed to
+	be used with DCERPC_AUTH_LEVEL_CONNECT, which provides authentication,
+	but no per message integrity nor privacy protection.</para>
+
+	<para>The behavior can be controlled per interface name (e.g. lsarpc, netlogon, samr, srvsvc,
+	winreg, wkssvc ...) by using 'allow dcerpc auth level connect:interface = no' as option.</para>
+
+	<para>This option yields precedence to the implentation specific restrictions.
+	E.g. the drsuapi and backupkey protocols require DCERPC_AUTH_LEVEL_PRIVACY.
+	While others like samr and lsarpc have a hardcoded default of <constant>no</constant>.
+	</para>
+</description>
+
+<value type="default">no</value>
+<value type="example">yes</value>
+
+</samba:parameter>
diff -daurN samba3/docs-xml/smbdotconf/security/clientipcsigning.xml samba3/docs-xml/smbdotconf/security/clientipcsigning.xml
--- samba3/docs-xml/smbdotconf/security/clientipcsigning.xml	1970-01-01 01:00:00.000000000 +0100
+++ samba3/docs-xml/smbdotconf/security/clientipcsigning.xml	2024-08-04 17:52:52.000000000 +0200
@@ -0,0 +1,23 @@
+<samba:parameter name="client ipc signing"
+                 context="G"
+                 type="enum"
+                 enumlist="enum_smb_signing_vals"
+                 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
+<description>
+    <para>This controls whether the client is allowed or required to use SMB signing for IPC$
+    connections as DCERPC transport inside of winbind. Possible values
+    are <emphasis>auto</emphasis>, <emphasis>mandatory</emphasis>
+    and <emphasis>disabled</emphasis>.
+    </para>
+
+    <para>When set to auto, SMB signing is offered, but not enforced and if set
+    to disabled, SMB signing is not offered either.</para>
+
+    <para>Connections from winbindd to Active Directory Domain Controllers
+    always enforce signing.</para>
+</description>
+
+<related>client signing</related>
+
+<value type="default">mandatory</value>
+</samba:parameter>
diff -daurN samba3/docs-xml/smbdotconf/security/clientntlmv2auth.xml samba3/docs-xml/smbdotconf/security/clientntlmv2auth.xml
--- samba3/docs-xml/smbdotconf/security/clientntlmv2auth.xml	2015-02-22 15:11:32.000000000 +0100
+++ samba3/docs-xml/smbdotconf/security/clientntlmv2auth.xml	2024-08-04 17:52:52.000000000 +0200
@@ -28,6 +28,11 @@
     NTLMv2 by default, and some sites (particularly those following
     'best practice' security polices) only allow NTLMv2 responses, and
     not the weaker LM or NTLM.</para>
+
+    <para>When <smbconfoption name="client use spnego"/> is also set to
+    <constant>yes</constant> extended security (SPNEGO) is required
+    in order to use NTLMv2 only within NTLMSSP. This behavior was
+    introduced with the patches for CVE-2016-2111.</para>
 </description>
 <value type="default">yes</value>
 </samba:parameter>
diff -daurN samba3/docs-xml/smbdotconf/security/clientsigning.xml samba3/docs-xml/smbdotconf/security/clientsigning.xml
--- samba3/docs-xml/smbdotconf/security/clientsigning.xml	2015-02-22 15:11:32.000000000 +0100
+++ samba3/docs-xml/smbdotconf/security/clientsigning.xml	2024-08-04 17:52:52.000000000 +0200
@@ -12,6 +12,9 @@
     <para>When set to auto, SMB signing is offered, but not enforced. 
     When set to mandatory, SMB signing is required and if set 
 	to disabled, SMB signing is not offered either.
+
+    <para>IPC$ connections for DCERPC e.g. in winbindd, are handled by the
+    <smbconfoption name="client ipc signing"/> option.</para>
 </para>
 </description>
 
diff -daurN samba3/docs-xml/smbdotconf/security/rawntlmv2auth.xml samba3/docs-xml/smbdotconf/security/rawntlmv2auth.xml
--- samba3/docs-xml/smbdotconf/security/rawntlmv2auth.xml	1970-01-01 01:00:00.000000000 +0100
+++ samba3/docs-xml/smbdotconf/security/rawntlmv2auth.xml	2024-08-04 17:52:52.000000000 +0200
@@ -0,0 +1,19 @@
+<samba:parameter name="raw NTLMv2 auth"
+                 context="G"
+                 type="boolean"
+                 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
+<description>
+    <para>This parameter determines whether or not <citerefentry><refentrytitle>smbd</refentrytitle>
+    <manvolnum>8</manvolnum></citerefentry> will allow SMB1 clients without
+    extended security (without SPNEGO) to use NTLMv2 authentication.</para>
+
+    <para>If this option, <command moreinfo="none">lanman auth</command>
+    and <command moreinfo="none">ntlm auth</command> are all disabled,
+    then only clients with SPNEGO support will be permitted.
+    That means NTLMv2 is only supported within NTLMSSP.</para>
+</description>
+
+<related>lanman auth</related>
+<related>ntlm auth</related>
+<value type="default">no</value>
+</samba:parameter>
diff -daurN samba3/docs-xml/smbdotconf/winbind/winbindsealedpipes.xml samba3/docs-xml/smbdotconf/winbind/winbindsealedpipes.xml
--- samba3/docs-xml/smbdotconf/winbind/winbindsealedpipes.xml	1970-01-01 01:00:00.000000000 +0100
+++ samba3/docs-xml/smbdotconf/winbind/winbindsealedpipes.xml	2024-08-04 17:52:52.000000000 +0200
@@ -0,0 +1,15 @@
+<samba:parameter name="winbind sealed pipes"
+                 context="G"
+                 type="boolean"
+                 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
+<description>
+	<para>This option controls whether any requests from winbindd to domain controllers
+		pipe will be sealed. Disabling sealing can be useful for debugging
+		purposes.</para>
+
+	<para>The behavior can be controlled per netbios domain
+	by using 'winbind sealed pipes:NETBIOSDOMAIN = no' as option.</para>
+</description>
+
+<value type="default">yes</value>
+</samba:parameter>
diff -daurN samba3/.gitignore samba3/.gitignore
--- samba3/.gitignore	2015-02-22 15:11:32.000000000 +0100
+++ samba3/.gitignore	2024-09-17 23:15:12.323920414 +0200
@@ -1,133 +1,28 @@
-bin/
-st/
-.waf*
-.lock-wscript
-*~
-*.1
-*.3
-*.8
-*.swp
-tags
-TAGS
-cscope*.out
-*.x
-autom4te.cache
-config.cache
-config.h
-config.h.in
-config.log
-config.status
-source3/.build.log
-source3/.clang_complete
-source3/configure
-source3/Makefile
-examples/libsmbclient/Makefile.internal
-examples/libsmbclient/smbwrapper/smbsh
-examples/libsmbclient/smbwrapper/smbwrapper.so
-examples/libsmbclient/testacl
-examples/libsmbclient/testacl2
-examples/libsmbclient/testacl3
-examples/libsmbclient/testbrowse
-examples/libsmbclient/testbrowse2
-examples/libsmbclient/testchmod
-examples/libsmbclient/testread
-examples/libsmbclient/testsmbc
-examples/libsmbclient/teststat
-examples/libsmbclient/teststat2
-examples/libsmbclient/teststat3
-examples/libsmbclient/testtruncate
-examples/libsmbclient/testutime
-examples/libsmbclient/testwrite
-examples/libsmbclient/tree
-examples/libsmbclient/testfstatvfs
-examples/libsmbclient/teststatvfs
-examples/VFS/config.log
-examples/VFS/config.status
-examples/VFS/configure
-examples/VFS/Makefile
-examples/VFS/module_config.h
-examples/VFS/module_config.h.in
-examples/VFS/shadow_copy_test.so
-examples/VFS/skel_opaque.so
-examples/VFS/skel_transparent.so
-*.gcda
-*.gcno
 *.o
-*.patch
-*.pc
 *.po
-*.pyc
-semantic.cache
-nsswitch/libnss_winbind.so
-nsswitch/libnss_wins.so
-source3/config.cache
-source3/config.log
-source3/config.status
-source3/configure
-source3/exports/libnetapi.syms
-source3/exports/libsmbclient.syms
-source3/exports/libsmbsharemodes.syms
-source3/exports/libtalloc.syms
-source3/exports/libtdb.syms
-source3/exports/libwbclient.syms
-source3/include/build_env.h
-source3/include/config.h
-source3/include/config.h.in
-source3/include/includes.h.gch
-source3/include/stamp-h
-source3/include/version.h
-source3/lib/netapi/examples/Makefile
-source3/lib/netapi/tests/Makefile
-source3/library-versions
-librpc/gen_ndr/*.*
-source3/librpc/gen_ndr/*.*
-source3/nsswitch/*.so
-source3/pkgconfig/*.pc
-source3/proto_exists
-source3/script/findsmb
-source3/script/gen-8bit-gap.sh
-source3/script/installbin.sh
-source3/script/uninstallbin.sh
-source3/smbadduser
-source3/smbd/build_options.c
-source3/setup
-pidl/blib
-pidl/cover_db
-pidl/Makefile
-pidl/pm_to_blib
-packaging/RHEL-CTDB/samba.spec
-packaging/RHEL/samba.spec
-packaging/RHEL/makerpms.sh
-docs-xml/build/catalog.xml
-docs-xml/*/images/*.eps
-docs-xml/*/images/*.pdf
-docs-xml/output
-docs-xml/Samba3-ByExample/images/AccountingNetwork.png
-docs-xml/Samba3-ByExample/images/Charity-Network.png
-docs-xml/Samba3-ByExample/images/UNIX-Samba-and-LDAP.png
-docs-xml/Samba3-ByExample/images/acct2net.png
-docs-xml/Samba3-ByExample/images/ch7-dual-additive-LDAP-Ok.png
-docs-xml/Samba3-ByExample/images/ch7-dual-additive-LDAP.png
-docs-xml/Samba3-ByExample/images/ch7-fail-overLDAP.png
-docs-xml/Samba3-ByExample/images/ch7-singleLDAP.png
-docs-xml/Samba3-ByExample/images/ch8-migration.png
-docs-xml/Samba3-ByExample/images/chap4-net.png
-docs-xml/Samba3-ByExample/images/chap5-net.png
-docs-xml/Samba3-ByExample/images/chap6-net.png
-docs-xml/Samba3-ByExample/images/chap7-idresol.png
-docs-xml/Samba3-ByExample/images/chap9-ADSDC.png
-docs-xml/Samba3-ByExample/images/chap9-SambaDC.png
-docs-xml/Samba3-HOWTO/images/access1.png
-docs-xml/Samba3-HOWTO/images/browsing1.png
-docs-xml/Samba3-HOWTO/images/cups1.png
-docs-xml/Samba3-HOWTO/images/cups2.png
-docs-xml/Samba3-HOWTO/images/domain.png
-docs-xml/Samba3-HOWTO/images/idmap-gid2sid.png
-docs-xml/Samba3-HOWTO/images/idmap-sid2gid.png
-docs-xml/Samba3-HOWTO/images/idmap-sid2uid.png
-docs-xml/Samba3-HOWTO/images/idmap-store-gid2sid.png
-docs-xml/Samba3-HOWTO/images/idmap-uid2sid.png
-docs-xml/Samba3-HOWTO/images/pdftoepsonusb.png
-docs-xml/Samba3-HOWTO/images/pdftosocket.png
-docs-xml/Samba3-HOWTO/images/trusts1.png
-source4/.testrepository
+source/client/client_proto.h
+source/include/build_env.h
+source/include/config.h
+source/include/proto.h
+source/include/stamp-h
+source/Makefile
+source/config.log
+source/config.status
+source/smbadduser
+source/bin/*
+source/script/findsmb
+source/script/gen-8bit-gap.sh
+source/script/installbin.sh
+source/script/uninstallbin.sh
+source/smbd/build_options.c
+source/utils/net_proto.h
+source/utils/ntlm_auth_proto.h
+source/web/swat_proto.h
+source/tags
+source/utils/passwd_proto.h
+source/include/includes.h.gch
+source/config.cache
+source/library-versions
+source/nsswitch/*.so
+source/proto_exists
+source/nsswitch/winbindd_proto.h
diff -daurN samba3/lib/replace/getifaddrs.c samba3/lib/replace/getifaddrs.c
--- samba3/lib/replace/getifaddrs.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/lib/replace/getifaddrs.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,6 +44,9 @@
 
 #ifdef HAVE_IFACE_GETIFADDRS
 #define _FOUND_IFACE_ANY
+#elif defined(BCMARM)
+#include "ifaddrs.c"
+#define _FOUND_IFACE_ANY
 #else
 
 void rep_freeifaddrs(struct ifaddrs *ifp)
diff -daurN samba3/lib/replace/ifaddrs.c samba3/lib/replace/ifaddrs.c
--- samba3/lib/replace/ifaddrs.c	1970-01-01 01:00:00.000000000 +0100
+++ samba3/lib/replace/ifaddrs.c	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,866 @@
+/*	$Id: ifaddrs.c 241182 2011-02-17 21:50:03Z $	*/
+/* 	from USAGI: ifaddrs.c,v 1.20.2.1 2002/12/08 08:22:23 yoshfuji Exp */
+
+/* 
+ * Copyright (C)2000 YOSHIFUJI Hideaki
+ * 
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ * 
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ */
+
+#include <string.h>
+#include <time.h>
+#include <malloc.h>
+#include <errno.h>
+#include <unistd.h>
+
+#define __set_errno(x)	errno = (x)
+
+#include <sys/socket.h>
+#include <asm/types.h>
+#include <linux/netlink.h>
+#include <linux/rtnetlink.h>
+#include <sys/types.h>
+#include <sys/socket.h>
+#include <netpacket/packet.h>
+#include <net/ethernet.h>	/* the L2 protocols */
+#include <sys/uio.h>
+#include <net/if.h>
+#include <net/if_arp.h>
+#include "ifaddrs.h"
+#include <netinet/in.h>
+
+#ifdef _USAGI_LIBINET6
+#include "libc-compat.h"
+#endif
+
+/* ====================================================================== */
+struct nlmsg_list
+{
+  struct nlmsg_list *nlm_next;
+  struct nlmsghdr *nlh;
+  int size;
+  time_t seq;
+};
+
+struct rtmaddr_ifamap
+{
+  void *address;
+  void *local;
+#ifdef IFA_NETMASK
+  void *netmask;
+#endif
+  void *broadcast;
+#ifdef HAVE_IFADDRS_IFA_ANYCAST
+  void *anycast;
+#endif
+  int address_len;
+  int local_len;
+#ifdef IFA_NETMASK
+  int netmask_len;
+#endif
+  int broadcast_len;
+#ifdef HAVE_IFADDRS_IFA_ANYCAST
+  int anycast_len;
+#endif
+};
+
+/* ====================================================================== */
+static size_t
+ifa_sa_len (sa_family_t family, int len)
+{
+  size_t size;
+  switch (family)
+    {
+    case AF_INET:
+      size = sizeof (struct sockaddr_in);
+      break;
+    case AF_INET6:
+      size = sizeof (struct sockaddr_in6);
+      break;
+    case AF_PACKET:
+      size = (size_t) (((struct sockaddr_ll *) NULL)->sll_addr) + len;
+      if (size < sizeof (struct sockaddr_ll))
+	size = sizeof (struct sockaddr_ll);
+      break;
+    default:
+      size = (size_t) (((struct sockaddr *) NULL)->sa_data) + len;
+      if (size < sizeof (struct sockaddr))
+	size = sizeof (struct sockaddr);
+    }
+  return size;
+}
+
+static void
+ifa_make_sockaddr (sa_family_t family,
+		   struct sockaddr *sa,
+		   void *p, size_t len, uint32_t scope, uint32_t scopeid)
+{
+  if (sa == NULL)
+    return;
+  switch (family)
+    {
+    case AF_INET:
+      memcpy (&((struct sockaddr_in *) sa)->sin_addr, (char *) p, len);
+      break;
+    case AF_INET6:
+      memcpy (&((struct sockaddr_in6 *) sa)->sin6_addr, (char *) p, len);
+      if (IN6_IS_ADDR_LINKLOCAL (p) || IN6_IS_ADDR_MC_LINKLOCAL (p))
+	{
+	  ((struct sockaddr_in6 *) sa)->sin6_scope_id = scopeid;
+	}
+      break;
+    case AF_PACKET:
+      memcpy (((struct sockaddr_ll *) sa)->sll_addr, (char *) p, len);
+      ((struct sockaddr_ll *) sa)->sll_halen = len;
+      break;
+    default:
+      memcpy (sa->sa_data, p, len);
+ break;
+    }
+  sa->sa_family = family;
+#ifdef HAVE_SOCKADDR_SA_LEN
+  sa->sa_len = ifa_sa_len (family, len);
+#endif
+}
+
+static struct sockaddr *
+ifa_make_sockaddr_mask (sa_family_t family,
+			struct sockaddr *sa, uint32_t prefixlen)
+{
+  int i;
+  char *p = NULL, c;
+  uint32_t max_prefixlen = 0;
+
+  if (sa == NULL)
+    return NULL;
+  switch (family)
+    {
+    case AF_INET:
+      memset (&((struct sockaddr_in *) sa)->sin_addr, 0,
+	      sizeof (((struct sockaddr_in *) sa)->sin_addr));
+      p = (char *) &((struct sockaddr_in *) sa)->sin_addr;
+      max_prefixlen = 32;
+      break;
+    case AF_INET6:
+      memset (&((struct sockaddr_in6 *) sa)->sin6_addr, 0,
+	      sizeof (((struct sockaddr_in6 *) sa)->sin6_addr));
+      p = (char *) &((struct sockaddr_in6 *) sa)->sin6_addr;
+      max_prefixlen = 128;
+      break;
+    default:
+      return NULL;
+    }
+  sa->sa_family = family;
+#ifdef HAVE_SOCKADDR_SA_LEN
+  sa->sa_len = ifa_sa_len (family, len);
+#endif
+  if (p)
+    {
+      if (prefixlen > max_prefixlen)
+	prefixlen = max_prefixlen;
+      for (i = 0; i < (prefixlen / 8); i++)
+	*p++ = 0xff;
+      c = 0xff;
+      c <<= (8 - (prefixlen % 8));
+      *p = c;
+    }
+  return sa;
+}
+
+/* ====================================================================== */
+static int
+nl_sendreq (int sd, int request, int flags, int *seq)
+{
+  char reqbuf[NLMSG_ALIGN (sizeof (struct nlmsghdr)) +
+	      NLMSG_ALIGN (sizeof (struct rtgenmsg))];
+  struct sockaddr_nl nladdr;
+  struct nlmsghdr *req_hdr;
+  struct rtgenmsg *req_msg;
+  time_t t = time (NULL);
+
+  if (seq)
+    *seq = t;
+  memset (&reqbuf, 0, sizeof (reqbuf));
+  req_hdr = (struct nlmsghdr *) reqbuf;
+  req_msg = (struct rtgenmsg *) NLMSG_DATA (req_hdr);
+  req_hdr->nlmsg_len = NLMSG_LENGTH (sizeof (*req_msg));
+  req_hdr->nlmsg_type = request;
+  req_hdr->nlmsg_flags = flags | NLM_F_REQUEST;
+  req_hdr->nlmsg_pid = 0;
+  req_hdr->nlmsg_seq = t;
+  req_msg->rtgen_family = AF_UNSPEC;
+  memset (&nladdr, 0, sizeof (nladdr));
+  nladdr.nl_family = AF_NETLINK;
+  return (sendto (sd, (void *) req_hdr, req_hdr->nlmsg_len, 0,
+		  (struct sockaddr *) &nladdr, sizeof (nladdr)));
+}
+
+static int
+nl_recvmsg (int sd, int request, int seq,
+	    void *buf, size_t buflen, int *flags)
+{
+  struct msghdr msg;
+  struct iovec iov = { buf, buflen };
+  struct sockaddr_nl nladdr;
+  int read_len;
+
+  for (;;)
+    {
+      msg.msg_name = (void *) &nladdr;
+      msg.msg_namelen = sizeof (nladdr);
+      msg.msg_iov = &iov;
+      msg.msg_iovlen = 1;
+      msg.msg_control = NULL;
+      msg.msg_controllen = 0;
+      msg.msg_flags = 0;
+      read_len = recvmsg (sd, &msg, 0);
+      if ((read_len < 0 && errno == EINTR) || (msg.msg_flags & MSG_TRUNC))
+	continue;
+      if (flags)
+	*flags = msg.msg_flags;
+      break;
+    }
+  return read_len;
+}
+
+static int
+nl_getmsg (int sd, int request, int seq, pid_t pid, struct nlmsghdr **nlhp, int *done)
+{
+  struct nlmsghdr *nh;
+  size_t bufsize = 65536, lastbufsize = 0;
+  void *buff = NULL;
+  int result = 0, read_size;
+  int msg_flags;
+  for (;;)
+    {
+      void *newbuff = realloc (buff, bufsize);
+      if (newbuff == NULL || bufsize < lastbufsize)
+	{
+	  result = -1;
+	  break;
+	}
+      buff = newbuff;
+      result = read_size =
+	nl_recvmsg (sd, request, seq, buff, bufsize, &msg_flags);
+      if (read_size < 0 || (msg_flags & MSG_TRUNC))
+	{
+	  lastbufsize = bufsize;
+	  bufsize *= 2;
+	  continue;
+	}
+      if (read_size == 0)
+	break;
+      nh = (struct nlmsghdr *) buff;
+      for (nh = (struct nlmsghdr *) buff;
+	   NLMSG_OK (nh, read_size);
+	   nh = (struct nlmsghdr *) NLMSG_NEXT (nh, read_size))
+	{
+	  if (nh->nlmsg_pid != pid || nh->nlmsg_seq != seq)
+	    continue;
+	  if (nh->nlmsg_type == NLMSG_DONE)
+	    {
+	      (*done)++;
+	      break;		/* ok */
+	    }
+	  if (nh->nlmsg_type == NLMSG_ERROR)
+	    {
+	      struct nlmsgerr *nlerr = (struct nlmsgerr *) NLMSG_DATA (nh);
+	      result = -1;
+	      if (nh->nlmsg_len < NLMSG_LENGTH (sizeof (struct nlmsgerr)))
+		__set_errno (EIO);
+	      else
+		__set_errno (-nlerr->error);
+	      break;
+	    }
+	}
+      break;
+    }
+  if (result < 0)
+    if (buff)
+      {
+	int saved_errno = errno;
+	free (buff);
+	__set_errno (saved_errno);
+      }
+  *nlhp = (struct nlmsghdr *) buff;
+  return result;
+}
+
+static int
+nl_getlist (int sd, int seq, pid_t pid,
+	    int request,
+	    struct nlmsg_list **nlm_list, struct nlmsg_list **nlm_end)
+{
+  struct nlmsghdr *nlh = NULL;
+  int status;
+  int done = 0;
+
+  status = nl_sendreq (sd, request, NLM_F_ROOT | NLM_F_MATCH, &seq);
+  if (status < 0)
+    return status;
+  if (seq == 0)
+    seq = (int) time (NULL);
+  while (!done)
+    {
+      status = nl_getmsg (sd, request, seq, pid, &nlh, &done);
+      if (status < 0)
+	return status;
+      if (nlh)
+	{
+	  struct nlmsg_list *nlm_next =
+	    (struct nlmsg_list *) malloc (sizeof (struct nlmsg_list));
+	  if (nlm_next == NULL)
+	    {
+	      int saved_errno = errno;
+	      free (nlh);
+	      __set_errno (saved_errno);
+	      status = -1;
+	    }
+	  else
+	    {
+	      nlm_next->nlm_next = NULL;
+	      nlm_next->nlh = (struct nlmsghdr *) nlh;
+	      nlm_next->size = status;
+	      nlm_next->seq = seq;
+	      if (*nlm_list == NULL)
+		{
+		  *nlm_list = nlm_next;
+		  *nlm_end = nlm_next;
+		}
+	      else
+		{
+		  (*nlm_end)->nlm_next = nlm_next;
+		  *nlm_end = nlm_next;
+		}
+	    }
+	}
+    }
+  return status >= 0 ? seq : status;
+}
+
+/* ---------------------------------------------------------------------- */
+static void
+free_nlmsglist (struct nlmsg_list *nlm0)
+{
+  struct nlmsg_list *nlm, *nlm_next;
+  int saved_errno;
+  if (!nlm0)
+    return;
+  saved_errno = errno;
+  nlm = nlm0;
+  while (nlm)
+    {
+      if (nlm->nlh)
+	free (nlm->nlh);
+      nlm_next = nlm->nlm_next;
+      free(nlm);
+      nlm = nlm_next;
+    }
+  __set_errno (saved_errno);
+}
+
+static void
+free_data (void *data, void *ifdata)
+{
+  int saved_errno = errno;
+  if (data != NULL)
+    free (data);
+  if (ifdata != NULL)
+    free (ifdata);
+  __set_errno (saved_errno);
+}
+
+/* ---------------------------------------------------------------------- */
+static void
+nl_close (int sd)
+{
+  int saved_errno = errno;
+  if (sd >= 0)
+    close (sd);
+  __set_errno (saved_errno);
+}
+
+/* ---------------------------------------------------------------------- */
+static int
+nl_open (pid_t *pid)
+{
+  struct sockaddr_nl nladdr;
+  int sd;
+
+  sd = socket (PF_NETLINK, SOCK_RAW, NETLINK_ROUTE);
+  if (sd < 0)
+    return -1;
+  memset (&nladdr, 0, sizeof (nladdr));
+  nladdr.nl_family = AF_NETLINK;
+  if (bind (sd, (struct sockaddr *) &nladdr, sizeof (nladdr)) < 0)
+    {
+      nl_close (sd);
+      return -1;
+    }
+  if (pid)
+    {
+      socklen_t len = sizeof(nladdr);
+      if (getsockname (sd, (struct sockaddr *) &nladdr, &len) < 0)
+        {
+          nl_close (sd);
+          return -1;
+        }
+      *pid = nladdr.nl_pid;
+    }
+  return sd;
+}
+
+/* ====================================================================== */
+int
+rep_getifaddrs (struct ifaddrs **ifap)
+{
+  int sd;
+  struct nlmsg_list *nlmsg_list, *nlmsg_end, *nlm;
+  /* - - - - - - - - - - - - - - - */
+  int icnt;
+  size_t dlen, xlen, nlen;
+  uint32_t max_ifindex = 0;
+
+  pid_t pid;
+  int seq;
+  int result;
+  int build;			/* 0 or 1 */
+
+/* ---------------------------------- */
+  /* initialize */
+  icnt = dlen = xlen = nlen = 0;
+  nlmsg_list = nlmsg_end = NULL;
+
+  if (ifap)
+    *ifap = NULL;
+
+/* ---------------------------------- */
+  /* open socket and bind */
+  sd = nl_open (&pid);
+  if (sd < 0)
+    return -1;
+
+/* ---------------------------------- */
+  /* gather info */
+  if ((seq = nl_getlist (sd, 0, pid, RTM_GETLINK, &nlmsg_list, &nlmsg_end)) < 0)
+    {
+      free_nlmsglist (nlmsg_list);
+      nl_close (sd);
+      return -1;
+    }
+  if ((seq = nl_getlist (sd, seq + 1, pid, RTM_GETADDR,
+			 &nlmsg_list, &nlmsg_end)) < 0)
+    {
+      free_nlmsglist (nlmsg_list);
+      nl_close (sd);
+      return -1;
+    }
+
+/* ---------------------------------- */
+  /* Estimate size of result buffer and fill it */
+  for (build = 0; build <= 1; build++)
+    {
+      struct ifaddrs *ifl = NULL, *ifa = NULL;
+      struct nlmsghdr *nlh, *nlh0;
+      void *data = NULL, *xdata = NULL, *ifdata = NULL;
+      char *ifname = NULL, **iflist = NULL;
+      uint16_t *ifflist = NULL;
+      struct rtmaddr_ifamap ifamap;
+
+      if (build)
+	{
+	  ifa = data = calloc (1,
+			       NLMSG_ALIGN (sizeof (struct ifaddrs[icnt]))
+			       + dlen + xlen + nlen);
+	  ifdata = calloc (1,
+			   NLMSG_ALIGN (sizeof (char *[max_ifindex + 1]))
+			   +
+			   NLMSG_ALIGN (sizeof (uint16_t[max_ifindex + 1])));
+	  if (ifap != NULL)
+	    *ifap = (ifdata != NULL) ? ifa : NULL;
+	  else
+	    {
+	      free_data (data, ifdata);
+	      result = 0;
+	      break;
+	    }
+	  if (data == NULL || ifdata == NULL)
+	    {
+	      free_data (data, ifdata);
+	      result = -1;
+	      break;
+	    }
+	  ifl = NULL;
+	  data += NLMSG_ALIGN (sizeof (struct ifaddrs)) * icnt;
+	  xdata = data + dlen;
+	  ifname = xdata + xlen;
+	  iflist = ifdata;
+	  ifflist =
+	    ((void *) iflist) +
+	    NLMSG_ALIGN (sizeof (char *[max_ifindex + 1]));
+	}
+
+      for (nlm = nlmsg_list; nlm; nlm = nlm->nlm_next)
+	{
+	  int nlmlen = nlm->size;
+	  if (!(nlh0 = nlm->nlh))
+	    continue;
+	  for (nlh = nlh0;
+	       NLMSG_OK (nlh, nlmlen); nlh = NLMSG_NEXT (nlh, nlmlen))
+	    {
+	      struct ifinfomsg *ifim = NULL;
+	      struct ifaddrmsg *ifam = NULL;
+	      struct rtattr *rta;
+
+	      size_t nlm_struct_size = 0;
+	      sa_family_t nlm_family = 0;
+	      uint32_t nlm_scope = 0, nlm_index = 0;
+#ifndef IFA_NETMASK
+	      size_t sockaddr_size = 0;
+	      uint32_t nlm_prefixlen = 0;
+#endif
+	      size_t rtasize;
+
+	      memset (&ifamap, 0, sizeof (ifamap));
+
+	      /* check if the message is what we want */
+	      if (nlh->nlmsg_pid != pid || nlh->nlmsg_seq != nlm->seq)
+		continue;
+	      if (nlh->nlmsg_type == NLMSG_DONE)
+		{
+		  break;	/* ok */
+		}
+	      switch (nlh->nlmsg_type)
+		{
+		case RTM_NEWLINK:
+		  ifim = (struct ifinfomsg *) NLMSG_DATA (nlh);
+		  nlm_struct_size = sizeof (*ifim);
+		  nlm_family = ifim->ifi_family;
+		  nlm_scope = 0;
+		  nlm_index = ifim->ifi_index;
+		  nlm_prefixlen = 0;
+		  if (build)
+		    ifflist[nlm_index] = ifa->ifa_flags = ifim->ifi_flags;
+		  break;
+		case RTM_NEWADDR:
+		  ifam = (struct ifaddrmsg *) NLMSG_DATA (nlh);
+		  nlm_struct_size = sizeof (*ifam);
+		  nlm_family = ifam->ifa_family;
+		  nlm_scope = ifam->ifa_scope;
+		  nlm_index = ifam->ifa_index;
+		  nlm_prefixlen = ifam->ifa_prefixlen;
+		  if (build)
+		    ifa->ifa_flags = ifflist[nlm_index];
+		  break;
+		default:
+		  continue;
+		}
+
+	      if (!build)
+		{
+		  if (max_ifindex < nlm_index)
+		    max_ifindex = nlm_index;
+		}
+	      else
+		{
+		  if (ifl != NULL)
+		    ifl->ifa_next = ifa;
+		}
+
+	      rtasize =
+		NLMSG_PAYLOAD (nlh, nlmlen) - NLMSG_ALIGN (nlm_struct_size);
+	      for (rta =
+		   (struct rtattr *) (((char *) NLMSG_DATA (nlh)) +
+				      NLMSG_ALIGN (nlm_struct_size));
+		   RTA_OK (rta, rtasize); rta = RTA_NEXT (rta, rtasize))
+		{
+		  struct sockaddr **sap = NULL;
+		  void *rtadata = RTA_DATA (rta);
+		  size_t rtapayload = RTA_PAYLOAD (rta);
+		  socklen_t sa_len;
+
+		  switch (nlh->nlmsg_type)
+		    {
+		    case RTM_NEWLINK:
+		      switch (rta->rta_type)
+			{
+			case IFLA_ADDRESS:
+			case IFLA_BROADCAST:
+			  if (build)
+			    {
+			      sap =
+				(rta->rta_type ==
+				 IFLA_ADDRESS) ? &ifa->ifa_addr : &ifa->
+				ifa_broadaddr;
+			      *sap = (struct sockaddr *) data;
+			    }
+			  sa_len = ifa_sa_len (AF_PACKET, rtapayload);
+			  if (rta->rta_type == IFLA_ADDRESS)
+			    sockaddr_size = NLMSG_ALIGN (sa_len);
+			  if (!build)
+			    {
+			      dlen += NLMSG_ALIGN (sa_len);
+			    }
+			  else
+			    {
+			      memset (*sap, 0, sa_len);
+			      ifa_make_sockaddr (AF_PACKET, *sap, rtadata,
+						 rtapayload, 0, 0);
+			      ((struct sockaddr_ll *) *sap)->sll_ifindex =
+				nlm_index;
+			      ((struct sockaddr_ll *) *sap)->sll_hatype =
+				ifim->ifi_type;
+			      data += NLMSG_ALIGN (sa_len);
+			    }
+			  break;
+			case IFLA_IFNAME:	/* Name of Interface */
+			  if (!build)
+			    nlen += NLMSG_ALIGN (rtapayload + 1);
+			  else
+			    {
+			      ifa->ifa_name = ifname;
+			      if (iflist[nlm_index] == NULL)
+				iflist[nlm_index] = ifa->ifa_name;
+			      strncpy (ifa->ifa_name, rtadata, rtapayload);
+			      ifa->ifa_name[rtapayload] = '\0';
+			      ifname += NLMSG_ALIGN (rtapayload + 1);
+			    }
+			  break;
+			case IFLA_STATS:	/* Statistics of Interface */
+			  if (!build)
+			    xlen += NLMSG_ALIGN (rtapayload);
+			  else
+			    {
+			      ifa->ifa_data = xdata;
+			      memcpy (ifa->ifa_data, rtadata, rtapayload);
+			      xdata += NLMSG_ALIGN (rtapayload);
+			    }
+			  break;
+			case IFLA_UNSPEC:
+			  break;
+			case IFLA_MTU:
+			  break;
+			case IFLA_LINK:
+			  break;
+			case IFLA_QDISC:
+			  break;
+			default:
+				;
+			}
+		      break;
+		    case RTM_NEWADDR:
+		      if (nlm_family == AF_PACKET)
+			break;
+		      switch (rta->rta_type)
+			{
+			case IFA_ADDRESS:
+			  ifamap.address = rtadata;
+			  ifamap.address_len = rtapayload;
+			  break;
+			case IFA_LOCAL:
+			  ifamap.local = rtadata;
+			  ifamap.local_len = rtapayload;
+			  break;
+			case IFA_BROADCAST:
+			  ifamap.broadcast = rtadata;
+			  ifamap.broadcast_len = rtapayload;
+			  break;
+#ifdef HAVE_IFADDRS_IFA_ANYCAST
+			case IFA_ANYCAST:
+			  ifamap.anycast = rtadata;
+			  ifamap.anycast_len = rtapayload;
+			  break;
+#endif
+			case IFA_LABEL:
+			  if (!build)
+			    nlen += NLMSG_ALIGN (rtapayload + 1);
+			  else
+			    {
+			      ifa->ifa_name = ifname;
+			      if (iflist[nlm_index] == NULL)
+				iflist[nlm_index] = ifname;
+			      strncpy (ifa->ifa_name, rtadata, rtapayload);
+			      ifa->ifa_name[rtapayload] = '\0';
+			      ifname += NLMSG_ALIGN (rtapayload + 1);
+			    }
+			  break;
+			case IFA_UNSPEC:
+			  break;
+			case IFA_CACHEINFO:
+			  break;
+			default:
+				;
+			}
+		    }
+		}
+	      if (nlh->nlmsg_type == RTM_NEWADDR && nlm_family != AF_PACKET)
+		{
+		  if (!ifamap.local)
+		    {
+		      ifamap.local = ifamap.address;
+		      ifamap.local_len = ifamap.address_len;
+		    }
+		  if (!ifamap.address)
+		    {
+		      ifamap.address = ifamap.local;
+		      ifamap.address_len = ifamap.local_len;
+		    }
+		  if (ifamap.address_len != ifamap.local_len ||
+		      (ifamap.address != NULL &&
+		       memcmp (ifamap.address, ifamap.local,
+			       ifamap.address_len)))
+		    {
+		      /* p2p; address is peer and local is ours */
+		      ifamap.broadcast = ifamap.address;
+		      ifamap.broadcast_len = ifamap.address_len;
+		      ifamap.address = ifamap.local;
+		      ifamap.address_len = ifamap.local_len;
+		    }
+		  if (ifamap.address)
+		    {
+#ifndef IFA_NETMASK
+		      sockaddr_size =
+			NLMSG_ALIGN (ifa_sa_len
+				     (nlm_family, ifamap.address_len));
+#endif
+		      if (!build)
+			dlen +=
+			  NLMSG_ALIGN (ifa_sa_len
+				       (nlm_family, ifamap.address_len));
+		      else
+			{
+			  ifa->ifa_addr = (struct sockaddr *) data;
+			  ifa_make_sockaddr (nlm_family, ifa->ifa_addr,
+					     ifamap.address,
+					     ifamap.address_len, nlm_scope,
+					     nlm_index);
+			  data +=
+			    NLMSG_ALIGN (ifa_sa_len
+					 (nlm_family, ifamap.address_len));
+			}
+		    }
+#ifdef IFA_NETMASK
+		  if (ifamap.netmask)
+		    {
+		      if (!build)
+			dlen +=
+			  NLMSG_ALIGN (ifa_sa_len
+				       (nlm_family, ifamap.netmask_len));
+		      else
+			{
+			  ifa->ifa_netmask = (struct sockaddr *) data;
+			  ifa_make_sockaddr (nlm_family, ifa->ifa_netmask,
+					     ifamap.netmask,
+					     ifamap.netmask_len, nlm_scope,
+					     nlm_index);
+			  data +=
+			    NLMSG_ALIGN (ifa_sa_len
+					 (nlm_family, ifamap.netmask_len));
+			}
+		    }
+#endif
+		  if (ifamap.broadcast)
+		    {
+		      if (!build)
+			dlen +=
+			  NLMSG_ALIGN (ifa_sa_len
+				       (nlm_family, ifamap.broadcast_len));
+		      else
+			{
+			  ifa->ifa_broadaddr = (struct sockaddr *) data;
+			  ifa_make_sockaddr (nlm_family, ifa->ifa_broadaddr,
+					     ifamap.broadcast,
+					     ifamap.broadcast_len, nlm_scope,
+					     nlm_index);
+			  data +=
+			    NLMSG_ALIGN (ifa_sa_len
+					 (nlm_family, ifamap.broadcast_len));
+			}
+		    }
+#ifdef HAVE_IFADDRS_IFA_ANYCAST
+		  if (ifamap.anycast)
+		    {
+		      if (!build)
+			dlen +=
+			  NLMSG_ALIGN (ifa_sa_len
+				       (nlm_family, ifamap.anycast_len));
+		      else
+			{
+			  ifa->ifa_anycast = (struct sockaddr *) data;
+			  ifa_make_sockaddr (nlm_family, ifa->ifa_anyaddr,
+					     ifamap.anycast,
+					     ifamap.anycast_len, nlm_scope,
+					     nlm_index);
+			  data +=
+			    NLMSG_ALIGN (ifa_sa_len
+					 (nlm_family, ifamap.anycast_len));
+			}
+		    }
+#endif
+		}
+	      if (!build)
+		{
+#ifndef IFA_NETMASK
+		  dlen += sockaddr_size;
+#endif
+		  icnt++;
+		}
+	      else
+		{
+		  if (ifa->ifa_name == NULL)
+		    ifa->ifa_name = iflist[nlm_index];
+#ifndef IFA_NETMASK
+		  if (ifa->ifa_addr &&
+		      ifa->ifa_addr->sa_family != AF_UNSPEC &&
+		      ifa->ifa_addr->sa_family != AF_PACKET)
+		    {
+		      ifa->ifa_netmask = (struct sockaddr *) data;
+		      ifa_make_sockaddr_mask (ifa->ifa_addr->sa_family,
+					      ifa->ifa_netmask,
+					      nlm_prefixlen);
+		    }
+		  data += sockaddr_size;
+#endif
+		  ifl = ifa++;
+		}
+	    }
+	}
+      if (!build)
+	{
+	  if (icnt == 0 && (dlen + nlen + xlen == 0))
+	    {
+	      if (ifap != NULL)
+		*ifap = NULL;
+	      break;		/* cannot found any addresses */
+	    }
+	}
+      else
+	free_data (NULL, ifdata);
+    }
+
+/* ---------------------------------- */
+  /* Finalize */
+  free_nlmsglist (nlmsg_list);
+  nl_close (sd);
+  return 0;
+}
+
+/* ---------------------------------------------------------------------- */
+void
+rep_freeifaddrs (struct ifaddrs *ifa)
+{
+  free (ifa);
+}
+
diff -daurN samba3/lib/replace/ifaddrs.h samba3/lib/replace/ifaddrs.h
--- samba3/lib/replace/ifaddrs.h	1970-01-01 01:00:00.000000000 +0100
+++ samba3/lib/replace/ifaddrs.h	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,64 @@
+/* 	$Id: ifaddrs.h 241182 2011-02-17 21:50:03Z $	*/
+/*	from USAGI: ifaddrs.h,v 1.1 2001/01/26 07:11:48 yoshfuji Exp	*/
+
+/*
+ * Copyright (c) 1995, 1999
+ *	Berkeley Software Design, Inc.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *
+ * THIS SOFTWARE IS PROVIDED BY Berkeley Software Design, Inc. ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL Berkeley Software Design, Inc. BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	BSDI ifaddrs.h,v 2.5 2000/02/23 14:51:59 dab Exp
+ */
+
+#ifndef	_IFADDRS_H
+#define	_IFADDRS_H
+
+struct ifaddrs {
+	struct ifaddrs  *ifa_next;
+	char		*ifa_name;
+	unsigned int	 ifa_flags;
+	struct sockaddr	*ifa_addr;
+	struct sockaddr	*ifa_netmask;
+	union{
+	    struct sockaddr *ifu_broadaddr;
+	    struct sockaddr *ifu_dstaddr;
+	} ifa_ifu;
+	void		*ifa_data;
+};
+#define HAVE_STRUCT_IFADDRS 1
+
+/*
+ * This may have been defined in <net/if.h>.  Note that if <net/if.h> is
+ * to be included it must be included before this header file.
+ */
+#ifndef	ifa_broadaddr
+#define	ifa_broadaddr	ifa_ifu.ifu_broadaddr	/* broadcast address */
+#endif
+#ifndef	ifa_dstaddr
+#define	ifa_dstaddr	ifa_ifu.ifu_dstaddr	/* other end of link */
+#endif
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+extern int rep_getifaddrs __P((struct ifaddrs **));
+extern void rep_freeifaddrs __P((struct ifaddrs *));
+__END_DECLS
+
+#endif	/* _IFADDRS_H */
diff -daurN samba3/lib/replace/system/network.h samba3/lib/replace/system/network.h
--- samba3/lib/replace/system/network.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/lib/replace/system/network.h	2024-08-04 17:52:53.000000000 +0200
@@ -331,6 +331,8 @@
      * which might return 512 or bigger
      */
 #   define IOV_MAX 512
+#  else
+#   error IOV_MAX and UIO_MAXIOV undefined
 #  endif
 # endif
 #endif
diff -daurN samba3/lib/util/bitmap.c samba3/lib/util/bitmap.c
--- samba3/lib/util/bitmap.c	1970-01-01 01:00:00.000000000 +0100
+++ samba3/lib/util/bitmap.c	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,137 @@
+/*
+   Unix SMB/CIFS implementation.
+   simple bitmap functions
+   Copyright (C) Andrew Tridgell 1992-1998
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "includes.h"
+#include "lib/util/bitmap.h"
+
+/* these functions provide a simple way to allocate integers from a
+   pool without repetition */
+
+/****************************************************************************
+talloc a bitmap
+****************************************************************************/
+struct bitmap *bitmap_talloc(TALLOC_CTX *mem_ctx, int n)
+{
+	struct bitmap *bm;
+
+	bm = talloc_zero(mem_ctx, struct bitmap);
+
+	if (!bm) return NULL;
+
+	bm->n = n;
+	bm->b = talloc_zero_array(bm, uint32_t, (n+31)/32);
+	if (!bm->b) {
+		TALLOC_FREE(bm);
+		return NULL;
+	}
+	return bm;
+}
+
+/****************************************************************************
+copy as much of the source bitmap as will fit in the destination bitmap.
+****************************************************************************/
+
+int bitmap_copy(struct bitmap * const dst, const struct bitmap * const src)
+{
+        int count = MIN(dst->n, src->n);
+
+        SMB_ASSERT(dst->b != src->b);
+	memcpy(dst->b, src->b, sizeof(uint32_t)*((count+31)/32));
+
+        return count;
+}
+
+/****************************************************************************
+set a bit in a bitmap
+****************************************************************************/
+bool bitmap_set(struct bitmap *bm, unsigned i)
+{
+	if (i >= bm->n) {
+		DEBUG(0,("Setting invalid bitmap entry %d (of %d)\n",
+		      i, bm->n));
+		return false;
+	}
+	bm->b[i/32] |= (1<<(i%32));
+	return true;
+}
+
+/****************************************************************************
+clear a bit in a bitmap
+****************************************************************************/
+bool bitmap_clear(struct bitmap *bm, unsigned i)
+{
+	if (i >= bm->n) {
+		DEBUG(0,("clearing invalid bitmap entry %d (of %d)\n",
+		      i, bm->n));
+		return false;
+	}
+	bm->b[i/32] &= ~(1<<(i%32));
+	return true;
+}
+
+/****************************************************************************
+query a bit in a bitmap
+****************************************************************************/
+bool bitmap_query(struct bitmap *bm, unsigned i)
+{
+	if (i >= bm->n) return false;
+	if (bm->b[i/32] & (1<<(i%32))) {
+		return true;
+	}
+	return false;
+}
+
+/****************************************************************************
+find a zero bit in a bitmap starting at the specified offset, with
+wraparound
+****************************************************************************/
+int bitmap_find(struct bitmap *bm, unsigned ofs)
+{
+	unsigned int i, j;
+
+	if (ofs > bm->n) ofs = 0;
+
+	i = ofs;
+	while (i < bm->n) {
+		if (~(bm->b[i/32])) {
+			j = i;
+			do {
+				if (!bitmap_query(bm, j)) return j;
+				j++;
+			} while (j & 31 && j < bm->n);
+		}
+		i += 32;
+		i &= ~31;
+	}
+
+	i = 0;
+	while (i < ofs) {
+		if (~(bm->b[i/32])) {
+			j = i;
+			do {
+				if (!bitmap_query(bm, j)) return j;
+				j++;
+			} while (j & 31 && j < bm->n);
+		}
+		i += 32;
+		i &= ~31;
+	}
+
+	return -1;
+}
diff -daurN samba3/lib/util/bitmap.h samba3/lib/util/bitmap.h
--- samba3/lib/util/bitmap.h	1970-01-01 01:00:00.000000000 +0100
+++ samba3/lib/util/bitmap.h	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,32 @@
+/*
+   Unix SMB/CIFS implementation.
+   simple bitmap functions
+   Copyright (C) Andrew Tridgell 1992-1998
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+/* The following definitions come from lib/bitmap.c  */
+
+struct bitmap {
+	uint32_t *b;
+	unsigned int n;
+};
+
+struct bitmap *bitmap_talloc(TALLOC_CTX *mem_ctx, int n);
+int bitmap_copy(struct bitmap * const dst, const struct bitmap * const src);
+bool bitmap_set(struct bitmap *bm, unsigned i);
+bool bitmap_clear(struct bitmap *bm, unsigned i);
+bool bitmap_query(struct bitmap *bm, unsigned i);
+int bitmap_find(struct bitmap *bm, unsigned ofs);
diff -daurN samba3/lib/util/util.h samba3/lib/util/util.h
--- samba3/lib/util/util.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/lib/util/util.h	2024-08-04 17:52:53.000000000 +0200
@@ -53,7 +53,7 @@
 #else
 /* redefine the assert macro for non-developer builds */
 #define SMB_ASSERT(b) do { if (!(b)) { \
-        DEBUG(0,("PANIC: assert failed at %s(%d): %s\n", \
+        DEBUG(3,("PANIC: assert failed at %s(%d): %s\n", \
 	    __FILE__, __LINE__, #b)); }} while (0)
 #endif
 
diff -daurN samba3/lib/util/wscript_build samba3/lib/util/wscript_build
--- samba3/lib/util/wscript_build	2015-02-22 15:11:32.000000000 +0100
+++ samba3/lib/util/wscript_build	2024-08-04 17:52:53.000000000 +0200
@@ -99,5 +99,11 @@
                   public_headers='tdb_wrap.h',
                   private_library=True,
                   local_include=False
-                  )
+                 )
+
+bld.SAMBA_LIBRARY('bitmap',
+		  source='bitmap.c',
+		  deps='talloc samba-util',
+                  local_include=False,
+		  private_library=True)
 
diff -daurN samba3/libcli/auth/ntlmssp.h samba3/libcli/auth/ntlmssp.h
--- samba3/libcli/auth/ntlmssp.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/libcli/auth/ntlmssp.h	2024-08-04 17:52:53.000000000 +0200
@@ -83,6 +83,7 @@
 	DATA_BLOB nt_resp;
 	DATA_BLOB session_key;
 
+	uint32_t required_flags;
 	uint32_t neg_flags; /* the current state of negotiation with the NTLMSSP partner */
 
 	/**
diff -daurN samba3/libcli/auth/proto.h samba3/libcli/auth/proto.h
--- samba3/libcli/auth/proto.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/libcli/auth/proto.h	2024-08-04 17:52:53.000000000 +0200
@@ -139,6 +139,11 @@
 		      const DATA_BLOB *names_blob,
 		      DATA_BLOB *lm_response, DATA_BLOB *nt_response, 
 		      DATA_BLOB *lm_session_key, DATA_BLOB *user_session_key) ;
+NTSTATUS NTLMv2_RESPONSE_verify_netlogon_creds(const char *account_name,
+			const char *account_domain,
+			const DATA_BLOB response,
+			const struct netlogon_creds_CredentialState *creds,
+			const char *workgroup);
 
 /***********************************************************
  encode a password buffer with a unicode password.  The buffer
diff -daurN samba3/libcli/auth/smbencrypt.c samba3/libcli/auth/smbencrypt.c
--- samba3/libcli/auth/smbencrypt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/libcli/auth/smbencrypt.c	2024-08-04 17:52:53.000000000 +0200
@@ -26,7 +26,7 @@
 #include "../libcli/auth/msrpc_parse.h"
 #include "../lib/crypto/crypto.h"
 #include "../libcli/auth/libcli_auth.h"
-#include "../librpc/gen_ndr/ntlmssp.h"
+#include "../librpc/gen_ndr/ndr_ntlmssp.h"
 
 void SMBencrypt_hash(const uint8_t lm_hash[16], const uint8_t *c8, uint8_t p24[24])
 {
@@ -355,11 +355,18 @@
 	DATA_BLOB names_blob = data_blob_talloc(mem_ctx, NULL, 0);
 
 	/* Deliberately ignore return here.. */
-	(void)msrpc_gen(mem_ctx, &names_blob,
-		  "aaa",
-		  MsvAvNbDomainName, domain,
-		  MsvAvNbComputerName, hostname,
-		  MsvAvEOL, "");
+	if (hostname != NULL) {
+		(void)msrpc_gen(mem_ctx, &names_blob,
+			  "aaa",
+			  MsvAvNbDomainName, domain,
+			  MsvAvNbComputerName, hostname,
+			  MsvAvEOL, "");
+	} else {
+		(void)msrpc_gen(mem_ctx, &names_blob,
+			  "aa",
+			  MsvAvNbDomainName, domain,
+			  MsvAvEOL, "");
+	}
 	return names_blob;
 }
 
@@ -515,6 +522,146 @@
 				     lm_response, nt_response, lm_session_key, user_session_key);
 }
 
+NTSTATUS NTLMv2_RESPONSE_verify_netlogon_creds(const char *account_name,
+			const char *account_domain,
+			const DATA_BLOB response,
+			const struct netlogon_creds_CredentialState *creds,
+			const char *workgroup)
+{
+	TALLOC_CTX *frame = NULL;
+	/* RespType + HiRespType */
+	static const char *magic = "\x01\x01";
+	int cmp;
+	struct NTLMv2_RESPONSE v2_resp;
+	enum ndr_err_code err;
+	const struct AV_PAIR *av_nb_cn = NULL;
+	const struct AV_PAIR *av_nb_dn = NULL;
+
+	if (response.length < 48) {
+		/*
+		 * NTLMv2_RESPONSE has at least 48 bytes.
+		 */
+		return NT_STATUS_OK;
+	}
+
+	cmp = memcmp(response.data + 16, magic, 2);
+	if (cmp != 0) {
+		/*
+		 * It doesn't look like a valid NTLMv2_RESPONSE
+		 */
+		return NT_STATUS_OK;
+	}
+
+	frame = talloc_stackframe();
+
+	err = ndr_pull_struct_blob(&response, frame, &v2_resp,
+		(ndr_pull_flags_fn_t)ndr_pull_NTLMv2_RESPONSE);
+	if (!NDR_ERR_CODE_IS_SUCCESS(err)) {
+		NTSTATUS status;
+		status = ndr_map_error2ntstatus(err);
+		DEBUG(2,("Failed to parse NTLMv2_RESPONSE "
+			 "length %u - %s - %s\n",
+			 (unsigned)response.length,
+			 ndr_map_error2string(err),
+			 nt_errstr(status)));
+		dump_data(2, response.data, response.length);
+		TALLOC_FREE(frame);
+		return status;
+	}
+
+	if (DEBUGLVL(10)) {
+		NDR_PRINT_DEBUG(NTLMv2_RESPONSE, &v2_resp);
+	}
+
+	/*
+	 * Make sure the netbios computer name in the
+	 * NTLMv2_RESPONSE matches the computer name
+	 * in the secure channel credentials for workstation
+	 * trusts.
+	 *
+	 * And the netbios domain name matches our
+	 * workgroup.
+	 *
+	 * This prevents workstations from requesting
+	 * the session key of NTLMSSP sessions of clients
+	 * to other hosts.
+	 */
+	if (creds->secure_channel_type == SEC_CHAN_WKSTA) {
+		av_nb_cn = ndr_ntlmssp_find_av(&v2_resp.Challenge.AvPairs,
+					       MsvAvNbComputerName);
+		av_nb_dn = ndr_ntlmssp_find_av(&v2_resp.Challenge.AvPairs,
+					       MsvAvNbDomainName);
+	}
+
+	if (av_nb_cn != NULL) {
+		const char *v = NULL;
+		char *a = NULL;
+		size_t len;
+
+		v = av_nb_cn->Value.AvNbComputerName;
+
+		a = talloc_strdup(frame, creds->account_name);
+		if (a == NULL) {
+			TALLOC_FREE(frame);
+			return NT_STATUS_NO_MEMORY;
+		}
+		len = strlen(a);
+		if (len > 0 && a[len - 1] == '$') {
+			a[len - 1] = '\0';
+		}
+
+#ifdef SAMBA4_INTERNAL_HEIMDAL /* smbtorture4 for make test */
+		cmp = strcasecmp_m(a, v);
+#else /* smbd */
+		cmp = StrCaseCmp(a, v);
+#endif
+		if (cmp != 0) {
+			DEBUG(2,("%s: NTLMv2_RESPONSE with "
+				 "NbComputerName[%s] rejected "
+				 "for user[%s\\%s] "
+				 "against SEC_CHAN_WKSTA[%s/%s] "
+				 "in workgroup[%s]\n",
+				 __func__, v,
+				 account_domain,
+				 account_name,
+				 creds->computer_name,
+				 creds->account_name,
+				 workgroup));
+			TALLOC_FREE(frame);
+			return NT_STATUS_LOGON_FAILURE;
+		}
+	}
+	if (av_nb_dn != NULL) {
+		const char *v = NULL;
+
+		v = av_nb_dn->Value.AvNbDomainName;
+
+#ifdef SAMBA4_INTERNAL_HEIMDAL /* smbtorture4 for make test */
+		cmp = strcasecmp_m(workgroup, v);
+#else /* smbd */
+		cmp = StrCaseCmp(workgroup, v);
+#endif
+		if (cmp != 0) {
+			DEBUG(2,("%s: NTLMv2_RESPONSE with "
+				 "NbDomainName[%s] rejected "
+				 "for user[%s\\%s] "
+				 "against SEC_CHAN_WKSTA[%s/%s] "
+				 "in workgroup[%s]\n",
+				 __func__, v,
+				 account_domain,
+				 account_name,
+				 creds->computer_name,
+				 creds->account_name,
+				 workgroup));
+			TALLOC_FREE(frame);
+			return NT_STATUS_LOGON_FAILURE;
+		}
+	}
+
+	TALLOC_FREE(frame);
+	return NT_STATUS_OK;
+}
+
 /***********************************************************
  encode a password buffer with a unicode password.  The buffer
  is filled with random data to make it harder to attack.
diff -daurN samba3/libcli/auth/wscript_build samba3/libcli/auth/wscript_build
--- samba3/libcli/auth/wscript_build	2015-02-22 15:11:32.000000000 +0100
+++ samba3/libcli/auth/wscript_build	2024-08-04 17:52:53.000000000 +0200
@@ -19,7 +19,7 @@
 
 bld.SAMBA_SUBSYSTEM('LIBCLI_AUTH',
 	source='credentials.c session.c smbencrypt.c smbdes.c',
-	public_deps='MSRPC_PARSE',
+	public_deps='MSRPC_PARSE NDR_NTLMSSP',
 	public_headers='credentials.h:domain_credentials.h'
 	)
 
diff -daurN samba3/librpc/ABI/ndr-0.0.2.sigs samba3/librpc/ABI/ndr-0.0.2.sigs
--- samba3/librpc/ABI/ndr-0.0.2.sigs	1970-01-01 01:00:00.000000000 +0100
+++ samba3/librpc/ABI/ndr-0.0.2.sigs	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,247 @@
+GUID_all_zero: bool (const struct GUID *)
+GUID_compare: int (const struct GUID *, const struct GUID *)
+GUID_equal: bool (const struct GUID *, const struct GUID *)
+GUID_from_data_blob: NTSTATUS (const DATA_BLOB *, struct GUID *)
+GUID_from_ndr_blob: NTSTATUS (const DATA_BLOB *, struct GUID *)
+GUID_from_string: NTSTATUS (const char *, struct GUID *)
+GUID_hexstring: char *(TALLOC_CTX *, const struct GUID *)
+GUID_random: struct GUID (void)
+GUID_string: char *(TALLOC_CTX *, const struct GUID *)
+GUID_string2: char *(TALLOC_CTX *, const struct GUID *)
+GUID_to_ndr_blob: NTSTATUS (const struct GUID *, TALLOC_CTX *, DATA_BLOB *)
+GUID_zero: struct GUID (void)
+ndr_align_size: size_t (uint32_t, size_t)
+ndr_charset_length: uint32_t (const void *, charset_t)
+ndr_check_array_length: enum ndr_err_code (struct ndr_pull *, void *, uint32_t)
+ndr_check_array_size: enum ndr_err_code (struct ndr_pull *, void *, uint32_t)
+ndr_check_padding: void (struct ndr_pull *, size_t)
+ndr_check_pipe_chunk_trailer: enum ndr_err_code (struct ndr_pull *, int, uint32_t)
+ndr_check_string_terminator: enum ndr_err_code (struct ndr_pull *, uint32_t, uint32_t)
+ndr_get_array_length: uint32_t (struct ndr_pull *, const void *)
+ndr_get_array_size: uint32_t (struct ndr_pull *, const void *)
+ndr_map_error2errno: int (enum ndr_err_code)
+ndr_map_error2ntstatus: NTSTATUS (enum ndr_err_code)
+ndr_map_error2string: const char *(enum ndr_err_code)
+ndr_policy_handle_empty: bool (const struct policy_handle *)
+ndr_policy_handle_equal: bool (const struct policy_handle *, const struct policy_handle *)
+ndr_print_DATA_BLOB: void (struct ndr_print *, const char *, DATA_BLOB)
+ndr_print_GUID: void (struct ndr_print *, const char *, const struct GUID *)
+ndr_print_KRB5_EDATA_NTSTATUS: void (struct ndr_print *, const char *, const struct KRB5_EDATA_NTSTATUS *)
+ndr_print_NTSTATUS: void (struct ndr_print *, const char *, NTSTATUS)
+ndr_print_NTTIME: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_NTTIME_1sec: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_NTTIME_hyper: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_WERROR: void (struct ndr_print *, const char *, WERROR)
+ndr_print_array_uint8: void (struct ndr_print *, const char *, const uint8_t *, uint32_t)
+ndr_print_bad_level: void (struct ndr_print *, const char *, uint16_t)
+ndr_print_bitmap_flag: void (struct ndr_print *, size_t, const char *, uint32_t, uint32_t)
+ndr_print_bool: void (struct ndr_print *, const char *, const bool)
+ndr_print_debug: void (ndr_print_fn_t, const char *, void *)
+ndr_print_debug_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_debugc: void (int, ndr_print_fn_t, const char *, void *)
+ndr_print_debugc_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_dlong: void (struct ndr_print *, const char *, int64_t)
+ndr_print_double: void (struct ndr_print *, const char *, double)
+ndr_print_enum: void (struct ndr_print *, const char *, const char *, const char *, uint32_t)
+ndr_print_function_debug: void (ndr_print_function_t, const char *, int, void *)
+ndr_print_function_string: char *(TALLOC_CTX *, ndr_print_function_t, const char *, int, void *)
+ndr_print_get_switch_value: uint32_t (struct ndr_print *, const void *)
+ndr_print_gid_t: void (struct ndr_print *, const char *, gid_t)
+ndr_print_hyper: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_int16: void (struct ndr_print *, const char *, int16_t)
+ndr_print_int32: void (struct ndr_print *, const char *, int32_t)
+ndr_print_int3264: void (struct ndr_print *, const char *, int32_t)
+ndr_print_int8: void (struct ndr_print *, const char *, int8_t)
+ndr_print_ipv4address: void (struct ndr_print *, const char *, const char *)
+ndr_print_ipv6address: void (struct ndr_print *, const char *, const char *)
+ndr_print_ndr_syntax_id: void (struct ndr_print *, const char *, const struct ndr_syntax_id *)
+ndr_print_netr_SamDatabaseID: void (struct ndr_print *, const char *, enum netr_SamDatabaseID)
+ndr_print_netr_SchannelType: void (struct ndr_print *, const char *, enum netr_SchannelType)
+ndr_print_null: void (struct ndr_print *)
+ndr_print_pointer: void (struct ndr_print *, const char *, void *)
+ndr_print_policy_handle: void (struct ndr_print *, const char *, const struct policy_handle *)
+ndr_print_printf_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_ptr: void (struct ndr_print *, const char *, const void *)
+ndr_print_set_switch_value: enum ndr_err_code (struct ndr_print *, const void *, uint32_t)
+ndr_print_sockaddr_storage: void (struct ndr_print *, const char *, const struct sockaddr_storage *)
+ndr_print_string: void (struct ndr_print *, const char *, const char *)
+ndr_print_string_array: void (struct ndr_print *, const char *, const char **)
+ndr_print_string_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_struct: void (struct ndr_print *, const char *, const char *)
+ndr_print_struct_string: char *(TALLOC_CTX *, ndr_print_fn_t, const char *, void *)
+ndr_print_svcctl_ServerType: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_time_t: void (struct ndr_print *, const char *, time_t)
+ndr_print_timespec: void (struct ndr_print *, const char *, const struct timespec *)
+ndr_print_timeval: void (struct ndr_print *, const char *, const struct timeval *)
+ndr_print_udlong: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_udlongr: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_uid_t: void (struct ndr_print *, const char *, uid_t)
+ndr_print_uint16: void (struct ndr_print *, const char *, uint16_t)
+ndr_print_uint32: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_uint3264: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_uint8: void (struct ndr_print *, const char *, uint8_t)
+ndr_print_union: void (struct ndr_print *, const char *, int, const char *)
+ndr_print_union_debug: void (ndr_print_fn_t, const char *, uint32_t, void *)
+ndr_print_union_string: char *(TALLOC_CTX *, ndr_print_fn_t, const char *, uint32_t, void *)
+ndr_print_winreg_Data: void (struct ndr_print *, const char *, const union winreg_Data *)
+ndr_print_winreg_Type: void (struct ndr_print *, const char *, enum winreg_Type)
+ndr_pull_DATA_BLOB: enum ndr_err_code (struct ndr_pull *, int, DATA_BLOB *)
+ndr_pull_GUID: enum ndr_err_code (struct ndr_pull *, int, struct GUID *)
+ndr_pull_KRB5_EDATA_NTSTATUS: enum ndr_err_code (struct ndr_pull *, int, struct KRB5_EDATA_NTSTATUS *)
+ndr_pull_NTSTATUS: enum ndr_err_code (struct ndr_pull *, int, NTSTATUS *)
+ndr_pull_NTTIME: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_NTTIME_1sec: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_NTTIME_hyper: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_WERROR: enum ndr_err_code (struct ndr_pull *, int, WERROR *)
+ndr_pull_advance: enum ndr_err_code (struct ndr_pull *, uint32_t)
+ndr_pull_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_array_length: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_array_size: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_array_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *, uint32_t)
+ndr_pull_bytes: enum ndr_err_code (struct ndr_pull *, uint8_t *, uint32_t)
+ndr_pull_charset: enum ndr_err_code (struct ndr_pull *, int, const char **, uint32_t, uint8_t, charset_t)
+ndr_pull_charset_to_null: enum ndr_err_code (struct ndr_pull *, int, const char **, uint32_t, uint8_t, charset_t)
+ndr_pull_dlong: enum ndr_err_code (struct ndr_pull *, int, int64_t *)
+ndr_pull_double: enum ndr_err_code (struct ndr_pull *, int, double *)
+ndr_pull_enum_uint16: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_enum_uint1632: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_enum_uint32: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_enum_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *)
+ndr_pull_error: enum ndr_err_code (struct ndr_pull *, enum ndr_err_code, const char *, ...)
+ndr_pull_generic_ptr: enum ndr_err_code (struct ndr_pull *, uint32_t *)
+ndr_pull_get_relative_base_offset: uint32_t (struct ndr_pull *)
+ndr_pull_get_switch_value: uint32_t (struct ndr_pull *, const void *)
+ndr_pull_gid_t: enum ndr_err_code (struct ndr_pull *, int, gid_t *)
+ndr_pull_hyper: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_init_blob: struct ndr_pull *(const DATA_BLOB *, TALLOC_CTX *)
+ndr_pull_int16: enum ndr_err_code (struct ndr_pull *, int, int16_t *)
+ndr_pull_int32: enum ndr_err_code (struct ndr_pull *, int, int32_t *)
+ndr_pull_int8: enum ndr_err_code (struct ndr_pull *, int, int8_t *)
+ndr_pull_ipv4address: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_ipv6address: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_ndr_syntax_id: enum ndr_err_code (struct ndr_pull *, int, struct ndr_syntax_id *)
+ndr_pull_netr_SamDatabaseID: enum ndr_err_code (struct ndr_pull *, int, enum netr_SamDatabaseID *)
+ndr_pull_netr_SchannelType: enum ndr_err_code (struct ndr_pull *, int, enum netr_SchannelType *)
+ndr_pull_pointer: enum ndr_err_code (struct ndr_pull *, int, void **)
+ndr_pull_policy_handle: enum ndr_err_code (struct ndr_pull *, int, struct policy_handle *)
+ndr_pull_ref_ptr: enum ndr_err_code (struct ndr_pull *, uint32_t *)
+ndr_pull_relative_ptr1: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_relative_ptr2: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_relative_ptr_short: enum ndr_err_code (struct ndr_pull *, uint16_t *)
+ndr_pull_restore_relative_base_offset: void (struct ndr_pull *, uint32_t)
+ndr_pull_set_switch_value: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_setup_relative_base_offset1: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_setup_relative_base_offset2: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_string: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_string_array: enum ndr_err_code (struct ndr_pull *, int, const char ***)
+ndr_pull_struct_blob: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, ndr_pull_flags_fn_t)
+ndr_pull_struct_blob_all: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, ndr_pull_flags_fn_t)
+ndr_pull_subcontext_end: enum ndr_err_code (struct ndr_pull *, struct ndr_pull *, size_t, ssize_t)
+ndr_pull_subcontext_start: enum ndr_err_code (struct ndr_pull *, struct ndr_pull **, size_t, ssize_t)
+ndr_pull_svcctl_ServerType: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_time_t: enum ndr_err_code (struct ndr_pull *, int, time_t *)
+ndr_pull_timespec: enum ndr_err_code (struct ndr_pull *, int, struct timespec *)
+ndr_pull_timeval: enum ndr_err_code (struct ndr_pull *, int, struct timeval *)
+ndr_pull_trailer_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_udlong: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_udlongr: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_uid_t: enum ndr_err_code (struct ndr_pull *, int, uid_t *)
+ndr_pull_uint16: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_uint1632: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_uint32: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_uint3264: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *)
+ndr_pull_union_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_union_blob: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_pull_flags_fn_t)
+ndr_pull_union_blob_all: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_pull_flags_fn_t)
+ndr_pull_winreg_Data: enum ndr_err_code (struct ndr_pull *, int, union winreg_Data *)
+ndr_pull_winreg_Type: enum ndr_err_code (struct ndr_pull *, int, enum winreg_Type *)
+ndr_push_DATA_BLOB: enum ndr_err_code (struct ndr_push *, int, DATA_BLOB)
+ndr_push_GUID: enum ndr_err_code (struct ndr_push *, int, const struct GUID *)
+ndr_push_KRB5_EDATA_NTSTATUS: enum ndr_err_code (struct ndr_push *, int, const struct KRB5_EDATA_NTSTATUS *)
+ndr_push_NTSTATUS: enum ndr_err_code (struct ndr_push *, int, NTSTATUS)
+ndr_push_NTTIME: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_NTTIME_1sec: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_NTTIME_hyper: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_WERROR: enum ndr_err_code (struct ndr_push *, int, WERROR)
+ndr_push_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_array_uint8: enum ndr_err_code (struct ndr_push *, int, const uint8_t *, uint32_t)
+ndr_push_blob: DATA_BLOB (struct ndr_push *)
+ndr_push_bytes: enum ndr_err_code (struct ndr_push *, const uint8_t *, uint32_t)
+ndr_push_charset: enum ndr_err_code (struct ndr_push *, int, const char *, uint32_t, uint8_t, charset_t)
+ndr_push_dlong: enum ndr_err_code (struct ndr_push *, int, int64_t)
+ndr_push_double: enum ndr_err_code (struct ndr_push *, int, double)
+ndr_push_enum_uint16: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_enum_uint1632: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_enum_uint32: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_enum_uint8: enum ndr_err_code (struct ndr_push *, int, uint8_t)
+ndr_push_error: enum ndr_err_code (struct ndr_push *, enum ndr_err_code, const char *, ...)
+ndr_push_expand: enum ndr_err_code (struct ndr_push *, uint32_t)
+ndr_push_full_ptr: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_get_relative_base_offset: uint32_t (struct ndr_push *)
+ndr_push_get_switch_value: uint32_t (struct ndr_push *, const void *)
+ndr_push_gid_t: enum ndr_err_code (struct ndr_push *, int, gid_t)
+ndr_push_hyper: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_init_ctx: struct ndr_push *(TALLOC_CTX *)
+ndr_push_int16: enum ndr_err_code (struct ndr_push *, int, int16_t)
+ndr_push_int32: enum ndr_err_code (struct ndr_push *, int, int32_t)
+ndr_push_int8: enum ndr_err_code (struct ndr_push *, int, int8_t)
+ndr_push_ipv4address: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_ipv6address: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_ndr_syntax_id: enum ndr_err_code (struct ndr_push *, int, const struct ndr_syntax_id *)
+ndr_push_netr_SamDatabaseID: enum ndr_err_code (struct ndr_push *, int, enum netr_SamDatabaseID)
+ndr_push_netr_SchannelType: enum ndr_err_code (struct ndr_push *, int, enum netr_SchannelType)
+ndr_push_pipe_chunk_trailer: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_pointer: enum ndr_err_code (struct ndr_push *, int, void *)
+ndr_push_policy_handle: enum ndr_err_code (struct ndr_push *, int, const struct policy_handle *)
+ndr_push_ref_ptr: enum ndr_err_code (struct ndr_push *)
+ndr_push_relative_ptr1: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_relative_ptr2_end: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_relative_ptr2_start: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_restore_relative_base_offset: void (struct ndr_push *, uint32_t)
+ndr_push_set_switch_value: enum ndr_err_code (struct ndr_push *, const void *, uint32_t)
+ndr_push_setup_relative_base_offset1: enum ndr_err_code (struct ndr_push *, const void *, uint32_t)
+ndr_push_setup_relative_base_offset2: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_short_relative_ptr1: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_short_relative_ptr2: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_string: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_string_array: enum ndr_err_code (struct ndr_push *, int, const char **)
+ndr_push_struct_blob: enum ndr_err_code (DATA_BLOB *, TALLOC_CTX *, const void *, ndr_push_flags_fn_t)
+ndr_push_subcontext_end: enum ndr_err_code (struct ndr_push *, struct ndr_push *, size_t, ssize_t)
+ndr_push_subcontext_start: enum ndr_err_code (struct ndr_push *, struct ndr_push **, size_t, ssize_t)
+ndr_push_svcctl_ServerType: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_time_t: enum ndr_err_code (struct ndr_push *, int, time_t)
+ndr_push_timespec: enum ndr_err_code (struct ndr_push *, int, const struct timespec *)
+ndr_push_timeval: enum ndr_err_code (struct ndr_push *, int, const struct timeval *)
+ndr_push_trailer_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_udlong: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_udlongr: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_uid_t: enum ndr_err_code (struct ndr_push *, int, uid_t)
+ndr_push_uint16: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_uint1632: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_uint32: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_uint3264: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_uint8: enum ndr_err_code (struct ndr_push *, int, uint8_t)
+ndr_push_union_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_union_blob: enum ndr_err_code (DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_push_flags_fn_t)
+ndr_push_unique_ptr: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_winreg_Data: enum ndr_err_code (struct ndr_push *, int, const union winreg_Data *)
+ndr_push_winreg_Type: enum ndr_err_code (struct ndr_push *, int, enum winreg_Type)
+ndr_push_zero: enum ndr_err_code (struct ndr_push *, uint32_t)
+ndr_set_flags: void (uint32_t *, uint32_t)
+ndr_size_DATA_BLOB: uint32_t (int, const DATA_BLOB *, int)
+ndr_size_GUID: size_t (const struct GUID *, int)
+ndr_size_string: uint32_t (int, const char * const *, int)
+ndr_size_string_array: size_t (const char **, uint32_t, int)
+ndr_size_struct: size_t (const void *, int, ndr_push_flags_fn_t)
+ndr_size_union: size_t (const void *, int, uint32_t, ndr_push_flags_fn_t)
+ndr_string_array_size: size_t (struct ndr_push *, const char *)
+ndr_string_length: uint32_t (const void *, uint32_t)
+ndr_syntax_id_equal: bool (const struct ndr_syntax_id *, const struct ndr_syntax_id *)
+ndr_syntax_id_null: uuid = {time_low = 0, time_mid = 0, time_hi_and_version = 0, clock_seq = "\000", node = "\000\000\000\000\000"}, if_version = 0
+ndr_token_peek: uint32_t (struct ndr_token_list **, const void *)
+ndr_token_retrieve: enum ndr_err_code (struct ndr_token_list **, const void *, uint32_t *)
+ndr_token_retrieve_cmp_fn: enum ndr_err_code (struct ndr_token_list **, const void *, uint32_t *, comparison_fn_t, bool)
+ndr_token_store: enum ndr_err_code (TALLOC_CTX *, struct ndr_token_list **, const void *, uint32_t)
+ndr_transfer_syntax_ndr: uuid = {time_low = 2324192516, time_mid = 7403, time_hi_and_version = 4553, clock_seq = "\237\350", node = "\b\000+\020H`"}, if_version = 2
+ndr_transfer_syntax_ndr64: uuid = {time_low = 1903232307, time_mid = 48826, time_hi_and_version = 18743, clock_seq = "\203\031", node = "\265\333\357\234\314\066"}, if_version = 1
diff -daurN samba3/librpc/ABI/ndr-0.0.3.sigs samba3/librpc/ABI/ndr-0.0.3.sigs
--- samba3/librpc/ABI/ndr-0.0.3.sigs	1970-01-01 01:00:00.000000000 +0100
+++ samba3/librpc/ABI/ndr-0.0.3.sigs	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,251 @@
+GUID_all_zero: bool (const struct GUID *)
+GUID_compare: int (const struct GUID *, const struct GUID *)
+GUID_equal: bool (const struct GUID *, const struct GUID *)
+GUID_from_data_blob: NTSTATUS (const DATA_BLOB *, struct GUID *)
+GUID_from_ndr_blob: NTSTATUS (const DATA_BLOB *, struct GUID *)
+GUID_from_string: NTSTATUS (const char *, struct GUID *)
+GUID_hexstring: char *(TALLOC_CTX *, const struct GUID *)
+GUID_random: struct GUID (void)
+GUID_string: char *(TALLOC_CTX *, const struct GUID *)
+GUID_string2: char *(TALLOC_CTX *, const struct GUID *)
+GUID_to_ndr_blob: NTSTATUS (const struct GUID *, TALLOC_CTX *, DATA_BLOB *)
+GUID_zero: struct GUID (void)
+ndr_align_size: size_t (uint32_t, size_t)
+ndr_charset_length: uint32_t (const void *, charset_t)
+ndr_check_array_length: enum ndr_err_code (struct ndr_pull *, void *, uint32_t)
+ndr_check_array_size: enum ndr_err_code (struct ndr_pull *, void *, uint32_t)
+ndr_check_padding: void (struct ndr_pull *, size_t)
+ndr_check_pipe_chunk_trailer: enum ndr_err_code (struct ndr_pull *, int, uint32_t)
+ndr_check_string_terminator: enum ndr_err_code (struct ndr_pull *, uint32_t, uint32_t)
+ndr_get_array_length: uint32_t (struct ndr_pull *, const void *)
+ndr_get_array_size: uint32_t (struct ndr_pull *, const void *)
+ndr_map_error2errno: int (enum ndr_err_code)
+ndr_map_error2ntstatus: NTSTATUS (enum ndr_err_code)
+ndr_map_error2string: const char *(enum ndr_err_code)
+ndr_policy_handle_empty: bool (const struct policy_handle *)
+ndr_policy_handle_equal: bool (const struct policy_handle *, const struct policy_handle *)
+ndr_print_DATA_BLOB: void (struct ndr_print *, const char *, DATA_BLOB)
+ndr_print_GUID: void (struct ndr_print *, const char *, const struct GUID *)
+ndr_print_KRB5_EDATA_NTSTATUS: void (struct ndr_print *, const char *, const struct KRB5_EDATA_NTSTATUS *)
+ndr_print_NTSTATUS: void (struct ndr_print *, const char *, NTSTATUS)
+ndr_print_NTTIME: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_NTTIME_1sec: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_NTTIME_hyper: void (struct ndr_print *, const char *, NTTIME)
+ndr_print_WERROR: void (struct ndr_print *, const char *, WERROR)
+ndr_print_array_uint8: void (struct ndr_print *, const char *, const uint8_t *, uint32_t)
+ndr_print_bad_level: void (struct ndr_print *, const char *, uint16_t)
+ndr_print_bitmap_flag: void (struct ndr_print *, size_t, const char *, uint32_t, uint32_t)
+ndr_print_bool: void (struct ndr_print *, const char *, const bool)
+ndr_print_debug: void (ndr_print_fn_t, const char *, void *)
+ndr_print_debug_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_debugc: void (int, ndr_print_fn_t, const char *, void *)
+ndr_print_debugc_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_dlong: void (struct ndr_print *, const char *, int64_t)
+ndr_print_double: void (struct ndr_print *, const char *, double)
+ndr_print_enum: void (struct ndr_print *, const char *, const char *, const char *, uint32_t)
+ndr_print_function_debug: void (ndr_print_function_t, const char *, int, void *)
+ndr_print_function_string: char *(TALLOC_CTX *, ndr_print_function_t, const char *, int, void *)
+ndr_print_get_switch_value: uint32_t (struct ndr_print *, const void *)
+ndr_print_gid_t: void (struct ndr_print *, const char *, gid_t)
+ndr_print_hyper: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_int16: void (struct ndr_print *, const char *, int16_t)
+ndr_print_int32: void (struct ndr_print *, const char *, int32_t)
+ndr_print_int3264: void (struct ndr_print *, const char *, int32_t)
+ndr_print_int8: void (struct ndr_print *, const char *, int8_t)
+ndr_print_ipv4address: void (struct ndr_print *, const char *, const char *)
+ndr_print_ipv6address: void (struct ndr_print *, const char *, const char *)
+ndr_print_ndr_syntax_id: void (struct ndr_print *, const char *, const struct ndr_syntax_id *)
+ndr_print_netr_SamDatabaseID: void (struct ndr_print *, const char *, enum netr_SamDatabaseID)
+ndr_print_netr_SchannelType: void (struct ndr_print *, const char *, enum netr_SchannelType)
+ndr_print_null: void (struct ndr_print *)
+ndr_print_pointer: void (struct ndr_print *, const char *, void *)
+ndr_print_policy_handle: void (struct ndr_print *, const char *, const struct policy_handle *)
+ndr_print_printf_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_ptr: void (struct ndr_print *, const char *, const void *)
+ndr_print_set_switch_value: enum ndr_err_code (struct ndr_print *, const void *, uint32_t)
+ndr_print_sockaddr_storage: void (struct ndr_print *, const char *, const struct sockaddr_storage *)
+ndr_print_string: void (struct ndr_print *, const char *, const char *)
+ndr_print_string_array: void (struct ndr_print *, const char *, const char **)
+ndr_print_string_helper: void (struct ndr_print *, const char *, ...)
+ndr_print_struct: void (struct ndr_print *, const char *, const char *)
+ndr_print_struct_string: char *(TALLOC_CTX *, ndr_print_fn_t, const char *, void *)
+ndr_print_svcctl_ServerType: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_time_t: void (struct ndr_print *, const char *, time_t)
+ndr_print_timespec: void (struct ndr_print *, const char *, const struct timespec *)
+ndr_print_timeval: void (struct ndr_print *, const char *, const struct timeval *)
+ndr_print_udlong: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_udlongr: void (struct ndr_print *, const char *, uint64_t)
+ndr_print_uid_t: void (struct ndr_print *, const char *, uid_t)
+ndr_print_uint16: void (struct ndr_print *, const char *, uint16_t)
+ndr_print_uint32: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_uint3264: void (struct ndr_print *, const char *, uint32_t)
+ndr_print_uint8: void (struct ndr_print *, const char *, uint8_t)
+ndr_print_union: void (struct ndr_print *, const char *, int, const char *)
+ndr_print_union_debug: void (ndr_print_fn_t, const char *, uint32_t, void *)
+ndr_print_union_string: char *(TALLOC_CTX *, ndr_print_fn_t, const char *, uint32_t, void *)
+ndr_print_winreg_Data: void (struct ndr_print *, const char *, const union winreg_Data *)
+ndr_print_winreg_Type: void (struct ndr_print *, const char *, enum winreg_Type)
+ndr_pull_DATA_BLOB: enum ndr_err_code (struct ndr_pull *, int, DATA_BLOB *)
+ndr_pull_GUID: enum ndr_err_code (struct ndr_pull *, int, struct GUID *)
+ndr_pull_KRB5_EDATA_NTSTATUS: enum ndr_err_code (struct ndr_pull *, int, struct KRB5_EDATA_NTSTATUS *)
+ndr_pull_NTSTATUS: enum ndr_err_code (struct ndr_pull *, int, NTSTATUS *)
+ndr_pull_NTTIME: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_NTTIME_1sec: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_NTTIME_hyper: enum ndr_err_code (struct ndr_pull *, int, NTTIME *)
+ndr_pull_WERROR: enum ndr_err_code (struct ndr_pull *, int, WERROR *)
+ndr_pull_advance: enum ndr_err_code (struct ndr_pull *, uint32_t)
+ndr_pull_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_append: enum ndr_err_code (struct ndr_pull *, DATA_BLOB *)
+ndr_pull_array_length: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_array_size: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_array_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *, uint32_t)
+ndr_pull_bytes: enum ndr_err_code (struct ndr_pull *, uint8_t *, uint32_t)
+ndr_pull_charset: enum ndr_err_code (struct ndr_pull *, int, const char **, uint32_t, uint8_t, charset_t)
+ndr_pull_charset_to_null: enum ndr_err_code (struct ndr_pull *, int, const char **, uint32_t, uint8_t, charset_t)
+ndr_pull_dlong: enum ndr_err_code (struct ndr_pull *, int, int64_t *)
+ndr_pull_double: enum ndr_err_code (struct ndr_pull *, int, double *)
+ndr_pull_enum_uint16: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_enum_uint1632: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_enum_uint32: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_enum_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *)
+ndr_pull_error: enum ndr_err_code (struct ndr_pull *, enum ndr_err_code, const char *, ...)
+ndr_pull_generic_ptr: enum ndr_err_code (struct ndr_pull *, uint32_t *)
+ndr_pull_get_relative_base_offset: uint32_t (struct ndr_pull *)
+ndr_pull_get_switch_value: uint32_t (struct ndr_pull *, const void *)
+ndr_pull_gid_t: enum ndr_err_code (struct ndr_pull *, int, gid_t *)
+ndr_pull_hyper: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_init_blob: struct ndr_pull *(const DATA_BLOB *, TALLOC_CTX *)
+ndr_pull_int16: enum ndr_err_code (struct ndr_pull *, int, int16_t *)
+ndr_pull_int32: enum ndr_err_code (struct ndr_pull *, int, int32_t *)
+ndr_pull_int8: enum ndr_err_code (struct ndr_pull *, int, int8_t *)
+ndr_pull_ipv4address: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_ipv6address: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_ndr_syntax_id: enum ndr_err_code (struct ndr_pull *, int, struct ndr_syntax_id *)
+ndr_pull_netr_SamDatabaseID: enum ndr_err_code (struct ndr_pull *, int, enum netr_SamDatabaseID *)
+ndr_pull_netr_SchannelType: enum ndr_err_code (struct ndr_pull *, int, enum netr_SchannelType *)
+ndr_pull_pointer: enum ndr_err_code (struct ndr_pull *, int, void **)
+ndr_pull_policy_handle: enum ndr_err_code (struct ndr_pull *, int, struct policy_handle *)
+ndr_pull_pop: enum ndr_err_code (struct ndr_pull *)
+ndr_pull_ref_ptr: enum ndr_err_code (struct ndr_pull *, uint32_t *)
+ndr_pull_relative_ptr1: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_relative_ptr2: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_relative_ptr_short: enum ndr_err_code (struct ndr_pull *, uint16_t *)
+ndr_pull_restore_relative_base_offset: void (struct ndr_pull *, uint32_t)
+ndr_pull_set_switch_value: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_setup_relative_base_offset1: enum ndr_err_code (struct ndr_pull *, const void *, uint32_t)
+ndr_pull_setup_relative_base_offset2: enum ndr_err_code (struct ndr_pull *, const void *)
+ndr_pull_string: enum ndr_err_code (struct ndr_pull *, int, const char **)
+ndr_pull_string_array: enum ndr_err_code (struct ndr_pull *, int, const char ***)
+ndr_pull_struct_blob: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, ndr_pull_flags_fn_t)
+ndr_pull_struct_blob_all: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, ndr_pull_flags_fn_t)
+ndr_pull_subcontext_end: enum ndr_err_code (struct ndr_pull *, struct ndr_pull *, size_t, ssize_t)
+ndr_pull_subcontext_start: enum ndr_err_code (struct ndr_pull *, struct ndr_pull **, size_t, ssize_t)
+ndr_pull_svcctl_ServerType: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_time_t: enum ndr_err_code (struct ndr_pull *, int, time_t *)
+ndr_pull_timespec: enum ndr_err_code (struct ndr_pull *, int, struct timespec *)
+ndr_pull_timeval: enum ndr_err_code (struct ndr_pull *, int, struct timeval *)
+ndr_pull_trailer_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_udlong: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_udlongr: enum ndr_err_code (struct ndr_pull *, int, uint64_t *)
+ndr_pull_uid_t: enum ndr_err_code (struct ndr_pull *, int, uid_t *)
+ndr_pull_uint16: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_uint1632: enum ndr_err_code (struct ndr_pull *, int, uint16_t *)
+ndr_pull_uint32: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_uint3264: enum ndr_err_code (struct ndr_pull *, int, uint32_t *)
+ndr_pull_uint8: enum ndr_err_code (struct ndr_pull *, int, uint8_t *)
+ndr_pull_union_align: enum ndr_err_code (struct ndr_pull *, size_t)
+ndr_pull_union_blob: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_pull_flags_fn_t)
+ndr_pull_union_blob_all: enum ndr_err_code (const DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_pull_flags_fn_t)
+ndr_pull_winreg_Data: enum ndr_err_code (struct ndr_pull *, int, union winreg_Data *)
+ndr_pull_winreg_Type: enum ndr_err_code (struct ndr_pull *, int, enum winreg_Type *)
+ndr_push_DATA_BLOB: enum ndr_err_code (struct ndr_push *, int, DATA_BLOB)
+ndr_push_GUID: enum ndr_err_code (struct ndr_push *, int, const struct GUID *)
+ndr_push_KRB5_EDATA_NTSTATUS: enum ndr_err_code (struct ndr_push *, int, const struct KRB5_EDATA_NTSTATUS *)
+ndr_push_NTSTATUS: enum ndr_err_code (struct ndr_push *, int, NTSTATUS)
+ndr_push_NTTIME: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_NTTIME_1sec: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_NTTIME_hyper: enum ndr_err_code (struct ndr_push *, int, NTTIME)
+ndr_push_WERROR: enum ndr_err_code (struct ndr_push *, int, WERROR)
+ndr_push_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_array_uint8: enum ndr_err_code (struct ndr_push *, int, const uint8_t *, uint32_t)
+ndr_push_blob: DATA_BLOB (struct ndr_push *)
+ndr_push_bytes: enum ndr_err_code (struct ndr_push *, const uint8_t *, uint32_t)
+ndr_push_charset: enum ndr_err_code (struct ndr_push *, int, const char *, uint32_t, uint8_t, charset_t)
+ndr_push_dlong: enum ndr_err_code (struct ndr_push *, int, int64_t)
+ndr_push_double: enum ndr_err_code (struct ndr_push *, int, double)
+ndr_push_enum_uint16: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_enum_uint1632: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_enum_uint32: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_enum_uint8: enum ndr_err_code (struct ndr_push *, int, uint8_t)
+ndr_push_error: enum ndr_err_code (struct ndr_push *, enum ndr_err_code, const char *, ...)
+ndr_push_expand: enum ndr_err_code (struct ndr_push *, uint32_t)
+ndr_push_full_ptr: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_get_relative_base_offset: uint32_t (struct ndr_push *)
+ndr_push_get_switch_value: uint32_t (struct ndr_push *, const void *)
+ndr_push_gid_t: enum ndr_err_code (struct ndr_push *, int, gid_t)
+ndr_push_hyper: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_init_ctx: struct ndr_push *(TALLOC_CTX *)
+ndr_push_int16: enum ndr_err_code (struct ndr_push *, int, int16_t)
+ndr_push_int32: enum ndr_err_code (struct ndr_push *, int, int32_t)
+ndr_push_int8: enum ndr_err_code (struct ndr_push *, int, int8_t)
+ndr_push_ipv4address: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_ipv6address: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_ndr_syntax_id: enum ndr_err_code (struct ndr_push *, int, const struct ndr_syntax_id *)
+ndr_push_netr_SamDatabaseID: enum ndr_err_code (struct ndr_push *, int, enum netr_SamDatabaseID)
+ndr_push_netr_SchannelType: enum ndr_err_code (struct ndr_push *, int, enum netr_SchannelType)
+ndr_push_pipe_chunk_trailer: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_pointer: enum ndr_err_code (struct ndr_push *, int, void *)
+ndr_push_policy_handle: enum ndr_err_code (struct ndr_push *, int, const struct policy_handle *)
+ndr_push_ref_ptr: enum ndr_err_code (struct ndr_push *)
+ndr_push_relative_ptr1: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_relative_ptr2_end: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_relative_ptr2_start: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_restore_relative_base_offset: void (struct ndr_push *, uint32_t)
+ndr_push_set_switch_value: enum ndr_err_code (struct ndr_push *, const void *, uint32_t)
+ndr_push_setup_relative_base_offset1: enum ndr_err_code (struct ndr_push *, const void *, uint32_t)
+ndr_push_setup_relative_base_offset2: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_short_relative_ptr1: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_short_relative_ptr2: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_string: enum ndr_err_code (struct ndr_push *, int, const char *)
+ndr_push_string_array: enum ndr_err_code (struct ndr_push *, int, const char **)
+ndr_push_struct_blob: enum ndr_err_code (DATA_BLOB *, TALLOC_CTX *, const void *, ndr_push_flags_fn_t)
+ndr_push_subcontext_end: enum ndr_err_code (struct ndr_push *, struct ndr_push *, size_t, ssize_t)
+ndr_push_subcontext_start: enum ndr_err_code (struct ndr_push *, struct ndr_push **, size_t, ssize_t)
+ndr_push_svcctl_ServerType: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_time_t: enum ndr_err_code (struct ndr_push *, int, time_t)
+ndr_push_timespec: enum ndr_err_code (struct ndr_push *, int, const struct timespec *)
+ndr_push_timeval: enum ndr_err_code (struct ndr_push *, int, const struct timeval *)
+ndr_push_trailer_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_udlong: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_udlongr: enum ndr_err_code (struct ndr_push *, int, uint64_t)
+ndr_push_uid_t: enum ndr_err_code (struct ndr_push *, int, uid_t)
+ndr_push_uint16: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_uint1632: enum ndr_err_code (struct ndr_push *, int, uint16_t)
+ndr_push_uint32: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_uint3264: enum ndr_err_code (struct ndr_push *, int, uint32_t)
+ndr_push_uint8: enum ndr_err_code (struct ndr_push *, int, uint8_t)
+ndr_push_union_align: enum ndr_err_code (struct ndr_push *, size_t)
+ndr_push_union_blob: enum ndr_err_code (DATA_BLOB *, TALLOC_CTX *, void *, uint32_t, ndr_push_flags_fn_t)
+ndr_push_unique_ptr: enum ndr_err_code (struct ndr_push *, const void *)
+ndr_push_winreg_Data: enum ndr_err_code (struct ndr_push *, int, const union winreg_Data *)
+ndr_push_winreg_Type: enum ndr_err_code (struct ndr_push *, int, enum winreg_Type)
+ndr_push_zero: enum ndr_err_code (struct ndr_push *, uint32_t)
+ndr_set_flags: void (uint32_t *, uint32_t)
+ndr_size_DATA_BLOB: uint32_t (int, const DATA_BLOB *, int)
+ndr_size_GUID: size_t (const struct GUID *, int)
+ndr_size_string: uint32_t (int, const char * const *, int)
+ndr_size_string_array: size_t (const char **, uint32_t, int)
+ndr_size_struct: size_t (const void *, int, ndr_push_flags_fn_t)
+ndr_size_union: size_t (const void *, int, uint32_t, ndr_push_flags_fn_t)
+ndr_string_array_size: size_t (struct ndr_push *, const char *)
+ndr_string_length: uint32_t (const void *, uint32_t)
+ndr_syntax_id_equal: bool (const struct ndr_syntax_id *, const struct ndr_syntax_id *)
+ndr_syntax_id_from_string: bool (const char *, struct ndr_syntax_id *)
+ndr_syntax_id_null: uuid = {time_low = 0, time_mid = 0, time_hi_and_version = 0, clock_seq = "\000", node = "\000\000\000\000\000"}, if_version = 0
+ndr_syntax_id_to_string: char *(TALLOC_CTX *, const struct ndr_syntax_id *)
+ndr_token_peek: uint32_t (struct ndr_token_list **, const void *)
+ndr_token_retrieve: enum ndr_err_code (struct ndr_token_list **, const void *, uint32_t *)
+ndr_token_retrieve_cmp_fn: enum ndr_err_code (struct ndr_token_list **, const void *, uint32_t *, comparison_fn_t, bool)
+ndr_token_store: enum ndr_err_code (TALLOC_CTX *, struct ndr_token_list **, const void *, uint32_t)
+ndr_transfer_syntax_ndr: uuid = {time_low = 2324192516, time_mid = 7403, time_hi_and_version = 4553, clock_seq = "\237\350", node = "\b\000+\020H`"}, if_version = 2
+ndr_transfer_syntax_ndr64: uuid = {time_low = 1903232307, time_mid = 48826, time_hi_and_version = 18743, clock_seq = "\203\031", node = "\265\333\357\234\314\066"}, if_version = 1
diff -daurN samba3/librpc/idl/dcerpc.idl samba3/librpc/idl/dcerpc.idl
--- samba3/librpc/idl/dcerpc.idl	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/idl/dcerpc.idl	2024-08-04 17:52:53.000000000 +0200
@@ -10,6 +10,8 @@
 */
 import "misc.idl";
 
+cpp_quote("extern const uint8_t DCERPC_SEC_VT_MAGIC[8];")
+
 interface dcerpc
 {
 	typedef struct {
@@ -453,21 +455,31 @@
 	} dcerpc_payload;
 
 	/* pfc_flags values */
-	const uint8 DCERPC_PFC_FLAG_FIRST		= 0x01; /* First fragment */
-	const uint8 DCERPC_PFC_FLAG_LAST		= 0x02; /* Last fragment */
-	const uint8 DCERPC_PFC_FLAG_PENDING_CANCEL	= 0x04; /* Cancel was pending at sender */
-	const uint8 DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN	= DCERPC_PFC_FLAG_PENDING_CANCEL; /* depends on the pdu type */
-	const uint8 DCERPC_PFC_FLAG_CONC_MPX		= 0x10; /* supports concurrent multiplexing of a single connection. */
-	const uint8 DCERPC_PFC_FLAG_DID_NOT_EXECUTE	= 0x20; /* on a fault it means the server hasn't done anything */
-	const uint8 DCERPC_PFC_FLAG_MAYBE		= 0x40; /* `maybe' call semantics requested */
-	const uint8 DCERPC_PFC_FLAG_OBJECT_UUID		= 0x80; /* on valid guid is in the optional object field */
+	typedef [bitmap8bit] bitmap {
+		DCERPC_PFC_FLAG_FIRST		= 0x01, /* First fragment */
+		DCERPC_PFC_FLAG_LAST		= 0x02, /* Last fragment */
+		DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING = 0x04, /* depends on the pdu type */
+		DCERPC_PFC_FLAG_CONC_MPX	= 0x10, /* supports concurrent multiplexing of a single connection. */
+		DCERPC_PFC_FLAG_DID_NOT_EXECUTE	= 0x20, /* on a fault it means the server hasn't done anything */
+		DCERPC_PFC_FLAG_MAYBE		= 0x40, /* `maybe' call semantics requested */
+		DCERPC_PFC_FLAG_OBJECT_UUID	= 0x80 /* on valid guid is in the optional object field */
+	} dcerpc_pfc_flags;
+
+	/* Cancel was pending at sender */
+	const int DCERPC_PFC_FLAG_PENDING_CANCEL =
+		DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING;
+	const ist DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN =
+		DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING;
 
 	/* these offsets are needed by the signing code */
 	const uint8 DCERPC_PFC_OFFSET      =  3;
 	const uint8 DCERPC_DREP_OFFSET     =  4;
 	const uint8 DCERPC_FRAG_LEN_OFFSET =  8;
+	const uint32 DCERPC_FRAG_MAX_SIZE  = 5840;
 	const uint8 DCERPC_AUTH_LEN_OFFSET = 10;
 	const uint8 DCERPC_CALL_ID_OFFSET  = 12;
+	const uint8 DCERPC_NCACN_PAYLOAD_OFFSET = 16;
+	const uint32 DCERPC_NCACN_PAYLOAD_MAX_SIZE = 0x400000; /* 4 MByte */
 
 	/* little-endian flag */
 	const uint8 DCERPC_DREP_LE  = 0x10;
@@ -476,7 +488,7 @@
 		uint8 rpc_vers;	        /* RPC version */
 		uint8 rpc_vers_minor;   /* Minor version */
 		dcerpc_pkt_type ptype;  /* Packet type */
-		uint8 pfc_flags;        /* Fragmentation flags */
+		dcerpc_pfc_flags pfc_flags; /* Fragmentation flags */
 		uint8 drep[4];	        /* NDR data representation */
 		uint16 frag_length;     /* Total length of fragment */
 		uint16 auth_length;     /* authenticator length */
@@ -506,4 +518,69 @@
 		uint8 serial_low;
 		[switch_is(ptype)] dcerpc_payload u;
 	} ncadg_packet;
+
+	typedef [bitmap16bit] bitmap {
+		DCERPC_SEC_VT_COMMAND_ENUM  = 0x3FFF,
+		DCERPC_SEC_VT_COMMAND_END   = 0x4000,
+		DCERPC_SEC_VT_MUST_PROCESS  = 0x8000
+	} dcerpc_sec_vt_command;
+
+	typedef [enum16bit] enum {
+		DCERPC_SEC_VT_COMMAND_BITMASK1  = 0x0001,
+		DCERPC_SEC_VT_COMMAND_PCONTEXT  = 0x0002,
+		DCERPC_SEC_VT_COMMAND_HEADER2   = 0x0003
+	} dcerpc_sec_vt_command_enum;
+
+	typedef [bitmap32bit] bitmap {
+		DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING = 0x00000001
+	} dcerpc_sec_vt_bitmask1;
+
+	typedef struct {
+		ndr_syntax_id abstract_syntax;
+		ndr_syntax_id transfer_syntax;
+	} dcerpc_sec_vt_pcontext;
+
+	typedef struct {
+		dcerpc_pkt_type ptype;  /* Packet type */
+		[value(0)] uint8 reserved1;
+		[value(0)] uint16 reserved2;
+		uint8 drep[4];          /* NDR data representation */
+		uint32 call_id;         /* Call identifier */
+		uint16 context_id;
+		uint16 opnum;
+	} dcerpc_sec_vt_header2;
+
+	typedef [switch_type(dcerpc_sec_vt_command_enum),nodiscriminant] union {
+	[case(DCERPC_SEC_VT_COMMAND_BITMASK1)] dcerpc_sec_vt_bitmask1 bitmask1;
+	[case(DCERPC_SEC_VT_COMMAND_PCONTEXT)] dcerpc_sec_vt_pcontext pcontext;
+	[case(DCERPC_SEC_VT_COMMAND_HEADER2)] dcerpc_sec_vt_header2 header2;
+	[default,flag(NDR_REMAINING)] DATA_BLOB _unknown;
+	} dcerpc_sec_vt_union;
+
+	typedef struct {
+		dcerpc_sec_vt_command command;
+		[switch_is(command & DCERPC_SEC_VT_COMMAND_ENUM)]
+			[subcontext(2),flag(NDR_SUBCONTEXT_NO_UNREAD_BYTES)]
+			dcerpc_sec_vt_union u;
+	} dcerpc_sec_vt;
+
+	typedef [public,nopush,nopull] struct {
+		uint16 count;
+	} dcerpc_sec_vt_count;
+
+	/*
+	 * We assume that the whole verification trailer fits into
+	 * the last 1024 bytes after the stub data.
+	 *
+	 * There're currently only 3 commands defined and each should
+	 * only be used once.
+	 */
+	const uint16 DCERPC_SEC_VT_MAX_SIZE = 1024;
+
+	typedef [public,flag(NDR_PAHEX)] struct {
+		[flag(NDR_ALIGN4)] DATA_BLOB _pad;
+		[value(DCERPC_SEC_VT_MAGIC)] uint8 magic[8];
+		dcerpc_sec_vt_count count;
+		dcerpc_sec_vt commands[count.count];
+	} dcerpc_sec_verification_trailer;
 }
diff -daurN samba3/librpc/idl/idl_types.h samba3/librpc/idl/idl_types.h
--- samba3/librpc/idl/idl_types.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/idl/idl_types.h	2024-08-04 17:52:53.000000000 +0200
@@ -47,3 +47,5 @@
 
 #define NDR_RELATIVE_REVERSE LIBNDR_FLAG_RELATIVE_REVERSE
 #define NDR_NO_RELATIVE_REVERSE LIBNDR_FLAG_NO_RELATIVE_REVERSE
+
+#define NDR_SUBCONTEXT_NO_UNREAD_BYTES LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES
diff -daurN samba3/librpc/ndr/libndr.h samba3/librpc/ndr/libndr.h
--- samba3/librpc/ndr/libndr.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/libndr.h	2024-08-04 17:52:53.000000000 +0200
@@ -124,6 +124,20 @@
 #define LIBNDR_FLAG_STR_UTF8		(1<<12)
 #define LIBNDR_STRING_FLAGS		(0x7FFC)
 
+/*
+ * don't debug NDR_ERR_BUFSIZE failures,
+ * as the available buffer might be incomplete.
+ *
+ * return NDR_ERR_INCOMPLETE_BUFFER instead.
+ */
+#define LIBNDR_FLAG_INCOMPLETE_BUFFER (1<<16)
+
+/*
+ * This lets ndr_pull_subcontext_end() return
+ * NDR_ERR_UNREAD_BYTES.
+ */
+#define LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES (1<<17)
+
 /* set if relative pointers should *not* be marshalled in reverse order */
 #define LIBNDR_FLAG_NO_RELATIVE_REVERSE	(1<<18)
 
@@ -163,6 +177,7 @@
 
 /* useful macro for debugging */
 #define NDR_PRINT_DEBUG(type, p) ndr_print_debug((ndr_print_fn_t)ndr_print_ ##type, #p, p)
+#define NDR_PRINT_DEBUGC(dbgc_class, type, p) ndr_print_debugc(dbgc_class, (ndr_print_fn_t)ndr_print_ ##type, #p, p)
 #define NDR_PRINT_UNION_DEBUG(type, level, p) ndr_print_union_debug((ndr_print_fn_t)ndr_print_ ##type, #p, level, p)
 #define NDR_PRINT_FUNCTION_DEBUG(type, flags, p) ndr_print_function_debug((ndr_print_function_t)ndr_print_ ##type, #type, flags, p)
 #define NDR_PRINT_BOTH_DEBUG(type, p) NDR_PRINT_FUNCTION_DEBUG(type, NDR_BOTH, p)
@@ -199,7 +214,9 @@
 	NDR_ERR_IPV6ADDRESS,
 	NDR_ERR_INVALID_POINTER,
 	NDR_ERR_UNREAD_BYTES,
-	NDR_ERR_NDR64
+	NDR_ERR_NDR64,
+	NDR_ERR_FLAGS,
+	NDR_ERR_INCOMPLETE_BUFFER
 };
 
 #define NDR_ERR_CODE_IS_SUCCESS(x) (x == NDR_ERR_SUCCESS)
@@ -217,20 +234,52 @@
 
 /*
   flags passed to control parse flow
+  These are deliberately in a different range to the NDR_IN/NDR_OUT
+  flags to catch mixups
 */
-#define NDR_SCALARS 1
-#define NDR_BUFFERS 2
+#define NDR_SCALARS    0x100
+#define NDR_BUFFERS    0x200
 
 /*
-  flags passed to ndr_print_*()
+  flags passed to ndr_print_*() and ndr pull/push for functions
+  These are deliberately in a different range to the NDR_SCALARS/NDR_BUFFERS
+  flags to catch mixups
 */
-#define NDR_IN 1
-#define NDR_OUT 2
-#define NDR_BOTH 3
-#define NDR_SET_VALUES 4
+#define NDR_IN         0x10
+#define NDR_OUT        0x20
+#define NDR_BOTH       0x30
+#define NDR_SET_VALUES 0x40
+
+
+#define NDR_PULL_CHECK_FLAGS(ndr, ndr_flags) do { \
+	if ((ndr_flags) & ~(NDR_SCALARS|NDR_BUFFERS)) { \
+		return ndr_pull_error(ndr, NDR_ERR_FLAGS, "Invalid pull struct ndr_flags 0x%x", ndr_flags); \
+	} \
+} while (0)
+
+#define NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags) do { \
+	if ((ndr_flags) & ~(NDR_SCALARS|NDR_BUFFERS)) \
+		return ndr_push_error(ndr, NDR_ERR_FLAGS, "Invalid push struct ndr_flags 0x%x", ndr_flags); \
+} while (0)
+
+#define NDR_PULL_CHECK_FN_FLAGS(ndr, flags) do { \
+	if ((flags) & ~(NDR_BOTH|NDR_SET_VALUES)) { \
+		return ndr_pull_error(ndr, NDR_ERR_FLAGS, "Invalid fn pull flags 0x%x", flags); \
+	} \
+} while (0)
+
+#define NDR_PUSH_CHECK_FN_FLAGS(ndr, flags) do { \
+	if ((flags) & ~(NDR_BOTH|NDR_SET_VALUES)) \
+		return ndr_push_error(ndr, NDR_ERR_FLAGS, "Invalid fn push flags 0x%x", flags); \
+} while (0)
 
 #define NDR_PULL_NEED_BYTES(ndr, n) do { \
 	if (unlikely((n) > ndr->data_size || ndr->offset + (n) > ndr->data_size)) { \
+		if (ndr->flags & LIBNDR_FLAG_INCOMPLETE_BUFFER) { \
+			uint32_t _available = ndr->data_size - ndr->offset; \
+			uint32_t _missing = n - _available; \
+			ndr->relative_highest_offset = _missing; \
+		} \
 		return ndr_pull_error(ndr, NDR_ERR_BUFSIZE, "Pull bytes %u (%s)", (unsigned)n, __location__); \
 	} \
 } while(0)
@@ -247,6 +296,10 @@
 		ndr->offset = (ndr->offset + (n-1)) & ~(n-1); \
 	} \
 	if (unlikely(ndr->offset > ndr->data_size)) {			\
+		if (ndr->flags & LIBNDR_FLAG_INCOMPLETE_BUFFER) { \
+			uint32_t _missing = ndr->offset - ndr->data_size; \
+			ndr->relative_highest_offset = _missing; \
+		} \
 		return ndr_pull_error(ndr, NDR_ERR_BUFSIZE, "Pull align %u", (unsigned)n); \
 	} \
 } while(0)
@@ -402,6 +455,8 @@
 size_t ndr_size_dom_sid0(const struct dom_sid *sid, int flags);
 void ndr_print_GUID(struct ndr_print *ndr, const char *name, const struct GUID *guid);
 bool ndr_syntax_id_equal(const struct ndr_syntax_id *i1, const struct ndr_syntax_id *i2); 
+char *ndr_syntax_id_to_string(TALLOC_CTX *mem_ctx, const struct ndr_syntax_id *id);
+bool ndr_syntax_id_from_string(const char *s, struct ndr_syntax_id *id);
 enum ndr_err_code ndr_push_struct_blob(DATA_BLOB *blob, TALLOC_CTX *mem_ctx, const void *p, ndr_push_flags_fn_t fn);
 enum ndr_err_code ndr_push_union_blob(DATA_BLOB *blob, TALLOC_CTX *mem_ctx, void *p, uint32_t level, ndr_push_flags_fn_t fn);
 size_t ndr_size_struct(const void *p, int flags, ndr_push_flags_fn_t push);
@@ -424,14 +479,18 @@
 enum ndr_err_code ndr_pull_relative_ptr_short(struct ndr_pull *ndr, uint16_t *v);
 size_t ndr_align_size(uint32_t offset, size_t n);
 struct ndr_pull *ndr_pull_init_blob(const DATA_BLOB *blob, TALLOC_CTX *mem_ctx);
+enum ndr_err_code ndr_pull_append(struct ndr_pull *ndr, DATA_BLOB *blob);
+enum ndr_err_code ndr_pull_pop(struct ndr_pull *ndr);
 enum ndr_err_code ndr_pull_advance(struct ndr_pull *ndr, uint32_t size);
 struct ndr_push *ndr_push_init_ctx(TALLOC_CTX *mem_ctx);
 DATA_BLOB ndr_push_blob(struct ndr_push *ndr);
 enum ndr_err_code ndr_push_expand(struct ndr_push *ndr, uint32_t extra_size);
 void ndr_print_debug_helper(struct ndr_print *ndr, const char *format, ...) PRINTF_ATTRIBUTE(2,3);
+void ndr_print_debugc_helper(struct ndr_print *ndr, const char *format, ...) PRINTF_ATTRIBUTE(2,3);
 void ndr_print_printf_helper(struct ndr_print *ndr, const char *format, ...) PRINTF_ATTRIBUTE(2,3);
 void ndr_print_string_helper(struct ndr_print *ndr, const char *format, ...) PRINTF_ATTRIBUTE(2,3);
 void ndr_print_debug(ndr_print_fn_t fn, const char *name, void *ptr);
+void ndr_print_debugc(int dbgc_class, ndr_print_fn_t fn, const char *name, void *ptr);
 void ndr_print_union_debug(ndr_print_fn_t fn, const char *name, uint32_t level, void *ptr);
 void ndr_print_function_debug(ndr_print_function_t fn, const char *name, int flags, void *ptr);
 char *ndr_print_struct_string(TALLOC_CTX *mem_ctx, ndr_print_fn_t fn, const char *name, void *ptr);
diff -daurN samba3/librpc/ndr/ndr_basic.c samba3/librpc/ndr/ndr_basic.c
--- samba3/librpc/ndr/ndr_basic.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/ndr_basic.c	2024-08-04 17:52:53.000000000 +0200
@@ -61,6 +74,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_int8(struct ndr_pull *ndr, int ndr_flags, int8_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_NEED_BYTES(ndr, 1);
 	*v = (int8_t)CVAL(ndr->data, ndr->offset);
 	ndr->offset += 1;
@@ -72,6 +86,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_uint8(struct ndr_pull *ndr, int ndr_flags, uint8_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_NEED_BYTES(ndr, 1);
 	*v = CVAL(ndr->data, ndr->offset);
 	ndr->offset += 1;
@@ -83,6 +98,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_int16(struct ndr_pull *ndr, int ndr_flags, int16_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 2);
 	NDR_PULL_NEED_BYTES(ndr, 2);
 	*v = (uint16_t)NDR_SVAL(ndr, ndr->offset);
@@ -95,6 +111,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_uint16(struct ndr_pull *ndr, int ndr_flags, uint16_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 2);
 	NDR_PULL_NEED_BYTES(ndr, 2);
 	*v = NDR_SVAL(ndr, ndr->offset);
@@ -107,6 +124,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_uint1632(struct ndr_pull *ndr, int ndr_flags, uint16_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	if (unlikely(ndr->flags & LIBNDR_FLAG_NDR64)) {
 		uint32_t v32 = 0;
 		enum ndr_err_code err = ndr_pull_uint32(ndr, ndr_flags, &v32);
@@ -125,6 +143,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_int32(struct ndr_pull *ndr, int ndr_flags, int32_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 4);
 	NDR_PULL_NEED_BYTES(ndr, 4);
 	*v = NDR_IVALS(ndr, ndr->offset);
@@ -137,6 +156,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_uint32(struct ndr_pull *ndr, int ndr_flags, uint32_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 4);
 	NDR_PULL_NEED_BYTES(ndr, 4);
 	*v = NDR_IVAL(ndr, ndr->offset);
@@ -151,6 +171,7 @@
 {
 	uint64_t v64;
 	enum ndr_err_code err;
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	if (likely(!(ndr->flags & LIBNDR_FLAG_NDR64))) {
 		return ndr_pull_uint32(ndr, ndr_flags, v);
 	}
@@ -169,6 +190,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_double(struct ndr_pull *ndr, int ndr_flags, double *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 8);
 	NDR_PULL_NEED_BYTES(ndr, 8);
 	memcpy(v, ndr->data+ndr->offset, 8);
@@ -217,6 +239,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_udlong(struct ndr_pull *ndr, int ndr_flags, uint64_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 4);
 	NDR_PULL_NEED_BYTES(ndr, 8);
 	*v = NDR_IVAL(ndr, ndr->offset);
@@ -230,6 +253,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_udlongr(struct ndr_pull *ndr, int ndr_flags, uint64_t *v)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, 4);
 	NDR_PULL_NEED_BYTES(ndr, 8);
 	*v = ((uint64_t)NDR_IVAL(ndr, ndr->offset)) << 32;
@@ -264,6 +288,7 @@
 _PUBLIC_ enum ndr_err_code ndr_pull_pointer(struct ndr_pull *ndr, int ndr_flags, void* *v)
 {
 	uintptr_t h;
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PULL_ALIGN(ndr, sizeof(h));
 	NDR_PULL_NEED_BYTES(ndr, sizeof(h));
 	memcpy(&h, ndr->data+ndr->offset, sizeof(h));
@@ -278,6 +303,7 @@
 _PUBLIC_ enum ndr_err_code ndr_pull_NTSTATUS(struct ndr_pull *ndr, int ndr_flags, NTSTATUS *status)
 {
 	uint32_t v;
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_pull_uint32(ndr, NDR_SCALARS, &v));
 	*status = NT_STATUS(v);
 	return NDR_ERR_SUCCESS;
@@ -302,6 +328,7 @@
 _PUBLIC_ enum ndr_err_code ndr_pull_WERROR(struct ndr_pull *ndr, int ndr_flags, WERROR *status)
 {
 	uint32_t v;
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_pull_uint32(ndr, NDR_SCALARS, &v));
 	*status = W_ERROR(v);
 	return NDR_ERR_SUCCESS;
@@ -414,6 +441,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_array_uint8(struct ndr_pull *ndr, int ndr_flags, uint8_t *data, uint32_t n)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	if (!(ndr_flags & NDR_SCALARS)) {
 		return NDR_ERR_SUCCESS;
 	}
@@ -425,6 +453,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_int8(struct ndr_push *ndr, int ndr_flags, int8_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_NEED_BYTES(ndr, 1);
 	SCVAL(ndr->data, ndr->offset, (uint8_t)v);
 	ndr->offset += 1;
@@ -436,6 +465,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_uint8(struct ndr_push *ndr, int ndr_flags, uint8_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_NEED_BYTES(ndr, 1);
 	SCVAL(ndr->data, ndr->offset, v);
 	ndr->offset += 1;
@@ -447,6 +477,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_int16(struct ndr_push *ndr, int ndr_flags, int16_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 2);
 	NDR_PUSH_NEED_BYTES(ndr, 2);
 	NDR_SSVAL(ndr, ndr->offset, (uint16_t)v);
@@ -459,6 +490,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_uint16(struct ndr_push *ndr, int ndr_flags, uint16_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 2);
 	NDR_PUSH_NEED_BYTES(ndr, 2);
 	NDR_SSVAL(ndr, ndr->offset, v);
@@ -482,6 +514,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_int32(struct ndr_push *ndr, int ndr_flags, int32_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 4);
 	NDR_PUSH_NEED_BYTES(ndr, 4);
 	NDR_SIVALS(ndr, ndr->offset, v);
@@ -494,6 +527,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_uint32(struct ndr_push *ndr, int ndr_flags, uint32_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 4);
 	NDR_PUSH_NEED_BYTES(ndr, 4);
 	NDR_SIVAL(ndr, ndr->offset, v);
@@ -517,6 +551,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_udlong(struct ndr_push *ndr, int ndr_flags, uint64_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 4);
 	NDR_PUSH_NEED_BYTES(ndr, 8);
 	NDR_SIVAL(ndr, ndr->offset, (v & 0xFFFFFFFF));
@@ -530,6 +565,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_udlongr(struct ndr_push *ndr, int ndr_flags, uint64_t v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 4);
 	NDR_PUSH_NEED_BYTES(ndr, 8);
 	NDR_SIVAL(ndr, ndr->offset, (v>>32));
@@ -563,6 +599,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_double(struct ndr_push *ndr, int ndr_flags, double v)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, 8);
 	NDR_PUSH_NEED_BYTES(ndr, 8);
 	memcpy(ndr->data+ndr->offset, &v, 8);
@@ -576,6 +613,7 @@
 _PUBLIC_ enum ndr_err_code ndr_push_pointer(struct ndr_push *ndr, int ndr_flags, void* v)
 {
 	uintptr_t h = (intptr_t)v;
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_PUSH_ALIGN(ndr, sizeof(h));
 	NDR_PUSH_NEED_BYTES(ndr, sizeof(h));
 	memcpy(ndr->data+ndr->offset, &h, sizeof(h));
@@ -686,6 +724,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_array_uint8(struct ndr_push *ndr, int ndr_flags, const uint8_t *data, uint32_t n)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	if (!(ndr_flags & NDR_SCALARS)) {
 		return NDR_ERR_SUCCESS;
 	}
@@ -738,6 +777,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_NTTIME(struct ndr_push *ndr, int ndr_flags, NTTIME t)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_push_udlong(ndr, ndr_flags, t));
 	return NDR_ERR_SUCCESS;
 }
@@ -747,6 +787,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_NTTIME(struct ndr_pull *ndr, int ndr_flags, NTTIME *t)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_pull_udlong(ndr, ndr_flags, t));
 	return NDR_ERR_SUCCESS;
 }
@@ -756,6 +797,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_NTTIME_1sec(struct ndr_push *ndr, int ndr_flags, NTTIME t)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	t /= 10000000;
 	NDR_CHECK(ndr_push_hyper(ndr, ndr_flags, t));
 	return NDR_ERR_SUCCESS;
@@ -766,6 +808,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_NTTIME_1sec(struct ndr_pull *ndr, int ndr_flags, NTTIME *t)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_pull_hyper(ndr, ndr_flags, t));
 	(*t) *= 10000000;
 	return NDR_ERR_SUCCESS;
@@ -776,6 +819,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_pull_NTTIME_hyper(struct ndr_pull *ndr, int ndr_flags, NTTIME *t)
 {
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_pull_hyper(ndr, ndr_flags, t));
 	return NDR_ERR_SUCCESS;
 }
@@ -785,6 +829,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_NTTIME_hyper(struct ndr_push *ndr, int ndr_flags, NTTIME t)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	NDR_CHECK(ndr_push_hyper(ndr, ndr_flags, t));
 	return NDR_ERR_SUCCESS;
 }
@@ -814,6 +859,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_uid_t(struct ndr_push *ndr, int ndr_flags, uid_t u)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	return ndr_push_hyper(ndr, NDR_SCALARS, (uint64_t)u);
 }
 
@@ -839,6 +885,7 @@
 */
 _PUBLIC_ enum ndr_err_code ndr_push_gid_t(struct ndr_push *ndr, int ndr_flags, gid_t g)
 {
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
 	return ndr_push_hyper(ndr, NDR_SCALARS, (uint64_t)g);
 }
 
diff -daurN samba3/librpc/ndr/ndr.c samba3/librpc/ndr/ndr.c
--- samba3/librpc/ndr/ndr.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/ndr.c	2024-08-04 17:52:53.000000000 +0200
@@ -77,6 +77,111 @@
 	return ndr;
 }
 
+_PUBLIC_ enum ndr_err_code ndr_pull_append(struct ndr_pull *ndr, DATA_BLOB *blob)
+{
+	enum ndr_err_code ndr_err;
+	DATA_BLOB b;
+	uint32_t append = 0;
+	bool ok;
+
+	if (blob->length == 0) {
+		return NDR_ERR_SUCCESS;
+	}
+
+	ndr_err = ndr_token_retrieve(&ndr->array_size_list, ndr, &append);
+	if (ndr_err == NDR_ERR_TOKEN) {
+		append = 0;
+		ndr_err = NDR_ERR_SUCCESS;
+	}
+	NDR_CHECK(ndr_err);
+
+	if (ndr->data_size == 0) {
+		ndr->data = NULL;
+		append = UINT32_MAX;
+	}
+
+	if (append == UINT32_MAX) {
+		/*
+		 * append == UINT32_MAX means that
+		 * ndr->data is either NULL or a valid
+		 * talloc child of ndr, which means
+		 * we can use data_blob_append() without
+		 * data_blob_talloc() of the existing callers data
+		 */
+		b = data_blob_const(ndr->data, ndr->data_size);
+	} else {
+		b = data_blob_talloc(ndr, ndr->data, ndr->data_size);
+		if (b.data == NULL) {
+			return ndr_pull_error(ndr, NDR_ERR_ALLOC, "%s", __location__);
+		}
+	}
+
+	ok = data_blob_append(ndr, &b, blob->data, blob->length);
+	if (!ok) {
+		return ndr_pull_error(ndr, NDR_ERR_ALLOC, "%s", __location__);
+	}
+
+	ndr->data = b.data;
+	ndr->data_size = b.length;
+
+	return ndr_token_store(ndr, &ndr->array_size_list, ndr, UINT32_MAX);
+}
+
+_PUBLIC_ enum ndr_err_code ndr_pull_pop(struct ndr_pull *ndr)
+{
+	uint32_t skip = 0;
+	uint32_t append = 0;
+
+	if (ndr->relative_base_offset != 0) {
+		return ndr_pull_error(ndr, NDR_ERR_RELATIVE,
+				      "%s", __location__);
+	}
+	if (ndr->relative_highest_offset != 0) {
+		return ndr_pull_error(ndr, NDR_ERR_RELATIVE,
+				      "%s", __location__);
+	}
+	if (ndr->relative_list != NULL) {
+		return ndr_pull_error(ndr, NDR_ERR_RELATIVE,
+				      "%s", __location__);
+	}
+	if (ndr->relative_base_list != NULL) {
+		return ndr_pull_error(ndr, NDR_ERR_RELATIVE,
+				      "%s", __location__);
+	}
+
+	/*
+	 * we need to keep up to 7 bytes
+	 * in order to get the aligment right.
+	 */
+	skip = ndr->offset & 0xFFFFFFF8;
+
+	if (skip == 0) {
+		return NDR_ERR_SUCCESS;
+	}
+
+	ndr->offset -= skip;
+	ndr->data_size -= skip;
+
+	append = ndr_token_peek(&ndr->array_size_list, ndr);
+	if (append != UINT32_MAX) {
+		/*
+		 * here we assume, that ndr->data is not a
+		 * talloc child of ndr.
+		 */
+		ndr->data += skip;
+		return NDR_ERR_SUCCESS;
+	}
+
+	memmove(ndr->data, ndr->data + skip, ndr->data_size);
+
+	ndr->data = talloc_realloc(ndr, ndr->data, uint8_t, ndr->data_size);
+	if (ndr->data_size != 0 && ndr->data == NULL) {
+		return ndr_pull_error(ndr, NDR_ERR_ALLOC, "%s", __location__);
+	}
+
+	return NDR_ERR_SUCCESS;
+}
+
 /*
   advance by 'size' bytes
 */
@@ -167,6 +272,38 @@
 	return NDR_ERR_SUCCESS;
 }
 
+_PUBLIC_ void ndr_print_debugc_helper(struct ndr_print *ndr, const char *format, ...)
+{
+	va_list ap;
+	char *s = NULL;
+	uint32_t i;
+	int ret;
+	int dbgc_class;
+
+	va_start(ap, format);
+	ret = vasprintf(&s, format, ap);
+	va_end(ap);
+
+	if (ret == -1) {
+		return;
+	}
+
+	dbgc_class = *(int *)ndr->private_data;
+
+	if (ndr->no_newline) {
+		DEBUGADDC(dbgc_class, 1,("%s", s));
+		free(s);
+		return;
+	}
+
+	for (i=0;i<ndr->depth;i++) {
+		DEBUGADDC(dbgc_class, 1,("    "));
+	}
+
+	DEBUGADDC(dbgc_class, 1,("%s\n", s));
+	free(s);
+}
+
 _PUBLIC_ void ndr_print_debug_helper(struct ndr_print *ndr, const char *format, ...) 
 {
 	va_list ap;
@@ -238,6 +375,25 @@
 }
 
 /*
+  a useful helper function for printing idl structures via DEBUGC()
+*/
+_PUBLIC_ void ndr_print_debugc(int dbgc_class, ndr_print_fn_t fn, const char *name, void *ptr)
+{
+	struct ndr_print *ndr;
+
+	DEBUGC(dbgc_class, 1,(" "));
+
+	ndr = talloc_zero(NULL, struct ndr_print);
+	if (!ndr) return;
+	ndr->private_data = &dbgc_class;
+	ndr->print = ndr_print_debugc_helper;
+	ndr->depth = 1;
+	ndr->flags = 0;
+	fn(ndr, name, ptr);
+	talloc_free(ndr);
+}
+
+/*
   a useful helper function for printing idl structures via DEBUG()
 */
 _PUBLIC_ void ndr_print_debug(ndr_print_fn_t fn, const char *name, void *ptr)
@@ -403,6 +559,15 @@
 	va_list ap;
 	int ret;
 
+	if (ndr->flags & LIBNDR_FLAG_INCOMPLETE_BUFFER) {
+		switch (ndr_err) {
+		case NDR_ERR_BUFSIZE:
+			return NDR_ERR_INCOMPLETE_BUFFER;
+		default:
+			break;
+		}
+	}
+
 	va_start(ap, format);
 	ret = vasprintf(&s, format, ap);
 	va_end(ap);
@@ -557,6 +722,23 @@
 		NDR_CHECK(ndr_pull_uint32(ndr, NDR_SCALARS, &reserved));
 		break;
 	}
+	case 0xFFFFFFFF:
+		/*
+		 * a shallow copy like subcontext
+		 * useful for DCERPC pipe chunks.
+		 */
+		subndr = talloc_zero(ndr, struct ndr_pull);
+		NDR_ERR_HAVE_NO_MEMORY(subndr);
+
+		subndr->flags		= ndr->flags;
+		subndr->current_mem_ctx	= ndr->current_mem_ctx;
+		subndr->data		= ndr->data;
+		subndr->offset		= ndr->offset;
+		subndr->data_size	= ndr->data_size;
+
+		*_subndr = subndr;
+		return NDR_ERR_SUCCESS;
+
 	default:
 		return ndr_pull_error(ndr, NDR_ERR_SUBCONTEXT, "Bad subcontext (PULL) header_size %d", 
 				      (int)header_size);
@@ -589,13 +771,35 @@
 				 ssize_t size_is)
 {
 	uint32_t advance;
-	if (size_is >= 0) {
+	uint32_t highest_ofs;
+
+	if (header_size == 0xFFFFFFFF) {
+		advance = subndr->offset - ndr->offset;
+	} else if (size_is >= 0) {
 		advance = size_is;
 	} else if (header_size > 0) {
 		advance = subndr->data_size;
 	} else {
 		advance = subndr->offset;
 	}
+
+	if (subndr->offset > ndr->relative_highest_offset) {
+		highest_ofs = subndr->offset;
+	} else {
+		highest_ofs = subndr->relative_highest_offset;
+	}
+	if (!(subndr->flags & LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES)) {
+		/*
+		 * avoid an error unless SUBCONTEXT_NO_UNREAD_BYTES is specified
+		 */
+		highest_ofs = advance;
+	}
+	if (highest_ofs < advance) {
+		return ndr_pull_error(subndr, NDR_ERR_UNREAD_BYTES,
+				      "not all bytes consumed ofs[%u] advance[%u]",
+				      highest_ofs, advance);
+	}
+
 	NDR_CHECK(ndr_pull_advance(ndr, advance));
 	return NDR_ERR_SUCCESS;
 }
@@ -1440,6 +1644,7 @@
 	{ NDR_ERR_INVALID_POINTER, "Invalid Pointer" },
 	{ NDR_ERR_UNREAD_BYTES, "Unread Bytes" },
 	{ NDR_ERR_NDR64, "NDR64 assertion error" },
+	{ NDR_ERR_INCOMPLETE_BUFFER, "Incomplete Buffer" },
 	{ 0, NULL }
 };
 
diff -daurN samba3/librpc/ndr/ndr_dcerpc.c samba3/librpc/ndr/ndr_dcerpc.c
--- samba3/librpc/ndr/ndr_dcerpc.c	1970-01-01 01:00:00.000000000 +0100
+++ samba3/librpc/ndr/ndr_dcerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,187 @@
+/*
+   Unix SMB/CIFS implementation.
+
+   Manually parsed structures found in the DCERPC protocol
+
+   Copyright (C) Stefan Metzmacher 2014
+   Copyright (C) Gregor Beck 2014
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "includes.h"
+#include "librpc/gen_ndr/ndr_dcerpc.h"
+
+#include "librpc/gen_ndr/ndr_misc.h"
+#include "lib/util/bitmap.h"
+
+const uint8_t DCERPC_SEC_VT_MAGIC[] = {0x8a,0xe3,0x13,0x71,0x02,0xf4,0x36,0x71};
+
+_PUBLIC_ enum ndr_err_code ndr_push_dcerpc_sec_vt_count(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_vt_count *r)
+{
+	NDR_PUSH_CHECK_FLAGS(ndr, ndr_flags);
+	/* nothing */
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ enum ndr_err_code ndr_pull_dcerpc_sec_vt_count(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_vt_count *r)
+{
+	uint32_t _saved_ofs = ndr->offset;
+
+	NDR_PULL_CHECK_FLAGS(ndr, ndr_flags);
+
+	if (!(ndr_flags & NDR_SCALARS)) {
+		return NDR_ERR_SUCCESS;
+	}
+
+	r->count = 0;
+
+	while (true) {
+		uint16_t command;
+		uint16_t length;
+
+		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &command));
+		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &length));
+		NDR_CHECK(ndr_pull_advance(ndr, length));
+
+		r->count += 1;
+
+		if (command & DCERPC_SEC_VT_COMMAND_END) {
+			break;
+		}
+	}
+
+	ndr->offset = _saved_ofs;
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ enum ndr_err_code ndr_pop_dcerpc_sec_verification_trailer(
+	struct ndr_pull *ndr, TALLOC_CTX *mem_ctx,
+	struct dcerpc_sec_verification_trailer **_r)
+{
+	enum ndr_err_code ndr_err;
+	uint32_t ofs;
+	uint32_t min_ofs = 0;
+	struct dcerpc_sec_verification_trailer *r;
+	DATA_BLOB sub_blob = data_blob_null;
+	struct ndr_pull *sub_ndr = NULL;
+	uint32_t remaining;
+
+	*_r = NULL;
+
+	r = talloc_zero(mem_ctx, struct dcerpc_sec_verification_trailer);
+	if (r == NULL) {
+		return NDR_ERR_ALLOC;
+	}
+
+	if (ndr->data_size < sizeof(DCERPC_SEC_VT_MAGIC)) {
+		/*
+		 * we return with r->count = 0
+		 */
+		*_r = r;
+		return NDR_ERR_SUCCESS;
+	}
+
+	ofs = ndr->data_size - sizeof(DCERPC_SEC_VT_MAGIC);
+	/* the magic is 4 byte aligned */
+	ofs &= ~3;
+
+	if (ofs > DCERPC_SEC_VT_MAX_SIZE) {
+		/*
+		 * We just scan the last 1024 bytes.
+		 */
+		min_ofs = ofs - DCERPC_SEC_VT_MAX_SIZE;
+	} else {
+		min_ofs = 0;
+	}
+
+	while (true) {
+		int ret;
+
+		ret = memcmp(&ndr->data[ofs],
+			     DCERPC_SEC_VT_MAGIC,
+			     sizeof(DCERPC_SEC_VT_MAGIC));
+		if (ret == 0) {
+			sub_blob = data_blob_const(&ndr->data[ofs],
+						   ndr->data_size - ofs);
+			break;
+		}
+
+		if (ofs <= min_ofs) {
+			break;
+		}
+
+		ofs -= 4;
+	}
+
+	if (sub_blob.length == 0) {
+		/*
+		 * we return with r->count = 0
+		 */
+		*_r = r;
+		return NDR_ERR_SUCCESS;
+	}
+
+	sub_ndr = ndr_pull_init_blob(&sub_blob, r);
+	if (sub_ndr == NULL) {
+		TALLOC_FREE(r);
+		return NDR_ERR_ALLOC;
+	}
+
+	ndr_err = ndr_pull_dcerpc_sec_verification_trailer(sub_ndr,
+							   NDR_SCALARS | NDR_BUFFERS,
+							   r);
+	if (ndr_err == NDR_ERR_ALLOC) {
+		TALLOC_FREE(r);
+		return NDR_ERR_ALLOC;
+	}
+
+	if (!NDR_ERR_CODE_IS_SUCCESS(ndr_err)) {
+		goto ignore_error;
+	}
+
+	remaining = sub_ndr->data_size - sub_ndr->offset;
+	if (remaining > 16) {
+		/*
+		 * we expect not more than 16 byte of additional
+		 * padding after the verification trailer.
+		 */
+		goto ignore_error;
+	}
+
+	/*
+	 * We assume that we got a real verification trailer.
+	 *
+	 * We remove it from the available stub data.
+	 */
+	ndr->data_size = ofs;
+
+	TALLOC_FREE(sub_ndr);
+
+	*_r = r;
+	return NDR_ERR_SUCCESS;
+
+ignore_error:
+	TALLOC_FREE(sub_ndr);
+	/*
+	 * just ignore the error, it's likely
+	 * that the magic we found belongs to
+	 * the stub data.
+	 *
+	 * we return with r->count = 0
+	 */
+	ZERO_STRUCTP(r);
+	*_r = r;
+	return NDR_ERR_SUCCESS;
+}
diff -daurN samba3/librpc/ndr/ndr_dcerpc.h samba3/librpc/ndr/ndr_dcerpc.h
--- samba3/librpc/ndr/ndr_dcerpc.h	1970-01-01 01:00:00.000000000 +0100
+++ samba3/librpc/ndr/ndr_dcerpc.h	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,25 @@
+/*
+   Unix SMB/CIFS implementation.
+
+   Manually parsed structures found in the DCERPC protocol
+
+   Copyright (C) Stefan Metzmacher 2014
+   Copyright (C) Gregor Beck 2014
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+enum ndr_err_code ndr_pop_dcerpc_sec_verification_trailer(
+	struct ndr_pull *ndr, TALLOC_CTX *mem_ctx,
+	struct dcerpc_sec_verification_trailer **_r);
diff -daurN samba3/librpc/ndr/ndr_misc.c samba3/librpc/ndr/ndr_misc.c
--- samba3/librpc/ndr/ndr_misc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/ndr_misc.c	2024-08-04 17:52:53.000000000 +0200
@@ -35,3 +35,50 @@
 	return GUID_equal(&i1->uuid, &i2->uuid)
 		&& (i1->if_version == i2->if_version);
 }
+
+_PUBLIC_ char *ndr_syntax_id_to_string(TALLOC_CTX *mem_ctx, const struct ndr_syntax_id *id)
+{
+	return talloc_asprintf(mem_ctx,
+			       "%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x/0x%08x",
+			       id->uuid.time_low, id->uuid.time_mid,
+			       id->uuid.time_hi_and_version,
+			       id->uuid.clock_seq[0],
+			       id->uuid.clock_seq[1],
+			       id->uuid.node[0], id->uuid.node[1],
+			       id->uuid.node[2], id->uuid.node[3],
+			       id->uuid.node[4], id->uuid.node[5],
+			       (unsigned)id->if_version);
+}
+
+_PUBLIC_ bool ndr_syntax_id_from_string(const char *s, struct ndr_syntax_id *id)
+{
+	int ret;
+	size_t i;
+	uint32_t time_low;
+	uint32_t time_mid, time_hi_and_version;
+	uint32_t clock_seq[2];
+	uint32_t node[6];
+	uint32_t if_version;
+
+	ret = sscanf(s,
+		     "%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x/0x%08x",
+		     &time_low, &time_mid, &time_hi_and_version,
+		     &clock_seq[0], &clock_seq[1],
+		     &node[0], &node[1], &node[2], &node[3], &node[4], &node[5],
+		     &if_version);
+	if (ret != 12) {
+		return false;
+	}
+
+	id->uuid.time_low = time_low;
+	id->uuid.time_mid = time_mid;
+	id->uuid.time_hi_and_version = time_hi_and_version;
+	id->uuid.clock_seq[0] = clock_seq[0];
+	id->uuid.clock_seq[1] = clock_seq[1];
+	for (i=0; i<6; i++) {
+		id->uuid.node[i] = node[i];
+	}
+	id->if_version = if_version;
+
+	return true;
+}
diff -daurN samba3/librpc/ndr/ndr_ntlmssp.c samba3/librpc/ndr/ndr_ntlmssp.c
--- samba3/librpc/ndr/ndr_ntlmssp.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/ndr_ntlmssp.c	2024-08-04 17:52:53.000000000 +0200
@@ -176,4 +176,20 @@
 	}
 }
 
+_PUBLIC_ struct AV_PAIR *ndr_ntlmssp_find_av(const struct AV_PAIR_LIST *av_list,
+					     enum ntlmssp_AvId AvId)
+{
+	struct AV_PAIR *res = NULL;
+	uint32_t i = 0;
+
+	for (i = 0; i < av_list->count; i++) {
+		if (av_list->pair[i].AvId != AvId) {
+			continue;
+		}
+
+		res = discard_const_p(struct AV_PAIR, &av_list->pair[i]);
+		break;
+	}
 
+	return res;
+}
diff -daurN samba3/librpc/ndr/ndr_ntlmssp.h samba3/librpc/ndr/ndr_ntlmssp.h
--- samba3/librpc/ndr/ndr_ntlmssp.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/ndr/ndr_ntlmssp.h	2024-08-04 17:52:53.000000000 +0200
@@ -31,3 +31,5 @@
 					    bool ntlmv2);
 _PUBLIC_ void ndr_print_ntlmssp_Version(struct ndr_print *ndr, const char *name, const union ntlmssp_Version *r);
 
+_PUBLIC_ struct AV_PAIR *ndr_ntlmssp_find_av(const struct AV_PAIR_LIST *av_list,
+					     enum ntlmssp_AvId AvId);
diff -daurN samba3/librpc/rpc/dcerpc_util.c samba3/librpc/rpc/dcerpc_util.c
--- samba3/librpc/rpc/dcerpc_util.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/rpc/dcerpc_util.c	2024-08-04 17:52:53.000000000 +0200
@@ -27,6 +27,7 @@
 #include "librpc/rpc/dcerpc.h"
 #include "librpc/gen_ndr/ndr_dcerpc.h"
 #include "rpc_common.h"
+#include "lib/util/bitmap.h"
 
 /* we need to be able to get/set the fragment length without doing a full
    decode */
@@ -91,31 +92,49 @@
 *
 * @return		- A NTSTATUS error code.
 */
-NTSTATUS dcerpc_pull_auth_trailer(struct ncacn_packet *pkt,
+NTSTATUS dcerpc_pull_auth_trailer(const struct ncacn_packet *pkt,
 				  TALLOC_CTX *mem_ctx,
-				  DATA_BLOB *pkt_trailer,
+				  const DATA_BLOB *pkt_trailer,
 				  struct dcerpc_auth *auth,
-				  uint32_t *auth_length,
+				  uint32_t *_auth_length,
 				  bool auth_data_only)
 {
 	struct ndr_pull *ndr;
 	enum ndr_err_code ndr_err;
-	uint32_t data_and_pad;
+	uint16_t data_and_pad;
+	uint16_t auth_length;
+	uint32_t tmp_length;
 
-	data_and_pad = pkt_trailer->length
-			- (DCERPC_AUTH_TRAILER_LENGTH + pkt->auth_length);
+	ZERO_STRUCTP(auth);
+	if (_auth_length != NULL) {
+		*_auth_length = 0;
+	}
 
-	/* paranoia check for pad size. This would be caught anyway by
-	   the ndr_pull_advance() a few lines down, but it scared
-	   Jeremy enough for him to call me, so we might as well check
-	   it now, just to prevent someone posting a bogus YouTube
-	   video in the future.
-	*/
-	if (data_and_pad > pkt_trailer->length) {
-		return NT_STATUS_INFO_LENGTH_MISMATCH;
+	/* Paranoia checks for auth_length. The caller should check this... */
+	if (pkt->auth_length == 0) {
+		return NT_STATUS_INTERNAL_ERROR;
 	}
 
-	*auth_length = pkt_trailer->length - data_and_pad;
+	/* Paranoia checks for auth_length. The caller should check this... */
+	if (pkt->auth_length > pkt->frag_length) {
+		return NT_STATUS_INTERNAL_ERROR;
+	}
+	tmp_length = DCERPC_NCACN_PAYLOAD_OFFSET;
+	tmp_length += DCERPC_AUTH_TRAILER_LENGTH;
+	tmp_length += pkt->auth_length;
+	if (tmp_length > pkt->frag_length) {
+		return NT_STATUS_INTERNAL_ERROR;
+	}
+	if (pkt_trailer->length > UINT16_MAX) {
+		return NT_STATUS_INTERNAL_ERROR;
+	}
+
+	auth_length = DCERPC_AUTH_TRAILER_LENGTH + pkt->auth_length;
+	if (pkt_trailer->length < auth_length) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	data_and_pad = pkt_trailer->length - auth_length;
 
 	ndr = ndr_pull_init_blob(pkt_trailer, mem_ctx);
 	if (!ndr) {
@@ -135,14 +154,28 @@
 	ndr_err = ndr_pull_dcerpc_auth(ndr, NDR_SCALARS|NDR_BUFFERS, auth);
 	if (!NDR_ERR_CODE_IS_SUCCESS(ndr_err)) {
 		talloc_free(ndr);
+		ZERO_STRUCTP(auth);
 		return ndr_map_error2ntstatus(ndr_err);
 	}
 
+	if (data_and_pad < auth->auth_pad_length) {
+		DEBUG(1, (__location__ ": ERROR: pad length mismatch. "
+			  "Calculated %u  got %u\n",
+			  (unsigned)data_and_pad,
+			  (unsigned)auth->auth_pad_length));
+		talloc_free(ndr);
+		ZERO_STRUCTP(auth);
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
 	if (auth_data_only && data_and_pad != auth->auth_pad_length) {
-		DEBUG(1, (__location__ ": WARNING: pad length mismatch. "
+		DEBUG(1, (__location__ ": ERROR: pad length mismatch. "
 			  "Calculated %u  got %u\n",
 			  (unsigned)data_and_pad,
 			  (unsigned)auth->auth_pad_length));
+		talloc_free(ndr);
+		ZERO_STRUCTP(auth);
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
 	}
 
 	DEBUG(6,(__location__ ": auth_pad_length %u\n",
@@ -151,6 +184,83 @@
 	talloc_steal(mem_ctx, auth->credentials.data);
 	talloc_free(ndr);
 
+	if (_auth_length != NULL) {
+		*_auth_length = auth_length;
+	}
+
+	return NT_STATUS_OK;
+}
+
+/**
+* @brief	Verify the fields in ncacn_packet header.
+*
+* @param pkt		- The ncacn_packet strcuture
+* @param ptype		- The expected PDU type
+* @param max_auth_info	- The maximum size of a possible auth trailer
+* @param required_flags	- The required flags for the pdu.
+* @param optional_flags	- The possible optional flags for the pdu.
+*
+* @return		- A NTSTATUS error code.
+*/
+NTSTATUS dcerpc_verify_ncacn_packet_header(const struct ncacn_packet *pkt,
+					   enum dcerpc_pkt_type ptype,
+					   size_t max_auth_info,
+					   uint8_t required_flags,
+					   uint8_t optional_flags)
+{
+	if (pkt->rpc_vers != 5) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	if (pkt->rpc_vers_minor != 0) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	if (pkt->auth_length > pkt->frag_length) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	if (pkt->ptype != ptype) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	if (max_auth_info > UINT16_MAX) {
+		return NT_STATUS_INTERNAL_ERROR;
+	}
+
+	if (pkt->auth_length > 0) {
+		size_t max_auth_length;
+
+		if (max_auth_info <= DCERPC_AUTH_TRAILER_LENGTH) {
+			return NT_STATUS_RPC_PROTOCOL_ERROR;
+		}
+		max_auth_length = max_auth_info - DCERPC_AUTH_TRAILER_LENGTH;
+
+		if (pkt->auth_length > max_auth_length) {
+			return NT_STATUS_RPC_PROTOCOL_ERROR;
+		}
+	}
+
+	if ((pkt->pfc_flags & required_flags) != required_flags) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+	if (pkt->pfc_flags & ~(optional_flags|required_flags)) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
+	if (pkt->drep[0] & ~DCERPC_DREP_LE) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+	if (pkt->drep[1] != 0) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+	if (pkt->drep[2] != 0) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+	if (pkt->drep[3] != 0) {
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
+	}
+
 	return NT_STATUS_OK;
 }
 
@@ -341,3 +451,194 @@
 	tevent_req_received(req);
 	return NT_STATUS_OK;
 }
+
+struct dcerpc_sec_vt_header2 dcerpc_sec_vt_header2_from_ncacn_packet(const struct ncacn_packet *pkt)
+{
+	struct dcerpc_sec_vt_header2 ret;
+
+	ZERO_STRUCT(ret);
+	ret.ptype = pkt->ptype;
+	memcpy(&ret.drep, pkt->drep, sizeof(ret.drep));
+	ret.call_id = pkt->call_id;
+
+	switch (pkt->ptype) {
+	case DCERPC_PKT_REQUEST:
+		ret.context_id = pkt->u.request.context_id;
+		ret.opnum      = pkt->u.request.opnum;
+		break;
+
+	case DCERPC_PKT_RESPONSE:
+		ret.context_id = pkt->u.response.context_id;
+		break;
+
+	case DCERPC_PKT_FAULT:
+		ret.context_id = pkt->u.fault.context_id;
+		break;
+
+	default:
+		break;
+	}
+
+	return ret;
+}
+
+bool dcerpc_sec_vt_header2_equal(const struct dcerpc_sec_vt_header2 *v1,
+				 const struct dcerpc_sec_vt_header2 *v2)
+{
+	if (v1->ptype != v2->ptype) {
+		return false;
+	}
+
+	if (memcmp(v1->drep, v2->drep, sizeof(v1->drep)) != 0) {
+		return false;
+	}
+
+	if (v1->call_id != v2->call_id) {
+		return false;
+	}
+
+	if (v1->context_id != v2->context_id) {
+		return false;
+	}
+
+	if (v1->opnum != v2->opnum) {
+		return false;
+	}
+
+	return true;
+}
+
+static bool dcerpc_sec_vt_is_valid(const struct dcerpc_sec_verification_trailer *r)
+{
+	bool ret = false;
+	TALLOC_CTX *frame = talloc_stackframe();
+	struct bitmap *commands_seen;
+	int i;
+
+	if (r->count.count == 0) {
+		ret = true;
+		goto done;
+	}
+
+	if (memcmp(r->magic, DCERPC_SEC_VT_MAGIC, sizeof(r->magic)) != 0) {
+		goto done;
+	}
+
+	commands_seen = bitmap_talloc(frame, DCERPC_SEC_VT_COMMAND_ENUM + 1);
+	if (commands_seen == NULL) {
+		goto done;
+	}
+
+	for (i=0; i < r->count.count; i++) {
+		enum dcerpc_sec_vt_command_enum cmd =
+			r->commands[i].command & DCERPC_SEC_VT_COMMAND_ENUM;
+
+		if (bitmap_query(commands_seen, cmd)) {
+			/* Each command must appear at most once. */
+			goto done;
+		}
+		bitmap_set(commands_seen, cmd);
+
+		switch (cmd) {
+		case DCERPC_SEC_VT_COMMAND_BITMASK1:
+		case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+		case DCERPC_SEC_VT_COMMAND_HEADER2:
+			break;
+		default:
+			if ((r->commands[i].u._unknown.length % 4) != 0) {
+				goto done;
+			}
+			break;
+		}
+	}
+	ret = true;
+done:
+	TALLOC_FREE(frame);
+	return ret;
+}
+
+#define CHECK(msg, ok)						\
+do {								\
+	if (!ok) {						\
+		DEBUG(10, ("SEC_VT check %s failed\n", msg));	\
+		return false;					\
+	}							\
+} while(0)
+
+#define CHECK_SYNTAX(msg, s1, s2)					\
+do {								\
+	if (!ndr_syntax_id_equal(&s1, &s2)) {				\
+		TALLOC_CTX *frame = talloc_stackframe();		\
+		DEBUG(10, ("SEC_VT check %s failed: %s vs. %s\n", msg,	\
+			   ndr_syntax_id_to_string(frame, &s1),		\
+			   ndr_syntax_id_to_string(frame, &s1)));	\
+		TALLOC_FREE(frame);					\
+		return false;						\
+	}								\
+} while(0)
+
+
+bool dcerpc_sec_verification_trailer_check(
+		const struct dcerpc_sec_verification_trailer *vt,
+		const uint32_t *bitmask1,
+		const struct dcerpc_sec_vt_pcontext *pcontext,
+		const struct dcerpc_sec_vt_header2 *header2)
+{
+	size_t i;
+
+	if (!dcerpc_sec_vt_is_valid(vt)) {
+		return false;
+	}
+
+	for (i=0; i < vt->count.count; i++) {
+		struct dcerpc_sec_vt *c = &vt->commands[i];
+
+		switch (c->command & DCERPC_SEC_VT_COMMAND_ENUM) {
+		case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			if (bitmask1 == NULL) {
+				CHECK("Bitmask1 must_process_command",
+				      !(c->command & DCERPC_SEC_VT_MUST_PROCESS));
+				break;
+			}
+
+			if (c->u.bitmask1 & DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING) {
+				CHECK("Bitmask1 client_header_signing",
+				      *bitmask1 & DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING);
+			}
+			break;
+
+		case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			if (pcontext == NULL) {
+				CHECK("Pcontext must_process_command",
+				      !(c->command & DCERPC_SEC_VT_MUST_PROCESS));
+				break;
+			}
+
+			CHECK_SYNTAX("Pcontect abstract_syntax",
+				     pcontext->abstract_syntax,
+				     c->u.pcontext.abstract_syntax);
+			CHECK_SYNTAX("Pcontext transfer_syntax",
+				     pcontext->transfer_syntax,
+				     c->u.pcontext.transfer_syntax);
+			break;
+
+		case DCERPC_SEC_VT_COMMAND_HEADER2: {
+			if (header2 == NULL) {
+				CHECK("Header2 must_process_command",
+				      !(c->command & DCERPC_SEC_VT_MUST_PROCESS));
+				break;
+			}
+
+			CHECK("Header2", dcerpc_sec_vt_header2_equal(header2, &c->u.header2));
+			break;
+		}
+
+		default:
+			CHECK("Unknown must_process_command",
+			      !(c->command & DCERPC_SEC_VT_MUST_PROCESS));
+			break;
+		}
+	}
+
+	return true;
+}
diff -daurN samba3/librpc/rpc/rpc_common.h samba3/librpc/rpc/rpc_common.h
--- samba3/librpc/rpc/rpc_common.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/rpc/rpc_common.h	2024-08-04 17:52:53.000000000 +0200
@@ -158,12 +158,17 @@
 *
 * @return		- A NTSTATUS error code.
 */
-NTSTATUS dcerpc_pull_auth_trailer(struct ncacn_packet *pkt,
+NTSTATUS dcerpc_pull_auth_trailer(const struct ncacn_packet *pkt,
 				  TALLOC_CTX *mem_ctx,
-				  DATA_BLOB *pkt_trailer,
+				  const DATA_BLOB *pkt_trailer,
 				  struct dcerpc_auth *auth,
 				  uint32_t *auth_length,
 				  bool auth_data_only);
+NTSTATUS dcerpc_verify_ncacn_packet_header(const struct ncacn_packet *pkt,
+					   enum dcerpc_pkt_type ptype,
+					   size_t max_auth_info,
+					   uint8_t required_flags,
+					   uint8_t optional_flags);
 struct tevent_req *dcerpc_read_ncacn_packet_send(TALLOC_CTX *mem_ctx,
 						 struct tevent_context *ev,
 						 struct tstream_context *stream);
@@ -296,4 +301,45 @@
 				    TALLOC_CTX *r_mem,
 				    void *r_ptr);
 
+/**
+ * Extract header information from a ncacn_packet
+ * as a dcerpc_sec_vt_header2 as used by the security verification trailer.
+ *
+ * @param[in] pkt a packet
+ *
+ * @return a dcerpc_sec_vt_header2
+ */
+struct dcerpc_sec_vt_header2 dcerpc_sec_vt_header2_from_ncacn_packet(const struct ncacn_packet *pkt);
+
+
+/**
+ * Test if two dcerpc_sec_vt_header2 structures are equal
+ * without consideration of reserved fields.
+ *
+ * @param v1 a pointer to a dcerpc_sec_vt_header2 structure
+ * @param v2 a pointer to a dcerpc_sec_vt_header2 structure
+ *
+ * @retval true if *v1 equals *v2
+ */
+bool dcerpc_sec_vt_header2_equal(const struct dcerpc_sec_vt_header2 *v1,
+				 const struct dcerpc_sec_vt_header2 *v2);
+
+/**
+ * Check for consistency of the security verification trailer with the PDU header.
+ * See <a href="http://msdn.microsoft.com/en-us/library/cc243559.aspx">MS-RPCE 2.2.2.13</a>.
+ * A check with an empty trailer succeeds.
+ *
+ * @param[in] vt a pointer to the security verification trailer.
+ * @param[in] bitmask1 which flags were negotiated on the connection.
+ * @param[in] pcontext the syntaxes negotiatied for the presentation context.
+ * @param[in] header2 some fields from the PDU header.
+ *
+ * @retval true on success.
+ */
+bool dcerpc_sec_verification_trailer_check(
+		const struct dcerpc_sec_verification_trailer *vt,
+		const uint32_t *bitmask1,
+		const struct dcerpc_sec_vt_pcontext *pcontext,
+		const struct dcerpc_sec_vt_header2 *header2);
+
 #endif /* __DEFAULT_LIBRPC_RPCCOMMON_H__ */
diff -daurN samba3/librpc/wscript_build samba3/librpc/wscript_build
--- samba3/librpc/wscript_build	2015-02-22 15:11:32.000000000 +0100
+++ samba3/librpc/wscript_build	2024-08-04 17:52:53.000000000 +0200
@@ -274,8 +274,9 @@
 	)
 
 bld.SAMBA_SUBSYSTEM('NDR_DCERPC',
-	source='gen_ndr/ndr_dcerpc.c',
+	source='gen_ndr/ndr_dcerpc.c ndr/ndr_dcerpc.c',
 	public_deps='ndr',
+	deps='bitmap',
 	public_headers='gen_ndr/ndr_dcerpc.h gen_ndr/dcerpc.h',
 	header_path= [ ('*gen_ndr*', 'gen_ndr') ],
 	)
diff -daurN samba3/Makefile samba3/Makefile
--- samba3/Makefile	1970-01-01 01:00:00.000000000 +0100
+++ samba3/Makefile	2024-09-17 23:15:12.323920414 +0200
@@ -0,0 +1,188 @@
+include ../common.mak
+
+#srcdir=source
+srcdir=source3
+
+export PARALLEL_BUILD := -j`grep -c '^processor' /proc/cpuinfo`
+
+SMBCFLAGS = $(EXTRACFLAGS) $(CFLAG_OPTIMIZE) -ffunction-sections -fdata-sections $(OPTSIZE_FLAG) $(if $(or $(TCONFIG_BCMARM),$(TCONFIG_NGINX)),-I$(TOP)/libiconv/staged/usr/include,) -I$(TOP)/zlib/staged/usr/include
+SMBLDFLAGS = -ffunction-sections -fdata-sections -Wl,--gc-sections $(if $(or $(TCONFIG_BCMARM),$(TCONFIG_NGINX)),-L$(TOP)/libiconv/staged/usr/lib,) -L$(TOP)/zlib/staged/usr/lib
+
+SMB_USE_MULTICALL=1
+
+ifeq ($(TCONFIG_BCMARM), y)
+SMBCFLAGS += -DBCMARM
+SMBLDFLAGS += -lgcc_s
+endif
+
+SMBLDFLAGS += -ldl -lpthread
+
+ifneq ($(CONFIG_LINUX26),y)
+SMBCFLAGS += -DMAX_DEBUG_LEVEL="-1"
+endif
+
+ifeq ($(TCONFIG_BCMARM),y)
+HOST = arm
+else
+HOST = mips
+endif
+
+all: .conf apps
+
+apps: .conf
+	mkdir -p $(srcdir)/bin
+	$(MAKE) -C $(srcdir) all $(PARALLEL_BUILD)
+
+.conf:
+	cd $(srcdir) && \
+	ac_cv_lib_resolv_dn_expand=no \
+	ac_cv_lib_resolv__dn_expand=no \
+	ac_cv_lib_resolv___dn_expand=no \
+	ac_cv_func_prctl=no \
+	ac_cv_file__proc_sys_kernel_core_pattern=yes \
+	SMB_BUILD_CC_NEGATIVE_ENUM_VALUES=yes \
+	linux_getgrouplist_ok=no \
+	samba_cv_fpie=no \
+	samba_cv_have_longlong=yes \
+	samba_cv_HAVE_INO64_T=yes \
+	samba_cv_HAVE_OFF64_T=yes \
+	samba_cv_HAVE_STRUCT_FLOCK64=yes \
+	samba_cv_SIZEOF_OFF_T=yes \
+	samba_cv_HAVE_MMAP=yes \
+	samba_cv_HAVE_FTRUNCATE_EXTEND=yes \
+	samba_cv_REPLACE_READDIR=no \
+	samba_cv_HAVE_BROKEN_LINUX_SENDFILE=no \
+	$(if $(TCONFIG_BCMARM),samba_cv_HAVE_SENDFILE=yes,samba_cv_HAVE_SENDFILE=no) \
+	samba_cv_HAVE_WRFILE_KEYTAB=yes \
+	samba_cv_HAVE_KERNEL_OPLOCKS_LINUX=yes \
+	samba_cv_HAVE_IFACE_IFCONF=yes \
+	samba_cv_have_setresgid=yes \
+	samba_cv_have_setresuid=yes \
+	samba_cv_USE_SETRESUID=yes \
+	samba_cv_USE_SETREUID=yes \
+	samba_cv_HAVE_GETTIMEOFDAY_TZ=yes \
+	samba_cv_REALPATH_TAKES_NULL=yes \
+	samba_cv_HAVE_FCNTL_LOCK=yes \
+	samba_cv_HAVE_SECURE_MKSTEMP=yes \
+	samba_cv_HAVE_NATIVE_ICONV=no \
+	samba_cv_HAVE_BROKEN_FCNTL64_LOCKS=no \
+	samba_cv_HAVE_BROKEN_GETGROUPS=no \
+	samba_cv_HAVE_BROKEN_READDIR_NAME=no \
+	samba_cv_HAVE_C99_VSNPRINTF=yes \
+	samba_cv_HAVE_DEV64_T=no \
+	samba_cv_HAVE_DEVICE_MAJOR_FN=yes \
+	samba_cv_HAVE_DEVICE_MINOR_FN=yes \
+	samba_cv_HAVE_IFACE_AIX=no \
+	samba_cv_HAVE_KERNEL_CHANGE_NOTIFY=yes \
+	samba_cv_HAVE_KERNEL_SHARE_MODES=yes \
+	samba_cv_HAVE_MAKEDEV=yes \
+	samba_cv_HAVE_TRUNCATED_SALT=no \
+	samba_cv_HAVE_UNSIGNED_CHAR=no \
+	samba_cv_HAVE_WORKING_AF_LOCAL=yes \
+	samba_cv_HAVE_Werror=yes \
+	samba_cv_REPLACE_INET_NTOA=no \
+	samba_cv_SIZEOF_DEV_T=yes \
+	samba_cv_SIZEOF_INO_T=yes \
+	samba_cv_SIZEOF_TIME_T=no \
+	samba_cv_CC_NEGATIVE_ENUM_VALUES=yes \
+	CPPFLAGS="-DNDEBUG -DSHMEM_SIZE=524288 -Dfcntl=fcntl64 -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE=1 -D_LARGEFILE64_SOURCE=1 -D_LARGE_FILES=1" \
+	CFLAGS="$(SMBCFLAGS)" LDFLAGS="$(SMBLDFLAGS)" CC=$(CC) LD=$(LD) AR=$(AR) RANLIB=$(RANLIB) \
+	$(CONFIGURE) \
+		--prefix=/usr \
+		--bindir=/usr/bin \
+		--sbindir=/usr/sbin \
+		--libdir=/etc \
+		--localstatedir=/var \
+		--host=$(HOST)-linux \
+		$(if $(or $(TCONFIG_BCMARM),$(TCONFIG_NGINX)),--with-libiconv=$(TOP)/libiconv/staged/usr,) \
+		--with-configdir=/etc/samba \
+		--with-rootsbindir=/usr/sbin \
+		--with-piddir=/var/run/samba \
+		--with-privatedir=/etc/samba \
+		--with-lockdir=/var/lock \
+		--with-syslog \
+		--with-included-popt=no \
+		--with-krb5=no \
+		--with-shared-modules=MODULES \
+		--with-included-iniparser \
+		--with-logfilebase=/var/log \
+		--with-nmbdsocketdir=/var/nmbd \
+		$(if $(TCONFIG_BCMARM),--with-sendfile-support,) \
+		--disable-avahi \
+		--disable-swat \
+		--disable-shared-libs \
+		--disable-static \
+		--disable-cups \
+		--disable-iprint \
+		--disable-pie \
+		--disable-fam \
+		--disable-dmalloc \
+		--disable-krb5developer \
+		--disable-developer \
+		--disable-debug \
+		--enable-largefile \
+		$(if $(TCONFIG_BCMARM),--with-codepagedir=/usr/share/samba/codepages,) \
+		--without-ads \
+		--without-krb5 \
+		--without-pam \
+		--without-libtdb \
+		--without-libnetapi \
+		--without-libsmbsharemodes \
+		--without-acl-support \
+		--without-ldap \
+		--without-cluster-support \
+		--without-utmp \
+		--without-winbind \
+		--without-quotas \
+		--without-libtalloc \
+		--without-libtevent \
+		--without-sys-quotas \
+		--without-dnsupdate
+	touch .conf
+	mkdir -p $(srcdir)/bin
+
+clean:
+	-$(MAKE) -C $(srcdir) distclean
+	@rm -f auth/*.o
+	@rm -f .conf
+
+distclean: clean
+	@find $(srcdir) -name config.h | xargs rm -f
+	@find $(srcdir) -name Makefile | xargs rm -f
+	@find $(srcdir) -name config.status | xargs rm -f
+	@find $(srcdir) -name config.cache | xargs rm -f
+
+install: all
+	@install -d $(INSTALLDIR)/usr/bin/
+	@install -d $(INSTALLDIR)/usr/sbin/
+	@install -d $(INSTALLDIR)/usr/lib/
+ifeq ($(SMB_USE_MULTICALL), 1)
+	@install -D $(srcdir)/bin/samba_multicall $(INSTALLDIR)/usr/bin/samba_multicall
+	@ln -sf ../bin/samba_multicall $(INSTALLDIR)/usr/sbin/smbd
+	@ln -sf ../bin/samba_multicall $(INSTALLDIR)/usr/sbin/nmbd
+	@ln -sf samba_multicall $(INSTALLDIR)/usr/bin/smbpasswd
+else
+	@install -D $(srcdir)/bin/smbd $(INSTALLDIR)/usr/sbin/smbd
+	@install -D $(srcdir)/bin/nmbd $(INSTALLDIR)/usr/sbin/nmbd
+	@install -D $(srcdir)/bin/smbpasswd $(INSTALLDIR)/usr/bin/smbpasswd
+endif
+ifeq ($(TCONFIG_BCMARM),y)
+	install -D codepages/lowcase.dat $(INSTALLDIR)/usr/share/samba/codepages/lowcase.dat
+	install -D codepages/upcase.dat $(INSTALLDIR)/usr/share/samba/codepages/upcase.dat
+endif
+
+#	@install -D $(srcdir)/bin/libsmbclient.so.0 $(INSTALLDIR)/usr/lib/libsmbclient.so.0
+#	@ln -sf libsmbclient.so.0 $(INSTALLDIR)/usr/lib/libsmbclient.so
+#	@install -D $(srcdir)/bin/libbigballofmud.so $(INSTALLDIR)/usr/lib/libbigballofmud.so
+###############################Charles Modify##########	
+
+ifeq ($(SMB_USE_MULTICALL), 1)
+	$(STRIP) -s $(INSTALLDIR)/usr/bin/samba_multicall
+else
+	$(STRIP) -s $(INSTALLDIR)/usr/sbin/smbd
+	$(STRIP) -s $(INSTALLDIR)/usr/sbin/nmbd
+	$(STRIP) -s $(INSTALLDIR)/usr/bin/smbpasswd
+endif
+#	$(STRIP) -s $(INSTALLDIR)/usr/lib/libsmbclient.so.0
+	# do not strip shared library, it will be optimized by libfoo.pl
+	# $(STRIP) -s $(INSTALLDIR)/usr/lib/libbigballofmud.so
diff -daurN samba3/pidl/lib/Parse/Pidl/ODL.pm samba3/pidl/lib/Parse/Pidl/ODL.pm
--- samba3/pidl/lib/Parse/Pidl/ODL.pm	2015-02-22 15:11:32.000000000 +0100
+++ samba3/pidl/lib/Parse/Pidl/ODL.pm	2024-08-04 17:52:53.000000000 +0200
@@ -70,7 +70,7 @@
 					next;
 				}
 				my $podl = Parse::Pidl::IDL::parse_file($idl_path, $opt_incdirs);
-				if (defined(@$podl)) {
+				if (defined($podl)) {
 					require Parse::Pidl::Typelist;
 					my $basename = basename($idl_path, ".idl");
 
diff -daurN samba3/pidl/lib/Parse/Pidl/Samba3/ServerNDR.pm samba3/pidl/lib/Parse/Pidl/Samba3/ServerNDR.pm
--- samba3/pidl/lib/Parse/Pidl/Samba3/ServerNDR.pm	2015-02-22 15:11:32.000000000 +0100
+++ samba3/pidl/lib/Parse/Pidl/Samba3/ServerNDR.pm	2024-08-04 17:52:53.000000000 +0200
@@ -183,7 +183,7 @@
 	);
 
 	pidl "";
-	pidl "if (p->rng_fault_state) {";
+	pidl "if (p->fault_state) {";
 	pidl "\ttalloc_free(r);";
 	pidl "\t/* Return true here, srv_pipe_hnd.c will take care */";
 	pidl "\treturn true;";
diff -daurN samba3/pidl/pidl samba3/pidl/pidl
--- samba3/pidl/pidl	2015-02-22 15:11:32.000000000 +0100
+++ samba3/pidl/pidl	2024-08-04 17:52:53.000000000 +0200
@@ -605,7 +605,7 @@
 		require Parse::Pidl::IDL;
 
 		$pidl = Parse::Pidl::IDL::parse_file($idl_file, \@opt_incdirs);
-		defined @$pidl || die "Failed to parse $idl_file";
+		defined $pidl || die "Failed to parse $idl_file";
 	}
 
 	require Parse::Pidl::Typelist;
diff -daurN samba3/selftest/target/Samba3.pm samba3/selftest/target/Samba3.pm
--- samba3/selftest/target/Samba3.pm	2015-02-22 15:11:32.000000000 +0100
+++ samba3/selftest/target/Samba3.pm	2024-08-04 17:52:53.000000000 +0200
@@ -127,6 +127,7 @@
 	domain master = yes
 	domain logons = yes
 	lanman auth = yes
+	raw NTLMv2 auth = yes
 ";
 
 	my $vars = $self->provision($path,
@@ -230,6 +231,7 @@
 	my $secserver_options = "
 	security = server
         password server = $s3dcvars->{SERVER_IP}
+	client ntlmv2 auth = no
 ";
 
 	my $ret = $self->provision($prefix,
diff -daurN samba3/source3/auth/auth_domain.c samba3/source3/auth/auth_domain.c
--- samba3/source3/auth/auth_domain.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/auth/auth_domain.c	2024-08-04 17:52:53.000000000 +0200
@@ -538,7 +538,9 @@
 
 NTSTATUS auth_domain_init(void) 
 {
+#ifdef NETLOGON_SUPPORT
 	smb_register_auth(AUTH_INTERFACE_VERSION, "trustdomain", auth_init_trustdomain);
 	smb_register_auth(AUTH_INTERFACE_VERSION, "ntdomain", auth_init_ntdomain);
+#endif
 	return NT_STATUS_OK;
 }
diff -daurN samba3/source3/auth/auth_util.c samba3/source3/auth/auth_util.c
--- samba3/source3/auth/auth_util.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/auth/auth_util.c	2024-08-04 17:52:53.000000000 +0200
@@ -30,6 +30,7 @@
 #include "../lib/util/util_pw.h"
 #include "lib/winbind_util.h"
 #include "passdb.h"
+#include "../lib/tsocket/tsocket.h"
 
 #undef DBGC_CLASS
 #define DBGC_CLASS DBGC_AUTH
@@ -367,6 +368,19 @@
                                       const char *client_domain, 
                                       DATA_BLOB lm_resp, DATA_BLOB nt_resp)
 {
+	bool allow_raw = lp_raw_ntlmv2_auth();
+
+	if (!allow_raw && nt_resp.length >= 48) {
+		/*
+		 * NTLMv2_RESPONSE has at least 48 bytes
+		 * and should only be supported via NTLMSSP.
+		 */
+		DEBUG(2,("Rejecting raw NTLMv2 authentication with "
+			 "user [%s\\%s]\n",
+			 client_domain, smb_name));
+		return NT_STATUS_INVALID_PARAMETER;
+	}
+
 	return make_user_info_map(user_info, smb_name, 
 				  client_domain, 
 				  get_remote_machine_name(), 
@@ -1109,7 +1123,7 @@
 				"%s%c%s",
 				domain,
 				*lp_winbind_separator(),
-				lower_username);
+				username);
 	if (!orig_dom_user) {
 		return NT_STATUS_NO_MEMORY;
 	}
diff -daurN samba3/source3/configure samba3/source3/configure
--- samba3/source3/configure	2015-02-22 15:16:23.000000000 +0100
+++ samba3/source3/configure	2024-08-04 17:52:53.000000000 +0200
@@ -13294,10 +13294,7 @@
 	# see bug 5910, use our replacements if we detect
 	# a broken system.
 	if test "$cross_compiling" = yes; then :
-  { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "cannot run test program while cross compiling
-See \`config.log' for more details" "$LINENO" 5; }
+		$as_echo "assuming valid getaddrinfo without bug 5910" >&2
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
diff -daurN samba3/source3/include/ntdomain.h samba3/source3/include/ntdomain.h
--- samba3/source3/include/ntdomain.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/include/ntdomain.h	2024-08-04 17:52:53.000000000 +0200
@@ -87,7 +87,12 @@
 	const struct api_struct *cmds;
 	int n_cmds;
 	uint32 context_id;
+	struct ndr_syntax_id syntax;
 
+	/*
+	 * shall we allow "connect" auth level for this interface ?
+	 */
+	bool allow_connect;
 } PIPE_RPC_FNS;
 
 /*
@@ -134,22 +139,17 @@
 	bool pipe_bound;
 
 	/*
-	 * Set to true when we should return fault PDU's for everything.
-	 */
-
-	bool fault_state;
-
-	/*
-	 * Set to true when we should return fault PDU's for a bad handle.
+	 * States we can be in.
 	 */
-
-	bool bad_handle_fault_state;
+	bool allow_alter;
+	bool allow_bind;
+	bool allow_auth3;
 
 	/*
-	 * Set to true when the backend does not support a call.
+	 * Set the DCERPC_FAULT to return.
 	 */
 
-	bool rng_fault_state;
+	int fault_state;
 
 	/*
 	 * Set to RPC_BIG_ENDIAN when dealing with big-endian PDU's
diff -daurN samba3/source3/include/proto.h samba3/source3/include/proto.h
--- samba3/source3/include/proto.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/include/proto.h	2024-08-04 17:52:53.000000000 +0200
@@ -61,15 +61,6 @@
 bool get_audit_category_from_param(const char *param, uint32 *audit_category);
 const char *audit_policy_str(TALLOC_CTX *mem_ctx, uint32 policy);
 
-/* The following definitions come from lib/bitmap.c  */
-
-struct bitmap *bitmap_talloc(TALLOC_CTX *mem_ctx, int n);
-int bitmap_copy(struct bitmap * const dst, const struct bitmap * const src);
-bool bitmap_set(struct bitmap *bm, unsigned i);
-bool bitmap_clear(struct bitmap *bm, unsigned i);
-bool bitmap_query(struct bitmap *bm, unsigned i);
-int bitmap_find(struct bitmap *bm, unsigned ofs);
-
 /* The following definitions come from lib/charcnv.c  */
 
 char lp_failed_convert_char(void);
@@ -1269,6 +1260,7 @@
 NTSTATUS ntlmssp_set_domain(struct ntlmssp_state *ntlmssp_state, const char *domain) ;
 void ntlmssp_want_feature_list(struct ntlmssp_state *ntlmssp_state, char *feature_list);
 void ntlmssp_want_feature(struct ntlmssp_state *ntlmssp_state, uint32_t feature);
+bool ntlmssp_have_feature(struct ntlmssp_state *ntlmssp_state, uint32_t feature);
 NTSTATUS ntlmssp_update(struct ntlmssp_state *ntlmssp_state,
 			const DATA_BLOB in, DATA_BLOB *out) ;
 NTSTATUS ntlmssp_server_start(TALLOC_CTX *mem_ctx,
@@ -1498,6 +1490,7 @@
 int lp_restrict_anonymous(void);
 bool lp_lanman_auth(void);
 bool lp_ntlm_auth(void);
+bool lp_raw_ntlmv2_auth(void);
 bool lp_client_plaintext_auth(void);
 bool lp_client_lanman_auth(void);
 bool lp_client_ntlmv2_auth(void);
@@ -1697,9 +1690,11 @@
 int lp_winbind_reconnect_delay(void);
 int lp_winbind_max_clients(void);
 const char **lp_winbind_nss_info(void);
+bool lp_winbind_sealed_pipes(void);
 int lp_algorithmic_rid_base(void);
 int lp_name_cache_timeout(void);
 int lp_client_signing(void);
+int lp_client_ipc_signing(void);
 int lp_server_signing(void);
 int lp_client_ldap_sasl_wrapping(void);
 char *lp_parm_talloc_string(int snum, const char *type, const char *option, const char *def);
@@ -1826,6 +1821,7 @@
 void lp_set_passdb_backend(const char *backend);
 void widelinks_warning(int snum);
 char *lp_ncalrpc_dir(void);
+bool lp_allow_dcerpc_auth_level_connect(void);
 
 /* The following definitions come from param/loadparm_server_role.c  */
 
diff -daurN samba3/source3/include/smb.h samba3/source3/include/smb.h
--- samba3/source3/include/smb.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/include/smb.h	2024-08-04 17:52:53.000000000 +0200
@@ -712,7 +712,6 @@
 	uint32 unused_compatitibility_field;
 };
 
-
 /* the following are used by loadparm for option lists */
 typedef enum {
 	P_BOOL,P_BOOLREV,P_CHAR,P_INTEGER,P_OCTAL,P_LIST,
@@ -759,11 +758,6 @@
 #define FLAG_META	0x8000 /* A meta directive - not a real parameter */
 #define FLAG_CMDLINE	0x10000 /* option has been overridden */
 
-struct bitmap {
-	uint32 *b;
-	unsigned int n;
-};
-
 /* offsets into message for common items */
 #define smb_com 8
 #define smb_rcls 9
diff -daurN samba3/source3/lib/bitmap.c samba3/source3/lib/bitmap.c
--- samba3/source3/lib/bitmap.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/lib/bitmap.c	1970-01-01 01:00:00.000000000 +0100
@@ -1,136 +0,0 @@
-/*
-   Unix SMB/CIFS implementation.
-   simple bitmap functions
-   Copyright (C) Andrew Tridgell 1992-1998
-
-   This program is free software; you can redistribute it and/or modify
-   it under the terms of the GNU General Public License as published by
-   the Free Software Foundation; either version 3 of the License, or
-   (at your option) any later version.
-
-   This program is distributed in the hope that it will be useful,
-   but WITHOUT ANY WARRANTY; without even the implied warranty of
-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-   GNU General Public License for more details.
-
-   You should have received a copy of the GNU General Public License
-   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-*/
-
-#include "includes.h"
-
-/* these functions provide a simple way to allocate integers from a
-   pool without repetition */
-
-/****************************************************************************
-talloc a bitmap
-****************************************************************************/
-struct bitmap *bitmap_talloc(TALLOC_CTX *mem_ctx, int n)
-{
-	struct bitmap *bm;
-
-	bm = TALLOC_P(mem_ctx, struct bitmap);
-
-	if (!bm) return NULL;
-
-	bm->n = n;
-	bm->b = TALLOC_ZERO_ARRAY(bm, uint32, (n+31)/32);
-	if (!bm->b) {
-		TALLOC_FREE(bm);
-		return NULL;
-	}
-	return bm;
-}
-
-/****************************************************************************
-copy as much of the source bitmap as will fit in the destination bitmap.
-****************************************************************************/
-
-int bitmap_copy(struct bitmap * const dst, const struct bitmap * const src)
-{
-        int count = MIN(dst->n, src->n);
-
-        SMB_ASSERT(dst->b != src->b);
-	memcpy(dst->b, src->b, sizeof(uint32)*((count+31)/32));
-
-        return count;
-}
-
-/****************************************************************************
-set a bit in a bitmap
-****************************************************************************/
-bool bitmap_set(struct bitmap *bm, unsigned i)
-{
-	if (i >= bm->n) {
-		DEBUG(0,("Setting invalid bitmap entry %d (of %d)\n",
-		      i, bm->n));
-		return False;
-	}
-	bm->b[i/32] |= (1<<(i%32));
-	return True;
-}
-
-/****************************************************************************
-clear a bit in a bitmap
-****************************************************************************/
-bool bitmap_clear(struct bitmap *bm, unsigned i)
-{
-	if (i >= bm->n) {
-		DEBUG(0,("clearing invalid bitmap entry %d (of %d)\n",
-		      i, bm->n));
-		return False;
-	}
-	bm->b[i/32] &= ~(1<<(i%32));
-	return True;
-}
-
-/****************************************************************************
-query a bit in a bitmap
-****************************************************************************/
-bool bitmap_query(struct bitmap *bm, unsigned i)
-{
-	if (i >= bm->n) return False;
-	if (bm->b[i/32] & (1<<(i%32))) {
-		return True;
-	}
-	return False;
-}
-
-/****************************************************************************
-find a zero bit in a bitmap starting at the specified offset, with
-wraparound
-****************************************************************************/
-int bitmap_find(struct bitmap *bm, unsigned ofs)
-{
-	unsigned int i, j;
-
-	if (ofs > bm->n) ofs = 0;
-
-	i = ofs;
-	while (i < bm->n) {
-		if (~(bm->b[i/32])) {
-			j = i;
-			do {
-				if (!bitmap_query(bm, j)) return j;
-				j++;
-			} while (j & 31 && j < bm->n);
-		}
-		i += 32;
-		i &= ~31;
-	}
-
-	i = 0;
-	while (i < ofs) {
-		if (~(bm->b[i/32])) {
-			j = i;
-			do {
-				if (!bitmap_query(bm, j)) return j;
-				j++;
-			} while (j & 31 && j < bm->n);
-		}
-		i += 32;
-		i &= ~31;
-	}
-
-	return -1;
-}
diff -daurN samba3/source3/lib/netapi/serverinfo.c samba3/source3/lib/netapi/serverinfo.c
--- samba3/source3/lib/netapi/serverinfo.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/lib/netapi/serverinfo.c	2024-08-04 17:52:53.000000000 +0200
@@ -557,7 +557,10 @@
 		return WERR_INVALID_PARAM;
 	}
 
-	if (!lp_config_backend_is_registry()) {
+#ifdef REGISTRY_BACKEND
+	if (!lp_config_backend_is_registry())
+#endif
+	{
 		libnetapi_set_error_string(ctx,
 			"Configuration manipulation requested but not "
 			"supported by backend");
diff -daurN samba3/source3/lib/smbconf/smbconf_init.c samba3/source3/lib/smbconf/smbconf_init.c
--- samba3/source3/lib/smbconf/smbconf_init.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/lib/smbconf/smbconf_init.c	2024-08-04 17:52:53.000000000 +0200
@@ -68,9 +68,12 @@
 		}
 	}
 
+#ifdef REGISTRY_BACKEND
 	if (strequal(backend, "registry") || strequal(backend, "reg")) {
 		err = smbconf_init_reg(mem_ctx, conf_ctx, path);
-	} else if (strequal(backend, "file") || strequal(backend, "txt")) {
+	} else
+#endif
+	if (strequal(backend, "file") || strequal(backend, "txt")) {
 		err = smbconf_init_txt(mem_ctx, conf_ctx, path);
 	} else if (sep == NULL) {
 		/*
diff -daurN samba3/source3/libads/sasl.c samba3/source3/libads/sasl.c
--- samba3/source3/libads/sasl.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/libads/sasl.c	2024-08-04 17:52:53.000000000 +0200
@@ -261,6 +261,37 @@
 	/* we have a reference conter on ntlmssp_state, if we are signing
 	   then the state will be kept by the signing engine */
 
+	if (ads->ldap.wrap_type >= ADS_SASLWRAP_TYPE_SEAL) {
+		bool ok;
+
+		ok = ntlmssp_have_feature(ntlmssp_state,
+					  NTLMSSP_FEATURE_SEAL);
+		if (!ok) {
+			DEBUG(0,("The ntlmssp feature sealing request, but unavailable\n"));
+			TALLOC_FREE(ntlmssp_state);
+			return ADS_ERROR_NT(NT_STATUS_INVALID_NETWORK_RESPONSE);
+		}
+
+		ok = ntlmssp_have_feature(ntlmssp_state,
+					  NTLMSSP_FEATURE_SIGN);
+		if (!ok) {
+			DEBUG(0,("The ntlmssp feature signing request, but unavailable\n"));
+			TALLOC_FREE(ntlmssp_state);
+			return ADS_ERROR_NT(NT_STATUS_INVALID_NETWORK_RESPONSE);
+		}
+
+	} else if (ads->ldap.wrap_type >= ADS_SASLWRAP_TYPE_SIGN) {
+		bool ok;
+
+		ok = ntlmssp_have_feature(ntlmssp_state,
+					  NTLMSSP_FEATURE_SIGN);
+		if (!ok) {
+			DEBUG(0,("The gensec feature signing request, but unavailable\n"));
+			TALLOC_FREE(ntlmssp_state);
+			return ADS_ERROR_NT(NT_STATUS_INVALID_NETWORK_RESPONSE);
+		}
+	}
+
 	if (ads->ldap.wrap_type > ADS_SASLWRAP_TYPE_PLAIN) {
 		ads->ldap.out.max_unwrapped = ADS_SASL_WRAPPING_OUT_MAX_WRAPPED - NTLMSSP_SIG_SIZE;
 		ads->ldap.out.sig_size = NTLMSSP_SIG_SIZE;
diff -daurN samba3/source3/librpc/gen_ndr/dcerpc.h samba3/source3/librpc/gen_ndr/dcerpc.h
--- samba3/source3/librpc/gen_ndr/dcerpc.h
+++ samba3/source3/librpc/gen_ndr/dcerpc.h
@@ -8,6 +8,7 @@
 #include "libcli/util/ntstatus.h"
 
 #include "librpc/gen_ndr/misc.h"
+extern const uint8_t DCERPC_SEC_VT_MAGIC[8];
 #ifndef _HEADER_dcerpc
 #define _HEADER_dcerpc
 
@@ -29,20 +30,18 @@
 #define DCERPC_FAULT_TODO	( 0x00000042 )
 #define DCERPC_AUTH_LEVEL_DEFAULT	( DCERPC_AUTH_LEVEL_CONNECT )
 #define DCERPC_AUTH_TRAILER_LENGTH	( 8 )
-#define DCERPC_PFC_FLAG_FIRST	( 0x01 )
-#define DCERPC_PFC_FLAG_LAST	( 0x02 )
-#define DCERPC_PFC_FLAG_PENDING_CANCEL	( 0x04 )
-#define DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN	( DCERPC_PFC_FLAG_PENDING_CANCEL )
-#define DCERPC_PFC_FLAG_CONC_MPX	( 0x10 )
-#define DCERPC_PFC_FLAG_DID_NOT_EXECUTE	( 0x20 )
-#define DCERPC_PFC_FLAG_MAYBE	( 0x40 )
-#define DCERPC_PFC_FLAG_OBJECT_UUID	( 0x80 )
+#define DCERPC_PFC_FLAG_PENDING_CANCEL	( DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING )
+#define DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN	( DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING )
 #define DCERPC_PFC_OFFSET	( 3 )
 #define DCERPC_DREP_OFFSET	( 4 )
 #define DCERPC_FRAG_LEN_OFFSET	( 8 )
+#define DCERPC_FRAG_MAX_SIZE	( 5840 )
 #define DCERPC_AUTH_LEN_OFFSET	( 10 )
 #define DCERPC_CALL_ID_OFFSET	( 12 )
+#define DCERPC_NCACN_PAYLOAD_OFFSET	( 16 )
+#define DCERPC_NCACN_PAYLOAD_MAX_SIZE	( 0x400000 )
 #define DCERPC_DREP_LE	( 0x10 )
+#define DCERPC_SEC_VT_MAX_SIZE	( 1024 )
 struct dcerpc_ctx_list {
 	uint16_t context_id;
 	uint8_t num_transfer_syntaxes;
@@ -568,6 +567,15 @@
 	struct dcerpc_rts rts;/* [case(DCERPC_PKT_RTS)] */
 }/* [nodiscriminant] */;
 
+/* bitmap dcerpc_pfc_flags */
+#define DCERPC_PFC_FLAG_FIRST ( 0x01 )
+#define DCERPC_PFC_FLAG_LAST ( 0x02 )
+#define DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING ( 0x04 )
+#define DCERPC_PFC_FLAG_CONC_MPX ( 0x10 )
+#define DCERPC_PFC_FLAG_DID_NOT_EXECUTE ( 0x20 )
+#define DCERPC_PFC_FLAG_MAYBE ( 0x40 )
+#define DCERPC_PFC_FLAG_OBJECT_UUID ( 0x80 )
+
 struct ncacn_packet {
 	uint8_t rpc_vers;
 	uint8_t rpc_vers_minor;
@@ -603,5 +611,66 @@
 	union dcerpc_payload u;/* [switch_is(ptype)] */
 }/* [public] */;
 
+/* bitmap dcerpc_sec_vt_command */
+#define DCERPC_SEC_VT_COMMAND_ENUM ( 0x3FFF )
+#define DCERPC_SEC_VT_COMMAND_END ( 0x4000 )
+#define DCERPC_SEC_VT_MUST_PROCESS ( 0x8000 )
+
+enum dcerpc_sec_vt_command_enum
+#ifndef USE_UINT_ENUMS
+ {
+	DCERPC_SEC_VT_COMMAND_BITMASK1=(int)(0x0001),
+	DCERPC_SEC_VT_COMMAND_PCONTEXT=(int)(0x0002),
+	DCERPC_SEC_VT_COMMAND_HEADER2=(int)(0x0003)
+}
+#else
+ { __donnot_use_enum_dcerpc_sec_vt_command_enum=0x7FFFFFFF}
+#define DCERPC_SEC_VT_COMMAND_BITMASK1 ( 0x0001 )
+#define DCERPC_SEC_VT_COMMAND_PCONTEXT ( 0x0002 )
+#define DCERPC_SEC_VT_COMMAND_HEADER2 ( 0x0003 )
+#endif
+;
+
+/* bitmap dcerpc_sec_vt_bitmask1 */
+#define DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING ( 0x00000001 )
+
+struct dcerpc_sec_vt_pcontext {
+	struct ndr_syntax_id abstract_syntax;
+	struct ndr_syntax_id transfer_syntax;
+};
+
+struct dcerpc_sec_vt_header2 {
+	enum dcerpc_pkt_type ptype;
+	uint8_t reserved1;/* [value(0)] */
+	uint16_t reserved2;/* [value(0)] */
+	uint8_t drep[4];
+	uint32_t call_id;
+	uint16_t context_id;
+	uint16_t opnum;
+};
+
+union dcerpc_sec_vt_union {
+	uint32_t bitmask1;/* [case(DCERPC_SEC_VT_COMMAND_BITMASK1)] */
+	struct dcerpc_sec_vt_pcontext pcontext;/* [case(DCERPC_SEC_VT_COMMAND_PCONTEXT)] */
+	struct dcerpc_sec_vt_header2 header2;/* [case(DCERPC_SEC_VT_COMMAND_HEADER2)] */
+	DATA_BLOB _unknown;/* [flag(LIBNDR_FLAG_REMAINING),default] */
+}/* [nodiscriminant,switch_type(dcerpc_sec_vt_command_enum)] */;
+
+struct dcerpc_sec_vt {
+	uint16_t command;
+	union dcerpc_sec_vt_union u;/* [subcontext(2),switch_is(command&DCERPC_SEC_VT_COMMAND_ENUM),flag(LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES)] */
+};
+
+struct dcerpc_sec_vt_count {
+	uint16_t count;
+}/* [nopush,public,nopull] */;
+
+struct dcerpc_sec_verification_trailer {
+	DATA_BLOB _pad;/* [flag(LIBNDR_FLAG_ALIGN4)] */
+	uint8_t magic[8];/* [value(DCERPC_SEC_VT_MAGIC)] */
+	struct dcerpc_sec_vt_count count;
+	struct dcerpc_sec_vt *commands;
+}/* [public,flag(LIBNDR_PRINT_ARRAY_HEX)] */;
+
 #endif /* _HEADER_dcerpc */
 #endif /* _PIDL_HEADER_dcerpc */
diff -daurN samba3/source3/librpc/gen_ndr/libnetapi.h samba3/source3/librpc/gen_ndr/libnetapi.h
--- samba3/source3/librpc/gen_ndr/libnetapi.h	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/libnetapi.h	2024-09-12 20:44:02.000000000 +0200
@@ -1706,7 +1706,7 @@
 
 	struct {
 		uint32_t *entries_read;/* [ref] */
-		void **buffer;/* [ref,noprint] */
+		void **buffer;/* [noprint,ref] */
 		enum NET_API_STATUS result;
 	} out;
 
diff -daurN samba3/source3/librpc/gen_ndr/libnet_join.h samba3/source3/librpc/gen_ndr/libnet_join.h
--- samba3/source3/librpc/gen_ndr/libnet_join.h	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/libnet_join.h	2024-09-12 23:44:50.000000000 +0200
@@ -68,7 +68,7 @@
 		struct ads_struct *ads;/* [unique] */
 		uint8_t debug;
 		uint8_t use_kerberos;
-		struct messaging_context *msg_ctx;/* [ref,noprint] */
+		struct messaging_context *msg_ctx;/* [noprint,ref] */
 	} in;
 
 	struct {
diff -daurN samba3/source3/librpc/gen_ndr/ndr_atsvc.c samba3/source3/librpc/gen_ndr/ndr_atsvc.c
--- samba3/source3/librpc/gen_ndr/ndr_atsvc.c	2015-02-22 15:16:24.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_atsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -867,7 +867,7 @@
 		sizeof(struct atsvc_JobAdd),
 		(ndr_push_flags_fn_t) ndr_push_atsvc_JobAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_atsvc_JobAdd,
-		(ndr_print_function_t) ndr_print_atsvc_JobAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -876,7 +876,7 @@
 		sizeof(struct atsvc_JobDel),
 		(ndr_push_flags_fn_t) ndr_push_atsvc_JobDel,
 		(ndr_pull_flags_fn_t) ndr_pull_atsvc_JobDel,
-		(ndr_print_function_t) ndr_print_atsvc_JobDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -885,7 +885,7 @@
 		sizeof(struct atsvc_JobEnum),
 		(ndr_push_flags_fn_t) ndr_push_atsvc_JobEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_atsvc_JobEnum,
-		(ndr_print_function_t) ndr_print_atsvc_JobEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -894,7 +894,7 @@
 		sizeof(struct atsvc_JobGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_atsvc_JobGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_atsvc_JobGetInfo,
-		(ndr_print_function_t) ndr_print_atsvc_JobGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_audiosrv.c samba3/source3/librpc/gen_ndr/ndr_audiosrv.c
--- samba3/source3/librpc/gen_ndr/ndr_audiosrv.c	2015-02-22 15:16:24.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_audiosrv.c	2024-08-04 17:52:53.000000000 +0200
@@ -594,7 +594,7 @@
 		sizeof(struct audiosrv_CreatezoneFactoriesList),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_CreatezoneFactoriesList,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_CreatezoneFactoriesList,
-		(ndr_print_function_t) ndr_print_audiosrv_CreatezoneFactoriesList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -603,7 +603,7 @@
 		sizeof(struct audiosrv_CreateGfxFactoriesList),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_CreateGfxFactoriesList,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_CreateGfxFactoriesList,
-		(ndr_print_function_t) ndr_print_audiosrv_CreateGfxFactoriesList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -612,7 +612,7 @@
 		sizeof(struct audiosrv_CreateGfxList),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_CreateGfxList,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_CreateGfxList,
-		(ndr_print_function_t) ndr_print_audiosrv_CreateGfxList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -621,7 +621,7 @@
 		sizeof(struct audiosrv_RemoveGfx),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_RemoveGfx,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_RemoveGfx,
-		(ndr_print_function_t) ndr_print_audiosrv_RemoveGfx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -630,7 +630,7 @@
 		sizeof(struct audiosrv_AddGfx),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_AddGfx,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_AddGfx,
-		(ndr_print_function_t) ndr_print_audiosrv_AddGfx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -639,7 +639,7 @@
 		sizeof(struct audiosrv_ModifyGfx),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_ModifyGfx,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_ModifyGfx,
-		(ndr_print_function_t) ndr_print_audiosrv_ModifyGfx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -648,7 +648,7 @@
 		sizeof(struct audiosrv_OpenGfx),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_OpenGfx,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_OpenGfx,
-		(ndr_print_function_t) ndr_print_audiosrv_OpenGfx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -657,7 +657,7 @@
 		sizeof(struct audiosrv_Logon),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_Logon,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_Logon,
-		(ndr_print_function_t) ndr_print_audiosrv_Logon,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -666,7 +666,7 @@
 		sizeof(struct audiosrv_Logoff),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_Logoff,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_Logoff,
-		(ndr_print_function_t) ndr_print_audiosrv_Logoff,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -675,7 +675,7 @@
 		sizeof(struct audiosrv_RegisterSessionNotificationEvent),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_RegisterSessionNotificationEvent,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_RegisterSessionNotificationEvent,
-		(ndr_print_function_t) ndr_print_audiosrv_RegisterSessionNotificationEvent,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -684,7 +684,7 @@
 		sizeof(struct audiosrv_UnregisterSessionNotificationEvent),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_UnregisterSessionNotificationEvent,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_UnregisterSessionNotificationEvent,
-		(ndr_print_function_t) ndr_print_audiosrv_UnregisterSessionNotificationEvent,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -693,7 +693,7 @@
 		sizeof(struct audiosrv_SessionConnectState),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_SessionConnectState,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_SessionConnectState,
-		(ndr_print_function_t) ndr_print_audiosrv_SessionConnectState,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -702,7 +702,7 @@
 		sizeof(struct audiosrv_DriverOpenDrvRegKey),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_DriverOpenDrvRegKey,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_DriverOpenDrvRegKey,
-		(ndr_print_function_t) ndr_print_audiosrv_DriverOpenDrvRegKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -711,7 +711,7 @@
 		sizeof(struct audiosrv_AdvisePreferredDeviceChange),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_AdvisePreferredDeviceChange,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_AdvisePreferredDeviceChange,
-		(ndr_print_function_t) ndr_print_audiosrv_AdvisePreferredDeviceChange,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -720,7 +720,7 @@
 		sizeof(struct audiosrv_GetPnpInfo),
 		(ndr_push_flags_fn_t) ndr_push_audiosrv_GetPnpInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_audiosrv_GetPnpInfo,
-		(ndr_print_function_t) ndr_print_audiosrv_GetPnpInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_backupkey.c samba3/source3/librpc/gen_ndr/ndr_backupkey.c
--- samba3/source3/librpc/gen_ndr/ndr_backupkey.c	2015-02-22 15:16:26.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_backupkey.c	2024-08-04 17:52:53.000000000 +0200
@@ -740,7 +740,7 @@
 		sizeof(struct bkrp_BackupKey),
 		(ndr_push_flags_fn_t) ndr_push_bkrp_BackupKey,
 		(ndr_pull_flags_fn_t) ndr_pull_bkrp_BackupKey,
-		(ndr_print_function_t) ndr_print_bkrp_BackupKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_browser.c samba3/source3/librpc/gen_ndr/ndr_browser.c
--- samba3/source3/librpc/gen_ndr/ndr_browser.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_browser.c	2024-08-04 17:52:53.000000000 +0200
@@ -928,7 +928,7 @@
 		sizeof(struct BrowserrServerEnum),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrServerEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrServerEnum,
-		(ndr_print_function_t) ndr_print_BrowserrServerEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -937,7 +937,7 @@
 		sizeof(struct BrowserrDebugCall),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrDebugCall,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrDebugCall,
-		(ndr_print_function_t) ndr_print_BrowserrDebugCall,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -946,7 +946,7 @@
 		sizeof(struct BrowserrQueryOtherDomains),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrQueryOtherDomains,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrQueryOtherDomains,
-		(ndr_print_function_t) ndr_print_BrowserrQueryOtherDomains,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -955,7 +955,7 @@
 		sizeof(struct BrowserrResetNetlogonState),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrResetNetlogonState,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrResetNetlogonState,
-		(ndr_print_function_t) ndr_print_BrowserrResetNetlogonState,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -964,7 +964,7 @@
 		sizeof(struct BrowserrDebugTrace),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrDebugTrace,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrDebugTrace,
-		(ndr_print_function_t) ndr_print_BrowserrDebugTrace,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -973,7 +973,7 @@
 		sizeof(struct BrowserrQueryStatistics),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrQueryStatistics,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrQueryStatistics,
-		(ndr_print_function_t) ndr_print_BrowserrQueryStatistics,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -982,7 +982,7 @@
 		sizeof(struct BrowserResetStatistics),
 		(ndr_push_flags_fn_t) ndr_push_BrowserResetStatistics,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserResetStatistics,
-		(ndr_print_function_t) ndr_print_BrowserResetStatistics,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -991,7 +991,7 @@
 		sizeof(struct NetrBrowserStatisticsClear),
 		(ndr_push_flags_fn_t) ndr_push_NetrBrowserStatisticsClear,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrBrowserStatisticsClear,
-		(ndr_print_function_t) ndr_print_NetrBrowserStatisticsClear,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1000,7 +1000,7 @@
 		sizeof(struct NetrBrowserStatisticsGet),
 		(ndr_push_flags_fn_t) ndr_push_NetrBrowserStatisticsGet,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrBrowserStatisticsGet,
-		(ndr_print_function_t) ndr_print_NetrBrowserStatisticsGet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1009,7 +1009,7 @@
 		sizeof(struct BrowserrSetNetlogonState),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrSetNetlogonState,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrSetNetlogonState,
-		(ndr_print_function_t) ndr_print_BrowserrSetNetlogonState,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1018,7 +1018,7 @@
 		sizeof(struct BrowserrQueryEmulatedDomains),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrQueryEmulatedDomains,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrQueryEmulatedDomains,
-		(ndr_print_function_t) ndr_print_BrowserrQueryEmulatedDomains,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1027,7 +1027,7 @@
 		sizeof(struct BrowserrServerEnumEx),
 		(ndr_push_flags_fn_t) ndr_push_BrowserrServerEnumEx,
 		(ndr_pull_flags_fn_t) ndr_pull_BrowserrServerEnumEx,
-		(ndr_print_function_t) ndr_print_BrowserrServerEnumEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dbgidl.c samba3/source3/librpc/gen_ndr/ndr_dbgidl.c
--- samba3/source3/librpc/gen_ndr/ndr_dbgidl.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dbgidl.c	2024-08-04 17:52:53.000000000 +0200
@@ -48,7 +48,7 @@
 		sizeof(struct dummy_dbgidl),
 		(ndr_push_flags_fn_t) ndr_push_dummy_dbgidl,
 		(ndr_pull_flags_fn_t) ndr_pull_dummy_dbgidl,
-		(ndr_print_function_t) ndr_print_dummy_dbgidl,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dcerpc.c samba3/source3/librpc/gen_ndr/ndr_dcerpc.c
--- samba3/source3/librpc/gen_ndr/ndr_dcerpc.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dcerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -3025,6 +3025,34 @@
 	}
 }
 
+static enum ndr_err_code ndr_push_dcerpc_pfc_flags(struct ndr_push *ndr, int ndr_flags, uint8_t r)
+{
+	NDR_CHECK(ndr_push_uint8(ndr, NDR_SCALARS, r));
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_pfc_flags(struct ndr_pull *ndr, int ndr_flags, uint8_t *r)
+{
+	uint8_t v;
+	NDR_CHECK(ndr_pull_uint8(ndr, NDR_SCALARS, &v));
+	*r = v;
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_pfc_flags(struct ndr_print *ndr, const char *name, uint8_t r)
+{
+	ndr_print_uint8(ndr, name, r);
+	ndr->depth++;
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_FIRST", DCERPC_PFC_FLAG_FIRST, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_LAST", DCERPC_PFC_FLAG_LAST, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING", DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_CONC_MPX", DCERPC_PFC_FLAG_CONC_MPX, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_DID_NOT_EXECUTE", DCERPC_PFC_FLAG_DID_NOT_EXECUTE, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_MAYBE", DCERPC_PFC_FLAG_MAYBE, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint8_t), "DCERPC_PFC_FLAG_OBJECT_UUID", DCERPC_PFC_FLAG_OBJECT_UUID, r);
+	ndr->depth--;
+}
+
 _PUBLIC_ enum ndr_err_code ndr_push_ncacn_packet(struct ndr_push *ndr, int ndr_flags, const struct ncacn_packet *r)
 {
 	if (ndr_flags & NDR_SCALARS) {
@@ -3032,7 +3060,7 @@
 		NDR_CHECK(ndr_push_uint8(ndr, NDR_SCALARS, r->rpc_vers));
 		NDR_CHECK(ndr_push_uint8(ndr, NDR_SCALARS, r->rpc_vers_minor));
 		NDR_CHECK(ndr_push_dcerpc_pkt_type(ndr, NDR_SCALARS, r->ptype));
-		NDR_CHECK(ndr_push_uint8(ndr, NDR_SCALARS, r->pfc_flags));
+		NDR_CHECK(ndr_push_dcerpc_pfc_flags(ndr, NDR_SCALARS, r->pfc_flags));
 		NDR_CHECK(ndr_push_array_uint8(ndr, NDR_SCALARS, r->drep, 4));
 		NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, r->frag_length));
 		NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, r->auth_length));
@@ -3055,7 +3083,7 @@
 		NDR_CHECK(ndr_pull_uint8(ndr, NDR_SCALARS, &r->rpc_vers));
 		NDR_CHECK(ndr_pull_uint8(ndr, NDR_SCALARS, &r->rpc_vers_minor));
 		NDR_CHECK(ndr_pull_dcerpc_pkt_type(ndr, NDR_SCALARS, &r->ptype));
-		NDR_CHECK(ndr_pull_uint8(ndr, NDR_SCALARS, &r->pfc_flags));
+		NDR_CHECK(ndr_pull_dcerpc_pfc_flags(ndr, NDR_SCALARS, &r->pfc_flags));
 		size_drep_0 = 4;
 		NDR_CHECK(ndr_pull_array_uint8(ndr, NDR_SCALARS, r->drep, size_drep_0));
 		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &r->frag_length));
@@ -3079,7 +3107,7 @@
 	ndr_print_uint8(ndr, "rpc_vers", r->rpc_vers);
 	ndr_print_uint8(ndr, "rpc_vers_minor", r->rpc_vers_minor);
 	ndr_print_dcerpc_pkt_type(ndr, "ptype", r->ptype);
-	ndr_print_uint8(ndr, "pfc_flags", r->pfc_flags);
+	ndr_print_dcerpc_pfc_flags(ndr, "pfc_flags", r->pfc_flags);
 	ndr_print_array_uint8(ndr, "drep", r->drep, 4);
 	ndr_print_uint16(ndr, "frag_length", r->frag_length);
 	ndr_print_uint16(ndr, "auth_length", r->auth_length);
@@ -3186,3 +3214,417 @@
 	ndr->depth--;
 }
 
+static enum ndr_err_code ndr_push_dcerpc_sec_vt_command(struct ndr_push *ndr, int ndr_flags, uint16_t r)
+{
+	NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, r));
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt_command(struct ndr_pull *ndr, int ndr_flags, uint16_t *r)
+{
+	uint16_t v;
+	NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &v));
+	*r = v;
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_command(struct ndr_print *ndr, const char *name, uint16_t r)
+{
+	ndr_print_uint16(ndr, name, r);
+	ndr->depth++;
+	ndr_print_bitmap_flag(ndr, sizeof(uint16_t), "DCERPC_SEC_VT_COMMAND_ENUM", DCERPC_SEC_VT_COMMAND_ENUM, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint16_t), "DCERPC_SEC_VT_COMMAND_END", DCERPC_SEC_VT_COMMAND_END, r);
+	ndr_print_bitmap_flag(ndr, sizeof(uint16_t), "DCERPC_SEC_VT_MUST_PROCESS", DCERPC_SEC_VT_MUST_PROCESS, r);
+	ndr->depth--;
+}
+
+static enum ndr_err_code ndr_push_dcerpc_sec_vt_bitmask1(struct ndr_push *ndr, int ndr_flags, uint32_t r)
+{
+	NDR_CHECK(ndr_push_uint32(ndr, NDR_SCALARS, r));
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt_bitmask1(struct ndr_pull *ndr, int ndr_flags, uint32_t *r)
+{
+	uint32_t v;
+	NDR_CHECK(ndr_pull_uint32(ndr, NDR_SCALARS, &v));
+	*r = v;
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_bitmask1(struct ndr_print *ndr, const char *name, uint32_t r)
+{
+	ndr_print_uint32(ndr, name, r);
+	ndr->depth++;
+	ndr_print_bitmap_flag(ndr, sizeof(uint32_t), "DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING", DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING, r);
+	ndr->depth--;
+}
+
+static enum ndr_err_code ndr_push_dcerpc_sec_vt_pcontext(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_vt_pcontext *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_push_align(ndr, 4));
+		NDR_CHECK(ndr_push_ndr_syntax_id(ndr, NDR_SCALARS, &r->abstract_syntax));
+		NDR_CHECK(ndr_push_ndr_syntax_id(ndr, NDR_SCALARS, &r->transfer_syntax));
+		NDR_CHECK(ndr_push_trailer_align(ndr, 4));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt_pcontext(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_vt_pcontext *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_pull_align(ndr, 4));
+		NDR_CHECK(ndr_pull_ndr_syntax_id(ndr, NDR_SCALARS, &r->abstract_syntax));
+		NDR_CHECK(ndr_pull_ndr_syntax_id(ndr, NDR_SCALARS, &r->transfer_syntax));
+		NDR_CHECK(ndr_pull_trailer_align(ndr, 4));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_pcontext(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_pcontext *r)
+{
+	ndr_print_struct(ndr, name, "dcerpc_sec_vt_pcontext");
+	if (r == NULL) { ndr_print_null(ndr); return; }
+	ndr->depth++;
+	ndr_print_ndr_syntax_id(ndr, "abstract_syntax", &r->abstract_syntax);
+	ndr_print_ndr_syntax_id(ndr, "transfer_syntax", &r->transfer_syntax);
+	ndr->depth--;
+}
+
+static enum ndr_err_code ndr_push_dcerpc_sec_vt_header2(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_vt_header2 *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_push_align(ndr, 4));
+		NDR_CHECK(ndr_push_dcerpc_pkt_type(ndr, NDR_SCALARS, r->ptype));
+		NDR_CHECK(ndr_push_uint8(ndr, NDR_SCALARS, 0));
+		NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, 0));
+		NDR_CHECK(ndr_push_array_uint8(ndr, NDR_SCALARS, r->drep, 4));
+		NDR_CHECK(ndr_push_uint32(ndr, NDR_SCALARS, r->call_id));
+		NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, r->context_id));
+		NDR_CHECK(ndr_push_uint16(ndr, NDR_SCALARS, r->opnum));
+		NDR_CHECK(ndr_push_trailer_align(ndr, 4));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt_header2(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_vt_header2 *r)
+{
+	uint32_t size_drep_0 = 0;
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_pull_align(ndr, 4));
+		NDR_CHECK(ndr_pull_dcerpc_pkt_type(ndr, NDR_SCALARS, &r->ptype));
+		NDR_CHECK(ndr_pull_uint8(ndr, NDR_SCALARS, &r->reserved1));
+		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &r->reserved2));
+		size_drep_0 = 4;
+		NDR_CHECK(ndr_pull_array_uint8(ndr, NDR_SCALARS, r->drep, size_drep_0));
+		NDR_CHECK(ndr_pull_uint32(ndr, NDR_SCALARS, &r->call_id));
+		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &r->context_id));
+		NDR_CHECK(ndr_pull_uint16(ndr, NDR_SCALARS, &r->opnum));
+		NDR_CHECK(ndr_pull_trailer_align(ndr, 4));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_header2(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_header2 *r)
+{
+	ndr_print_struct(ndr, name, "dcerpc_sec_vt_header2");
+	if (r == NULL) { ndr_print_null(ndr); return; }
+	ndr->depth++;
+	ndr_print_dcerpc_pkt_type(ndr, "ptype", r->ptype);
+	ndr_print_uint8(ndr, "reserved1", (ndr->flags & LIBNDR_PRINT_SET_VALUES)?0:r->reserved1);
+	ndr_print_uint16(ndr, "reserved2", (ndr->flags & LIBNDR_PRINT_SET_VALUES)?0:r->reserved2);
+	ndr_print_array_uint8(ndr, "drep", r->drep, 4);
+	ndr_print_uint32(ndr, "call_id", r->call_id);
+	ndr_print_uint16(ndr, "context_id", r->context_id);
+	ndr_print_uint16(ndr, "opnum", r->opnum);
+	ndr->depth--;
+}
+
+static enum ndr_err_code ndr_push_dcerpc_sec_vt_union(struct ndr_push *ndr, int ndr_flags, const union dcerpc_sec_vt_union *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		uint32_t level = ndr_push_get_switch_value(ndr, r);
+		NDR_CHECK(ndr_push_union_align(ndr, 4));
+		switch (level) {
+			case DCERPC_SEC_VT_COMMAND_BITMASK1: {
+				NDR_CHECK(ndr_push_dcerpc_sec_vt_bitmask1(ndr, NDR_SCALARS, r->bitmask1));
+			break; }
+
+			case DCERPC_SEC_VT_COMMAND_PCONTEXT: {
+				NDR_CHECK(ndr_push_dcerpc_sec_vt_pcontext(ndr, NDR_SCALARS, &r->pcontext));
+			break; }
+
+			case DCERPC_SEC_VT_COMMAND_HEADER2: {
+				NDR_CHECK(ndr_push_dcerpc_sec_vt_header2(ndr, NDR_SCALARS, &r->header2));
+			break; }
+
+			default: {
+				{
+					uint32_t _flags_save_DATA_BLOB = ndr->flags;
+					ndr_set_flags(&ndr->flags, LIBNDR_FLAG_REMAINING);
+					NDR_CHECK(ndr_push_DATA_BLOB(ndr, NDR_SCALARS, r->_unknown));
+					ndr->flags = _flags_save_DATA_BLOB;
+				}
+			break; }
+
+		}
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+		uint32_t level = ndr_push_get_switch_value(ndr, r);
+		switch (level) {
+			case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			break;
+
+			case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			break;
+
+			case DCERPC_SEC_VT_COMMAND_HEADER2:
+			break;
+
+			default:
+			break;
+
+		}
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt_union(struct ndr_pull *ndr, int ndr_flags, union dcerpc_sec_vt_union *r)
+{
+	uint32_t level;
+	level = ndr_pull_get_switch_value(ndr, r);
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_pull_union_align(ndr, 4));
+		switch (level) {
+			case DCERPC_SEC_VT_COMMAND_BITMASK1: {
+				NDR_CHECK(ndr_pull_dcerpc_sec_vt_bitmask1(ndr, NDR_SCALARS, &r->bitmask1));
+			break; }
+
+			case DCERPC_SEC_VT_COMMAND_PCONTEXT: {
+				NDR_CHECK(ndr_pull_dcerpc_sec_vt_pcontext(ndr, NDR_SCALARS, &r->pcontext));
+			break; }
+
+			case DCERPC_SEC_VT_COMMAND_HEADER2: {
+				NDR_CHECK(ndr_pull_dcerpc_sec_vt_header2(ndr, NDR_SCALARS, &r->header2));
+			break; }
+
+			default: {
+				{
+					uint32_t _flags_save_DATA_BLOB = ndr->flags;
+					ndr_set_flags(&ndr->flags, LIBNDR_FLAG_REMAINING);
+					NDR_CHECK(ndr_pull_DATA_BLOB(ndr, NDR_SCALARS, &r->_unknown));
+					ndr->flags = _flags_save_DATA_BLOB;
+				}
+			break; }
+
+		}
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+		switch (level) {
+			case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			break;
+
+			case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			break;
+
+			case DCERPC_SEC_VT_COMMAND_HEADER2:
+			break;
+
+			default:
+			break;
+
+		}
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_union(struct ndr_print *ndr, const char *name, const union dcerpc_sec_vt_union *r)
+{
+	uint32_t level;
+	level = ndr_print_get_switch_value(ndr, r);
+	ndr_print_union(ndr, name, level, "dcerpc_sec_vt_union");
+	switch (level) {
+		case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			ndr_print_dcerpc_sec_vt_bitmask1(ndr, "bitmask1", r->bitmask1);
+		break;
+
+		case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			ndr_print_dcerpc_sec_vt_pcontext(ndr, "pcontext", &r->pcontext);
+		break;
+
+		case DCERPC_SEC_VT_COMMAND_HEADER2:
+			ndr_print_dcerpc_sec_vt_header2(ndr, "header2", &r->header2);
+		break;
+
+		default:
+			ndr_print_DATA_BLOB(ndr, "_unknown", r->_unknown);
+		break;
+
+	}
+}
+
+static enum ndr_err_code ndr_push_dcerpc_sec_vt(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_vt *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_push_align(ndr, 2));
+		NDR_CHECK(ndr_push_dcerpc_sec_vt_command(ndr, NDR_SCALARS, r->command));
+		{
+			uint32_t _flags_save_dcerpc_sec_vt_union = ndr->flags;
+			ndr_set_flags(&ndr->flags, LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES);
+			{
+				struct ndr_push *_ndr_u;
+				NDR_CHECK(ndr_push_subcontext_start(ndr, &_ndr_u, 2, -1));
+				NDR_CHECK(ndr_push_set_switch_value(_ndr_u, &r->u, r->command & DCERPC_SEC_VT_COMMAND_ENUM));
+				NDR_CHECK(ndr_push_dcerpc_sec_vt_union(_ndr_u, NDR_SCALARS, &r->u));
+				NDR_CHECK(ndr_push_subcontext_end(ndr, _ndr_u, 2, -1));
+			}
+			ndr->flags = _flags_save_dcerpc_sec_vt_union;
+		}
+		NDR_CHECK(ndr_push_trailer_align(ndr, 2));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+static enum ndr_err_code ndr_pull_dcerpc_sec_vt(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_vt *r)
+{
+	if (ndr_flags & NDR_SCALARS) {
+		NDR_CHECK(ndr_pull_align(ndr, 2));
+		NDR_CHECK(ndr_pull_dcerpc_sec_vt_command(ndr, NDR_SCALARS, &r->command));
+		{
+			uint32_t _flags_save_dcerpc_sec_vt_union = ndr->flags;
+			ndr_set_flags(&ndr->flags, LIBNDR_FLAG_SUBCONTEXT_NO_UNREAD_BYTES);
+			{
+				struct ndr_pull *_ndr_u;
+				NDR_CHECK(ndr_pull_subcontext_start(ndr, &_ndr_u, 2, -1));
+				NDR_CHECK(ndr_pull_set_switch_value(_ndr_u, &r->u, r->command & DCERPC_SEC_VT_COMMAND_ENUM));
+				NDR_CHECK(ndr_pull_dcerpc_sec_vt_union(_ndr_u, NDR_SCALARS, &r->u));
+				NDR_CHECK(ndr_pull_subcontext_end(ndr, _ndr_u, 2, -1));
+			}
+			ndr->flags = _flags_save_dcerpc_sec_vt_union;
+		}
+		NDR_CHECK(ndr_pull_trailer_align(ndr, 2));
+	}
+	if (ndr_flags & NDR_BUFFERS) {
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt *r)
+{
+	ndr_print_struct(ndr, name, "dcerpc_sec_vt");
+	if (r == NULL) { ndr_print_null(ndr); return; }
+	ndr->depth++;
+	ndr_print_dcerpc_sec_vt_command(ndr, "command", r->command);
+	ndr_print_set_switch_value(ndr, &r->u, r->command & DCERPC_SEC_VT_COMMAND_ENUM);
+	ndr_print_dcerpc_sec_vt_union(ndr, "u", &r->u);
+	ndr->depth--;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_vt_count(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_count *r)
+{
+	ndr_print_struct(ndr, name, "dcerpc_sec_vt_count");
+	if (r == NULL) { ndr_print_null(ndr); return; }
+	ndr->depth++;
+	ndr_print_uint16(ndr, "count", r->count);
+	ndr->depth--;
+}
+
+_PUBLIC_ enum ndr_err_code ndr_push_dcerpc_sec_verification_trailer(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_verification_trailer *r)
+{
+	uint32_t cntr_commands_0;
+	{
+		uint32_t _flags_save_STRUCT = ndr->flags;
+		ndr_set_flags(&ndr->flags, LIBNDR_PRINT_ARRAY_HEX);
+		if (ndr_flags & NDR_SCALARS) {
+			NDR_CHECK(ndr_push_align(ndr, 4));
+			{
+				uint32_t _flags_save_DATA_BLOB = ndr->flags;
+				ndr_set_flags(&ndr->flags, LIBNDR_FLAG_ALIGN4);
+				NDR_CHECK(ndr_push_DATA_BLOB(ndr, NDR_SCALARS, r->_pad));
+				ndr->flags = _flags_save_DATA_BLOB;
+			}
+			NDR_CHECK(ndr_push_array_uint8(ndr, NDR_SCALARS, DCERPC_SEC_VT_MAGIC, 8));
+			NDR_CHECK(ndr_push_dcerpc_sec_vt_count(ndr, NDR_SCALARS, &r->count));
+			for (cntr_commands_0 = 0; cntr_commands_0 < r->count.count; cntr_commands_0++) {
+				NDR_CHECK(ndr_push_dcerpc_sec_vt(ndr, NDR_SCALARS, &r->commands[cntr_commands_0]));
+			}
+			NDR_CHECK(ndr_push_trailer_align(ndr, 4));
+		}
+		if (ndr_flags & NDR_BUFFERS) {
+		}
+		ndr->flags = _flags_save_STRUCT;
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ enum ndr_err_code ndr_pull_dcerpc_sec_verification_trailer(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_verification_trailer *r)
+{
+	uint32_t size_magic_0 = 0;
+	uint32_t size_commands_0 = 0;
+	uint32_t cntr_commands_0;
+	TALLOC_CTX *_mem_save_commands_0;
+	{
+		uint32_t _flags_save_STRUCT = ndr->flags;
+		ndr_set_flags(&ndr->flags, LIBNDR_PRINT_ARRAY_HEX);
+		if (ndr_flags & NDR_SCALARS) {
+			NDR_CHECK(ndr_pull_align(ndr, 4));
+			{
+				uint32_t _flags_save_DATA_BLOB = ndr->flags;
+				ndr_set_flags(&ndr->flags, LIBNDR_FLAG_ALIGN4);
+				NDR_CHECK(ndr_pull_DATA_BLOB(ndr, NDR_SCALARS, &r->_pad));
+				ndr->flags = _flags_save_DATA_BLOB;
+			}
+			size_magic_0 = 8;
+			NDR_CHECK(ndr_pull_array_uint8(ndr, NDR_SCALARS, r->magic, size_magic_0));
+			NDR_CHECK(ndr_pull_dcerpc_sec_vt_count(ndr, NDR_SCALARS, &r->count));
+			size_commands_0 = r->count.count;
+			NDR_PULL_ALLOC_N(ndr, r->commands, size_commands_0);
+			_mem_save_commands_0 = NDR_PULL_GET_MEM_CTX(ndr);
+			NDR_PULL_SET_MEM_CTX(ndr, r->commands, 0);
+			for (cntr_commands_0 = 0; cntr_commands_0 < size_commands_0; cntr_commands_0++) {
+				NDR_CHECK(ndr_pull_dcerpc_sec_vt(ndr, NDR_SCALARS, &r->commands[cntr_commands_0]));
+			}
+			NDR_PULL_SET_MEM_CTX(ndr, _mem_save_commands_0, 0);
+			NDR_CHECK(ndr_pull_trailer_align(ndr, 4));
+		}
+		if (ndr_flags & NDR_BUFFERS) {
+		}
+		ndr->flags = _flags_save_STRUCT;
+	}
+	return NDR_ERR_SUCCESS;
+}
+
+_PUBLIC_ void ndr_print_dcerpc_sec_verification_trailer(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_verification_trailer *r)
+{
+	uint32_t cntr_commands_0;
+	ndr_print_struct(ndr, name, "dcerpc_sec_verification_trailer");
+	if (r == NULL) { ndr_print_null(ndr); return; }
+	{
+		uint32_t _flags_save_STRUCT = ndr->flags;
+		ndr_set_flags(&ndr->flags, LIBNDR_PRINT_ARRAY_HEX);
+		ndr->depth++;
+		ndr_print_DATA_BLOB(ndr, "_pad", r->_pad);
+		ndr_print_array_uint8(ndr, "magic", (ndr->flags & LIBNDR_PRINT_SET_VALUES)?DCERPC_SEC_VT_MAGIC:r->magic, 8);
+		ndr_print_dcerpc_sec_vt_count(ndr, "count", &r->count);
+		ndr->print(ndr, "%s: ARRAY(%d)", "commands", (int)r->count.count);
+		ndr->depth++;
+		for (cntr_commands_0=0;cntr_commands_0<r->count.count;cntr_commands_0++) {
+			ndr_print_dcerpc_sec_vt(ndr, "commands", &r->commands[cntr_commands_0]);
+		}
+		ndr->depth--;
+		ndr->depth--;
+		ndr->flags = _flags_save_STRUCT;
+	}
+}
+
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dcerpc.h samba3/source3/librpc/gen_ndr/ndr_dcerpc.h
--- samba3/source3/librpc/gen_ndr/ndr_dcerpc.h	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dcerpc.h	2024-08-04 17:52:53.000000000 +0200
@@ -130,10 +130,23 @@
 void ndr_print_dcerpc_rts(struct ndr_print *ndr, const char *name, const struct dcerpc_rts *r);
 void ndr_print_dcerpc_pkt_type(struct ndr_print *ndr, const char *name, enum dcerpc_pkt_type r);
 void ndr_print_dcerpc_payload(struct ndr_print *ndr, const char *name, const union dcerpc_payload *r);
+void ndr_print_dcerpc_pfc_flags(struct ndr_print *ndr, const char *name, uint8_t r);
 enum ndr_err_code ndr_push_ncacn_packet(struct ndr_push *ndr, int ndr_flags, const struct ncacn_packet *r);
 enum ndr_err_code ndr_pull_ncacn_packet(struct ndr_pull *ndr, int ndr_flags, struct ncacn_packet *r);
 void ndr_print_ncacn_packet(struct ndr_print *ndr, const char *name, const struct ncacn_packet *r);
 enum ndr_err_code ndr_push_ncadg_packet(struct ndr_push *ndr, int ndr_flags, const struct ncadg_packet *r);
 enum ndr_err_code ndr_pull_ncadg_packet(struct ndr_pull *ndr, int ndr_flags, struct ncadg_packet *r);
 void ndr_print_ncadg_packet(struct ndr_print *ndr, const char *name, const struct ncadg_packet *r);
+void ndr_print_dcerpc_sec_vt_command(struct ndr_print *ndr, const char *name, uint16_t r);
+void ndr_print_dcerpc_sec_vt_bitmask1(struct ndr_print *ndr, const char *name, uint32_t r);
+void ndr_print_dcerpc_sec_vt_pcontext(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_pcontext *r);
+void ndr_print_dcerpc_sec_vt_header2(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_header2 *r);
+void ndr_print_dcerpc_sec_vt_union(struct ndr_print *ndr, const char *name, const union dcerpc_sec_vt_union *r);
+void ndr_print_dcerpc_sec_vt(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt *r);
+enum ndr_err_code ndr_push_dcerpc_sec_vt_count(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_vt_count *r);
+enum ndr_err_code ndr_pull_dcerpc_sec_vt_count(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_vt_count *r);
+void ndr_print_dcerpc_sec_vt_count(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_vt_count *r);
+enum ndr_err_code ndr_push_dcerpc_sec_verification_trailer(struct ndr_push *ndr, int ndr_flags, const struct dcerpc_sec_verification_trailer *r);
+enum ndr_err_code ndr_pull_dcerpc_sec_verification_trailer(struct ndr_pull *ndr, int ndr_flags, struct dcerpc_sec_verification_trailer *r);
+void ndr_print_dcerpc_sec_verification_trailer(struct ndr_print *ndr, const char *name, const struct dcerpc_sec_verification_trailer *r);
 #endif /* _HEADER_NDR_dcerpc */
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dcom.c samba3/source3/librpc/gen_ndr/ndr_dcom.c
--- samba3/source3/librpc/gen_ndr/ndr_dcom.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dcom.c	2024-08-04 17:52:53.000000000 +0200
@@ -128,7 +128,7 @@
 		sizeof(struct UseProtSeq),
 		(ndr_push_flags_fn_t) ndr_push_UseProtSeq,
 		(ndr_pull_flags_fn_t) ndr_pull_UseProtSeq,
-		(ndr_print_function_t) ndr_print_UseProtSeq,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -137,7 +137,7 @@
 		sizeof(struct GetCustomProtseqInfo),
 		(ndr_push_flags_fn_t) ndr_push_GetCustomProtseqInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_GetCustomProtseqInfo,
-		(ndr_print_function_t) ndr_print_GetCustomProtseqInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -146,7 +146,7 @@
 		sizeof(struct UpdateResolverBindings),
 		(ndr_push_flags_fn_t) ndr_push_UpdateResolverBindings,
 		(ndr_pull_flags_fn_t) ndr_pull_UpdateResolverBindings,
-		(ndr_print_function_t) ndr_print_UpdateResolverBindings,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -450,7 +450,7 @@
 		sizeof(struct QueryInterface),
 		(ndr_push_flags_fn_t) ndr_push_QueryInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_QueryInterface,
-		(ndr_print_function_t) ndr_print_QueryInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -459,7 +459,7 @@
 		sizeof(struct AddRef),
 		(ndr_push_flags_fn_t) ndr_push_AddRef,
 		(ndr_pull_flags_fn_t) ndr_pull_AddRef,
-		(ndr_print_function_t) ndr_print_AddRef,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -468,7 +468,7 @@
 		sizeof(struct Release),
 		(ndr_push_flags_fn_t) ndr_push_Release,
 		(ndr_pull_flags_fn_t) ndr_pull_Release,
-		(ndr_print_function_t) ndr_print_Release,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -849,7 +849,7 @@
 		sizeof(struct CreateInstance),
 		(ndr_push_flags_fn_t) ndr_push_CreateInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_CreateInstance,
-		(ndr_print_function_t) ndr_print_CreateInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -858,7 +858,7 @@
 		sizeof(struct RemoteCreateInstance),
 		(ndr_push_flags_fn_t) ndr_push_RemoteCreateInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_RemoteCreateInstance,
-		(ndr_print_function_t) ndr_print_RemoteCreateInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -867,7 +867,7 @@
 		sizeof(struct LockServer),
 		(ndr_push_flags_fn_t) ndr_push_LockServer,
 		(ndr_pull_flags_fn_t) ndr_pull_LockServer,
-		(ndr_print_function_t) ndr_print_LockServer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -876,7 +876,7 @@
 		sizeof(struct RemoteLockServer),
 		(ndr_push_flags_fn_t) ndr_push_RemoteLockServer,
 		(ndr_pull_flags_fn_t) ndr_pull_RemoteLockServer,
-		(ndr_print_function_t) ndr_print_RemoteLockServer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1434,7 +1434,7 @@
 		sizeof(struct RemQueryInterface),
 		(ndr_push_flags_fn_t) ndr_push_RemQueryInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_RemQueryInterface,
-		(ndr_print_function_t) ndr_print_RemQueryInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1443,7 +1443,7 @@
 		sizeof(struct RemAddRef),
 		(ndr_push_flags_fn_t) ndr_push_RemAddRef,
 		(ndr_pull_flags_fn_t) ndr_pull_RemAddRef,
-		(ndr_print_function_t) ndr_print_RemAddRef,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1452,7 +1452,7 @@
 		sizeof(struct RemRelease),
 		(ndr_push_flags_fn_t) ndr_push_RemRelease,
 		(ndr_pull_flags_fn_t) ndr_pull_RemRelease,
-		(ndr_print_function_t) ndr_print_RemRelease,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1590,7 +1590,7 @@
 		sizeof(struct GetClassObject),
 		(ndr_push_flags_fn_t) ndr_push_GetClassObject,
 		(ndr_pull_flags_fn_t) ndr_pull_GetClassObject,
-		(ndr_print_function_t) ndr_print_GetClassObject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1701,7 +1701,7 @@
 		sizeof(struct ISCMLocalActivator_CreateInstance),
 		(ndr_push_flags_fn_t) ndr_push_ISCMLocalActivator_CreateInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_ISCMLocalActivator_CreateInstance,
-		(ndr_print_function_t) ndr_print_ISCMLocalActivator_CreateInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1788,7 +1788,7 @@
 		sizeof(struct IMachineLocalActivator_foo),
 		(ndr_push_flags_fn_t) ndr_push_IMachineLocalActivator_foo,
 		(ndr_pull_flags_fn_t) ndr_pull_IMachineLocalActivator_foo,
-		(ndr_print_function_t) ndr_print_IMachineLocalActivator_foo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1875,7 +1875,7 @@
 		sizeof(struct ILocalObjectExporter_Foo),
 		(ndr_push_flags_fn_t) ndr_push_ILocalObjectExporter_Foo,
 		(ndr_pull_flags_fn_t) ndr_pull_ILocalObjectExporter_Foo,
-		(ndr_print_function_t) ndr_print_ILocalObjectExporter_Foo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2031,7 +2031,7 @@
 		sizeof(struct ISystemActivatorRemoteCreateInstance),
 		(ndr_push_flags_fn_t) ndr_push_ISystemActivatorRemoteCreateInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_ISystemActivatorRemoteCreateInstance,
-		(ndr_print_function_t) ndr_print_ISystemActivatorRemoteCreateInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2319,7 +2319,7 @@
 		sizeof(struct RemQueryInterface2),
 		(ndr_push_flags_fn_t) ndr_push_RemQueryInterface2,
 		(ndr_pull_flags_fn_t) ndr_pull_RemQueryInterface2,
-		(ndr_print_function_t) ndr_print_RemQueryInterface2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3040,7 +3040,7 @@
 		sizeof(struct GetTypeInfoCount),
 		(ndr_push_flags_fn_t) ndr_push_GetTypeInfoCount,
 		(ndr_pull_flags_fn_t) ndr_pull_GetTypeInfoCount,
-		(ndr_print_function_t) ndr_print_GetTypeInfoCount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3049,7 +3049,7 @@
 		sizeof(struct GetTypeInfo),
 		(ndr_push_flags_fn_t) ndr_push_GetTypeInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_GetTypeInfo,
-		(ndr_print_function_t) ndr_print_GetTypeInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3058,7 +3058,7 @@
 		sizeof(struct GetIDsOfNames),
 		(ndr_push_flags_fn_t) ndr_push_GetIDsOfNames,
 		(ndr_pull_flags_fn_t) ndr_pull_GetIDsOfNames,
-		(ndr_print_function_t) ndr_print_GetIDsOfNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3067,7 +3067,7 @@
 		sizeof(struct Invoke),
 		(ndr_push_flags_fn_t) ndr_push_Invoke,
 		(ndr_pull_flags_fn_t) ndr_pull_Invoke,
-		(ndr_print_function_t) ndr_print_Invoke,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3243,7 +3243,7 @@
 		sizeof(struct MarshalInterface),
 		(ndr_push_flags_fn_t) ndr_push_MarshalInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_MarshalInterface,
-		(ndr_print_function_t) ndr_print_MarshalInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3252,7 +3252,7 @@
 		sizeof(struct UnMarshalInterface),
 		(ndr_push_flags_fn_t) ndr_push_UnMarshalInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_UnMarshalInterface,
-		(ndr_print_function_t) ndr_print_UnMarshalInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3385,7 +3385,7 @@
 		sizeof(struct MakeCoffee),
 		(ndr_push_flags_fn_t) ndr_push_MakeCoffee,
 		(ndr_pull_flags_fn_t) ndr_pull_MakeCoffee,
-		(ndr_print_function_t) ndr_print_MakeCoffee,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3681,7 +3681,7 @@
 		sizeof(struct Read),
 		(ndr_push_flags_fn_t) ndr_push_Read,
 		(ndr_pull_flags_fn_t) ndr_pull_Read,
-		(ndr_print_function_t) ndr_print_Read,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3690,7 +3690,7 @@
 		sizeof(struct Write),
 		(ndr_push_flags_fn_t) ndr_push_Write,
 		(ndr_pull_flags_fn_t) ndr_pull_Write,
-		(ndr_print_function_t) ndr_print_Write,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dfsblobs.c samba3/source3/librpc/gen_ndr/ndr_dfsblobs.c
--- samba3/source3/librpc/gen_ndr/ndr_dfsblobs.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dfsblobs.c	2024-08-04 17:52:53.000000000 +0200
@@ -1398,7 +1398,7 @@
 		sizeof(struct dfs_GetDFSReferral),
 		(ndr_push_flags_fn_t) ndr_push_dfs_GetDFSReferral,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_GetDFSReferral,
-		(ndr_print_function_t) ndr_print_dfs_GetDFSReferral,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dfs.c samba3/source3/librpc/gen_ndr/ndr_dfs.c
--- samba3/source3/librpc/gen_ndr/ndr_dfs.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dfs.c	2024-08-04 17:52:53.000000000 +0200
@@ -5910,7 +5910,7 @@
 		sizeof(struct dfs_GetManagerVersion),
 		(ndr_push_flags_fn_t) ndr_push_dfs_GetManagerVersion,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_GetManagerVersion,
-		(ndr_print_function_t) ndr_print_dfs_GetManagerVersion,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5919,7 +5919,7 @@
 		sizeof(struct dfs_Add),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Add,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Add,
-		(ndr_print_function_t) ndr_print_dfs_Add,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5928,7 +5928,7 @@
 		sizeof(struct dfs_Remove),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Remove,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Remove,
-		(ndr_print_function_t) ndr_print_dfs_Remove,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5937,7 +5937,7 @@
 		sizeof(struct dfs_SetInfo),
 		(ndr_push_flags_fn_t) ndr_push_dfs_SetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_SetInfo,
-		(ndr_print_function_t) ndr_print_dfs_SetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5946,7 +5946,7 @@
 		sizeof(struct dfs_GetInfo),
 		(ndr_push_flags_fn_t) ndr_push_dfs_GetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_GetInfo,
-		(ndr_print_function_t) ndr_print_dfs_GetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5955,7 +5955,7 @@
 		sizeof(struct dfs_Enum),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Enum,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Enum,
-		(ndr_print_function_t) ndr_print_dfs_Enum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5964,7 +5964,7 @@
 		sizeof(struct dfs_Rename),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Rename,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Rename,
-		(ndr_print_function_t) ndr_print_dfs_Rename,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5973,7 +5973,7 @@
 		sizeof(struct dfs_Move),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Move,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Move,
-		(ndr_print_function_t) ndr_print_dfs_Move,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5982,7 +5982,7 @@
 		sizeof(struct dfs_ManagerGetConfigInfo),
 		(ndr_push_flags_fn_t) ndr_push_dfs_ManagerGetConfigInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_ManagerGetConfigInfo,
-		(ndr_print_function_t) ndr_print_dfs_ManagerGetConfigInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5991,7 +5991,7 @@
 		sizeof(struct dfs_ManagerSendSiteInfo),
 		(ndr_push_flags_fn_t) ndr_push_dfs_ManagerSendSiteInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_ManagerSendSiteInfo,
-		(ndr_print_function_t) ndr_print_dfs_ManagerSendSiteInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6000,7 +6000,7 @@
 		sizeof(struct dfs_AddFtRoot),
 		(ndr_push_flags_fn_t) ndr_push_dfs_AddFtRoot,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_AddFtRoot,
-		(ndr_print_function_t) ndr_print_dfs_AddFtRoot,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6009,7 +6009,7 @@
 		sizeof(struct dfs_RemoveFtRoot),
 		(ndr_push_flags_fn_t) ndr_push_dfs_RemoveFtRoot,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_RemoveFtRoot,
-		(ndr_print_function_t) ndr_print_dfs_RemoveFtRoot,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6018,7 +6018,7 @@
 		sizeof(struct dfs_AddStdRoot),
 		(ndr_push_flags_fn_t) ndr_push_dfs_AddStdRoot,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_AddStdRoot,
-		(ndr_print_function_t) ndr_print_dfs_AddStdRoot,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6027,7 +6027,7 @@
 		sizeof(struct dfs_RemoveStdRoot),
 		(ndr_push_flags_fn_t) ndr_push_dfs_RemoveStdRoot,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_RemoveStdRoot,
-		(ndr_print_function_t) ndr_print_dfs_RemoveStdRoot,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6036,7 +6036,7 @@
 		sizeof(struct dfs_ManagerInitialize),
 		(ndr_push_flags_fn_t) ndr_push_dfs_ManagerInitialize,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_ManagerInitialize,
-		(ndr_print_function_t) ndr_print_dfs_ManagerInitialize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6045,7 +6045,7 @@
 		sizeof(struct dfs_AddStdRootForced),
 		(ndr_push_flags_fn_t) ndr_push_dfs_AddStdRootForced,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_AddStdRootForced,
-		(ndr_print_function_t) ndr_print_dfs_AddStdRootForced,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6054,7 +6054,7 @@
 		sizeof(struct dfs_GetDcAddress),
 		(ndr_push_flags_fn_t) ndr_push_dfs_GetDcAddress,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_GetDcAddress,
-		(ndr_print_function_t) ndr_print_dfs_GetDcAddress,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6063,7 +6063,7 @@
 		sizeof(struct dfs_SetDcAddress),
 		(ndr_push_flags_fn_t) ndr_push_dfs_SetDcAddress,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_SetDcAddress,
-		(ndr_print_function_t) ndr_print_dfs_SetDcAddress,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6072,7 +6072,7 @@
 		sizeof(struct dfs_FlushFtTable),
 		(ndr_push_flags_fn_t) ndr_push_dfs_FlushFtTable,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_FlushFtTable,
-		(ndr_print_function_t) ndr_print_dfs_FlushFtTable,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6081,7 +6081,7 @@
 		sizeof(struct dfs_Add2),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Add2,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Add2,
-		(ndr_print_function_t) ndr_print_dfs_Add2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6090,7 +6090,7 @@
 		sizeof(struct dfs_Remove2),
 		(ndr_push_flags_fn_t) ndr_push_dfs_Remove2,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_Remove2,
-		(ndr_print_function_t) ndr_print_dfs_Remove2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6099,7 +6099,7 @@
 		sizeof(struct dfs_EnumEx),
 		(ndr_push_flags_fn_t) ndr_push_dfs_EnumEx,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_EnumEx,
-		(ndr_print_function_t) ndr_print_dfs_EnumEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6108,7 +6108,7 @@
 		sizeof(struct dfs_SetInfo2),
 		(ndr_push_flags_fn_t) ndr_push_dfs_SetInfo2,
 		(ndr_pull_flags_fn_t) ndr_pull_dfs_SetInfo2,
-		(ndr_print_function_t) ndr_print_dfs_SetInfo2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dns.c samba3/source3/librpc/gen_ndr/ndr_dns.c
--- samba3/source3/librpc/gen_ndr/ndr_dns.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dns.c	2024-08-04 17:52:53.000000000 +0200
@@ -860,7 +860,7 @@
 		sizeof(struct decode_dns_name_packet),
 		(ndr_push_flags_fn_t) ndr_push_decode_dns_name_packet,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_dns_name_packet,
-		(ndr_print_function_t) ndr_print_decode_dns_name_packet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dnsp.c samba3/source3/librpc/gen_ndr/ndr_dnsp.c
--- samba3/source3/librpc/gen_ndr/ndr_dnsp.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dnsp.c	2024-08-04 17:52:53.000000000 +0200
@@ -700,7 +700,7 @@
 		sizeof(struct decode_DnssrvRpcRecord),
 		(ndr_push_flags_fn_t) ndr_push_decode_DnssrvRpcRecord,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_DnssrvRpcRecord,
-		(ndr_print_function_t) ndr_print_decode_DnssrvRpcRecord,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dnsserver.c samba3/source3/librpc/gen_ndr/ndr_dnsserver.c
--- samba3/source3/librpc/gen_ndr/ndr_dnsserver.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dnsserver.c	2024-08-04 17:52:53.000000000 +0200
@@ -48,7 +48,7 @@
 		sizeof(struct dnsserver_foo),
 		(ndr_push_flags_fn_t) ndr_push_dnsserver_foo,
 		(ndr_pull_flags_fn_t) ndr_pull_dnsserver_foo,
-		(ndr_print_function_t) ndr_print_dnsserver_foo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_drsblobs.c samba3/source3/librpc/gen_ndr/ndr_drsblobs.c
--- samba3/source3/librpc/gen_ndr/ndr_drsblobs.c	2015-02-22 15:16:30.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_drsblobs.c	2024-08-04 17:52:53.000000000 +0200
@@ -5275,7 +5275,7 @@
 		sizeof(struct decode_replPropertyMetaData),
 		(ndr_push_flags_fn_t) ndr_push_decode_replPropertyMetaData,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_replPropertyMetaData,
-		(ndr_print_function_t) ndr_print_decode_replPropertyMetaData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5284,7 +5284,7 @@
 		sizeof(struct decode_replUpToDateVector),
 		(ndr_push_flags_fn_t) ndr_push_decode_replUpToDateVector,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_replUpToDateVector,
-		(ndr_print_function_t) ndr_print_decode_replUpToDateVector,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5293,7 +5293,7 @@
 		sizeof(struct decode_repsFromTo),
 		(ndr_push_flags_fn_t) ndr_push_decode_repsFromTo,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_repsFromTo,
-		(ndr_print_function_t) ndr_print_decode_repsFromTo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5302,7 +5302,7 @@
 		sizeof(struct decode_partialAttributeSet),
 		(ndr_push_flags_fn_t) ndr_push_decode_partialAttributeSet,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_partialAttributeSet,
-		(ndr_print_function_t) ndr_print_decode_partialAttributeSet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5311,7 +5311,7 @@
 		sizeof(struct decode_prefixMap),
 		(ndr_push_flags_fn_t) ndr_push_decode_prefixMap,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_prefixMap,
-		(ndr_print_function_t) ndr_print_decode_prefixMap,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5320,7 +5320,7 @@
 		sizeof(struct decode_ldapControlDirSync),
 		(ndr_push_flags_fn_t) ndr_push_decode_ldapControlDirSync,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ldapControlDirSync,
-		(ndr_print_function_t) ndr_print_decode_ldapControlDirSync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5329,7 +5329,7 @@
 		sizeof(struct decode_supplementalCredentials),
 		(ndr_push_flags_fn_t) ndr_push_decode_supplementalCredentials,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_supplementalCredentials,
-		(ndr_print_function_t) ndr_print_decode_supplementalCredentials,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5338,7 +5338,7 @@
 		sizeof(struct decode_Packages),
 		(ndr_push_flags_fn_t) ndr_push_decode_Packages,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_Packages,
-		(ndr_print_function_t) ndr_print_decode_Packages,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5347,7 +5347,7 @@
 		sizeof(struct decode_PrimaryKerberos),
 		(ndr_push_flags_fn_t) ndr_push_decode_PrimaryKerberos,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_PrimaryKerberos,
-		(ndr_print_function_t) ndr_print_decode_PrimaryKerberos,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5356,7 +5356,7 @@
 		sizeof(struct decode_PrimaryCLEARTEXT),
 		(ndr_push_flags_fn_t) ndr_push_decode_PrimaryCLEARTEXT,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_PrimaryCLEARTEXT,
-		(ndr_print_function_t) ndr_print_decode_PrimaryCLEARTEXT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5365,7 +5365,7 @@
 		sizeof(struct decode_PrimaryWDigest),
 		(ndr_push_flags_fn_t) ndr_push_decode_PrimaryWDigest,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_PrimaryWDigest,
-		(ndr_print_function_t) ndr_print_decode_PrimaryWDigest,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5374,7 +5374,7 @@
 		sizeof(struct decode_trustAuthInOut),
 		(ndr_push_flags_fn_t) ndr_push_decode_trustAuthInOut,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_trustAuthInOut,
-		(ndr_print_function_t) ndr_print_decode_trustAuthInOut,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5383,7 +5383,7 @@
 		sizeof(struct decode_trustDomainPasswords),
 		(ndr_push_flags_fn_t) ndr_push_decode_trustDomainPasswords,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_trustDomainPasswords,
-		(ndr_print_function_t) ndr_print_decode_trustDomainPasswords,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5392,7 +5392,7 @@
 		sizeof(struct decode_ExtendedErrorInfo),
 		(ndr_push_flags_fn_t) ndr_push_decode_ExtendedErrorInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ExtendedErrorInfo,
-		(ndr_print_function_t) ndr_print_decode_ExtendedErrorInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5401,7 +5401,7 @@
 		sizeof(struct decode_ForestTrustInfo),
 		(ndr_push_flags_fn_t) ndr_push_decode_ForestTrustInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ForestTrustInfo,
-		(ndr_print_function_t) ndr_print_decode_ForestTrustInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_drsuapi.c samba3/source3/librpc/gen_ndr/ndr_drsuapi.c
--- samba3/source3/librpc/gen_ndr/ndr_drsuapi.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_drsuapi.c	2024-08-04 17:52:53.000000000 +0200
@@ -16500,7 +16500,7 @@
 		sizeof(struct drsuapi_DsBind),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsBind,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsBind,
-		(ndr_print_function_t) ndr_print_drsuapi_DsBind,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16509,7 +16509,7 @@
 		sizeof(struct drsuapi_DsUnbind),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsUnbind,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsUnbind,
-		(ndr_print_function_t) ndr_print_drsuapi_DsUnbind,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16518,7 +16518,7 @@
 		sizeof(struct drsuapi_DsReplicaSync),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaSync,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaSync,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaSync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16527,7 +16527,7 @@
 		sizeof(struct drsuapi_DsGetNCChanges),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsGetNCChanges,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsGetNCChanges,
-		(ndr_print_function_t) ndr_print_drsuapi_DsGetNCChanges,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16536,7 +16536,7 @@
 		sizeof(struct drsuapi_DsReplicaUpdateRefs),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaUpdateRefs,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaUpdateRefs,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaUpdateRefs,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16545,7 +16545,7 @@
 		sizeof(struct drsuapi_DsReplicaAdd),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaAdd,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16554,7 +16554,7 @@
 		sizeof(struct drsuapi_DsReplicaDel),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaDel,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaDel,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16563,7 +16563,7 @@
 		sizeof(struct drsuapi_DsReplicaMod),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaMod,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaMod,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaMod,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16572,7 +16572,7 @@
 		sizeof(struct DRSUAPI_VERIFY_NAMES),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_VERIFY_NAMES,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_VERIFY_NAMES,
-		(ndr_print_function_t) ndr_print_DRSUAPI_VERIFY_NAMES,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16581,7 +16581,7 @@
 		sizeof(struct drsuapi_DsGetMemberships),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsGetMemberships,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsGetMemberships,
-		(ndr_print_function_t) ndr_print_drsuapi_DsGetMemberships,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16590,7 +16590,7 @@
 		sizeof(struct DRSUAPI_INTER_DOMAIN_MOVE),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_INTER_DOMAIN_MOVE,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_INTER_DOMAIN_MOVE,
-		(ndr_print_function_t) ndr_print_DRSUAPI_INTER_DOMAIN_MOVE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16599,7 +16599,7 @@
 		sizeof(struct drsuapi_DsGetNT4ChangeLog),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsGetNT4ChangeLog,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsGetNT4ChangeLog,
-		(ndr_print_function_t) ndr_print_drsuapi_DsGetNT4ChangeLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16608,7 +16608,7 @@
 		sizeof(struct drsuapi_DsCrackNames),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsCrackNames,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsCrackNames,
-		(ndr_print_function_t) ndr_print_drsuapi_DsCrackNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16617,7 +16617,7 @@
 		sizeof(struct drsuapi_DsWriteAccountSpn),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsWriteAccountSpn,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsWriteAccountSpn,
-		(ndr_print_function_t) ndr_print_drsuapi_DsWriteAccountSpn,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16626,7 +16626,7 @@
 		sizeof(struct drsuapi_DsRemoveDSServer),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsRemoveDSServer,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsRemoveDSServer,
-		(ndr_print_function_t) ndr_print_drsuapi_DsRemoveDSServer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16635,7 +16635,7 @@
 		sizeof(struct DRSUAPI_REMOVE_DS_DOMAIN),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_REMOVE_DS_DOMAIN,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_REMOVE_DS_DOMAIN,
-		(ndr_print_function_t) ndr_print_DRSUAPI_REMOVE_DS_DOMAIN,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16644,7 +16644,7 @@
 		sizeof(struct drsuapi_DsGetDomainControllerInfo),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsGetDomainControllerInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsGetDomainControllerInfo,
-		(ndr_print_function_t) ndr_print_drsuapi_DsGetDomainControllerInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16653,7 +16653,7 @@
 		sizeof(struct drsuapi_DsAddEntry),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsAddEntry,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsAddEntry,
-		(ndr_print_function_t) ndr_print_drsuapi_DsAddEntry,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16662,7 +16662,7 @@
 		sizeof(struct drsuapi_DsExecuteKCC),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsExecuteKCC,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsExecuteKCC,
-		(ndr_print_function_t) ndr_print_drsuapi_DsExecuteKCC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16671,7 +16671,7 @@
 		sizeof(struct drsuapi_DsReplicaGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsReplicaGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsReplicaGetInfo,
-		(ndr_print_function_t) ndr_print_drsuapi_DsReplicaGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16680,7 +16680,7 @@
 		sizeof(struct DRSUAPI_ADD_SID_HISTORY),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_ADD_SID_HISTORY,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_ADD_SID_HISTORY,
-		(ndr_print_function_t) ndr_print_DRSUAPI_ADD_SID_HISTORY,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16689,7 +16689,7 @@
 		sizeof(struct drsuapi_DsGetMemberships2),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_DsGetMemberships2,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_DsGetMemberships2,
-		(ndr_print_function_t) ndr_print_drsuapi_DsGetMemberships2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16698,7 +16698,7 @@
 		sizeof(struct DRSUAPI_REPLICA_VERIFY_OBJECTS),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_REPLICA_VERIFY_OBJECTS,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_REPLICA_VERIFY_OBJECTS,
-		(ndr_print_function_t) ndr_print_DRSUAPI_REPLICA_VERIFY_OBJECTS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16707,7 +16707,7 @@
 		sizeof(struct DRSUAPI_GET_OBJECT_EXISTENCE),
 		(ndr_push_flags_fn_t) ndr_push_DRSUAPI_GET_OBJECT_EXISTENCE,
 		(ndr_pull_flags_fn_t) ndr_pull_DRSUAPI_GET_OBJECT_EXISTENCE,
-		(ndr_print_function_t) ndr_print_DRSUAPI_GET_OBJECT_EXISTENCE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -16716,7 +16716,7 @@
 		sizeof(struct drsuapi_QuerySitesByCost),
 		(ndr_push_flags_fn_t) ndr_push_drsuapi_QuerySitesByCost,
 		(ndr_pull_flags_fn_t) ndr_pull_drsuapi_QuerySitesByCost,
-		(ndr_print_function_t) ndr_print_drsuapi_QuerySitesByCost,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dsbackup.c samba3/source3/librpc/gen_ndr/ndr_dsbackup.c
--- samba3/source3/librpc/gen_ndr/ndr_dsbackup.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dsbackup.c	2024-08-04 17:52:53.000000000 +0200
@@ -360,7 +360,7 @@
 		sizeof(struct HrRBackupPrepare),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupPrepare,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupPrepare,
-		(ndr_print_function_t) ndr_print_HrRBackupPrepare,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -369,7 +369,7 @@
 		sizeof(struct HrRBackupEnd),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupEnd,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupEnd,
-		(ndr_print_function_t) ndr_print_HrRBackupEnd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -378,7 +378,7 @@
 		sizeof(struct HrRBackupGetAttachmentInformation),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupGetAttachmentInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupGetAttachmentInformation,
-		(ndr_print_function_t) ndr_print_HrRBackupGetAttachmentInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -387,7 +387,7 @@
 		sizeof(struct HrRBackupOpenFile),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupOpenFile,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupOpenFile,
-		(ndr_print_function_t) ndr_print_HrRBackupOpenFile,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -396,7 +396,7 @@
 		sizeof(struct HrRBackupRead),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupRead,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupRead,
-		(ndr_print_function_t) ndr_print_HrRBackupRead,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -405,7 +405,7 @@
 		sizeof(struct HrRBackupClose),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupClose,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupClose,
-		(ndr_print_function_t) ndr_print_HrRBackupClose,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -414,7 +414,7 @@
 		sizeof(struct HrRBackupGetBackupLogs),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupGetBackupLogs,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupGetBackupLogs,
-		(ndr_print_function_t) ndr_print_HrRBackupGetBackupLogs,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -423,7 +423,7 @@
 		sizeof(struct HrRBackupTruncateLogs),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupTruncateLogs,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupTruncateLogs,
-		(ndr_print_function_t) ndr_print_HrRBackupTruncateLogs,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -432,7 +432,7 @@
 		sizeof(struct HrRBackupPing),
 		(ndr_push_flags_fn_t) ndr_push_HrRBackupPing,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRBackupPing,
-		(ndr_print_function_t) ndr_print_HrRBackupPing,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -789,7 +789,7 @@
 		sizeof(struct HrRIsNTDSOnline),
 		(ndr_push_flags_fn_t) ndr_push_HrRIsNTDSOnline,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRIsNTDSOnline,
-		(ndr_print_function_t) ndr_print_HrRIsNTDSOnline,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -798,7 +798,7 @@
 		sizeof(struct HrRRestorePrepare),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestorePrepare,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestorePrepare,
-		(ndr_print_function_t) ndr_print_HrRRestorePrepare,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -807,7 +807,7 @@
 		sizeof(struct HrRRestoreRegister),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreRegister,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreRegister,
-		(ndr_print_function_t) ndr_print_HrRRestoreRegister,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -816,7 +816,7 @@
 		sizeof(struct HrRRestoreRegisterComplete),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreRegisterComplete,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreRegisterComplete,
-		(ndr_print_function_t) ndr_print_HrRRestoreRegisterComplete,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -825,7 +825,7 @@
 		sizeof(struct HrRRestoreGetDatabaseLocations),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreGetDatabaseLocations,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreGetDatabaseLocations,
-		(ndr_print_function_t) ndr_print_HrRRestoreGetDatabaseLocations,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -834,7 +834,7 @@
 		sizeof(struct HrRRestoreEnd),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreEnd,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreEnd,
-		(ndr_print_function_t) ndr_print_HrRRestoreEnd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -843,7 +843,7 @@
 		sizeof(struct HrRRestoreSetCurrentLogNumber),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreSetCurrentLogNumber,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreSetCurrentLogNumber,
-		(ndr_print_function_t) ndr_print_HrRRestoreSetCurrentLogNumber,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -852,7 +852,7 @@
 		sizeof(struct HrRRestoreCheckLogsForBackup),
 		(ndr_push_flags_fn_t) ndr_push_HrRRestoreCheckLogsForBackup,
 		(ndr_pull_flags_fn_t) ndr_pull_HrRRestoreCheckLogsForBackup,
-		(ndr_print_function_t) ndr_print_HrRRestoreCheckLogsForBackup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_dssetup.c samba3/source3/librpc/gen_ndr/ndr_dssetup.c
--- samba3/source3/librpc/gen_ndr/ndr_dssetup.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_dssetup.c	2024-08-04 17:52:53.000000000 +0200
@@ -995,7 +995,7 @@
 		sizeof(struct dssetup_DsRoleGetPrimaryDomainInformation),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleGetPrimaryDomainInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleGetPrimaryDomainInformation,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleGetPrimaryDomainInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1004,7 +1004,7 @@
 		sizeof(struct dssetup_DsRoleDnsNameToFlatName),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleDnsNameToFlatName,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleDnsNameToFlatName,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleDnsNameToFlatName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1013,7 +1013,7 @@
 		sizeof(struct dssetup_DsRoleDcAsDc),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleDcAsDc,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleDcAsDc,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleDcAsDc,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1022,7 +1022,7 @@
 		sizeof(struct dssetup_DsRoleDcAsReplica),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleDcAsReplica,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleDcAsReplica,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleDcAsReplica,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1031,7 +1031,7 @@
 		sizeof(struct dssetup_DsRoleDemoteDc),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleDemoteDc,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleDemoteDc,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleDemoteDc,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1040,7 +1040,7 @@
 		sizeof(struct dssetup_DsRoleGetDcOperationProgress),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleGetDcOperationProgress,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleGetDcOperationProgress,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleGetDcOperationProgress,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1049,7 +1049,7 @@
 		sizeof(struct dssetup_DsRoleGetDcOperationResults),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleGetDcOperationResults,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleGetDcOperationResults,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleGetDcOperationResults,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1058,7 +1058,7 @@
 		sizeof(struct dssetup_DsRoleCancel),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleCancel,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleCancel,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleCancel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1067,7 +1067,7 @@
 		sizeof(struct dssetup_DsRoleServerSaveStateForUpgrade),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleServerSaveStateForUpgrade,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleServerSaveStateForUpgrade,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleServerSaveStateForUpgrade,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1076,7 +1076,7 @@
 		sizeof(struct dssetup_DsRoleUpgradeDownlevelServer),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleUpgradeDownlevelServer,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleUpgradeDownlevelServer,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleUpgradeDownlevelServer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1085,7 +1085,7 @@
 		sizeof(struct dssetup_DsRoleAbortDownlevelServerUpgrade),
 		(ndr_push_flags_fn_t) ndr_push_dssetup_DsRoleAbortDownlevelServerUpgrade,
 		(ndr_pull_flags_fn_t) ndr_pull_dssetup_DsRoleAbortDownlevelServerUpgrade,
-		(ndr_print_function_t) ndr_print_dssetup_DsRoleAbortDownlevelServerUpgrade,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_echo.c samba3/source3/librpc/gen_ndr/ndr_echo.c
--- samba3/source3/librpc/gen_ndr/ndr_echo.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_echo.c	2024-08-04 17:52:53.000000000 +0200
@@ -1458,7 +1458,7 @@
 		sizeof(struct echo_AddOne),
 		(ndr_push_flags_fn_t) ndr_push_echo_AddOne,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_AddOne,
-		(ndr_print_function_t) ndr_print_echo_AddOne,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1467,7 +1467,7 @@
 		sizeof(struct echo_EchoData),
 		(ndr_push_flags_fn_t) ndr_push_echo_EchoData,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_EchoData,
-		(ndr_print_function_t) ndr_print_echo_EchoData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1476,7 +1476,7 @@
 		sizeof(struct echo_SinkData),
 		(ndr_push_flags_fn_t) ndr_push_echo_SinkData,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_SinkData,
-		(ndr_print_function_t) ndr_print_echo_SinkData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1485,7 +1485,7 @@
 		sizeof(struct echo_SourceData),
 		(ndr_push_flags_fn_t) ndr_push_echo_SourceData,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_SourceData,
-		(ndr_print_function_t) ndr_print_echo_SourceData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1494,7 +1494,7 @@
 		sizeof(struct echo_TestCall),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestCall,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestCall,
-		(ndr_print_function_t) ndr_print_echo_TestCall,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1503,7 +1503,7 @@
 		sizeof(struct echo_TestCall2),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestCall2,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestCall2,
-		(ndr_print_function_t) ndr_print_echo_TestCall2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1512,7 +1512,7 @@
 		sizeof(struct echo_TestSleep),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestSleep,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestSleep,
-		(ndr_print_function_t) ndr_print_echo_TestSleep,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1521,7 +1521,7 @@
 		sizeof(struct echo_TestEnum),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestEnum,
-		(ndr_print_function_t) ndr_print_echo_TestEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1530,7 +1530,7 @@
 		sizeof(struct echo_TestSurrounding),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestSurrounding,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestSurrounding,
-		(ndr_print_function_t) ndr_print_echo_TestSurrounding,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1539,7 +1539,7 @@
 		sizeof(struct echo_TestDoublePointer),
 		(ndr_push_flags_fn_t) ndr_push_echo_TestDoublePointer,
 		(ndr_pull_flags_fn_t) ndr_pull_echo_TestDoublePointer,
-		(ndr_print_function_t) ndr_print_echo_TestDoublePointer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_efs.c samba3/source3/librpc/gen_ndr/ndr_efs.c
--- samba3/source3/librpc/gen_ndr/ndr_efs.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_efs.c	2024-08-04 17:52:53.000000000 +0200
@@ -1327,7 +1327,7 @@
 		sizeof(struct EfsRpcOpenFileRaw),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcOpenFileRaw,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcOpenFileRaw,
-		(ndr_print_function_t) ndr_print_EfsRpcOpenFileRaw,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1336,7 +1336,7 @@
 		sizeof(struct EfsRpcReadFileRaw),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcReadFileRaw,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcReadFileRaw,
-		(ndr_print_function_t) ndr_print_EfsRpcReadFileRaw,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1345,7 +1345,7 @@
 		sizeof(struct EfsRpcWriteFileRaw),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcWriteFileRaw,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcWriteFileRaw,
-		(ndr_print_function_t) ndr_print_EfsRpcWriteFileRaw,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1354,7 +1354,7 @@
 		sizeof(struct EfsRpcCloseRaw),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcCloseRaw,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcCloseRaw,
-		(ndr_print_function_t) ndr_print_EfsRpcCloseRaw,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1363,7 +1363,7 @@
 		sizeof(struct EfsRpcEncryptFileSrv),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcEncryptFileSrv,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcEncryptFileSrv,
-		(ndr_print_function_t) ndr_print_EfsRpcEncryptFileSrv,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1372,7 +1372,7 @@
 		sizeof(struct EfsRpcDecryptFileSrv),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcDecryptFileSrv,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcDecryptFileSrv,
-		(ndr_print_function_t) ndr_print_EfsRpcDecryptFileSrv,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1381,7 +1381,7 @@
 		sizeof(struct EfsRpcQueryUsersOnFile),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcQueryUsersOnFile,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcQueryUsersOnFile,
-		(ndr_print_function_t) ndr_print_EfsRpcQueryUsersOnFile,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1390,7 +1390,7 @@
 		sizeof(struct EfsRpcQueryRecoveryAgents),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcQueryRecoveryAgents,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcQueryRecoveryAgents,
-		(ndr_print_function_t) ndr_print_EfsRpcQueryRecoveryAgents,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1399,7 +1399,7 @@
 		sizeof(struct EfsRpcRemoveUsersFromFile),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcRemoveUsersFromFile,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcRemoveUsersFromFile,
-		(ndr_print_function_t) ndr_print_EfsRpcRemoveUsersFromFile,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1408,7 +1408,7 @@
 		sizeof(struct EfsRpcAddUsersToFile),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcAddUsersToFile,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcAddUsersToFile,
-		(ndr_print_function_t) ndr_print_EfsRpcAddUsersToFile,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1417,7 +1417,7 @@
 		sizeof(struct EfsRpcSetFileEncryptionKey),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcSetFileEncryptionKey,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcSetFileEncryptionKey,
-		(ndr_print_function_t) ndr_print_EfsRpcSetFileEncryptionKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1426,7 +1426,7 @@
 		sizeof(struct EfsRpcNotSupported),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcNotSupported,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcNotSupported,
-		(ndr_print_function_t) ndr_print_EfsRpcNotSupported,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1435,7 +1435,7 @@
 		sizeof(struct EfsRpcFileKeyInfo),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcFileKeyInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcFileKeyInfo,
-		(ndr_print_function_t) ndr_print_EfsRpcFileKeyInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1444,7 +1444,7 @@
 		sizeof(struct EfsRpcDuplicateEncryptionInfoFile),
 		(ndr_push_flags_fn_t) ndr_push_EfsRpcDuplicateEncryptionInfoFile,
 		(ndr_pull_flags_fn_t) ndr_pull_EfsRpcDuplicateEncryptionInfoFile,
-		(ndr_print_function_t) ndr_print_EfsRpcDuplicateEncryptionInfoFile,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_epmapper.c samba3/source3/librpc/gen_ndr/ndr_epmapper.c
--- samba3/source3/librpc/gen_ndr/ndr_epmapper.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_epmapper.c	2024-08-04 17:52:53.000000000 +0200
@@ -2754,7 +2754,7 @@
 		sizeof(struct epm_Insert),
 		(ndr_push_flags_fn_t) ndr_push_epm_Insert,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_Insert,
-		(ndr_print_function_t) ndr_print_epm_Insert,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2763,7 +2763,7 @@
 		sizeof(struct epm_Delete),
 		(ndr_push_flags_fn_t) ndr_push_epm_Delete,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_Delete,
-		(ndr_print_function_t) ndr_print_epm_Delete,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2772,7 +2772,7 @@
 		sizeof(struct epm_Lookup),
 		(ndr_push_flags_fn_t) ndr_push_epm_Lookup,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_Lookup,
-		(ndr_print_function_t) ndr_print_epm_Lookup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2781,7 +2781,7 @@
 		sizeof(struct epm_Map),
 		(ndr_push_flags_fn_t) ndr_push_epm_Map,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_Map,
-		(ndr_print_function_t) ndr_print_epm_Map,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2790,7 +2790,7 @@
 		sizeof(struct epm_LookupHandleFree),
 		(ndr_push_flags_fn_t) ndr_push_epm_LookupHandleFree,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_LookupHandleFree,
-		(ndr_print_function_t) ndr_print_epm_LookupHandleFree,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2799,7 +2799,7 @@
 		sizeof(struct epm_InqObject),
 		(ndr_push_flags_fn_t) ndr_push_epm_InqObject,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_InqObject,
-		(ndr_print_function_t) ndr_print_epm_InqObject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2808,7 +2808,7 @@
 		sizeof(struct epm_MgmtDelete),
 		(ndr_push_flags_fn_t) ndr_push_epm_MgmtDelete,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_MgmtDelete,
-		(ndr_print_function_t) ndr_print_epm_MgmtDelete,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2817,7 +2817,7 @@
 		sizeof(struct epm_MapAuth),
 		(ndr_push_flags_fn_t) ndr_push_epm_MapAuth,
 		(ndr_pull_flags_fn_t) ndr_pull_epm_MapAuth,
-		(ndr_print_function_t) ndr_print_epm_MapAuth,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_eventlog6.c samba3/source3/librpc/gen_ndr/ndr_eventlog6.c
--- samba3/source3/librpc/gen_ndr/ndr_eventlog6.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_eventlog6.c	2024-08-04 17:52:53.000000000 +0200
@@ -5482,7 +5482,7 @@
 		sizeof(struct eventlog6_EvtRpcRegisterRemoteSubscription),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRegisterRemoteSubscription,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRegisterRemoteSubscription,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRegisterRemoteSubscription,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5491,7 +5491,7 @@
 		sizeof(struct eventlog6_EvtRpcRemoteSubscriptionNextAsync),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRemoteSubscriptionNextAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRemoteSubscriptionNextAsync,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRemoteSubscriptionNextAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5500,7 +5500,7 @@
 		sizeof(struct eventlog6_EvtRpcRemoteSubscriptionNext),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRemoteSubscriptionNext,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRemoteSubscriptionNext,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRemoteSubscriptionNext,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5509,7 +5509,7 @@
 		sizeof(struct eventlog6_EvtRpcRemoteSubscriptionWaitAsync),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRemoteSubscriptionWaitAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRemoteSubscriptionWaitAsync,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRemoteSubscriptionWaitAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5518,7 +5518,7 @@
 		sizeof(struct eventlog6_EvtRpcRegisterControllableOperation),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRegisterControllableOperation,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRegisterControllableOperation,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRegisterControllableOperation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5527,7 +5527,7 @@
 		sizeof(struct eventlog6_EvtRpcRegisterLogQuery),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRegisterLogQuery,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRegisterLogQuery,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRegisterLogQuery,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5536,7 +5536,7 @@
 		sizeof(struct eventlog6_EvtRpcClearLog),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcClearLog,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcClearLog,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcClearLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5545,7 +5545,7 @@
 		sizeof(struct eventlog6_EvtRpcExportLog),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcExportLog,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcExportLog,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcExportLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5554,7 +5554,7 @@
 		sizeof(struct eventlog6_EvtRpcLocalizeExportLog),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcLocalizeExportLog,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcLocalizeExportLog,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcLocalizeExportLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5563,7 +5563,7 @@
 		sizeof(struct eventlog6_EvtRpcMessageRender),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcMessageRender,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcMessageRender,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcMessageRender,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5572,7 +5572,7 @@
 		sizeof(struct eventlog6_EvtRpcMessageRenderDefault),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcMessageRenderDefault,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcMessageRenderDefault,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcMessageRenderDefault,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5581,7 +5581,7 @@
 		sizeof(struct eventlog6_EvtRpcQueryNext),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcQueryNext,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcQueryNext,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcQueryNext,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5590,7 +5590,7 @@
 		sizeof(struct eventlog6_EvtRpcQuerySeek),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcQuerySeek,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcQuerySeek,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcQuerySeek,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5599,7 +5599,7 @@
 		sizeof(struct eventlog6_EvtRpcClose),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcClose,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcClose,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcClose,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5608,7 +5608,7 @@
 		sizeof(struct eventlog6_EvtRpcCancel),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcCancel,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcCancel,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcCancel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5617,7 +5617,7 @@
 		sizeof(struct eventlog6_EvtRpcAssertConfig),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcAssertConfig,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcAssertConfig,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcAssertConfig,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5626,7 +5626,7 @@
 		sizeof(struct eventlog6_EvtRpcRetractConfig),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcRetractConfig,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcRetractConfig,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcRetractConfig,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5635,7 +5635,7 @@
 		sizeof(struct eventlog6_EvtRpcOpenLogHandle),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcOpenLogHandle,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcOpenLogHandle,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcOpenLogHandle,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5644,7 +5644,7 @@
 		sizeof(struct eventlog6_EvtRpcGetLogFileInfo),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetLogFileInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetLogFileInfo,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetLogFileInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5653,7 +5653,7 @@
 		sizeof(struct eventlog6_EvtRpcGetChannelList),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetChannelList,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetChannelList,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetChannelList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5662,7 +5662,7 @@
 		sizeof(struct eventlog6_EvtRpcGetChannelConfig),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetChannelConfig,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetChannelConfig,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetChannelConfig,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5671,7 +5671,7 @@
 		sizeof(struct eventlog6_EvtRpcPutChannelConfig),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcPutChannelConfig,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcPutChannelConfig,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcPutChannelConfig,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5680,7 +5680,7 @@
 		sizeof(struct eventlog6_EvtRpcGetPublisherList),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetPublisherList,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetPublisherList,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetPublisherList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5689,7 +5689,7 @@
 		sizeof(struct eventlog6_EvtRpcGetPublisherListForChannel),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetPublisherListForChannel,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetPublisherListForChannel,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetPublisherListForChannel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5698,7 +5698,7 @@
 		sizeof(struct eventlog6_EvtRpcGetPublisherMetadata),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetPublisherMetadata,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetPublisherMetadata,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetPublisherMetadata,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5707,7 +5707,7 @@
 		sizeof(struct eventlog6_EvtRpcGetPublisherResourceMetadata),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetPublisherResourceMetadata,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetPublisherResourceMetadata,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetPublisherResourceMetadata,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5716,7 +5716,7 @@
 		sizeof(struct eventlog6_EvtRpcGetEventMetadataEnum),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetEventMetadataEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetEventMetadataEnum,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetEventMetadataEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5725,7 +5725,7 @@
 		sizeof(struct eventlog6_EvtRpcGetNextEventMetadata),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetNextEventMetadata,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetNextEventMetadata,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetNextEventMetadata,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5734,7 +5734,7 @@
 		sizeof(struct eventlog6_EvtRpcGetClassicLogDisplayName),
 		(ndr_push_flags_fn_t) ndr_push_eventlog6_EvtRpcGetClassicLogDisplayName,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog6_EvtRpcGetClassicLogDisplayName,
-		(ndr_print_function_t) ndr_print_eventlog6_EvtRpcGetClassicLogDisplayName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_eventlog.c samba3/source3/librpc/gen_ndr/ndr_eventlog.c
--- samba3/source3/librpc/gen_ndr/ndr_eventlog.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_eventlog.c	2024-08-04 17:52:53.000000000 +0200
@@ -2983,7 +2983,7 @@
 		sizeof(struct eventlog_ClearEventLogW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ClearEventLogW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ClearEventLogW,
-		(ndr_print_function_t) ndr_print_eventlog_ClearEventLogW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2992,7 +2992,7 @@
 		sizeof(struct eventlog_BackupEventLogW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_BackupEventLogW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_BackupEventLogW,
-		(ndr_print_function_t) ndr_print_eventlog_BackupEventLogW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3001,7 +3001,7 @@
 		sizeof(struct eventlog_CloseEventLog),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_CloseEventLog,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_CloseEventLog,
-		(ndr_print_function_t) ndr_print_eventlog_CloseEventLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3010,7 +3010,7 @@
 		sizeof(struct eventlog_DeregisterEventSource),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_DeregisterEventSource,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_DeregisterEventSource,
-		(ndr_print_function_t) ndr_print_eventlog_DeregisterEventSource,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3019,7 +3019,7 @@
 		sizeof(struct eventlog_GetNumRecords),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_GetNumRecords,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_GetNumRecords,
-		(ndr_print_function_t) ndr_print_eventlog_GetNumRecords,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3028,7 +3028,7 @@
 		sizeof(struct eventlog_GetOldestRecord),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_GetOldestRecord,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_GetOldestRecord,
-		(ndr_print_function_t) ndr_print_eventlog_GetOldestRecord,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3037,7 +3037,7 @@
 		sizeof(struct eventlog_ChangeNotify),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ChangeNotify,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ChangeNotify,
-		(ndr_print_function_t) ndr_print_eventlog_ChangeNotify,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3046,7 +3046,7 @@
 		sizeof(struct eventlog_OpenEventLogW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_OpenEventLogW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_OpenEventLogW,
-		(ndr_print_function_t) ndr_print_eventlog_OpenEventLogW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3055,7 +3055,7 @@
 		sizeof(struct eventlog_RegisterEventSourceW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_RegisterEventSourceW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_RegisterEventSourceW,
-		(ndr_print_function_t) ndr_print_eventlog_RegisterEventSourceW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3064,7 +3064,7 @@
 		sizeof(struct eventlog_OpenBackupEventLogW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_OpenBackupEventLogW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_OpenBackupEventLogW,
-		(ndr_print_function_t) ndr_print_eventlog_OpenBackupEventLogW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3073,7 +3073,7 @@
 		sizeof(struct eventlog_ReadEventLogW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ReadEventLogW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ReadEventLogW,
-		(ndr_print_function_t) ndr_print_eventlog_ReadEventLogW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3082,7 +3082,7 @@
 		sizeof(struct eventlog_ReportEventW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ReportEventW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ReportEventW,
-		(ndr_print_function_t) ndr_print_eventlog_ReportEventW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3091,7 +3091,7 @@
 		sizeof(struct eventlog_ClearEventLogA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ClearEventLogA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ClearEventLogA,
-		(ndr_print_function_t) ndr_print_eventlog_ClearEventLogA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3100,7 +3100,7 @@
 		sizeof(struct eventlog_BackupEventLogA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_BackupEventLogA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_BackupEventLogA,
-		(ndr_print_function_t) ndr_print_eventlog_BackupEventLogA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3109,7 +3109,7 @@
 		sizeof(struct eventlog_OpenEventLogA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_OpenEventLogA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_OpenEventLogA,
-		(ndr_print_function_t) ndr_print_eventlog_OpenEventLogA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3118,7 +3118,7 @@
 		sizeof(struct eventlog_RegisterEventSourceA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_RegisterEventSourceA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_RegisterEventSourceA,
-		(ndr_print_function_t) ndr_print_eventlog_RegisterEventSourceA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3127,7 +3127,7 @@
 		sizeof(struct eventlog_OpenBackupEventLogA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_OpenBackupEventLogA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_OpenBackupEventLogA,
-		(ndr_print_function_t) ndr_print_eventlog_OpenBackupEventLogA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3136,7 +3136,7 @@
 		sizeof(struct eventlog_ReadEventLogA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ReadEventLogA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ReadEventLogA,
-		(ndr_print_function_t) ndr_print_eventlog_ReadEventLogA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3145,7 +3145,7 @@
 		sizeof(struct eventlog_ReportEventA),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ReportEventA,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ReportEventA,
-		(ndr_print_function_t) ndr_print_eventlog_ReportEventA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3154,7 +3154,7 @@
 		sizeof(struct eventlog_RegisterClusterSvc),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_RegisterClusterSvc,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_RegisterClusterSvc,
-		(ndr_print_function_t) ndr_print_eventlog_RegisterClusterSvc,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3163,7 +3163,7 @@
 		sizeof(struct eventlog_DeregisterClusterSvc),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_DeregisterClusterSvc,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_DeregisterClusterSvc,
-		(ndr_print_function_t) ndr_print_eventlog_DeregisterClusterSvc,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3172,7 +3172,7 @@
 		sizeof(struct eventlog_WriteClusterEvents),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_WriteClusterEvents,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_WriteClusterEvents,
-		(ndr_print_function_t) ndr_print_eventlog_WriteClusterEvents,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3181,7 +3181,7 @@
 		sizeof(struct eventlog_GetLogInformation),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_GetLogInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_GetLogInformation,
-		(ndr_print_function_t) ndr_print_eventlog_GetLogInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3190,7 +3190,7 @@
 		sizeof(struct eventlog_FlushEventLog),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_FlushEventLog,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_FlushEventLog,
-		(ndr_print_function_t) ndr_print_eventlog_FlushEventLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3199,7 +3199,7 @@
 		sizeof(struct eventlog_ReportEventAndSourceW),
 		(ndr_push_flags_fn_t) ndr_push_eventlog_ReportEventAndSourceW,
 		(ndr_pull_flags_fn_t) ndr_pull_eventlog_ReportEventAndSourceW,
-		(ndr_print_function_t) ndr_print_eventlog_ReportEventAndSourceW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_frsapi.c samba3/source3/librpc/gen_ndr/ndr_frsapi.c
--- samba3/source3/librpc/gen_ndr/ndr_frsapi.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_frsapi.c	2024-08-04 17:52:53.000000000 +0200
@@ -979,7 +979,7 @@
 		sizeof(struct FRSAPI_VERIFY_PROMOTION),
 		(ndr_push_flags_fn_t) ndr_push_FRSAPI_VERIFY_PROMOTION,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSAPI_VERIFY_PROMOTION,
-		(ndr_print_function_t) ndr_print_FRSAPI_VERIFY_PROMOTION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -988,7 +988,7 @@
 		sizeof(struct FRSAPI_PROMOTION_STATUS),
 		(ndr_push_flags_fn_t) ndr_push_FRSAPI_PROMOTION_STATUS,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSAPI_PROMOTION_STATUS,
-		(ndr_print_function_t) ndr_print_FRSAPI_PROMOTION_STATUS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -997,7 +997,7 @@
 		sizeof(struct FRSAPI_START_DEMOTION),
 		(ndr_push_flags_fn_t) ndr_push_FRSAPI_START_DEMOTION,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSAPI_START_DEMOTION,
-		(ndr_print_function_t) ndr_print_FRSAPI_START_DEMOTION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1006,7 +1006,7 @@
 		sizeof(struct FRSAPI_COMMIT_DEMOTION),
 		(ndr_push_flags_fn_t) ndr_push_FRSAPI_COMMIT_DEMOTION,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSAPI_COMMIT_DEMOTION,
-		(ndr_print_function_t) ndr_print_FRSAPI_COMMIT_DEMOTION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1015,7 +1015,7 @@
 		sizeof(struct frsapi_SetDsPollingIntervalW),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_SetDsPollingIntervalW,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_SetDsPollingIntervalW,
-		(ndr_print_function_t) ndr_print_frsapi_SetDsPollingIntervalW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1024,7 +1024,7 @@
 		sizeof(struct frsapi_GetDsPollingIntervalW),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_GetDsPollingIntervalW,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_GetDsPollingIntervalW,
-		(ndr_print_function_t) ndr_print_frsapi_GetDsPollingIntervalW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1033,7 +1033,7 @@
 		sizeof(struct FRSAPI_VERIFY_PROMOTION_W),
 		(ndr_push_flags_fn_t) ndr_push_FRSAPI_VERIFY_PROMOTION_W,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSAPI_VERIFY_PROMOTION_W,
-		(ndr_print_function_t) ndr_print_FRSAPI_VERIFY_PROMOTION_W,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1042,7 +1042,7 @@
 		sizeof(struct frsapi_InfoW),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_InfoW,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_InfoW,
-		(ndr_print_function_t) ndr_print_frsapi_InfoW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1051,7 +1051,7 @@
 		sizeof(struct frsapi_IsPathReplicated),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_IsPathReplicated,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_IsPathReplicated,
-		(ndr_print_function_t) ndr_print_frsapi_IsPathReplicated,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1060,7 +1060,7 @@
 		sizeof(struct frsapi_WriterCommand),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_WriterCommand,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_WriterCommand,
-		(ndr_print_function_t) ndr_print_frsapi_WriterCommand,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1069,7 +1069,7 @@
 		sizeof(struct frsapi_ForceReplication),
 		(ndr_push_flags_fn_t) ndr_push_frsapi_ForceReplication,
 		(ndr_pull_flags_fn_t) ndr_pull_frsapi_ForceReplication,
-		(ndr_print_function_t) ndr_print_frsapi_ForceReplication,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_frsrpc.c samba3/source3/librpc/gen_ndr/ndr_frsrpc.c
--- samba3/source3/librpc/gen_ndr/ndr_frsrpc.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_frsrpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -2781,7 +2781,7 @@
 		sizeof(struct frsrpc_FrsSendCommPkt),
 		(ndr_push_flags_fn_t) ndr_push_frsrpc_FrsSendCommPkt,
 		(ndr_pull_flags_fn_t) ndr_pull_frsrpc_FrsSendCommPkt,
-		(ndr_print_function_t) ndr_print_frsrpc_FrsSendCommPkt,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2790,7 +2790,7 @@
 		sizeof(struct frsrpc_FrsVerifyPromotionParent),
 		(ndr_push_flags_fn_t) ndr_push_frsrpc_FrsVerifyPromotionParent,
 		(ndr_pull_flags_fn_t) ndr_pull_frsrpc_FrsVerifyPromotionParent,
-		(ndr_print_function_t) ndr_print_frsrpc_FrsVerifyPromotionParent,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2799,7 +2799,7 @@
 		sizeof(struct frsrpc_FrsStartPromotionParent),
 		(ndr_push_flags_fn_t) ndr_push_frsrpc_FrsStartPromotionParent,
 		(ndr_pull_flags_fn_t) ndr_pull_frsrpc_FrsStartPromotionParent,
-		(ndr_print_function_t) ndr_print_frsrpc_FrsStartPromotionParent,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2808,7 +2808,7 @@
 		sizeof(struct frsrpc_FrsNOP),
 		(ndr_push_flags_fn_t) ndr_push_frsrpc_FrsNOP,
 		(ndr_pull_flags_fn_t) ndr_pull_frsrpc_FrsNOP,
-		(ndr_print_function_t) ndr_print_frsrpc_FrsNOP,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2817,7 +2817,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2826,7 +2826,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE_5),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE_5,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE_5,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE_5,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2835,7 +2835,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE_6),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE_6,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE_6,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE_6,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2844,7 +2844,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE_7),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE_7,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE_7,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE_7,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2853,7 +2853,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE_8),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE_8,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE_8,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE_8,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2862,7 +2862,7 @@
 		sizeof(struct FRSRPC_BACKUP_COMPLETE_9),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_BACKUP_COMPLETE_9,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_BACKUP_COMPLETE_9,
-		(ndr_print_function_t) ndr_print_FRSRPC_BACKUP_COMPLETE_9,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2871,7 +2871,7 @@
 		sizeof(struct FRSRPC_VERIFY_PROMOTION_PARENT_EX),
 		(ndr_push_flags_fn_t) ndr_push_FRSRPC_VERIFY_PROMOTION_PARENT_EX,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSRPC_VERIFY_PROMOTION_PARENT_EX,
-		(ndr_print_function_t) ndr_print_FRSRPC_VERIFY_PROMOTION_PARENT_EX,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_frstrans.c samba3/source3/librpc/gen_ndr/ndr_frstrans.c
--- samba3/source3/librpc/gen_ndr/ndr_frstrans.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_frstrans.c	2024-08-04 17:52:53.000000000 +0200
@@ -2331,7 +2331,7 @@
 		sizeof(struct frstrans_CheckConnectivity),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_CheckConnectivity,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_CheckConnectivity,
-		(ndr_print_function_t) ndr_print_frstrans_CheckConnectivity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2340,7 +2340,7 @@
 		sizeof(struct frstrans_EstablishConnection),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_EstablishConnection,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_EstablishConnection,
-		(ndr_print_function_t) ndr_print_frstrans_EstablishConnection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2349,7 +2349,7 @@
 		sizeof(struct frstrans_EstablishSession),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_EstablishSession,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_EstablishSession,
-		(ndr_print_function_t) ndr_print_frstrans_EstablishSession,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2358,7 +2358,7 @@
 		sizeof(struct frstrans_RequestUpdates),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_RequestUpdates,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_RequestUpdates,
-		(ndr_print_function_t) ndr_print_frstrans_RequestUpdates,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2367,7 +2367,7 @@
 		sizeof(struct frstrans_RequestVersionVector),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_RequestVersionVector,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_RequestVersionVector,
-		(ndr_print_function_t) ndr_print_frstrans_RequestVersionVector,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2376,7 +2376,7 @@
 		sizeof(struct frstrans_AsyncPoll),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_AsyncPoll,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_AsyncPoll,
-		(ndr_print_function_t) ndr_print_frstrans_AsyncPoll,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2385,7 +2385,7 @@
 		sizeof(struct FRSTRANS_REQUEST_RECORDS),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_REQUEST_RECORDS,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_REQUEST_RECORDS,
-		(ndr_print_function_t) ndr_print_FRSTRANS_REQUEST_RECORDS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2394,7 +2394,7 @@
 		sizeof(struct FRSTRANS_UPDATE_CANCEL),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_UPDATE_CANCEL,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_UPDATE_CANCEL,
-		(ndr_print_function_t) ndr_print_FRSTRANS_UPDATE_CANCEL,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2403,7 +2403,7 @@
 		sizeof(struct FRSTRANS_RAW_GET_FILE_DATA),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_RAW_GET_FILE_DATA,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_RAW_GET_FILE_DATA,
-		(ndr_print_function_t) ndr_print_FRSTRANS_RAW_GET_FILE_DATA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2412,7 +2412,7 @@
 		sizeof(struct FRSTRANS_RDC_GET_SIGNATURES),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_RDC_GET_SIGNATURES,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_RDC_GET_SIGNATURES,
-		(ndr_print_function_t) ndr_print_FRSTRANS_RDC_GET_SIGNATURES,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2421,7 +2421,7 @@
 		sizeof(struct FRSTRANS_RDC_PUSH_SOURCE_NEEDS),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_RDC_PUSH_SOURCE_NEEDS,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_RDC_PUSH_SOURCE_NEEDS,
-		(ndr_print_function_t) ndr_print_FRSTRANS_RDC_PUSH_SOURCE_NEEDS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2430,7 +2430,7 @@
 		sizeof(struct FRSTRANS_RDC_GET_FILE_DATA),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_RDC_GET_FILE_DATA,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_RDC_GET_FILE_DATA,
-		(ndr_print_function_t) ndr_print_FRSTRANS_RDC_GET_FILE_DATA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2439,7 +2439,7 @@
 		sizeof(struct FRSTRANS_RDC_CLOSE),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_RDC_CLOSE,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_RDC_CLOSE,
-		(ndr_print_function_t) ndr_print_FRSTRANS_RDC_CLOSE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2448,7 +2448,7 @@
 		sizeof(struct frstrans_InitializeFileTransferAsync),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_InitializeFileTransferAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_InitializeFileTransferAsync,
-		(ndr_print_function_t) ndr_print_frstrans_InitializeFileTransferAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2457,7 +2457,7 @@
 		sizeof(struct FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE),
 		(ndr_push_flags_fn_t) ndr_push_FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE,
 		(ndr_pull_flags_fn_t) ndr_pull_FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE,
-		(ndr_print_function_t) ndr_print_FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2466,7 +2466,7 @@
 		sizeof(struct frstrans_RawGetFileDataAsync),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_RawGetFileDataAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_RawGetFileDataAsync,
-		(ndr_print_function_t) ndr_print_frstrans_RawGetFileDataAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 1, frstrans_RawGetFileDataAsync_out_pipes },
 	},
@@ -2475,7 +2475,7 @@
 		sizeof(struct frstrans_RdcGetFileDataAsync),
 		(ndr_push_flags_fn_t) ndr_push_frstrans_RdcGetFileDataAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_frstrans_RdcGetFileDataAsync,
-		(ndr_print_function_t) ndr_print_frstrans_RdcGetFileDataAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 1, frstrans_RdcGetFileDataAsync_out_pipes },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_initshutdown.c samba3/source3/librpc/gen_ndr/ndr_initshutdown.c
--- samba3/source3/librpc/gen_ndr/ndr_initshutdown.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_initshutdown.c	2024-08-04 17:52:53.000000000 +0200
@@ -277,7 +277,7 @@
 		sizeof(struct initshutdown_Init),
 		(ndr_push_flags_fn_t) ndr_push_initshutdown_Init,
 		(ndr_pull_flags_fn_t) ndr_pull_initshutdown_Init,
-		(ndr_print_function_t) ndr_print_initshutdown_Init,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -286,7 +286,7 @@
 		sizeof(struct initshutdown_Abort),
 		(ndr_push_flags_fn_t) ndr_push_initshutdown_Abort,
 		(ndr_pull_flags_fn_t) ndr_pull_initshutdown_Abort,
-		(ndr_print_function_t) ndr_print_initshutdown_Abort,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -295,7 +295,7 @@
 		sizeof(struct initshutdown_InitEx),
 		(ndr_push_flags_fn_t) ndr_push_initshutdown_InitEx,
 		(ndr_pull_flags_fn_t) ndr_pull_initshutdown_InitEx,
-		(ndr_print_function_t) ndr_print_initshutdown_InitEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_keysvc.c samba3/source3/librpc/gen_ndr/ndr_keysvc.c
--- samba3/source3/librpc/gen_ndr/ndr_keysvc.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_keysvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 		sizeof(struct keysvc_Unknown0),
 		(ndr_push_flags_fn_t) ndr_push_keysvc_Unknown0,
 		(ndr_pull_flags_fn_t) ndr_pull_keysvc_Unknown0,
-		(ndr_print_function_t) ndr_print_keysvc_Unknown0,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_krb5pac.c samba3/source3/librpc/gen_ndr/ndr_krb5pac.c
--- samba3/source3/librpc/gen_ndr/ndr_krb5pac.c	2015-02-22 15:16:35.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_krb5pac.c	2024-08-04 17:52:53.000000000 +0200
@@ -1002,7 +1002,7 @@
 		sizeof(struct decode_pac),
 		(ndr_push_flags_fn_t) ndr_push_decode_pac,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_pac,
-		(ndr_print_function_t) ndr_print_decode_pac,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1011,7 +1011,7 @@
 		sizeof(struct decode_pac_raw),
 		(ndr_push_flags_fn_t) ndr_push_decode_pac_raw,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_pac_raw,
-		(ndr_print_function_t) ndr_print_decode_pac_raw,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1020,7 +1020,7 @@
 		sizeof(struct decode_login_info),
 		(ndr_push_flags_fn_t) ndr_push_decode_login_info,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_login_info,
-		(ndr_print_function_t) ndr_print_decode_login_info,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1029,7 +1029,7 @@
 		sizeof(struct decode_login_info_ctr),
 		(ndr_push_flags_fn_t) ndr_push_decode_login_info_ctr,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_login_info_ctr,
-		(ndr_print_function_t) ndr_print_decode_login_info_ctr,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -1038,7 +1038,7 @@
 		sizeof(struct decode_pac_validate),
 		(ndr_push_flags_fn_t) ndr_push_decode_pac_validate,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_pac_validate,
-		(ndr_print_function_t) ndr_print_decode_pac_validate,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.c samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.c
--- samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.c	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.c	2024-09-12 20:44:02.000000000 +0200
@@ -4814,7 +4814,7 @@
 							  uint32_t _entries_requested /* [in]  */,
 							  uint32_t _prefmaxlen /* [in]  */,
 							  uint32_t *_entries_read /* [out] [ref] */,
-							  void **_buffer /* [out] [ref,noprint] */)
+							  void **_buffer /* [out] [noprint,ref] */)
 {
 	struct tevent_req *req;
 	struct dcerpc_NetQueryDisplayInformation_state *state;
@@ -4924,7 +4924,7 @@
 					   uint32_t _entries_requested /* [in]  */,
 					   uint32_t _prefmaxlen /* [in]  */,
 					   uint32_t *_entries_read /* [out] [ref] */,
-					   void **_buffer /* [out] [ref,noprint] */,
+					   void **_buffer /* [out] [noprint,ref] */,
 					   enum NET_API_STATUS *result)
 {
 	struct NetQueryDisplayInformation r;
diff -daurN samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.h samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.h
--- samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.h	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_libnetapi_c.h	2024-09-12 20:44:02.000000000 +0200
@@ -548,7 +548,7 @@
 							  uint32_t _entries_requested /* [in]  */,
 							  uint32_t _prefmaxlen /* [in]  */,
 							  uint32_t *_entries_read /* [out] [ref] */,
-							  void **_buffer /* [out] [ref,noprint] */);
+							  void **_buffer /* [out] [noprint,ref] */);
 NTSTATUS dcerpc_NetQueryDisplayInformation_recv(struct tevent_req *req,
 						TALLOC_CTX *mem_ctx,
 						enum NET_API_STATUS *result);
@@ -560,7 +560,7 @@
 					   uint32_t _entries_requested /* [in]  */,
 					   uint32_t _prefmaxlen /* [in]  */,
 					   uint32_t *_entries_read /* [out] [ref] */,
-					   void **_buffer /* [out] [ref,noprint] */,
+					   void **_buffer /* [out] [noprint,ref] */,
 					   enum NET_API_STATUS *result);
 
 struct tevent_req *dcerpc_NetGroupAdd_r_send(TALLOC_CTX *mem_ctx,
diff -daurN samba3/source3/librpc/gen_ndr/ndr_lsa.c samba3/source3/librpc/gen_ndr/ndr_lsa.c
--- samba3/source3/librpc/gen_ndr/ndr_lsa.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_lsa.c	2024-08-04 17:52:53.000000000 +0200
@@ -13565,7 +13565,7 @@
 		sizeof(struct lsa_Close),
 		(ndr_push_flags_fn_t) ndr_push_lsa_Close,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_Close,
-		(ndr_print_function_t) ndr_print_lsa_Close,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13574,7 +13574,7 @@
 		sizeof(struct lsa_Delete),
 		(ndr_push_flags_fn_t) ndr_push_lsa_Delete,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_Delete,
-		(ndr_print_function_t) ndr_print_lsa_Delete,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13583,7 +13583,7 @@
 		sizeof(struct lsa_EnumPrivs),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumPrivs,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumPrivs,
-		(ndr_print_function_t) ndr_print_lsa_EnumPrivs,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13592,7 +13592,7 @@
 		sizeof(struct lsa_QuerySecurity),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QuerySecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QuerySecurity,
-		(ndr_print_function_t) ndr_print_lsa_QuerySecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13601,7 +13601,7 @@
 		sizeof(struct lsa_SetSecObj),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetSecObj,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetSecObj,
-		(ndr_print_function_t) ndr_print_lsa_SetSecObj,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13610,7 +13610,7 @@
 		sizeof(struct lsa_ChangePassword),
 		(ndr_push_flags_fn_t) ndr_push_lsa_ChangePassword,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_ChangePassword,
-		(ndr_print_function_t) ndr_print_lsa_ChangePassword,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13619,7 +13619,7 @@
 		sizeof(struct lsa_OpenPolicy),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenPolicy,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenPolicy,
-		(ndr_print_function_t) ndr_print_lsa_OpenPolicy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13628,7 +13628,7 @@
 		sizeof(struct lsa_QueryInfoPolicy),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryInfoPolicy,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryInfoPolicy,
-		(ndr_print_function_t) ndr_print_lsa_QueryInfoPolicy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13637,7 +13637,7 @@
 		sizeof(struct lsa_SetInfoPolicy),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetInfoPolicy,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetInfoPolicy,
-		(ndr_print_function_t) ndr_print_lsa_SetInfoPolicy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13646,7 +13646,7 @@
 		sizeof(struct lsa_ClearAuditLog),
 		(ndr_push_flags_fn_t) ndr_push_lsa_ClearAuditLog,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_ClearAuditLog,
-		(ndr_print_function_t) ndr_print_lsa_ClearAuditLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13655,7 +13655,7 @@
 		sizeof(struct lsa_CreateAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CreateAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CreateAccount,
-		(ndr_print_function_t) ndr_print_lsa_CreateAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13664,7 +13664,7 @@
 		sizeof(struct lsa_EnumAccounts),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumAccounts,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumAccounts,
-		(ndr_print_function_t) ndr_print_lsa_EnumAccounts,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13673,7 +13673,7 @@
 		sizeof(struct lsa_CreateTrustedDomain),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CreateTrustedDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CreateTrustedDomain,
-		(ndr_print_function_t) ndr_print_lsa_CreateTrustedDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13682,7 +13682,7 @@
 		sizeof(struct lsa_EnumTrustDom),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumTrustDom,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumTrustDom,
-		(ndr_print_function_t) ndr_print_lsa_EnumTrustDom,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13691,7 +13691,7 @@
 		sizeof(struct lsa_LookupNames),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupNames,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupNames,
-		(ndr_print_function_t) ndr_print_lsa_LookupNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13700,7 +13700,7 @@
 		sizeof(struct lsa_LookupSids),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupSids,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupSids,
-		(ndr_print_function_t) ndr_print_lsa_LookupSids,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13709,7 +13709,7 @@
 		sizeof(struct lsa_CreateSecret),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CreateSecret,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CreateSecret,
-		(ndr_print_function_t) ndr_print_lsa_CreateSecret,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13718,7 +13718,7 @@
 		sizeof(struct lsa_OpenAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenAccount,
-		(ndr_print_function_t) ndr_print_lsa_OpenAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13727,7 +13727,7 @@
 		sizeof(struct lsa_EnumPrivsAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumPrivsAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumPrivsAccount,
-		(ndr_print_function_t) ndr_print_lsa_EnumPrivsAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13736,7 +13736,7 @@
 		sizeof(struct lsa_AddPrivilegesToAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_AddPrivilegesToAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_AddPrivilegesToAccount,
-		(ndr_print_function_t) ndr_print_lsa_AddPrivilegesToAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13745,7 +13745,7 @@
 		sizeof(struct lsa_RemovePrivilegesFromAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_RemovePrivilegesFromAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_RemovePrivilegesFromAccount,
-		(ndr_print_function_t) ndr_print_lsa_RemovePrivilegesFromAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13754,7 +13754,7 @@
 		sizeof(struct lsa_GetQuotasForAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_GetQuotasForAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_GetQuotasForAccount,
-		(ndr_print_function_t) ndr_print_lsa_GetQuotasForAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13763,7 +13763,7 @@
 		sizeof(struct lsa_SetQuotasForAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetQuotasForAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetQuotasForAccount,
-		(ndr_print_function_t) ndr_print_lsa_SetQuotasForAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13772,7 +13772,7 @@
 		sizeof(struct lsa_GetSystemAccessAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_GetSystemAccessAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_GetSystemAccessAccount,
-		(ndr_print_function_t) ndr_print_lsa_GetSystemAccessAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13781,7 +13781,7 @@
 		sizeof(struct lsa_SetSystemAccessAccount),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetSystemAccessAccount,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetSystemAccessAccount,
-		(ndr_print_function_t) ndr_print_lsa_SetSystemAccessAccount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13790,7 +13790,7 @@
 		sizeof(struct lsa_OpenTrustedDomain),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenTrustedDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenTrustedDomain,
-		(ndr_print_function_t) ndr_print_lsa_OpenTrustedDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13799,7 +13799,7 @@
 		sizeof(struct lsa_QueryTrustedDomainInfo),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryTrustedDomainInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryTrustedDomainInfo,
-		(ndr_print_function_t) ndr_print_lsa_QueryTrustedDomainInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13808,7 +13808,7 @@
 		sizeof(struct lsa_SetInformationTrustedDomain),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetInformationTrustedDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetInformationTrustedDomain,
-		(ndr_print_function_t) ndr_print_lsa_SetInformationTrustedDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13817,7 +13817,7 @@
 		sizeof(struct lsa_OpenSecret),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenSecret,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenSecret,
-		(ndr_print_function_t) ndr_print_lsa_OpenSecret,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13826,7 +13826,7 @@
 		sizeof(struct lsa_SetSecret),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetSecret,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetSecret,
-		(ndr_print_function_t) ndr_print_lsa_SetSecret,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13835,7 +13835,7 @@
 		sizeof(struct lsa_QuerySecret),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QuerySecret,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QuerySecret,
-		(ndr_print_function_t) ndr_print_lsa_QuerySecret,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13844,7 +13844,7 @@
 		sizeof(struct lsa_LookupPrivValue),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupPrivValue,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupPrivValue,
-		(ndr_print_function_t) ndr_print_lsa_LookupPrivValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13853,7 +13853,7 @@
 		sizeof(struct lsa_LookupPrivName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupPrivName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupPrivName,
-		(ndr_print_function_t) ndr_print_lsa_LookupPrivName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13862,7 +13862,7 @@
 		sizeof(struct lsa_LookupPrivDisplayName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupPrivDisplayName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupPrivDisplayName,
-		(ndr_print_function_t) ndr_print_lsa_LookupPrivDisplayName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13871,7 +13871,7 @@
 		sizeof(struct lsa_DeleteObject),
 		(ndr_push_flags_fn_t) ndr_push_lsa_DeleteObject,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_DeleteObject,
-		(ndr_print_function_t) ndr_print_lsa_DeleteObject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13880,7 +13880,7 @@
 		sizeof(struct lsa_EnumAccountsWithUserRight),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumAccountsWithUserRight,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumAccountsWithUserRight,
-		(ndr_print_function_t) ndr_print_lsa_EnumAccountsWithUserRight,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13889,7 +13889,7 @@
 		sizeof(struct lsa_EnumAccountRights),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumAccountRights,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumAccountRights,
-		(ndr_print_function_t) ndr_print_lsa_EnumAccountRights,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13898,7 +13898,7 @@
 		sizeof(struct lsa_AddAccountRights),
 		(ndr_push_flags_fn_t) ndr_push_lsa_AddAccountRights,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_AddAccountRights,
-		(ndr_print_function_t) ndr_print_lsa_AddAccountRights,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13907,7 +13907,7 @@
 		sizeof(struct lsa_RemoveAccountRights),
 		(ndr_push_flags_fn_t) ndr_push_lsa_RemoveAccountRights,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_RemoveAccountRights,
-		(ndr_print_function_t) ndr_print_lsa_RemoveAccountRights,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13916,7 +13916,7 @@
 		sizeof(struct lsa_QueryTrustedDomainInfoBySid),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryTrustedDomainInfoBySid,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryTrustedDomainInfoBySid,
-		(ndr_print_function_t) ndr_print_lsa_QueryTrustedDomainInfoBySid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13925,7 +13925,7 @@
 		sizeof(struct lsa_SetTrustedDomainInfo),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetTrustedDomainInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetTrustedDomainInfo,
-		(ndr_print_function_t) ndr_print_lsa_SetTrustedDomainInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13934,7 +13934,7 @@
 		sizeof(struct lsa_DeleteTrustedDomain),
 		(ndr_push_flags_fn_t) ndr_push_lsa_DeleteTrustedDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_DeleteTrustedDomain,
-		(ndr_print_function_t) ndr_print_lsa_DeleteTrustedDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13943,7 +13943,7 @@
 		sizeof(struct lsa_StorePrivateData),
 		(ndr_push_flags_fn_t) ndr_push_lsa_StorePrivateData,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_StorePrivateData,
-		(ndr_print_function_t) ndr_print_lsa_StorePrivateData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13952,7 +13952,7 @@
 		sizeof(struct lsa_RetrievePrivateData),
 		(ndr_push_flags_fn_t) ndr_push_lsa_RetrievePrivateData,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_RetrievePrivateData,
-		(ndr_print_function_t) ndr_print_lsa_RetrievePrivateData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13961,7 +13961,7 @@
 		sizeof(struct lsa_OpenPolicy2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenPolicy2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenPolicy2,
-		(ndr_print_function_t) ndr_print_lsa_OpenPolicy2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13970,7 +13970,7 @@
 		sizeof(struct lsa_GetUserName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_GetUserName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_GetUserName,
-		(ndr_print_function_t) ndr_print_lsa_GetUserName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13979,7 +13979,7 @@
 		sizeof(struct lsa_QueryInfoPolicy2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryInfoPolicy2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryInfoPolicy2,
-		(ndr_print_function_t) ndr_print_lsa_QueryInfoPolicy2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13988,7 +13988,7 @@
 		sizeof(struct lsa_SetInfoPolicy2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetInfoPolicy2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetInfoPolicy2,
-		(ndr_print_function_t) ndr_print_lsa_SetInfoPolicy2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13997,7 +13997,7 @@
 		sizeof(struct lsa_QueryTrustedDomainInfoByName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryTrustedDomainInfoByName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryTrustedDomainInfoByName,
-		(ndr_print_function_t) ndr_print_lsa_QueryTrustedDomainInfoByName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14006,7 +14006,7 @@
 		sizeof(struct lsa_SetTrustedDomainInfoByName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetTrustedDomainInfoByName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetTrustedDomainInfoByName,
-		(ndr_print_function_t) ndr_print_lsa_SetTrustedDomainInfoByName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14015,7 +14015,7 @@
 		sizeof(struct lsa_EnumTrustedDomainsEx),
 		(ndr_push_flags_fn_t) ndr_push_lsa_EnumTrustedDomainsEx,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_EnumTrustedDomainsEx,
-		(ndr_print_function_t) ndr_print_lsa_EnumTrustedDomainsEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14024,7 +14024,7 @@
 		sizeof(struct lsa_CreateTrustedDomainEx),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CreateTrustedDomainEx,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CreateTrustedDomainEx,
-		(ndr_print_function_t) ndr_print_lsa_CreateTrustedDomainEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14033,7 +14033,7 @@
 		sizeof(struct lsa_CloseTrustedDomainEx),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CloseTrustedDomainEx,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CloseTrustedDomainEx,
-		(ndr_print_function_t) ndr_print_lsa_CloseTrustedDomainEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14042,7 +14042,7 @@
 		sizeof(struct lsa_QueryDomainInformationPolicy),
 		(ndr_push_flags_fn_t) ndr_push_lsa_QueryDomainInformationPolicy,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_QueryDomainInformationPolicy,
-		(ndr_print_function_t) ndr_print_lsa_QueryDomainInformationPolicy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14051,7 +14051,7 @@
 		sizeof(struct lsa_SetDomainInformationPolicy),
 		(ndr_push_flags_fn_t) ndr_push_lsa_SetDomainInformationPolicy,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_SetDomainInformationPolicy,
-		(ndr_print_function_t) ndr_print_lsa_SetDomainInformationPolicy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14060,7 +14060,7 @@
 		sizeof(struct lsa_OpenTrustedDomainByName),
 		(ndr_push_flags_fn_t) ndr_push_lsa_OpenTrustedDomainByName,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_OpenTrustedDomainByName,
-		(ndr_print_function_t) ndr_print_lsa_OpenTrustedDomainByName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14069,7 +14069,7 @@
 		sizeof(struct lsa_TestCall),
 		(ndr_push_flags_fn_t) ndr_push_lsa_TestCall,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_TestCall,
-		(ndr_print_function_t) ndr_print_lsa_TestCall,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14078,7 +14078,7 @@
 		sizeof(struct lsa_LookupSids2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupSids2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupSids2,
-		(ndr_print_function_t) ndr_print_lsa_LookupSids2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14087,7 +14087,7 @@
 		sizeof(struct lsa_LookupNames2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupNames2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupNames2,
-		(ndr_print_function_t) ndr_print_lsa_LookupNames2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14096,7 +14096,7 @@
 		sizeof(struct lsa_CreateTrustedDomainEx2),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CreateTrustedDomainEx2,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CreateTrustedDomainEx2,
-		(ndr_print_function_t) ndr_print_lsa_CreateTrustedDomainEx2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14105,7 +14105,7 @@
 		sizeof(struct lsa_CREDRWRITE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRWRITE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRWRITE,
-		(ndr_print_function_t) ndr_print_lsa_CREDRWRITE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14114,7 +14114,7 @@
 		sizeof(struct lsa_CREDRREAD),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRREAD,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRREAD,
-		(ndr_print_function_t) ndr_print_lsa_CREDRREAD,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14123,7 +14123,7 @@
 		sizeof(struct lsa_CREDRENUMERATE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRENUMERATE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRENUMERATE,
-		(ndr_print_function_t) ndr_print_lsa_CREDRENUMERATE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14132,7 +14132,7 @@
 		sizeof(struct lsa_CREDRWRITEDOMAINCREDENTIALS),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRWRITEDOMAINCREDENTIALS,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRWRITEDOMAINCREDENTIALS,
-		(ndr_print_function_t) ndr_print_lsa_CREDRWRITEDOMAINCREDENTIALS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14141,7 +14141,7 @@
 		sizeof(struct lsa_CREDRREADDOMAINCREDENTIALS),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRREADDOMAINCREDENTIALS,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRREADDOMAINCREDENTIALS,
-		(ndr_print_function_t) ndr_print_lsa_CREDRREADDOMAINCREDENTIALS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14150,7 +14150,7 @@
 		sizeof(struct lsa_CREDRDELETE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRDELETE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRDELETE,
-		(ndr_print_function_t) ndr_print_lsa_CREDRDELETE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14159,7 +14159,7 @@
 		sizeof(struct lsa_CREDRGETTARGETINFO),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRGETTARGETINFO,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRGETTARGETINFO,
-		(ndr_print_function_t) ndr_print_lsa_CREDRGETTARGETINFO,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14168,7 +14168,7 @@
 		sizeof(struct lsa_CREDRPROFILELOADED),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRPROFILELOADED,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRPROFILELOADED,
-		(ndr_print_function_t) ndr_print_lsa_CREDRPROFILELOADED,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14177,7 +14177,7 @@
 		sizeof(struct lsa_LookupNames3),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupNames3,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupNames3,
-		(ndr_print_function_t) ndr_print_lsa_LookupNames3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14186,7 +14186,7 @@
 		sizeof(struct lsa_CREDRGETSESSIONTYPES),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRGETSESSIONTYPES,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRGETSESSIONTYPES,
-		(ndr_print_function_t) ndr_print_lsa_CREDRGETSESSIONTYPES,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14195,7 +14195,7 @@
 		sizeof(struct lsa_LSARREGISTERAUDITEVENT),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARREGISTERAUDITEVENT,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARREGISTERAUDITEVENT,
-		(ndr_print_function_t) ndr_print_lsa_LSARREGISTERAUDITEVENT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14204,7 +14204,7 @@
 		sizeof(struct lsa_LSARGENAUDITEVENT),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARGENAUDITEVENT,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARGENAUDITEVENT,
-		(ndr_print_function_t) ndr_print_lsa_LSARGENAUDITEVENT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14213,7 +14213,7 @@
 		sizeof(struct lsa_LSARUNREGISTERAUDITEVENT),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARUNREGISTERAUDITEVENT,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARUNREGISTERAUDITEVENT,
-		(ndr_print_function_t) ndr_print_lsa_LSARUNREGISTERAUDITEVENT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14222,7 +14222,7 @@
 		sizeof(struct lsa_lsaRQueryForestTrustInformation),
 		(ndr_push_flags_fn_t) ndr_push_lsa_lsaRQueryForestTrustInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_lsaRQueryForestTrustInformation,
-		(ndr_print_function_t) ndr_print_lsa_lsaRQueryForestTrustInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14231,7 +14231,7 @@
 		sizeof(struct lsa_lsaRSetForestTrustInformation),
 		(ndr_push_flags_fn_t) ndr_push_lsa_lsaRSetForestTrustInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_lsaRSetForestTrustInformation,
-		(ndr_print_function_t) ndr_print_lsa_lsaRSetForestTrustInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14240,7 +14240,7 @@
 		sizeof(struct lsa_CREDRRENAME),
 		(ndr_push_flags_fn_t) ndr_push_lsa_CREDRRENAME,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_CREDRRENAME,
-		(ndr_print_function_t) ndr_print_lsa_CREDRRENAME,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14249,7 +14249,7 @@
 		sizeof(struct lsa_LookupSids3),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupSids3,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupSids3,
-		(ndr_print_function_t) ndr_print_lsa_LookupSids3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14258,7 +14258,7 @@
 		sizeof(struct lsa_LookupNames4),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LookupNames4,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LookupNames4,
-		(ndr_print_function_t) ndr_print_lsa_LookupNames4,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14267,7 +14267,7 @@
 		sizeof(struct lsa_LSAROPENPOLICYSCE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSAROPENPOLICYSCE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSAROPENPOLICYSCE,
-		(ndr_print_function_t) ndr_print_lsa_LSAROPENPOLICYSCE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14276,7 +14276,7 @@
 		sizeof(struct lsa_LSARADTREGISTERSECURITYEVENTSOURCE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARADTREGISTERSECURITYEVENTSOURCE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARADTREGISTERSECURITYEVENTSOURCE,
-		(ndr_print_function_t) ndr_print_lsa_LSARADTREGISTERSECURITYEVENTSOURCE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14285,7 +14285,7 @@
 		sizeof(struct lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE,
-		(ndr_print_function_t) ndr_print_lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -14294,7 +14294,7 @@
 		sizeof(struct lsa_LSARADTREPORTSECURITYEVENT),
 		(ndr_push_flags_fn_t) ndr_push_lsa_LSARADTREPORTSECURITYEVENT,
 		(ndr_pull_flags_fn_t) ndr_pull_lsa_LSARADTREPORTSECURITYEVENT,
-		(ndr_print_function_t) ndr_print_lsa_LSARADTREPORTSECURITYEVENT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_mgmt.c samba3/source3/librpc/gen_ndr/ndr_mgmt.c
--- samba3/source3/librpc/gen_ndr/ndr_mgmt.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_mgmt.c	2024-08-04 17:52:53.000000000 +0200
@@ -515,7 +515,7 @@
 		sizeof(struct mgmt_inq_if_ids),
 		(ndr_push_flags_fn_t) ndr_push_mgmt_inq_if_ids,
 		(ndr_pull_flags_fn_t) ndr_pull_mgmt_inq_if_ids,
-		(ndr_print_function_t) ndr_print_mgmt_inq_if_ids,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -524,7 +524,7 @@
 		sizeof(struct mgmt_inq_stats),
 		(ndr_push_flags_fn_t) ndr_push_mgmt_inq_stats,
 		(ndr_pull_flags_fn_t) ndr_pull_mgmt_inq_stats,
-		(ndr_print_function_t) ndr_print_mgmt_inq_stats,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -533,7 +533,7 @@
 		sizeof(struct mgmt_is_server_listening),
 		(ndr_push_flags_fn_t) ndr_push_mgmt_is_server_listening,
 		(ndr_pull_flags_fn_t) ndr_pull_mgmt_is_server_listening,
-		(ndr_print_function_t) ndr_print_mgmt_is_server_listening,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -542,7 +542,7 @@
 		sizeof(struct mgmt_stop_server_listening),
 		(ndr_push_flags_fn_t) ndr_push_mgmt_stop_server_listening,
 		(ndr_pull_flags_fn_t) ndr_pull_mgmt_stop_server_listening,
-		(ndr_print_function_t) ndr_print_mgmt_stop_server_listening,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -551,7 +551,7 @@
 		sizeof(struct mgmt_inq_princ_name),
 		(ndr_push_flags_fn_t) ndr_push_mgmt_inq_princ_name,
 		(ndr_pull_flags_fn_t) ndr_pull_mgmt_inq_princ_name,
-		(ndr_print_function_t) ndr_print_mgmt_inq_princ_name,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_msgsvc.c samba3/source3/librpc/gen_ndr/ndr_msgsvc.c
--- samba3/source3/librpc/gen_ndr/ndr_msgsvc.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_msgsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -165,7 +165,7 @@
 		sizeof(struct NetrMessageNameAdd),
 		(ndr_push_flags_fn_t) ndr_push_NetrMessageNameAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrMessageNameAdd,
-		(ndr_print_function_t) ndr_print_NetrMessageNameAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -174,7 +174,7 @@
 		sizeof(struct NetrMessageNameEnum),
 		(ndr_push_flags_fn_t) ndr_push_NetrMessageNameEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrMessageNameEnum,
-		(ndr_print_function_t) ndr_print_NetrMessageNameEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -183,7 +183,7 @@
 		sizeof(struct NetrMessageNameGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_NetrMessageNameGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrMessageNameGetInfo,
-		(ndr_print_function_t) ndr_print_NetrMessageNameGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -192,7 +192,7 @@
 		sizeof(struct NetrMessageNameDel),
 		(ndr_push_flags_fn_t) ndr_push_NetrMessageNameDel,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrMessageNameDel,
-		(ndr_print_function_t) ndr_print_NetrMessageNameDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -276,7 +276,7 @@
 		sizeof(struct NetrSendMessage),
 		(ndr_push_flags_fn_t) ndr_push_NetrSendMessage,
 		(ndr_pull_flags_fn_t) ndr_pull_NetrSendMessage,
-		(ndr_print_function_t) ndr_print_NetrSendMessage,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_nbt.c samba3/source3/librpc/gen_ndr/ndr_nbt.c
--- samba3/source3/librpc/gen_ndr/ndr_nbt.c	2015-02-22 15:16:41.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_nbt.c	2024-08-04 17:52:53.000000000 +0200
@@ -3671,7 +3671,7 @@
 		sizeof(struct decode_nbt_netlogon_packet),
 		(ndr_push_flags_fn_t) ndr_push_decode_nbt_netlogon_packet,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_nbt_netlogon_packet,
-		(ndr_print_function_t) ndr_print_decode_nbt_netlogon_packet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_netlogon.c samba3/source3/librpc/gen_ndr/ndr_netlogon.c
--- samba3/source3/librpc/gen_ndr/ndr_netlogon.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_netlogon.c	2024-08-04 17:52:53.000000000 +0200
@@ -17827,7 +17827,7 @@
 		sizeof(struct netr_LogonUasLogon),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonUasLogon,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonUasLogon,
-		(ndr_print_function_t) ndr_print_netr_LogonUasLogon,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17836,7 +17836,7 @@
 		sizeof(struct netr_LogonUasLogoff),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonUasLogoff,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonUasLogoff,
-		(ndr_print_function_t) ndr_print_netr_LogonUasLogoff,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17845,7 +17845,7 @@
 		sizeof(struct netr_LogonSamLogon),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonSamLogon,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonSamLogon,
-		(ndr_print_function_t) ndr_print_netr_LogonSamLogon,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17854,7 +17854,7 @@
 		sizeof(struct netr_LogonSamLogoff),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonSamLogoff,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonSamLogoff,
-		(ndr_print_function_t) ndr_print_netr_LogonSamLogoff,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17863,7 +17863,7 @@
 		sizeof(struct netr_ServerReqChallenge),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerReqChallenge,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerReqChallenge,
-		(ndr_print_function_t) ndr_print_netr_ServerReqChallenge,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17872,7 +17872,7 @@
 		sizeof(struct netr_ServerAuthenticate),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerAuthenticate,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerAuthenticate,
-		(ndr_print_function_t) ndr_print_netr_ServerAuthenticate,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17881,7 +17881,7 @@
 		sizeof(struct netr_ServerPasswordSet),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerPasswordSet,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerPasswordSet,
-		(ndr_print_function_t) ndr_print_netr_ServerPasswordSet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17890,7 +17890,7 @@
 		sizeof(struct netr_DatabaseDeltas),
 		(ndr_push_flags_fn_t) ndr_push_netr_DatabaseDeltas,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DatabaseDeltas,
-		(ndr_print_function_t) ndr_print_netr_DatabaseDeltas,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17899,7 +17899,7 @@
 		sizeof(struct netr_DatabaseSync),
 		(ndr_push_flags_fn_t) ndr_push_netr_DatabaseSync,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DatabaseSync,
-		(ndr_print_function_t) ndr_print_netr_DatabaseSync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17908,7 +17908,7 @@
 		sizeof(struct netr_AccountDeltas),
 		(ndr_push_flags_fn_t) ndr_push_netr_AccountDeltas,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_AccountDeltas,
-		(ndr_print_function_t) ndr_print_netr_AccountDeltas,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17917,7 +17917,7 @@
 		sizeof(struct netr_AccountSync),
 		(ndr_push_flags_fn_t) ndr_push_netr_AccountSync,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_AccountSync,
-		(ndr_print_function_t) ndr_print_netr_AccountSync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17926,7 +17926,7 @@
 		sizeof(struct netr_GetDcName),
 		(ndr_push_flags_fn_t) ndr_push_netr_GetDcName,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_GetDcName,
-		(ndr_print_function_t) ndr_print_netr_GetDcName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17935,7 +17935,7 @@
 		sizeof(struct netr_LogonControl),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonControl,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonControl,
-		(ndr_print_function_t) ndr_print_netr_LogonControl,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17944,7 +17944,7 @@
 		sizeof(struct netr_GetAnyDCName),
 		(ndr_push_flags_fn_t) ndr_push_netr_GetAnyDCName,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_GetAnyDCName,
-		(ndr_print_function_t) ndr_print_netr_GetAnyDCName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17953,7 +17953,7 @@
 		sizeof(struct netr_LogonControl2),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonControl2,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonControl2,
-		(ndr_print_function_t) ndr_print_netr_LogonControl2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17962,7 +17962,7 @@
 		sizeof(struct netr_ServerAuthenticate2),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerAuthenticate2,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerAuthenticate2,
-		(ndr_print_function_t) ndr_print_netr_ServerAuthenticate2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17971,7 +17971,7 @@
 		sizeof(struct netr_DatabaseSync2),
 		(ndr_push_flags_fn_t) ndr_push_netr_DatabaseSync2,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DatabaseSync2,
-		(ndr_print_function_t) ndr_print_netr_DatabaseSync2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17980,7 +17980,7 @@
 		sizeof(struct netr_DatabaseRedo),
 		(ndr_push_flags_fn_t) ndr_push_netr_DatabaseRedo,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DatabaseRedo,
-		(ndr_print_function_t) ndr_print_netr_DatabaseRedo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17989,7 +17989,7 @@
 		sizeof(struct netr_LogonControl2Ex),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonControl2Ex,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonControl2Ex,
-		(ndr_print_function_t) ndr_print_netr_LogonControl2Ex,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -17998,7 +17998,7 @@
 		sizeof(struct netr_NetrEnumerateTrustedDomains),
 		(ndr_push_flags_fn_t) ndr_push_netr_NetrEnumerateTrustedDomains,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NetrEnumerateTrustedDomains,
-		(ndr_print_function_t) ndr_print_netr_NetrEnumerateTrustedDomains,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18007,7 +18007,7 @@
 		sizeof(struct netr_DsRGetDCName),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRGetDCName,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRGetDCName,
-		(ndr_print_function_t) ndr_print_netr_DsRGetDCName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18016,7 +18016,7 @@
 		sizeof(struct netr_LogonGetCapabilities),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonGetCapabilities,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonGetCapabilities,
-		(ndr_print_function_t) ndr_print_netr_LogonGetCapabilities,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18025,7 +18025,7 @@
 		sizeof(struct netr_NETRLOGONSETSERVICEBITS),
 		(ndr_push_flags_fn_t) ndr_push_netr_NETRLOGONSETSERVICEBITS,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NETRLOGONSETSERVICEBITS,
-		(ndr_print_function_t) ndr_print_netr_NETRLOGONSETSERVICEBITS,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18034,7 +18034,7 @@
 		sizeof(struct netr_LogonGetTrustRid),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonGetTrustRid,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonGetTrustRid,
-		(ndr_print_function_t) ndr_print_netr_LogonGetTrustRid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18043,7 +18043,7 @@
 		sizeof(struct netr_NETRLOGONCOMPUTESERVERDIGEST),
 		(ndr_push_flags_fn_t) ndr_push_netr_NETRLOGONCOMPUTESERVERDIGEST,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NETRLOGONCOMPUTESERVERDIGEST,
-		(ndr_print_function_t) ndr_print_netr_NETRLOGONCOMPUTESERVERDIGEST,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18052,7 +18052,7 @@
 		sizeof(struct netr_NETRLOGONCOMPUTECLIENTDIGEST),
 		(ndr_push_flags_fn_t) ndr_push_netr_NETRLOGONCOMPUTECLIENTDIGEST,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NETRLOGONCOMPUTECLIENTDIGEST,
-		(ndr_print_function_t) ndr_print_netr_NETRLOGONCOMPUTECLIENTDIGEST,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18061,7 +18061,7 @@
 		sizeof(struct netr_ServerAuthenticate3),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerAuthenticate3,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerAuthenticate3,
-		(ndr_print_function_t) ndr_print_netr_ServerAuthenticate3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18070,7 +18070,7 @@
 		sizeof(struct netr_DsRGetDCNameEx),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRGetDCNameEx,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRGetDCNameEx,
-		(ndr_print_function_t) ndr_print_netr_DsRGetDCNameEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18079,7 +18079,7 @@
 		sizeof(struct netr_DsRGetSiteName),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRGetSiteName,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRGetSiteName,
-		(ndr_print_function_t) ndr_print_netr_DsRGetSiteName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18088,7 +18088,7 @@
 		sizeof(struct netr_LogonGetDomainInfo),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonGetDomainInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonGetDomainInfo,
-		(ndr_print_function_t) ndr_print_netr_LogonGetDomainInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18097,7 +18097,7 @@
 		sizeof(struct netr_ServerPasswordSet2),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerPasswordSet2,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerPasswordSet2,
-		(ndr_print_function_t) ndr_print_netr_ServerPasswordSet2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18106,7 +18106,7 @@
 		sizeof(struct netr_ServerPasswordGet),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerPasswordGet,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerPasswordGet,
-		(ndr_print_function_t) ndr_print_netr_ServerPasswordGet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18115,7 +18115,7 @@
 		sizeof(struct netr_NETRLOGONSENDTOSAM),
 		(ndr_push_flags_fn_t) ndr_push_netr_NETRLOGONSENDTOSAM,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NETRLOGONSENDTOSAM,
-		(ndr_print_function_t) ndr_print_netr_NETRLOGONSENDTOSAM,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18124,7 +18124,7 @@
 		sizeof(struct netr_DsRAddressToSitenamesW),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRAddressToSitenamesW,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRAddressToSitenamesW,
-		(ndr_print_function_t) ndr_print_netr_DsRAddressToSitenamesW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18133,7 +18133,7 @@
 		sizeof(struct netr_DsRGetDCNameEx2),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRGetDCNameEx2,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRGetDCNameEx2,
-		(ndr_print_function_t) ndr_print_netr_DsRGetDCNameEx2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18142,7 +18142,7 @@
 		sizeof(struct netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN),
 		(ndr_push_flags_fn_t) ndr_push_netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN,
-		(ndr_print_function_t) ndr_print_netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18151,7 +18151,7 @@
 		sizeof(struct netr_NetrEnumerateTrustedDomainsEx),
 		(ndr_push_flags_fn_t) ndr_push_netr_NetrEnumerateTrustedDomainsEx,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_NetrEnumerateTrustedDomainsEx,
-		(ndr_print_function_t) ndr_print_netr_NetrEnumerateTrustedDomainsEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18160,7 +18160,7 @@
 		sizeof(struct netr_DsRAddressToSitenamesExW),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRAddressToSitenamesExW,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRAddressToSitenamesExW,
-		(ndr_print_function_t) ndr_print_netr_DsRAddressToSitenamesExW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18169,7 +18169,7 @@
 		sizeof(struct netr_DsrGetDcSiteCoverageW),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsrGetDcSiteCoverageW,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsrGetDcSiteCoverageW,
-		(ndr_print_function_t) ndr_print_netr_DsrGetDcSiteCoverageW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18178,7 +18178,7 @@
 		sizeof(struct netr_LogonSamLogonEx),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonSamLogonEx,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonSamLogonEx,
-		(ndr_print_function_t) ndr_print_netr_LogonSamLogonEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18187,7 +18187,7 @@
 		sizeof(struct netr_DsrEnumerateDomainTrusts),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsrEnumerateDomainTrusts,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsrEnumerateDomainTrusts,
-		(ndr_print_function_t) ndr_print_netr_DsrEnumerateDomainTrusts,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18196,7 +18196,7 @@
 		sizeof(struct netr_DsrDeregisterDNSHostRecords),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsrDeregisterDNSHostRecords,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsrDeregisterDNSHostRecords,
-		(ndr_print_function_t) ndr_print_netr_DsrDeregisterDNSHostRecords,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18205,7 +18205,7 @@
 		sizeof(struct netr_ServerTrustPasswordsGet),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerTrustPasswordsGet,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerTrustPasswordsGet,
-		(ndr_print_function_t) ndr_print_netr_ServerTrustPasswordsGet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18214,7 +18214,7 @@
 		sizeof(struct netr_DsRGetForestTrustInformation),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsRGetForestTrustInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsRGetForestTrustInformation,
-		(ndr_print_function_t) ndr_print_netr_DsRGetForestTrustInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18223,7 +18223,7 @@
 		sizeof(struct netr_GetForestTrustInformation),
 		(ndr_push_flags_fn_t) ndr_push_netr_GetForestTrustInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_GetForestTrustInformation,
-		(ndr_print_function_t) ndr_print_netr_GetForestTrustInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18232,7 +18232,7 @@
 		sizeof(struct netr_LogonSamLogonWithFlags),
 		(ndr_push_flags_fn_t) ndr_push_netr_LogonSamLogonWithFlags,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_LogonSamLogonWithFlags,
-		(ndr_print_function_t) ndr_print_netr_LogonSamLogonWithFlags,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18241,7 +18241,7 @@
 		sizeof(struct netr_ServerGetTrustInfo),
 		(ndr_push_flags_fn_t) ndr_push_netr_ServerGetTrustInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_ServerGetTrustInfo,
-		(ndr_print_function_t) ndr_print_netr_ServerGetTrustInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18250,7 +18250,7 @@
 		sizeof(struct netr_Unused47),
 		(ndr_push_flags_fn_t) ndr_push_netr_Unused47,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_Unused47,
-		(ndr_print_function_t) ndr_print_netr_Unused47,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -18259,7 +18259,7 @@
 		sizeof(struct netr_DsrUpdateReadOnlyServerDnsRecords),
 		(ndr_push_flags_fn_t) ndr_push_netr_DsrUpdateReadOnlyServerDnsRecords,
 		(ndr_pull_flags_fn_t) ndr_pull_netr_DsrUpdateReadOnlyServerDnsRecords,
-		(ndr_print_function_t) ndr_print_netr_DsrUpdateReadOnlyServerDnsRecords,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_ntlmssp.c samba3/source3/librpc/gen_ndr/ndr_ntlmssp.c
--- samba3/source3/librpc/gen_ndr/ndr_ntlmssp.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_ntlmssp.c	2024-08-04 17:52:53.000000000 +0200
@@ -2408,7 +2408,7 @@
 		sizeof(struct decode_NEGOTIATE_MESSAGE),
 		(ndr_push_flags_fn_t) ndr_push_decode_NEGOTIATE_MESSAGE,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_NEGOTIATE_MESSAGE,
-		(ndr_print_function_t) ndr_print_decode_NEGOTIATE_MESSAGE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2417,7 +2417,7 @@
 		sizeof(struct decode_CHALLENGE_MESSAGE),
 		(ndr_push_flags_fn_t) ndr_push_decode_CHALLENGE_MESSAGE,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_CHALLENGE_MESSAGE,
-		(ndr_print_function_t) ndr_print_decode_CHALLENGE_MESSAGE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2426,7 +2426,7 @@
 		sizeof(struct decode_AUTHENTICATE_MESSAGE),
 		(ndr_push_flags_fn_t) ndr_push_decode_AUTHENTICATE_MESSAGE,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_AUTHENTICATE_MESSAGE,
-		(ndr_print_function_t) ndr_print_decode_AUTHENTICATE_MESSAGE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2435,7 +2435,7 @@
 		sizeof(struct decode_NTLMv2_CLIENT_CHALLENGE),
 		(ndr_push_flags_fn_t) ndr_push_decode_NTLMv2_CLIENT_CHALLENGE,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_NTLMv2_CLIENT_CHALLENGE,
-		(ndr_print_function_t) ndr_print_decode_NTLMv2_CLIENT_CHALLENGE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -2444,7 +2444,7 @@
 		sizeof(struct decode_NTLMv2_RESPONSE),
 		(ndr_push_flags_fn_t) ndr_push_decode_NTLMv2_RESPONSE,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_NTLMv2_RESPONSE,
-		(ndr_print_function_t) ndr_print_decode_NTLMv2_RESPONSE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_ntprinting.c samba3/source3/librpc/gen_ndr/ndr_ntprinting.c
--- samba3/source3/librpc/gen_ndr/ndr_ntprinting.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_ntprinting.c	2024-08-04 17:52:53.000000000 +0200
@@ -914,7 +914,7 @@
 		sizeof(struct decode_ntprinting_form),
 		(ndr_push_flags_fn_t) ndr_push_decode_ntprinting_form,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ntprinting_form,
-		(ndr_print_function_t) ndr_print_decode_ntprinting_form,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -923,7 +923,7 @@
 		sizeof(struct decode_ntprinting_driver),
 		(ndr_push_flags_fn_t) ndr_push_decode_ntprinting_driver,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ntprinting_driver,
-		(ndr_print_function_t) ndr_print_decode_ntprinting_driver,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -932,7 +932,7 @@
 		sizeof(struct decode_ntprinting_printer),
 		(ndr_push_flags_fn_t) ndr_push_decode_ntprinting_printer,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_ntprinting_printer,
-		(ndr_print_function_t) ndr_print_decode_ntprinting_printer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_ntsvcs.c samba3/source3/librpc/gen_ndr/ndr_ntsvcs.c
--- samba3/source3/librpc/gen_ndr/ndr_ntsvcs.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_ntsvcs.c	2024-08-04 17:52:53.000000000 +0200
@@ -3466,7 +3466,7 @@
 		sizeof(struct PNP_Disconnect),
 		(ndr_push_flags_fn_t) ndr_push_PNP_Disconnect,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_Disconnect,
-		(ndr_print_function_t) ndr_print_PNP_Disconnect,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3475,7 +3475,7 @@
 		sizeof(struct PNP_Connect),
 		(ndr_push_flags_fn_t) ndr_push_PNP_Connect,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_Connect,
-		(ndr_print_function_t) ndr_print_PNP_Connect,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3484,7 +3484,7 @@
 		sizeof(struct PNP_GetVersion),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetVersion,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetVersion,
-		(ndr_print_function_t) ndr_print_PNP_GetVersion,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3493,7 +3493,7 @@
 		sizeof(struct PNP_GetGlobalState),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetGlobalState,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetGlobalState,
-		(ndr_print_function_t) ndr_print_PNP_GetGlobalState,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3502,7 +3502,7 @@
 		sizeof(struct PNP_InitDetection),
 		(ndr_push_flags_fn_t) ndr_push_PNP_InitDetection,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_InitDetection,
-		(ndr_print_function_t) ndr_print_PNP_InitDetection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3511,7 +3511,7 @@
 		sizeof(struct PNP_ReportLogOn),
 		(ndr_push_flags_fn_t) ndr_push_PNP_ReportLogOn,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_ReportLogOn,
-		(ndr_print_function_t) ndr_print_PNP_ReportLogOn,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3520,7 +3520,7 @@
 		sizeof(struct PNP_ValidateDeviceInstance),
 		(ndr_push_flags_fn_t) ndr_push_PNP_ValidateDeviceInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_ValidateDeviceInstance,
-		(ndr_print_function_t) ndr_print_PNP_ValidateDeviceInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3529,7 +3529,7 @@
 		sizeof(struct PNP_GetRootDeviceInstance),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetRootDeviceInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetRootDeviceInstance,
-		(ndr_print_function_t) ndr_print_PNP_GetRootDeviceInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3538,7 +3538,7 @@
 		sizeof(struct PNP_GetRelatedDeviceInstance),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetRelatedDeviceInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetRelatedDeviceInstance,
-		(ndr_print_function_t) ndr_print_PNP_GetRelatedDeviceInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3547,7 +3547,7 @@
 		sizeof(struct PNP_EnumerateSubKeys),
 		(ndr_push_flags_fn_t) ndr_push_PNP_EnumerateSubKeys,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_EnumerateSubKeys,
-		(ndr_print_function_t) ndr_print_PNP_EnumerateSubKeys,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3556,7 +3556,7 @@
 		sizeof(struct PNP_GetDeviceList),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetDeviceList,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetDeviceList,
-		(ndr_print_function_t) ndr_print_PNP_GetDeviceList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3565,7 +3565,7 @@
 		sizeof(struct PNP_GetDeviceListSize),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetDeviceListSize,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetDeviceListSize,
-		(ndr_print_function_t) ndr_print_PNP_GetDeviceListSize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3574,7 +3574,7 @@
 		sizeof(struct PNP_GetDepth),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetDepth,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetDepth,
-		(ndr_print_function_t) ndr_print_PNP_GetDepth,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3583,7 +3583,7 @@
 		sizeof(struct PNP_GetDeviceRegProp),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetDeviceRegProp,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetDeviceRegProp,
-		(ndr_print_function_t) ndr_print_PNP_GetDeviceRegProp,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3592,7 +3592,7 @@
 		sizeof(struct PNP_SetDeviceRegProp),
 		(ndr_push_flags_fn_t) ndr_push_PNP_SetDeviceRegProp,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_SetDeviceRegProp,
-		(ndr_print_function_t) ndr_print_PNP_SetDeviceRegProp,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3601,7 +3601,7 @@
 		sizeof(struct PNP_GetClassInstance),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetClassInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetClassInstance,
-		(ndr_print_function_t) ndr_print_PNP_GetClassInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3610,7 +3610,7 @@
 		sizeof(struct PNP_CreateKey),
 		(ndr_push_flags_fn_t) ndr_push_PNP_CreateKey,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_CreateKey,
-		(ndr_print_function_t) ndr_print_PNP_CreateKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3619,7 +3619,7 @@
 		sizeof(struct PNP_DeleteRegistryKey),
 		(ndr_push_flags_fn_t) ndr_push_PNP_DeleteRegistryKey,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_DeleteRegistryKey,
-		(ndr_print_function_t) ndr_print_PNP_DeleteRegistryKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3628,7 +3628,7 @@
 		sizeof(struct PNP_GetClassCount),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetClassCount,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetClassCount,
-		(ndr_print_function_t) ndr_print_PNP_GetClassCount,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3637,7 +3637,7 @@
 		sizeof(struct PNP_GetClassName),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetClassName,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetClassName,
-		(ndr_print_function_t) ndr_print_PNP_GetClassName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3646,7 +3646,7 @@
 		sizeof(struct PNP_DeleteClassKey),
 		(ndr_push_flags_fn_t) ndr_push_PNP_DeleteClassKey,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_DeleteClassKey,
-		(ndr_print_function_t) ndr_print_PNP_DeleteClassKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3655,7 +3655,7 @@
 		sizeof(struct PNP_GetInterfaceDeviceAlias),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetInterfaceDeviceAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetInterfaceDeviceAlias,
-		(ndr_print_function_t) ndr_print_PNP_GetInterfaceDeviceAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3664,7 +3664,7 @@
 		sizeof(struct PNP_GetInterfaceDeviceList),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetInterfaceDeviceList,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetInterfaceDeviceList,
-		(ndr_print_function_t) ndr_print_PNP_GetInterfaceDeviceList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3673,7 +3673,7 @@
 		sizeof(struct PNP_GetInterfaceDeviceListSize),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetInterfaceDeviceListSize,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetInterfaceDeviceListSize,
-		(ndr_print_function_t) ndr_print_PNP_GetInterfaceDeviceListSize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3682,7 +3682,7 @@
 		sizeof(struct PNP_RegisterDeviceClassAssociation),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RegisterDeviceClassAssociation,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RegisterDeviceClassAssociation,
-		(ndr_print_function_t) ndr_print_PNP_RegisterDeviceClassAssociation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3691,7 +3691,7 @@
 		sizeof(struct PNP_UnregisterDeviceClassAssociation),
 		(ndr_push_flags_fn_t) ndr_push_PNP_UnregisterDeviceClassAssociation,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_UnregisterDeviceClassAssociation,
-		(ndr_print_function_t) ndr_print_PNP_UnregisterDeviceClassAssociation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3700,7 +3700,7 @@
 		sizeof(struct PNP_GetClassRegProp),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetClassRegProp,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetClassRegProp,
-		(ndr_print_function_t) ndr_print_PNP_GetClassRegProp,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3709,7 +3709,7 @@
 		sizeof(struct PNP_SetClassRegProp),
 		(ndr_push_flags_fn_t) ndr_push_PNP_SetClassRegProp,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_SetClassRegProp,
-		(ndr_print_function_t) ndr_print_PNP_SetClassRegProp,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3718,7 +3718,7 @@
 		sizeof(struct PNP_CreateDevInst),
 		(ndr_push_flags_fn_t) ndr_push_PNP_CreateDevInst,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_CreateDevInst,
-		(ndr_print_function_t) ndr_print_PNP_CreateDevInst,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3727,7 +3727,7 @@
 		sizeof(struct PNP_DeviceInstanceAction),
 		(ndr_push_flags_fn_t) ndr_push_PNP_DeviceInstanceAction,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_DeviceInstanceAction,
-		(ndr_print_function_t) ndr_print_PNP_DeviceInstanceAction,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3736,7 +3736,7 @@
 		sizeof(struct PNP_GetDeviceStatus),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetDeviceStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetDeviceStatus,
-		(ndr_print_function_t) ndr_print_PNP_GetDeviceStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3745,7 +3745,7 @@
 		sizeof(struct PNP_SetDeviceProblem),
 		(ndr_push_flags_fn_t) ndr_push_PNP_SetDeviceProblem,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_SetDeviceProblem,
-		(ndr_print_function_t) ndr_print_PNP_SetDeviceProblem,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3754,7 +3754,7 @@
 		sizeof(struct PNP_DisableDevInst),
 		(ndr_push_flags_fn_t) ndr_push_PNP_DisableDevInst,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_DisableDevInst,
-		(ndr_print_function_t) ndr_print_PNP_DisableDevInst,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3763,7 +3763,7 @@
 		sizeof(struct PNP_UninstallDevInst),
 		(ndr_push_flags_fn_t) ndr_push_PNP_UninstallDevInst,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_UninstallDevInst,
-		(ndr_print_function_t) ndr_print_PNP_UninstallDevInst,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3772,7 +3772,7 @@
 		sizeof(struct PNP_AddID),
 		(ndr_push_flags_fn_t) ndr_push_PNP_AddID,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_AddID,
-		(ndr_print_function_t) ndr_print_PNP_AddID,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3781,7 +3781,7 @@
 		sizeof(struct PNP_RegisterDriver),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RegisterDriver,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RegisterDriver,
-		(ndr_print_function_t) ndr_print_PNP_RegisterDriver,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3790,7 +3790,7 @@
 		sizeof(struct PNP_QueryRemove),
 		(ndr_push_flags_fn_t) ndr_push_PNP_QueryRemove,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_QueryRemove,
-		(ndr_print_function_t) ndr_print_PNP_QueryRemove,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3799,7 +3799,7 @@
 		sizeof(struct PNP_RequestDeviceEject),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RequestDeviceEject,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RequestDeviceEject,
-		(ndr_print_function_t) ndr_print_PNP_RequestDeviceEject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3808,7 +3808,7 @@
 		sizeof(struct PNP_IsDockStationPresent),
 		(ndr_push_flags_fn_t) ndr_push_PNP_IsDockStationPresent,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_IsDockStationPresent,
-		(ndr_print_function_t) ndr_print_PNP_IsDockStationPresent,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3817,7 +3817,7 @@
 		sizeof(struct PNP_RequestEjectPC),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RequestEjectPC,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RequestEjectPC,
-		(ndr_print_function_t) ndr_print_PNP_RequestEjectPC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3826,7 +3826,7 @@
 		sizeof(struct PNP_HwProfFlags),
 		(ndr_push_flags_fn_t) ndr_push_PNP_HwProfFlags,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_HwProfFlags,
-		(ndr_print_function_t) ndr_print_PNP_HwProfFlags,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3835,7 +3835,7 @@
 		sizeof(struct PNP_GetHwProfInfo),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetHwProfInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetHwProfInfo,
-		(ndr_print_function_t) ndr_print_PNP_GetHwProfInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3844,7 +3844,7 @@
 		sizeof(struct PNP_AddEmptyLogConf),
 		(ndr_push_flags_fn_t) ndr_push_PNP_AddEmptyLogConf,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_AddEmptyLogConf,
-		(ndr_print_function_t) ndr_print_PNP_AddEmptyLogConf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3853,7 +3853,7 @@
 		sizeof(struct PNP_FreeLogConf),
 		(ndr_push_flags_fn_t) ndr_push_PNP_FreeLogConf,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_FreeLogConf,
-		(ndr_print_function_t) ndr_print_PNP_FreeLogConf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3862,7 +3862,7 @@
 		sizeof(struct PNP_GetFirstLogConf),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetFirstLogConf,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetFirstLogConf,
-		(ndr_print_function_t) ndr_print_PNP_GetFirstLogConf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3871,7 +3871,7 @@
 		sizeof(struct PNP_GetNextLogConf),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetNextLogConf,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetNextLogConf,
-		(ndr_print_function_t) ndr_print_PNP_GetNextLogConf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3880,7 +3880,7 @@
 		sizeof(struct PNP_GetLogConfPriority),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetLogConfPriority,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetLogConfPriority,
-		(ndr_print_function_t) ndr_print_PNP_GetLogConfPriority,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3889,7 +3889,7 @@
 		sizeof(struct PNP_AddResDes),
 		(ndr_push_flags_fn_t) ndr_push_PNP_AddResDes,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_AddResDes,
-		(ndr_print_function_t) ndr_print_PNP_AddResDes,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3898,7 +3898,7 @@
 		sizeof(struct PNP_FreeResDes),
 		(ndr_push_flags_fn_t) ndr_push_PNP_FreeResDes,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_FreeResDes,
-		(ndr_print_function_t) ndr_print_PNP_FreeResDes,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3907,7 +3907,7 @@
 		sizeof(struct PNP_GetNextResDes),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetNextResDes,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetNextResDes,
-		(ndr_print_function_t) ndr_print_PNP_GetNextResDes,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3916,7 +3916,7 @@
 		sizeof(struct PNP_GetResDesData),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetResDesData,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetResDesData,
-		(ndr_print_function_t) ndr_print_PNP_GetResDesData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3925,7 +3925,7 @@
 		sizeof(struct PNP_GetResDesDataSize),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetResDesDataSize,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetResDesDataSize,
-		(ndr_print_function_t) ndr_print_PNP_GetResDesDataSize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3934,7 +3934,7 @@
 		sizeof(struct PNP_ModifyResDes),
 		(ndr_push_flags_fn_t) ndr_push_PNP_ModifyResDes,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_ModifyResDes,
-		(ndr_print_function_t) ndr_print_PNP_ModifyResDes,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3943,7 +3943,7 @@
 		sizeof(struct PNP_DetectResourceLimit),
 		(ndr_push_flags_fn_t) ndr_push_PNP_DetectResourceLimit,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_DetectResourceLimit,
-		(ndr_print_function_t) ndr_print_PNP_DetectResourceLimit,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3952,7 +3952,7 @@
 		sizeof(struct PNP_QueryResConfList),
 		(ndr_push_flags_fn_t) ndr_push_PNP_QueryResConfList,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_QueryResConfList,
-		(ndr_print_function_t) ndr_print_PNP_QueryResConfList,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3961,7 +3961,7 @@
 		sizeof(struct PNP_SetHwProf),
 		(ndr_push_flags_fn_t) ndr_push_PNP_SetHwProf,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_SetHwProf,
-		(ndr_print_function_t) ndr_print_PNP_SetHwProf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3970,7 +3970,7 @@
 		sizeof(struct PNP_QueryArbitratorFreeData),
 		(ndr_push_flags_fn_t) ndr_push_PNP_QueryArbitratorFreeData,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_QueryArbitratorFreeData,
-		(ndr_print_function_t) ndr_print_PNP_QueryArbitratorFreeData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3979,7 +3979,7 @@
 		sizeof(struct PNP_QueryArbitratorFreeSize),
 		(ndr_push_flags_fn_t) ndr_push_PNP_QueryArbitratorFreeSize,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_QueryArbitratorFreeSize,
-		(ndr_print_function_t) ndr_print_PNP_QueryArbitratorFreeSize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3988,7 +3988,7 @@
 		sizeof(struct PNP_RunDetection),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RunDetection,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RunDetection,
-		(ndr_print_function_t) ndr_print_PNP_RunDetection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3997,7 +3997,7 @@
 		sizeof(struct PNP_RegisterNotification),
 		(ndr_push_flags_fn_t) ndr_push_PNP_RegisterNotification,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_RegisterNotification,
-		(ndr_print_function_t) ndr_print_PNP_RegisterNotification,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4006,7 +4006,7 @@
 		sizeof(struct PNP_UnregisterNotification),
 		(ndr_push_flags_fn_t) ndr_push_PNP_UnregisterNotification,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_UnregisterNotification,
-		(ndr_print_function_t) ndr_print_PNP_UnregisterNotification,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4015,7 +4015,7 @@
 		sizeof(struct PNP_GetCustomDevProp),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetCustomDevProp,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetCustomDevProp,
-		(ndr_print_function_t) ndr_print_PNP_GetCustomDevProp,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4024,7 +4024,7 @@
 		sizeof(struct PNP_GetVersionInternal),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetVersionInternal,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetVersionInternal,
-		(ndr_print_function_t) ndr_print_PNP_GetVersionInternal,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4033,7 +4033,7 @@
 		sizeof(struct PNP_GetBlockedDriverInfo),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetBlockedDriverInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetBlockedDriverInfo,
-		(ndr_print_function_t) ndr_print_PNP_GetBlockedDriverInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4042,7 +4042,7 @@
 		sizeof(struct PNP_GetServerSideDeviceInstallFlags),
 		(ndr_push_flags_fn_t) ndr_push_PNP_GetServerSideDeviceInstallFlags,
 		(ndr_pull_flags_fn_t) ndr_pull_PNP_GetServerSideDeviceInstallFlags,
-		(ndr_print_function_t) ndr_print_PNP_GetServerSideDeviceInstallFlags,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_oxidresolver.c samba3/source3/librpc/gen_ndr/ndr_oxidresolver.c
--- samba3/source3/librpc/gen_ndr/ndr_oxidresolver.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_oxidresolver.c	2024-08-04 17:52:53.000000000 +0200
@@ -761,7 +761,7 @@
 		sizeof(struct ResolveOxid),
 		(ndr_push_flags_fn_t) ndr_push_ResolveOxid,
 		(ndr_pull_flags_fn_t) ndr_pull_ResolveOxid,
-		(ndr_print_function_t) ndr_print_ResolveOxid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -770,7 +770,7 @@
 		sizeof(struct SimplePing),
 		(ndr_push_flags_fn_t) ndr_push_SimplePing,
 		(ndr_pull_flags_fn_t) ndr_pull_SimplePing,
-		(ndr_print_function_t) ndr_print_SimplePing,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -779,7 +779,7 @@
 		sizeof(struct ComplexPing),
 		(ndr_push_flags_fn_t) ndr_push_ComplexPing,
 		(ndr_pull_flags_fn_t) ndr_pull_ComplexPing,
-		(ndr_print_function_t) ndr_print_ComplexPing,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -788,7 +788,7 @@
 		sizeof(struct ServerAlive),
 		(ndr_push_flags_fn_t) ndr_push_ServerAlive,
 		(ndr_pull_flags_fn_t) ndr_pull_ServerAlive,
-		(ndr_print_function_t) ndr_print_ServerAlive,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -797,7 +797,7 @@
 		sizeof(struct ResolveOxid2),
 		(ndr_push_flags_fn_t) ndr_push_ResolveOxid2,
 		(ndr_pull_flags_fn_t) ndr_pull_ResolveOxid2,
-		(ndr_print_function_t) ndr_print_ResolveOxid2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -806,7 +806,7 @@
 		sizeof(struct ServerAlive2),
 		(ndr_push_flags_fn_t) ndr_push_ServerAlive2,
 		(ndr_pull_flags_fn_t) ndr_pull_ServerAlive2,
-		(ndr_print_function_t) ndr_print_ServerAlive2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_policyagent.c samba3/source3/librpc/gen_ndr/ndr_policyagent.c
--- samba3/source3/librpc/gen_ndr/ndr_policyagent.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_policyagent.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 		sizeof(struct policyagent_Dummy),
 		(ndr_push_flags_fn_t) ndr_push_policyagent_Dummy,
 		(ndr_pull_flags_fn_t) ndr_pull_policyagent_Dummy,
-		(ndr_print_function_t) ndr_print_policyagent_Dummy,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_preg.c samba3/source3/librpc/gen_ndr/ndr_preg.c
--- samba3/source3/librpc/gen_ndr/ndr_preg.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_preg.c	2024-08-04 17:52:53.000000000 +0200
@@ -204,7 +204,7 @@
 		sizeof(struct decode_preg_file),
 		(ndr_push_flags_fn_t) ndr_push_decode_preg_file,
 		(ndr_pull_flags_fn_t) ndr_pull_decode_preg_file,
-		(ndr_print_function_t) ndr_print_decode_preg_file,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_remact.c samba3/source3/librpc/gen_ndr/ndr_remact.c
--- samba3/source3/librpc/gen_ndr/ndr_remact.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_remact.c	2024-08-04 17:52:53.000000000 +0200
@@ -373,7 +373,7 @@
 		sizeof(struct RemoteActivation),
 		(ndr_push_flags_fn_t) ndr_push_RemoteActivation,
 		(ndr_pull_flags_fn_t) ndr_pull_RemoteActivation,
-		(ndr_print_function_t) ndr_print_RemoteActivation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_rot.c samba3/source3/librpc/gen_ndr/ndr_rot.c
--- samba3/source3/librpc/gen_ndr/ndr_rot.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_rot.c	2024-08-04 17:52:53.000000000 +0200
@@ -489,7 +489,7 @@
 		sizeof(struct rot_add),
 		(ndr_push_flags_fn_t) ndr_push_rot_add,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_add,
-		(ndr_print_function_t) ndr_print_rot_add,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -498,7 +498,7 @@
 		sizeof(struct rot_remove),
 		(ndr_push_flags_fn_t) ndr_push_rot_remove,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_remove,
-		(ndr_print_function_t) ndr_print_rot_remove,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -507,7 +507,7 @@
 		sizeof(struct rot_is_listed),
 		(ndr_push_flags_fn_t) ndr_push_rot_is_listed,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_is_listed,
-		(ndr_print_function_t) ndr_print_rot_is_listed,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -516,7 +516,7 @@
 		sizeof(struct rot_get_interface_pointer),
 		(ndr_push_flags_fn_t) ndr_push_rot_get_interface_pointer,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_get_interface_pointer,
-		(ndr_print_function_t) ndr_print_rot_get_interface_pointer,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -525,7 +525,7 @@
 		sizeof(struct rot_set_modification_time),
 		(ndr_push_flags_fn_t) ndr_push_rot_set_modification_time,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_set_modification_time,
-		(ndr_print_function_t) ndr_print_rot_set_modification_time,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -534,7 +534,7 @@
 		sizeof(struct rot_get_modification_time),
 		(ndr_push_flags_fn_t) ndr_push_rot_get_modification_time,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_get_modification_time,
-		(ndr_print_function_t) ndr_print_rot_get_modification_time,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -543,7 +543,7 @@
 		sizeof(struct rot_enum),
 		(ndr_push_flags_fn_t) ndr_push_rot_enum,
 		(ndr_pull_flags_fn_t) ndr_pull_rot_enum,
-		(ndr_print_function_t) ndr_print_rot_enum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_samr.c samba3/source3/librpc/gen_ndr/ndr_samr.c
--- samba3/source3/librpc/gen_ndr/ndr_samr.c	2015-02-22 15:16:44.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_samr.c	2024-08-04 17:52:53.000000000 +0200
@@ -12674,7 +12674,7 @@
 		sizeof(struct samr_Connect),
 		(ndr_push_flags_fn_t) ndr_push_samr_Connect,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Connect,
-		(ndr_print_function_t) ndr_print_samr_Connect,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12683,7 +12683,7 @@
 		sizeof(struct samr_Close),
 		(ndr_push_flags_fn_t) ndr_push_samr_Close,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Close,
-		(ndr_print_function_t) ndr_print_samr_Close,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12692,7 +12692,7 @@
 		sizeof(struct samr_SetSecurity),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetSecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetSecurity,
-		(ndr_print_function_t) ndr_print_samr_SetSecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12701,7 +12701,7 @@
 		sizeof(struct samr_QuerySecurity),
 		(ndr_push_flags_fn_t) ndr_push_samr_QuerySecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QuerySecurity,
-		(ndr_print_function_t) ndr_print_samr_QuerySecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12710,7 +12710,7 @@
 		sizeof(struct samr_Shutdown),
 		(ndr_push_flags_fn_t) ndr_push_samr_Shutdown,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Shutdown,
-		(ndr_print_function_t) ndr_print_samr_Shutdown,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12719,7 +12719,7 @@
 		sizeof(struct samr_LookupDomain),
 		(ndr_push_flags_fn_t) ndr_push_samr_LookupDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_LookupDomain,
-		(ndr_print_function_t) ndr_print_samr_LookupDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12728,7 +12728,7 @@
 		sizeof(struct samr_EnumDomains),
 		(ndr_push_flags_fn_t) ndr_push_samr_EnumDomains,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_EnumDomains,
-		(ndr_print_function_t) ndr_print_samr_EnumDomains,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12737,7 +12737,7 @@
 		sizeof(struct samr_OpenDomain),
 		(ndr_push_flags_fn_t) ndr_push_samr_OpenDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_OpenDomain,
-		(ndr_print_function_t) ndr_print_samr_OpenDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12746,7 +12746,7 @@
 		sizeof(struct samr_QueryDomainInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryDomainInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryDomainInfo,
-		(ndr_print_function_t) ndr_print_samr_QueryDomainInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12755,7 +12755,7 @@
 		sizeof(struct samr_SetDomainInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetDomainInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetDomainInfo,
-		(ndr_print_function_t) ndr_print_samr_SetDomainInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12764,7 +12764,7 @@
 		sizeof(struct samr_CreateDomainGroup),
 		(ndr_push_flags_fn_t) ndr_push_samr_CreateDomainGroup,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_CreateDomainGroup,
-		(ndr_print_function_t) ndr_print_samr_CreateDomainGroup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12773,7 +12773,7 @@
 		sizeof(struct samr_EnumDomainGroups),
 		(ndr_push_flags_fn_t) ndr_push_samr_EnumDomainGroups,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_EnumDomainGroups,
-		(ndr_print_function_t) ndr_print_samr_EnumDomainGroups,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12782,7 +12782,7 @@
 		sizeof(struct samr_CreateUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_CreateUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_CreateUser,
-		(ndr_print_function_t) ndr_print_samr_CreateUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12791,7 +12791,7 @@
 		sizeof(struct samr_EnumDomainUsers),
 		(ndr_push_flags_fn_t) ndr_push_samr_EnumDomainUsers,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_EnumDomainUsers,
-		(ndr_print_function_t) ndr_print_samr_EnumDomainUsers,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12800,7 +12800,7 @@
 		sizeof(struct samr_CreateDomAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_CreateDomAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_CreateDomAlias,
-		(ndr_print_function_t) ndr_print_samr_CreateDomAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12809,7 +12809,7 @@
 		sizeof(struct samr_EnumDomainAliases),
 		(ndr_push_flags_fn_t) ndr_push_samr_EnumDomainAliases,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_EnumDomainAliases,
-		(ndr_print_function_t) ndr_print_samr_EnumDomainAliases,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12818,7 +12818,7 @@
 		sizeof(struct samr_GetAliasMembership),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetAliasMembership,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetAliasMembership,
-		(ndr_print_function_t) ndr_print_samr_GetAliasMembership,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12827,7 +12827,7 @@
 		sizeof(struct samr_LookupNames),
 		(ndr_push_flags_fn_t) ndr_push_samr_LookupNames,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_LookupNames,
-		(ndr_print_function_t) ndr_print_samr_LookupNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12836,7 +12836,7 @@
 		sizeof(struct samr_LookupRids),
 		(ndr_push_flags_fn_t) ndr_push_samr_LookupRids,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_LookupRids,
-		(ndr_print_function_t) ndr_print_samr_LookupRids,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12845,7 +12845,7 @@
 		sizeof(struct samr_OpenGroup),
 		(ndr_push_flags_fn_t) ndr_push_samr_OpenGroup,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_OpenGroup,
-		(ndr_print_function_t) ndr_print_samr_OpenGroup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12854,7 +12854,7 @@
 		sizeof(struct samr_QueryGroupInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryGroupInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryGroupInfo,
-		(ndr_print_function_t) ndr_print_samr_QueryGroupInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12863,7 +12863,7 @@
 		sizeof(struct samr_SetGroupInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetGroupInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetGroupInfo,
-		(ndr_print_function_t) ndr_print_samr_SetGroupInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12872,7 +12872,7 @@
 		sizeof(struct samr_AddGroupMember),
 		(ndr_push_flags_fn_t) ndr_push_samr_AddGroupMember,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_AddGroupMember,
-		(ndr_print_function_t) ndr_print_samr_AddGroupMember,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12881,7 +12881,7 @@
 		sizeof(struct samr_DeleteDomainGroup),
 		(ndr_push_flags_fn_t) ndr_push_samr_DeleteDomainGroup,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_DeleteDomainGroup,
-		(ndr_print_function_t) ndr_print_samr_DeleteDomainGroup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12890,7 +12890,7 @@
 		sizeof(struct samr_DeleteGroupMember),
 		(ndr_push_flags_fn_t) ndr_push_samr_DeleteGroupMember,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_DeleteGroupMember,
-		(ndr_print_function_t) ndr_print_samr_DeleteGroupMember,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12899,7 +12899,7 @@
 		sizeof(struct samr_QueryGroupMember),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryGroupMember,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryGroupMember,
-		(ndr_print_function_t) ndr_print_samr_QueryGroupMember,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12908,7 +12908,7 @@
 		sizeof(struct samr_SetMemberAttributesOfGroup),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetMemberAttributesOfGroup,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetMemberAttributesOfGroup,
-		(ndr_print_function_t) ndr_print_samr_SetMemberAttributesOfGroup,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12917,7 +12917,7 @@
 		sizeof(struct samr_OpenAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_OpenAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_OpenAlias,
-		(ndr_print_function_t) ndr_print_samr_OpenAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12926,7 +12926,7 @@
 		sizeof(struct samr_QueryAliasInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryAliasInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryAliasInfo,
-		(ndr_print_function_t) ndr_print_samr_QueryAliasInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12935,7 +12935,7 @@
 		sizeof(struct samr_SetAliasInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetAliasInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetAliasInfo,
-		(ndr_print_function_t) ndr_print_samr_SetAliasInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12944,7 +12944,7 @@
 		sizeof(struct samr_DeleteDomAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_DeleteDomAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_DeleteDomAlias,
-		(ndr_print_function_t) ndr_print_samr_DeleteDomAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12953,7 +12953,7 @@
 		sizeof(struct samr_AddAliasMember),
 		(ndr_push_flags_fn_t) ndr_push_samr_AddAliasMember,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_AddAliasMember,
-		(ndr_print_function_t) ndr_print_samr_AddAliasMember,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12962,7 +12962,7 @@
 		sizeof(struct samr_DeleteAliasMember),
 		(ndr_push_flags_fn_t) ndr_push_samr_DeleteAliasMember,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_DeleteAliasMember,
-		(ndr_print_function_t) ndr_print_samr_DeleteAliasMember,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12971,7 +12971,7 @@
 		sizeof(struct samr_GetMembersInAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetMembersInAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetMembersInAlias,
-		(ndr_print_function_t) ndr_print_samr_GetMembersInAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12980,7 +12980,7 @@
 		sizeof(struct samr_OpenUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_OpenUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_OpenUser,
-		(ndr_print_function_t) ndr_print_samr_OpenUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12989,7 +12989,7 @@
 		sizeof(struct samr_DeleteUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_DeleteUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_DeleteUser,
-		(ndr_print_function_t) ndr_print_samr_DeleteUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -12998,7 +12998,7 @@
 		sizeof(struct samr_QueryUserInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryUserInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryUserInfo,
-		(ndr_print_function_t) ndr_print_samr_QueryUserInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13007,7 +13007,7 @@
 		sizeof(struct samr_SetUserInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetUserInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetUserInfo,
-		(ndr_print_function_t) ndr_print_samr_SetUserInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13016,7 +13016,7 @@
 		sizeof(struct samr_ChangePasswordUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_ChangePasswordUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_ChangePasswordUser,
-		(ndr_print_function_t) ndr_print_samr_ChangePasswordUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13025,7 +13025,7 @@
 		sizeof(struct samr_GetGroupsForUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetGroupsForUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetGroupsForUser,
-		(ndr_print_function_t) ndr_print_samr_GetGroupsForUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13034,7 +13034,7 @@
 		sizeof(struct samr_QueryDisplayInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryDisplayInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryDisplayInfo,
-		(ndr_print_function_t) ndr_print_samr_QueryDisplayInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13043,7 +13043,7 @@
 		sizeof(struct samr_GetDisplayEnumerationIndex),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetDisplayEnumerationIndex,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetDisplayEnumerationIndex,
-		(ndr_print_function_t) ndr_print_samr_GetDisplayEnumerationIndex,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13052,7 +13052,7 @@
 		sizeof(struct samr_TestPrivateFunctionsDomain),
 		(ndr_push_flags_fn_t) ndr_push_samr_TestPrivateFunctionsDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_TestPrivateFunctionsDomain,
-		(ndr_print_function_t) ndr_print_samr_TestPrivateFunctionsDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13061,7 +13061,7 @@
 		sizeof(struct samr_TestPrivateFunctionsUser),
 		(ndr_push_flags_fn_t) ndr_push_samr_TestPrivateFunctionsUser,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_TestPrivateFunctionsUser,
-		(ndr_print_function_t) ndr_print_samr_TestPrivateFunctionsUser,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13070,7 +13070,7 @@
 		sizeof(struct samr_GetUserPwInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetUserPwInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetUserPwInfo,
-		(ndr_print_function_t) ndr_print_samr_GetUserPwInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13079,7 +13079,7 @@
 		sizeof(struct samr_RemoveMemberFromForeignDomain),
 		(ndr_push_flags_fn_t) ndr_push_samr_RemoveMemberFromForeignDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_RemoveMemberFromForeignDomain,
-		(ndr_print_function_t) ndr_print_samr_RemoveMemberFromForeignDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13088,7 +13088,7 @@
 		sizeof(struct samr_QueryDomainInfo2),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryDomainInfo2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryDomainInfo2,
-		(ndr_print_function_t) ndr_print_samr_QueryDomainInfo2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13097,7 +13097,7 @@
 		sizeof(struct samr_QueryUserInfo2),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryUserInfo2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryUserInfo2,
-		(ndr_print_function_t) ndr_print_samr_QueryUserInfo2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13106,7 +13106,7 @@
 		sizeof(struct samr_QueryDisplayInfo2),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryDisplayInfo2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryDisplayInfo2,
-		(ndr_print_function_t) ndr_print_samr_QueryDisplayInfo2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13115,7 +13115,7 @@
 		sizeof(struct samr_GetDisplayEnumerationIndex2),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetDisplayEnumerationIndex2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetDisplayEnumerationIndex2,
-		(ndr_print_function_t) ndr_print_samr_GetDisplayEnumerationIndex2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13124,7 +13124,7 @@
 		sizeof(struct samr_CreateUser2),
 		(ndr_push_flags_fn_t) ndr_push_samr_CreateUser2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_CreateUser2,
-		(ndr_print_function_t) ndr_print_samr_CreateUser2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13133,7 +13133,7 @@
 		sizeof(struct samr_QueryDisplayInfo3),
 		(ndr_push_flags_fn_t) ndr_push_samr_QueryDisplayInfo3,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_QueryDisplayInfo3,
-		(ndr_print_function_t) ndr_print_samr_QueryDisplayInfo3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13142,7 +13142,7 @@
 		sizeof(struct samr_AddMultipleMembersToAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_AddMultipleMembersToAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_AddMultipleMembersToAlias,
-		(ndr_print_function_t) ndr_print_samr_AddMultipleMembersToAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13151,7 +13151,7 @@
 		sizeof(struct samr_RemoveMultipleMembersFromAlias),
 		(ndr_push_flags_fn_t) ndr_push_samr_RemoveMultipleMembersFromAlias,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_RemoveMultipleMembersFromAlias,
-		(ndr_print_function_t) ndr_print_samr_RemoveMultipleMembersFromAlias,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13160,7 +13160,7 @@
 		sizeof(struct samr_OemChangePasswordUser2),
 		(ndr_push_flags_fn_t) ndr_push_samr_OemChangePasswordUser2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_OemChangePasswordUser2,
-		(ndr_print_function_t) ndr_print_samr_OemChangePasswordUser2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13169,7 +13169,7 @@
 		sizeof(struct samr_ChangePasswordUser2),
 		(ndr_push_flags_fn_t) ndr_push_samr_ChangePasswordUser2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_ChangePasswordUser2,
-		(ndr_print_function_t) ndr_print_samr_ChangePasswordUser2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13178,7 +13178,7 @@
 		sizeof(struct samr_GetDomPwInfo),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetDomPwInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetDomPwInfo,
-		(ndr_print_function_t) ndr_print_samr_GetDomPwInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13187,7 +13187,7 @@
 		sizeof(struct samr_Connect2),
 		(ndr_push_flags_fn_t) ndr_push_samr_Connect2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Connect2,
-		(ndr_print_function_t) ndr_print_samr_Connect2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13196,7 +13196,7 @@
 		sizeof(struct samr_SetUserInfo2),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetUserInfo2,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetUserInfo2,
-		(ndr_print_function_t) ndr_print_samr_SetUserInfo2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13205,7 +13205,7 @@
 		sizeof(struct samr_SetBootKeyInformation),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetBootKeyInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetBootKeyInformation,
-		(ndr_print_function_t) ndr_print_samr_SetBootKeyInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13214,7 +13214,7 @@
 		sizeof(struct samr_GetBootKeyInformation),
 		(ndr_push_flags_fn_t) ndr_push_samr_GetBootKeyInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_GetBootKeyInformation,
-		(ndr_print_function_t) ndr_print_samr_GetBootKeyInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13223,7 +13223,7 @@
 		sizeof(struct samr_Connect3),
 		(ndr_push_flags_fn_t) ndr_push_samr_Connect3,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Connect3,
-		(ndr_print_function_t) ndr_print_samr_Connect3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13232,7 +13232,7 @@
 		sizeof(struct samr_Connect4),
 		(ndr_push_flags_fn_t) ndr_push_samr_Connect4,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Connect4,
-		(ndr_print_function_t) ndr_print_samr_Connect4,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13241,7 +13241,7 @@
 		sizeof(struct samr_ChangePasswordUser3),
 		(ndr_push_flags_fn_t) ndr_push_samr_ChangePasswordUser3,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_ChangePasswordUser3,
-		(ndr_print_function_t) ndr_print_samr_ChangePasswordUser3,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13250,7 +13250,7 @@
 		sizeof(struct samr_Connect5),
 		(ndr_push_flags_fn_t) ndr_push_samr_Connect5,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_Connect5,
-		(ndr_print_function_t) ndr_print_samr_Connect5,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13259,7 +13259,7 @@
 		sizeof(struct samr_RidToSid),
 		(ndr_push_flags_fn_t) ndr_push_samr_RidToSid,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_RidToSid,
-		(ndr_print_function_t) ndr_print_samr_RidToSid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13268,7 +13268,7 @@
 		sizeof(struct samr_SetDsrmPassword),
 		(ndr_push_flags_fn_t) ndr_push_samr_SetDsrmPassword,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_SetDsrmPassword,
-		(ndr_print_function_t) ndr_print_samr_SetDsrmPassword,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -13277,7 +13277,7 @@
 		sizeof(struct samr_ValidatePassword),
 		(ndr_push_flags_fn_t) ndr_push_samr_ValidatePassword,
 		(ndr_pull_flags_fn_t) ndr_pull_samr_ValidatePassword,
-		(ndr_print_function_t) ndr_print_samr_ValidatePassword,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_scerpc.c samba3/source3/librpc/gen_ndr/ndr_scerpc.c
--- samba3/source3/librpc/gen_ndr/ndr_scerpc.c	2015-02-22 15:16:44.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_scerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 		sizeof(struct scerpc_Unknown0),
 		(ndr_push_flags_fn_t) ndr_push_scerpc_Unknown0,
 		(ndr_pull_flags_fn_t) ndr_pull_scerpc_Unknown0,
-		(ndr_print_function_t) ndr_print_scerpc_Unknown0,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_spoolss.c samba3/source3/librpc/gen_ndr/ndr_spoolss.c
--- samba3/source3/librpc/gen_ndr/ndr_spoolss.c	2015-02-22 15:16:49.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_spoolss.c	2024-08-04 17:52:53.000000000 +0200
@@ -32661,7 +32661,7 @@
 		sizeof(struct spoolss_EnumPrinters),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrinters,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrinters,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrinters,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32670,7 +32670,7 @@
 		sizeof(struct spoolss_OpenPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_OpenPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_OpenPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_OpenPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32679,7 +32679,7 @@
 		sizeof(struct spoolss_SetJob),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetJob,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetJob,
-		(ndr_print_function_t) ndr_print_spoolss_SetJob,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32688,7 +32688,7 @@
 		sizeof(struct spoolss_GetJob),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetJob,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetJob,
-		(ndr_print_function_t) ndr_print_spoolss_GetJob,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32697,7 +32697,7 @@
 		sizeof(struct spoolss_EnumJobs),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumJobs,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumJobs,
-		(ndr_print_function_t) ndr_print_spoolss_EnumJobs,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32706,7 +32706,7 @@
 		sizeof(struct spoolss_AddPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32715,7 +32715,7 @@
 		sizeof(struct spoolss_DeletePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32724,7 +32724,7 @@
 		sizeof(struct spoolss_SetPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_SetPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32733,7 +32733,7 @@
 		sizeof(struct spoolss_GetPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32742,7 +32742,7 @@
 		sizeof(struct spoolss_AddPrinterDriver),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrinterDriver,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrinterDriver,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrinterDriver,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32751,7 +32751,7 @@
 		sizeof(struct spoolss_EnumPrinterDrivers),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrinterDrivers,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrinterDrivers,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrinterDrivers,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32760,7 +32760,7 @@
 		sizeof(struct spoolss_GetPrinterDriver),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterDriver,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterDriver,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterDriver,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32769,7 +32769,7 @@
 		sizeof(struct spoolss_GetPrinterDriverDirectory),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterDriverDirectory,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterDriverDirectory,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterDriverDirectory,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32778,7 +32778,7 @@
 		sizeof(struct spoolss_DeletePrinterDriver),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterDriver,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterDriver,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterDriver,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32787,7 +32787,7 @@
 		sizeof(struct spoolss_AddPrintProcessor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrintProcessor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrintProcessor,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrintProcessor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32796,7 +32796,7 @@
 		sizeof(struct spoolss_EnumPrintProcessors),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrintProcessors,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrintProcessors,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrintProcessors,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32805,7 +32805,7 @@
 		sizeof(struct spoolss_GetPrintProcessorDirectory),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrintProcessorDirectory,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrintProcessorDirectory,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrintProcessorDirectory,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32814,7 +32814,7 @@
 		sizeof(struct spoolss_StartDocPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_StartDocPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_StartDocPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_StartDocPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32823,7 +32823,7 @@
 		sizeof(struct spoolss_StartPagePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_StartPagePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_StartPagePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_StartPagePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32832,7 +32832,7 @@
 		sizeof(struct spoolss_WritePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_WritePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_WritePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_WritePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32841,7 +32841,7 @@
 		sizeof(struct spoolss_EndPagePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EndPagePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EndPagePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_EndPagePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32850,7 +32850,7 @@
 		sizeof(struct spoolss_AbortPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AbortPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AbortPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_AbortPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32859,7 +32859,7 @@
 		sizeof(struct spoolss_ReadPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ReadPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ReadPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_ReadPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32868,7 +32868,7 @@
 		sizeof(struct spoolss_EndDocPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EndDocPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EndDocPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_EndDocPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32877,7 +32877,7 @@
 		sizeof(struct spoolss_AddJob),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddJob,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddJob,
-		(ndr_print_function_t) ndr_print_spoolss_AddJob,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32886,7 +32886,7 @@
 		sizeof(struct spoolss_ScheduleJob),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ScheduleJob,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ScheduleJob,
-		(ndr_print_function_t) ndr_print_spoolss_ScheduleJob,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32895,7 +32895,7 @@
 		sizeof(struct spoolss_GetPrinterData),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterData,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterData,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32904,7 +32904,7 @@
 		sizeof(struct spoolss_SetPrinterData),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetPrinterData,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetPrinterData,
-		(ndr_print_function_t) ndr_print_spoolss_SetPrinterData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32913,7 +32913,7 @@
 		sizeof(struct spoolss_WaitForPrinterChange),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_WaitForPrinterChange,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_WaitForPrinterChange,
-		(ndr_print_function_t) ndr_print_spoolss_WaitForPrinterChange,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32922,7 +32922,7 @@
 		sizeof(struct spoolss_ClosePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ClosePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ClosePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_ClosePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32931,7 +32931,7 @@
 		sizeof(struct spoolss_AddForm),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddForm,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddForm,
-		(ndr_print_function_t) ndr_print_spoolss_AddForm,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32940,7 +32940,7 @@
 		sizeof(struct spoolss_DeleteForm),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeleteForm,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeleteForm,
-		(ndr_print_function_t) ndr_print_spoolss_DeleteForm,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32949,7 +32949,7 @@
 		sizeof(struct spoolss_GetForm),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetForm,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetForm,
-		(ndr_print_function_t) ndr_print_spoolss_GetForm,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32958,7 +32958,7 @@
 		sizeof(struct spoolss_SetForm),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetForm,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetForm,
-		(ndr_print_function_t) ndr_print_spoolss_SetForm,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32967,7 +32967,7 @@
 		sizeof(struct spoolss_EnumForms),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumForms,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumForms,
-		(ndr_print_function_t) ndr_print_spoolss_EnumForms,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32976,7 +32976,7 @@
 		sizeof(struct spoolss_EnumPorts),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPorts,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPorts,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPorts,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32985,7 +32985,7 @@
 		sizeof(struct spoolss_EnumMonitors),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumMonitors,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumMonitors,
-		(ndr_print_function_t) ndr_print_spoolss_EnumMonitors,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -32994,7 +32994,7 @@
 		sizeof(struct spoolss_AddPort),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPort,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPort,
-		(ndr_print_function_t) ndr_print_spoolss_AddPort,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33003,7 +33003,7 @@
 		sizeof(struct spoolss_ConfigurePort),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ConfigurePort,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ConfigurePort,
-		(ndr_print_function_t) ndr_print_spoolss_ConfigurePort,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33012,7 +33012,7 @@
 		sizeof(struct spoolss_DeletePort),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePort,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePort,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePort,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33021,7 +33021,7 @@
 		sizeof(struct spoolss_CreatePrinterIC),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_CreatePrinterIC,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_CreatePrinterIC,
-		(ndr_print_function_t) ndr_print_spoolss_CreatePrinterIC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33030,7 +33030,7 @@
 		sizeof(struct spoolss_PlayGDIScriptOnPrinterIC),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_PlayGDIScriptOnPrinterIC,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_PlayGDIScriptOnPrinterIC,
-		(ndr_print_function_t) ndr_print_spoolss_PlayGDIScriptOnPrinterIC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33039,7 +33039,7 @@
 		sizeof(struct spoolss_DeletePrinterIC),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterIC,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterIC,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterIC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33048,7 +33048,7 @@
 		sizeof(struct spoolss_AddPrinterConnection),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrinterConnection,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrinterConnection,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrinterConnection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33057,7 +33057,7 @@
 		sizeof(struct spoolss_DeletePrinterConnection),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterConnection,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterConnection,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterConnection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33066,7 +33066,7 @@
 		sizeof(struct spoolss_PrinterMessageBox),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_PrinterMessageBox,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_PrinterMessageBox,
-		(ndr_print_function_t) ndr_print_spoolss_PrinterMessageBox,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33075,7 +33075,7 @@
 		sizeof(struct spoolss_AddMonitor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddMonitor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddMonitor,
-		(ndr_print_function_t) ndr_print_spoolss_AddMonitor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33084,7 +33084,7 @@
 		sizeof(struct spoolss_DeleteMonitor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeleteMonitor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeleteMonitor,
-		(ndr_print_function_t) ndr_print_spoolss_DeleteMonitor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33093,7 +33093,7 @@
 		sizeof(struct spoolss_DeletePrintProcessor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrintProcessor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrintProcessor,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrintProcessor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33102,7 +33102,7 @@
 		sizeof(struct spoolss_AddPrintProvidor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrintProvidor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrintProvidor,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrintProvidor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33111,7 +33111,7 @@
 		sizeof(struct spoolss_DeletePrintProvidor),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrintProvidor,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrintProvidor,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrintProvidor,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33120,7 +33120,7 @@
 		sizeof(struct spoolss_EnumPrintProcDataTypes),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrintProcDataTypes,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrintProcDataTypes,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrintProcDataTypes,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33129,7 +33129,7 @@
 		sizeof(struct spoolss_ResetPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ResetPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ResetPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_ResetPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33138,7 +33138,7 @@
 		sizeof(struct spoolss_GetPrinterDriver2),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterDriver2,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterDriver2,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterDriver2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33147,7 +33147,7 @@
 		sizeof(struct spoolss_FindFirstPrinterChangeNotification),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_FindFirstPrinterChangeNotification,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_FindFirstPrinterChangeNotification,
-		(ndr_print_function_t) ndr_print_spoolss_FindFirstPrinterChangeNotification,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33156,7 +33156,7 @@
 		sizeof(struct spoolss_FindNextPrinterChangeNotification),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_FindNextPrinterChangeNotification,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_FindNextPrinterChangeNotification,
-		(ndr_print_function_t) ndr_print_spoolss_FindNextPrinterChangeNotification,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33165,7 +33165,7 @@
 		sizeof(struct spoolss_FindClosePrinterNotify),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_FindClosePrinterNotify,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_FindClosePrinterNotify,
-		(ndr_print_function_t) ndr_print_spoolss_FindClosePrinterNotify,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33174,7 +33174,7 @@
 		sizeof(struct spoolss_RouterFindFirstPrinterChangeNotificationOld),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RouterFindFirstPrinterChangeNotificationOld,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RouterFindFirstPrinterChangeNotificationOld,
-		(ndr_print_function_t) ndr_print_spoolss_RouterFindFirstPrinterChangeNotificationOld,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33183,7 +33183,7 @@
 		sizeof(struct spoolss_ReplyOpenPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ReplyOpenPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ReplyOpenPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_ReplyOpenPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33192,7 +33192,7 @@
 		sizeof(struct spoolss_RouterReplyPrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RouterReplyPrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RouterReplyPrinter,
-		(ndr_print_function_t) ndr_print_spoolss_RouterReplyPrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33201,7 +33201,7 @@
 		sizeof(struct spoolss_ReplyClosePrinter),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ReplyClosePrinter,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ReplyClosePrinter,
-		(ndr_print_function_t) ndr_print_spoolss_ReplyClosePrinter,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33210,7 +33210,7 @@
 		sizeof(struct spoolss_AddPortEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPortEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPortEx,
-		(ndr_print_function_t) ndr_print_spoolss_AddPortEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33219,7 +33219,7 @@
 		sizeof(struct spoolss_RouterFindFirstPrinterChangeNotification),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RouterFindFirstPrinterChangeNotification,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RouterFindFirstPrinterChangeNotification,
-		(ndr_print_function_t) ndr_print_spoolss_RouterFindFirstPrinterChangeNotification,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33228,7 +33228,7 @@
 		sizeof(struct spoolss_SpoolerInit),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SpoolerInit,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SpoolerInit,
-		(ndr_print_function_t) ndr_print_spoolss_SpoolerInit,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33237,7 +33237,7 @@
 		sizeof(struct spoolss_ResetPrinterEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_ResetPrinterEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_ResetPrinterEx,
-		(ndr_print_function_t) ndr_print_spoolss_ResetPrinterEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33246,7 +33246,7 @@
 		sizeof(struct spoolss_RemoteFindFirstPrinterChangeNotifyEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RemoteFindFirstPrinterChangeNotifyEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RemoteFindFirstPrinterChangeNotifyEx,
-		(ndr_print_function_t) ndr_print_spoolss_RemoteFindFirstPrinterChangeNotifyEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33255,7 +33255,7 @@
 		sizeof(struct spoolss_RouterReplyPrinterEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RouterReplyPrinterEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RouterReplyPrinterEx,
-		(ndr_print_function_t) ndr_print_spoolss_RouterReplyPrinterEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33264,7 +33264,7 @@
 		sizeof(struct spoolss_RouterRefreshPrinterChangeNotify),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_RouterRefreshPrinterChangeNotify,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_RouterRefreshPrinterChangeNotify,
-		(ndr_print_function_t) ndr_print_spoolss_RouterRefreshPrinterChangeNotify,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33273,7 +33273,7 @@
 		sizeof(struct spoolss_44),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_44,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_44,
-		(ndr_print_function_t) ndr_print_spoolss_44,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33282,7 +33282,7 @@
 		sizeof(struct spoolss_OpenPrinterEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_OpenPrinterEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_OpenPrinterEx,
-		(ndr_print_function_t) ndr_print_spoolss_OpenPrinterEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33291,7 +33291,7 @@
 		sizeof(struct spoolss_AddPrinterEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrinterEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrinterEx,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrinterEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33300,7 +33300,7 @@
 		sizeof(struct spoolss_SetPort),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetPort,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetPort,
-		(ndr_print_function_t) ndr_print_spoolss_SetPort,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33309,7 +33309,7 @@
 		sizeof(struct spoolss_EnumPrinterData),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrinterData,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrinterData,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrinterData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33318,7 +33318,7 @@
 		sizeof(struct spoolss_DeletePrinterData),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterData,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterData,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33327,7 +33327,7 @@
 		sizeof(struct spoolss_4a),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_4a,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_4a,
-		(ndr_print_function_t) ndr_print_spoolss_4a,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33336,7 +33336,7 @@
 		sizeof(struct spoolss_4b),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_4b,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_4b,
-		(ndr_print_function_t) ndr_print_spoolss_4b,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33345,7 +33345,7 @@
 		sizeof(struct spoolss_4c),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_4c,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_4c,
-		(ndr_print_function_t) ndr_print_spoolss_4c,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33354,7 +33354,7 @@
 		sizeof(struct spoolss_SetPrinterDataEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_SetPrinterDataEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_SetPrinterDataEx,
-		(ndr_print_function_t) ndr_print_spoolss_SetPrinterDataEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33363,7 +33363,7 @@
 		sizeof(struct spoolss_GetPrinterDataEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterDataEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterDataEx,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterDataEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33372,7 +33372,7 @@
 		sizeof(struct spoolss_EnumPrinterDataEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrinterDataEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrinterDataEx,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrinterDataEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33381,7 +33381,7 @@
 		sizeof(struct spoolss_EnumPrinterKey),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPrinterKey,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPrinterKey,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPrinterKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33390,7 +33390,7 @@
 		sizeof(struct spoolss_DeletePrinterDataEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterDataEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterDataEx,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterDataEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33399,7 +33399,7 @@
 		sizeof(struct spoolss_DeletePrinterKey),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterKey,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterKey,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33408,7 +33408,7 @@
 		sizeof(struct spoolss_53),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_53,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_53,
-		(ndr_print_function_t) ndr_print_spoolss_53,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33417,7 +33417,7 @@
 		sizeof(struct spoolss_DeletePrinterDriverEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePrinterDriverEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePrinterDriverEx,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePrinterDriverEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33426,7 +33426,7 @@
 		sizeof(struct spoolss_AddPerMachineConnection),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPerMachineConnection,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPerMachineConnection,
-		(ndr_print_function_t) ndr_print_spoolss_AddPerMachineConnection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33435,7 +33435,7 @@
 		sizeof(struct spoolss_DeletePerMachineConnection),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_DeletePerMachineConnection,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_DeletePerMachineConnection,
-		(ndr_print_function_t) ndr_print_spoolss_DeletePerMachineConnection,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33444,7 +33444,7 @@
 		sizeof(struct spoolss_EnumPerMachineConnections),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_EnumPerMachineConnections,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_EnumPerMachineConnections,
-		(ndr_print_function_t) ndr_print_spoolss_EnumPerMachineConnections,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33453,7 +33453,7 @@
 		sizeof(struct spoolss_XcvData),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_XcvData,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_XcvData,
-		(ndr_print_function_t) ndr_print_spoolss_XcvData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33462,7 +33462,7 @@
 		sizeof(struct spoolss_AddPrinterDriverEx),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_AddPrinterDriverEx,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_AddPrinterDriverEx,
-		(ndr_print_function_t) ndr_print_spoolss_AddPrinterDriverEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33471,7 +33471,7 @@
 		sizeof(struct spoolss_5a),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5a,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5a,
-		(ndr_print_function_t) ndr_print_spoolss_5a,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33480,7 +33480,7 @@
 		sizeof(struct spoolss_5b),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5b,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5b,
-		(ndr_print_function_t) ndr_print_spoolss_5b,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33489,7 +33489,7 @@
 		sizeof(struct spoolss_5c),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5c,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5c,
-		(ndr_print_function_t) ndr_print_spoolss_5c,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33498,7 +33498,7 @@
 		sizeof(struct spoolss_5d),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5d,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5d,
-		(ndr_print_function_t) ndr_print_spoolss_5d,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33507,7 +33507,7 @@
 		sizeof(struct spoolss_5e),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5e,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5e,
-		(ndr_print_function_t) ndr_print_spoolss_5e,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33516,7 +33516,7 @@
 		sizeof(struct spoolss_5f),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_5f,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_5f,
-		(ndr_print_function_t) ndr_print_spoolss_5f,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33525,7 +33525,7 @@
 		sizeof(struct spoolss_60),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_60,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_60,
-		(ndr_print_function_t) ndr_print_spoolss_60,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33534,7 +33534,7 @@
 		sizeof(struct spoolss_61),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_61,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_61,
-		(ndr_print_function_t) ndr_print_spoolss_61,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33543,7 +33543,7 @@
 		sizeof(struct spoolss_62),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_62,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_62,
-		(ndr_print_function_t) ndr_print_spoolss_62,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33552,7 +33552,7 @@
 		sizeof(struct spoolss_63),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_63,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_63,
-		(ndr_print_function_t) ndr_print_spoolss_63,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33561,7 +33561,7 @@
 		sizeof(struct spoolss_64),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_64,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_64,
-		(ndr_print_function_t) ndr_print_spoolss_64,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33570,7 +33570,7 @@
 		sizeof(struct spoolss_65),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_65,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_65,
-		(ndr_print_function_t) ndr_print_spoolss_65,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33579,7 +33579,7 @@
 		sizeof(struct spoolss_GetCorePrinterDrivers),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetCorePrinterDrivers,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetCorePrinterDrivers,
-		(ndr_print_function_t) ndr_print_spoolss_GetCorePrinterDrivers,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33588,7 +33588,7 @@
 		sizeof(struct spoolss_67),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_67,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_67,
-		(ndr_print_function_t) ndr_print_spoolss_67,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33597,7 +33597,7 @@
 		sizeof(struct spoolss_GetPrinterDriverPackagePath),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_GetPrinterDriverPackagePath,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_GetPrinterDriverPackagePath,
-		(ndr_print_function_t) ndr_print_spoolss_GetPrinterDriverPackagePath,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33606,7 +33606,7 @@
 		sizeof(struct spoolss_69),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_69,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_69,
-		(ndr_print_function_t) ndr_print_spoolss_69,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33615,7 +33615,7 @@
 		sizeof(struct spoolss_6a),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_6a,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_6a,
-		(ndr_print_function_t) ndr_print_spoolss_6a,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33624,7 +33624,7 @@
 		sizeof(struct spoolss_6b),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_6b,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_6b,
-		(ndr_print_function_t) ndr_print_spoolss_6b,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33633,7 +33633,7 @@
 		sizeof(struct spoolss_6c),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_6c,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_6c,
-		(ndr_print_function_t) ndr_print_spoolss_6c,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -33642,7 +33642,7 @@
 		sizeof(struct spoolss_6d),
 		(ndr_push_flags_fn_t) ndr_push_spoolss_6d,
 		(ndr_pull_flags_fn_t) ndr_pull_spoolss_6d,
-		(ndr_print_function_t) ndr_print_spoolss_6d,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_srvsvc.c samba3/source3/librpc/gen_ndr/ndr_srvsvc.c
--- samba3/source3/librpc/gen_ndr/ndr_srvsvc.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_srvsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -20229,7 +20229,7 @@
 		sizeof(struct srvsvc_NetCharDevEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20238,7 +20238,7 @@
 		sizeof(struct srvsvc_NetCharDevGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevGetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20247,7 +20247,7 @@
 		sizeof(struct srvsvc_NetCharDevControl),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevControl,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevControl,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevControl,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20256,7 +20256,7 @@
 		sizeof(struct srvsvc_NetCharDevQEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevQEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevQEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevQEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20265,7 +20265,7 @@
 		sizeof(struct srvsvc_NetCharDevQGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevQGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevQGetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevQGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20274,7 +20274,7 @@
 		sizeof(struct srvsvc_NetCharDevQSetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevQSetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevQSetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevQSetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20283,7 +20283,7 @@
 		sizeof(struct srvsvc_NetCharDevQPurge),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevQPurge,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevQPurge,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevQPurge,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20292,7 +20292,7 @@
 		sizeof(struct srvsvc_NetCharDevQPurgeSelf),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetCharDevQPurgeSelf,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetCharDevQPurgeSelf,
-		(ndr_print_function_t) ndr_print_srvsvc_NetCharDevQPurgeSelf,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20301,7 +20301,7 @@
 		sizeof(struct srvsvc_NetConnEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetConnEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetConnEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetConnEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20310,7 +20310,7 @@
 		sizeof(struct srvsvc_NetFileEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetFileEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetFileEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetFileEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20319,7 +20319,7 @@
 		sizeof(struct srvsvc_NetFileGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetFileGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetFileGetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetFileGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20328,7 +20328,7 @@
 		sizeof(struct srvsvc_NetFileClose),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetFileClose,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetFileClose,
-		(ndr_print_function_t) ndr_print_srvsvc_NetFileClose,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20337,7 +20337,7 @@
 		sizeof(struct srvsvc_NetSessEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSessEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSessEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSessEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20346,7 +20346,7 @@
 		sizeof(struct srvsvc_NetSessDel),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSessDel,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSessDel,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSessDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20355,7 +20355,7 @@
 		sizeof(struct srvsvc_NetShareAdd),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareAdd,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20364,7 +20364,7 @@
 		sizeof(struct srvsvc_NetShareEnumAll),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareEnumAll,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareEnumAll,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareEnumAll,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20373,7 +20373,7 @@
 		sizeof(struct srvsvc_NetShareGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareGetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20382,7 +20382,7 @@
 		sizeof(struct srvsvc_NetShareSetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareSetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareSetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareSetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20391,7 +20391,7 @@
 		sizeof(struct srvsvc_NetShareDel),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareDel,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareDel,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20400,7 +20400,7 @@
 		sizeof(struct srvsvc_NetShareDelSticky),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareDelSticky,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareDelSticky,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareDelSticky,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20409,7 +20409,7 @@
 		sizeof(struct srvsvc_NetShareCheck),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareCheck,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareCheck,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareCheck,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20418,7 +20418,7 @@
 		sizeof(struct srvsvc_NetSrvGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSrvGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSrvGetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSrvGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20427,7 +20427,7 @@
 		sizeof(struct srvsvc_NetSrvSetInfo),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSrvSetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSrvSetInfo,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSrvSetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20436,7 +20436,7 @@
 		sizeof(struct srvsvc_NetDiskEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetDiskEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetDiskEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetDiskEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20445,7 +20445,7 @@
 		sizeof(struct srvsvc_NetServerStatisticsGet),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetServerStatisticsGet,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetServerStatisticsGet,
-		(ndr_print_function_t) ndr_print_srvsvc_NetServerStatisticsGet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20454,7 +20454,7 @@
 		sizeof(struct srvsvc_NetTransportAdd),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetTransportAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetTransportAdd,
-		(ndr_print_function_t) ndr_print_srvsvc_NetTransportAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20463,7 +20463,7 @@
 		sizeof(struct srvsvc_NetTransportEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetTransportEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetTransportEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetTransportEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20472,7 +20472,7 @@
 		sizeof(struct srvsvc_NetTransportDel),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetTransportDel,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetTransportDel,
-		(ndr_print_function_t) ndr_print_srvsvc_NetTransportDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20481,7 +20481,7 @@
 		sizeof(struct srvsvc_NetRemoteTOD),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetRemoteTOD,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetRemoteTOD,
-		(ndr_print_function_t) ndr_print_srvsvc_NetRemoteTOD,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20490,7 +20490,7 @@
 		sizeof(struct srvsvc_NetSetServiceBits),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSetServiceBits,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSetServiceBits,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSetServiceBits,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20499,7 +20499,7 @@
 		sizeof(struct srvsvc_NetPathType),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetPathType,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetPathType,
-		(ndr_print_function_t) ndr_print_srvsvc_NetPathType,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20508,7 +20508,7 @@
 		sizeof(struct srvsvc_NetPathCanonicalize),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetPathCanonicalize,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetPathCanonicalize,
-		(ndr_print_function_t) ndr_print_srvsvc_NetPathCanonicalize,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20517,7 +20517,7 @@
 		sizeof(struct srvsvc_NetPathCompare),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetPathCompare,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetPathCompare,
-		(ndr_print_function_t) ndr_print_srvsvc_NetPathCompare,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20526,7 +20526,7 @@
 		sizeof(struct srvsvc_NetNameValidate),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetNameValidate,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetNameValidate,
-		(ndr_print_function_t) ndr_print_srvsvc_NetNameValidate,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20535,7 +20535,7 @@
 		sizeof(struct srvsvc_NETRPRNAMECANONICALIZE),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRPRNAMECANONICALIZE,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRPRNAMECANONICALIZE,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRPRNAMECANONICALIZE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20544,7 +20544,7 @@
 		sizeof(struct srvsvc_NetPRNameCompare),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetPRNameCompare,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetPRNameCompare,
-		(ndr_print_function_t) ndr_print_srvsvc_NetPRNameCompare,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20553,7 +20553,7 @@
 		sizeof(struct srvsvc_NetShareEnum),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareEnum,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20562,7 +20562,7 @@
 		sizeof(struct srvsvc_NetShareDelStart),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareDelStart,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareDelStart,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareDelStart,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20571,7 +20571,7 @@
 		sizeof(struct srvsvc_NetShareDelCommit),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetShareDelCommit,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetShareDelCommit,
-		(ndr_print_function_t) ndr_print_srvsvc_NetShareDelCommit,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20580,7 +20580,7 @@
 		sizeof(struct srvsvc_NetGetFileSecurity),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetGetFileSecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetGetFileSecurity,
-		(ndr_print_function_t) ndr_print_srvsvc_NetGetFileSecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20589,7 +20589,7 @@
 		sizeof(struct srvsvc_NetSetFileSecurity),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetSetFileSecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetSetFileSecurity,
-		(ndr_print_function_t) ndr_print_srvsvc_NetSetFileSecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20598,7 +20598,7 @@
 		sizeof(struct srvsvc_NetServerTransportAddEx),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetServerTransportAddEx,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetServerTransportAddEx,
-		(ndr_print_function_t) ndr_print_srvsvc_NetServerTransportAddEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20607,7 +20607,7 @@
 		sizeof(struct srvsvc_NetServerSetServiceBitsEx),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NetServerSetServiceBitsEx,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NetServerSetServiceBitsEx,
-		(ndr_print_function_t) ndr_print_srvsvc_NetServerSetServiceBitsEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20616,7 +20616,7 @@
 		sizeof(struct srvsvc_NETRDFSGETVERSION),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSGETVERSION,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSGETVERSION,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSGETVERSION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20625,7 +20625,7 @@
 		sizeof(struct srvsvc_NETRDFSCREATELOCALPARTITION),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSCREATELOCALPARTITION,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSCREATELOCALPARTITION,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSCREATELOCALPARTITION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20634,7 +20634,7 @@
 		sizeof(struct srvsvc_NETRDFSDELETELOCALPARTITION),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSDELETELOCALPARTITION,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSDELETELOCALPARTITION,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSDELETELOCALPARTITION,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20643,7 +20643,7 @@
 		sizeof(struct srvsvc_NETRDFSSETLOCALVOLUMESTATE),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSSETLOCALVOLUMESTATE,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSSETLOCALVOLUMESTATE,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSSETLOCALVOLUMESTATE,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20652,7 +20652,7 @@
 		sizeof(struct srvsvc_NETRDFSSETSERVERINFO),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSSETSERVERINFO,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSSETSERVERINFO,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSSETSERVERINFO,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20661,7 +20661,7 @@
 		sizeof(struct srvsvc_NETRDFSCREATEEXITPOINT),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSCREATEEXITPOINT,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSCREATEEXITPOINT,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSCREATEEXITPOINT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20670,7 +20670,7 @@
 		sizeof(struct srvsvc_NETRDFSDELETEEXITPOINT),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSDELETEEXITPOINT,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSDELETEEXITPOINT,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSDELETEEXITPOINT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20679,7 +20679,7 @@
 		sizeof(struct srvsvc_NETRDFSMODIFYPREFIX),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSMODIFYPREFIX,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSMODIFYPREFIX,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSMODIFYPREFIX,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20688,7 +20688,7 @@
 		sizeof(struct srvsvc_NETRDFSFIXLOCALVOLUME),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSFIXLOCALVOLUME,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSFIXLOCALVOLUME,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSFIXLOCALVOLUME,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20697,7 +20697,7 @@
 		sizeof(struct srvsvc_NETRDFSMANAGERREPORTSITEINFO),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRDFSMANAGERREPORTSITEINFO,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRDFSMANAGERREPORTSITEINFO,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRDFSMANAGERREPORTSITEINFO,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -20706,7 +20706,7 @@
 		sizeof(struct srvsvc_NETRSERVERTRANSPORTDELEX),
 		(ndr_push_flags_fn_t) ndr_push_srvsvc_NETRSERVERTRANSPORTDELEX,
 		(ndr_pull_flags_fn_t) ndr_pull_srvsvc_NETRSERVERTRANSPORTDELEX,
-		(ndr_print_function_t) ndr_print_srvsvc_NETRSERVERTRANSPORTDELEX,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_svcctl.c samba3/source3/librpc/gen_ndr/ndr_svcctl.c
--- samba3/source3/librpc/gen_ndr/ndr_svcctl.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_svcctl.c	2024-08-04 17:52:53.000000000 +0200
@@ -7175,7 +7175,7 @@
 		sizeof(struct svcctl_CloseServiceHandle),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_CloseServiceHandle,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_CloseServiceHandle,
-		(ndr_print_function_t) ndr_print_svcctl_CloseServiceHandle,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7184,7 +7184,7 @@
 		sizeof(struct svcctl_ControlService),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_ControlService,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_ControlService,
-		(ndr_print_function_t) ndr_print_svcctl_ControlService,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7193,7 +7193,7 @@
 		sizeof(struct svcctl_DeleteService),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_DeleteService,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_DeleteService,
-		(ndr_print_function_t) ndr_print_svcctl_DeleteService,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7202,7 +7202,7 @@
 		sizeof(struct svcctl_LockServiceDatabase),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_LockServiceDatabase,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_LockServiceDatabase,
-		(ndr_print_function_t) ndr_print_svcctl_LockServiceDatabase,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7211,7 +7211,7 @@
 		sizeof(struct svcctl_QueryServiceObjectSecurity),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceObjectSecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceObjectSecurity,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceObjectSecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7220,7 +7220,7 @@
 		sizeof(struct svcctl_SetServiceObjectSecurity),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_SetServiceObjectSecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_SetServiceObjectSecurity,
-		(ndr_print_function_t) ndr_print_svcctl_SetServiceObjectSecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7229,7 +7229,7 @@
 		sizeof(struct svcctl_QueryServiceStatus),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceStatus,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7238,7 +7238,7 @@
 		sizeof(struct svcctl_SetServiceStatus),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_SetServiceStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_SetServiceStatus,
-		(ndr_print_function_t) ndr_print_svcctl_SetServiceStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7247,7 +7247,7 @@
 		sizeof(struct svcctl_UnlockServiceDatabase),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_UnlockServiceDatabase,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_UnlockServiceDatabase,
-		(ndr_print_function_t) ndr_print_svcctl_UnlockServiceDatabase,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7256,7 +7256,7 @@
 		sizeof(struct svcctl_NotifyBootConfigStatus),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_NotifyBootConfigStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_NotifyBootConfigStatus,
-		(ndr_print_function_t) ndr_print_svcctl_NotifyBootConfigStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7265,7 +7265,7 @@
 		sizeof(struct svcctl_SCSetServiceBitsW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_SCSetServiceBitsW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_SCSetServiceBitsW,
-		(ndr_print_function_t) ndr_print_svcctl_SCSetServiceBitsW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7274,7 +7274,7 @@
 		sizeof(struct svcctl_ChangeServiceConfigW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_ChangeServiceConfigW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_ChangeServiceConfigW,
-		(ndr_print_function_t) ndr_print_svcctl_ChangeServiceConfigW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7283,7 +7283,7 @@
 		sizeof(struct svcctl_CreateServiceW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_CreateServiceW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_CreateServiceW,
-		(ndr_print_function_t) ndr_print_svcctl_CreateServiceW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7292,7 +7292,7 @@
 		sizeof(struct svcctl_EnumDependentServicesW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_EnumDependentServicesW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_EnumDependentServicesW,
-		(ndr_print_function_t) ndr_print_svcctl_EnumDependentServicesW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7301,7 +7301,7 @@
 		sizeof(struct svcctl_EnumServicesStatusW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_EnumServicesStatusW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_EnumServicesStatusW,
-		(ndr_print_function_t) ndr_print_svcctl_EnumServicesStatusW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7310,7 +7310,7 @@
 		sizeof(struct svcctl_OpenSCManagerW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_OpenSCManagerW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_OpenSCManagerW,
-		(ndr_print_function_t) ndr_print_svcctl_OpenSCManagerW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7319,7 +7319,7 @@
 		sizeof(struct svcctl_OpenServiceW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_OpenServiceW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_OpenServiceW,
-		(ndr_print_function_t) ndr_print_svcctl_OpenServiceW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7328,7 +7328,7 @@
 		sizeof(struct svcctl_QueryServiceConfigW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceConfigW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceConfigW,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceConfigW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7337,7 +7337,7 @@
 		sizeof(struct svcctl_QueryServiceLockStatusW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceLockStatusW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceLockStatusW,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceLockStatusW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7346,7 +7346,7 @@
 		sizeof(struct svcctl_StartServiceW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_StartServiceW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_StartServiceW,
-		(ndr_print_function_t) ndr_print_svcctl_StartServiceW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7355,7 +7355,7 @@
 		sizeof(struct svcctl_GetServiceDisplayNameW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_GetServiceDisplayNameW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_GetServiceDisplayNameW,
-		(ndr_print_function_t) ndr_print_svcctl_GetServiceDisplayNameW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7364,7 +7364,7 @@
 		sizeof(struct svcctl_GetServiceKeyNameW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_GetServiceKeyNameW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_GetServiceKeyNameW,
-		(ndr_print_function_t) ndr_print_svcctl_GetServiceKeyNameW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7373,7 +7373,7 @@
 		sizeof(struct svcctl_SCSetServiceBitsA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_SCSetServiceBitsA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_SCSetServiceBitsA,
-		(ndr_print_function_t) ndr_print_svcctl_SCSetServiceBitsA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7382,7 +7382,7 @@
 		sizeof(struct svcctl_ChangeServiceConfigA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_ChangeServiceConfigA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_ChangeServiceConfigA,
-		(ndr_print_function_t) ndr_print_svcctl_ChangeServiceConfigA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7391,7 +7391,7 @@
 		sizeof(struct svcctl_CreateServiceA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_CreateServiceA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_CreateServiceA,
-		(ndr_print_function_t) ndr_print_svcctl_CreateServiceA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7400,7 +7400,7 @@
 		sizeof(struct svcctl_EnumDependentServicesA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_EnumDependentServicesA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_EnumDependentServicesA,
-		(ndr_print_function_t) ndr_print_svcctl_EnumDependentServicesA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7409,7 +7409,7 @@
 		sizeof(struct svcctl_EnumServicesStatusA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_EnumServicesStatusA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_EnumServicesStatusA,
-		(ndr_print_function_t) ndr_print_svcctl_EnumServicesStatusA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7418,7 +7418,7 @@
 		sizeof(struct svcctl_OpenSCManagerA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_OpenSCManagerA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_OpenSCManagerA,
-		(ndr_print_function_t) ndr_print_svcctl_OpenSCManagerA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7427,7 +7427,7 @@
 		sizeof(struct svcctl_OpenServiceA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_OpenServiceA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_OpenServiceA,
-		(ndr_print_function_t) ndr_print_svcctl_OpenServiceA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7436,7 +7436,7 @@
 		sizeof(struct svcctl_QueryServiceConfigA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceConfigA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceConfigA,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceConfigA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7445,7 +7445,7 @@
 		sizeof(struct svcctl_QueryServiceLockStatusA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceLockStatusA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceLockStatusA,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceLockStatusA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7454,7 +7454,7 @@
 		sizeof(struct svcctl_StartServiceA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_StartServiceA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_StartServiceA,
-		(ndr_print_function_t) ndr_print_svcctl_StartServiceA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7463,7 +7463,7 @@
 		sizeof(struct svcctl_GetServiceDisplayNameA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_GetServiceDisplayNameA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_GetServiceDisplayNameA,
-		(ndr_print_function_t) ndr_print_svcctl_GetServiceDisplayNameA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7472,7 +7472,7 @@
 		sizeof(struct svcctl_GetServiceKeyNameA),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_GetServiceKeyNameA,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_GetServiceKeyNameA,
-		(ndr_print_function_t) ndr_print_svcctl_GetServiceKeyNameA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7481,7 +7481,7 @@
 		sizeof(struct svcctl_GetCurrentGroupeStateW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_GetCurrentGroupeStateW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_GetCurrentGroupeStateW,
-		(ndr_print_function_t) ndr_print_svcctl_GetCurrentGroupeStateW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7490,7 +7490,7 @@
 		sizeof(struct svcctl_EnumServiceGroupW),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_EnumServiceGroupW,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_EnumServiceGroupW,
-		(ndr_print_function_t) ndr_print_svcctl_EnumServiceGroupW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7499,7 +7499,7 @@
 		sizeof(struct svcctl_ChangeServiceConfig2A),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_ChangeServiceConfig2A,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_ChangeServiceConfig2A,
-		(ndr_print_function_t) ndr_print_svcctl_ChangeServiceConfig2A,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7508,7 +7508,7 @@
 		sizeof(struct svcctl_ChangeServiceConfig2W),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_ChangeServiceConfig2W,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_ChangeServiceConfig2W,
-		(ndr_print_function_t) ndr_print_svcctl_ChangeServiceConfig2W,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7517,7 +7517,7 @@
 		sizeof(struct svcctl_QueryServiceConfig2A),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceConfig2A,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceConfig2A,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceConfig2A,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7526,7 +7526,7 @@
 		sizeof(struct svcctl_QueryServiceConfig2W),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceConfig2W,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceConfig2W,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceConfig2W,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7535,7 +7535,7 @@
 		sizeof(struct svcctl_QueryServiceStatusEx),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_QueryServiceStatusEx,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_QueryServiceStatusEx,
-		(ndr_print_function_t) ndr_print_svcctl_QueryServiceStatusEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7544,7 +7544,7 @@
 		sizeof(struct EnumServicesStatusExA),
 		(ndr_push_flags_fn_t) ndr_push_EnumServicesStatusExA,
 		(ndr_pull_flags_fn_t) ndr_pull_EnumServicesStatusExA,
-		(ndr_print_function_t) ndr_print_EnumServicesStatusExA,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7553,7 +7553,7 @@
 		sizeof(struct EnumServicesStatusExW),
 		(ndr_push_flags_fn_t) ndr_push_EnumServicesStatusExW,
 		(ndr_pull_flags_fn_t) ndr_pull_EnumServicesStatusExW,
-		(ndr_print_function_t) ndr_print_EnumServicesStatusExW,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7562,7 +7562,7 @@
 		sizeof(struct svcctl_SCSendTSMessage),
 		(ndr_push_flags_fn_t) ndr_push_svcctl_SCSendTSMessage,
 		(ndr_pull_flags_fn_t) ndr_pull_svcctl_SCSendTSMessage,
-		(ndr_print_function_t) ndr_print_svcctl_SCSendTSMessage,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_trkwks.c samba3/source3/librpc/gen_ndr/ndr_trkwks.c
--- samba3/source3/librpc/gen_ndr/ndr_trkwks.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_trkwks.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 		sizeof(struct trkwks_Unknown0),
 		(ndr_push_flags_fn_t) ndr_push_trkwks_Unknown0,
 		(ndr_pull_flags_fn_t) ndr_pull_trkwks_Unknown0,
-		(ndr_print_function_t) ndr_print_trkwks_Unknown0,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_unixinfo.c samba3/source3/librpc/gen_ndr/ndr_unixinfo.c
--- samba3/source3/librpc/gen_ndr/ndr_unixinfo.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_unixinfo.c	2024-08-04 17:52:53.000000000 +0200
@@ -472,7 +472,7 @@
 		sizeof(struct unixinfo_SidToUid),
 		(ndr_push_flags_fn_t) ndr_push_unixinfo_SidToUid,
 		(ndr_pull_flags_fn_t) ndr_pull_unixinfo_SidToUid,
-		(ndr_print_function_t) ndr_print_unixinfo_SidToUid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -481,7 +481,7 @@
 		sizeof(struct unixinfo_UidToSid),
 		(ndr_push_flags_fn_t) ndr_push_unixinfo_UidToSid,
 		(ndr_pull_flags_fn_t) ndr_pull_unixinfo_UidToSid,
-		(ndr_print_function_t) ndr_print_unixinfo_UidToSid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -490,7 +490,7 @@
 		sizeof(struct unixinfo_SidToGid),
 		(ndr_push_flags_fn_t) ndr_push_unixinfo_SidToGid,
 		(ndr_pull_flags_fn_t) ndr_pull_unixinfo_SidToGid,
-		(ndr_print_function_t) ndr_print_unixinfo_SidToGid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -499,7 +499,7 @@
 		sizeof(struct unixinfo_GidToSid),
 		(ndr_push_flags_fn_t) ndr_push_unixinfo_GidToSid,
 		(ndr_pull_flags_fn_t) ndr_pull_unixinfo_GidToSid,
-		(ndr_print_function_t) ndr_print_unixinfo_GidToSid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -508,7 +508,7 @@
 		sizeof(struct unixinfo_GetPWUid),
 		(ndr_push_flags_fn_t) ndr_push_unixinfo_GetPWUid,
 		(ndr_pull_flags_fn_t) ndr_pull_unixinfo_GetPWUid,
-		(ndr_print_function_t) ndr_print_unixinfo_GetPWUid,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_w32time.c samba3/source3/librpc/gen_ndr/ndr_w32time.c
--- samba3/source3/librpc/gen_ndr/ndr_w32time.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_w32time.c	2024-08-04 17:52:53.000000000 +0200
@@ -135,7 +135,7 @@
 		sizeof(struct w32time_SyncTime),
 		(ndr_push_flags_fn_t) ndr_push_w32time_SyncTime,
 		(ndr_pull_flags_fn_t) ndr_pull_w32time_SyncTime,
-		(ndr_print_function_t) ndr_print_w32time_SyncTime,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -144,7 +144,7 @@
 		sizeof(struct w32time_GetNetLogonServiceBits),
 		(ndr_push_flags_fn_t) ndr_push_w32time_GetNetLogonServiceBits,
 		(ndr_pull_flags_fn_t) ndr_pull_w32time_GetNetLogonServiceBits,
-		(ndr_print_function_t) ndr_print_w32time_GetNetLogonServiceBits,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -153,7 +153,7 @@
 		sizeof(struct w32time_QueryProviderStatus),
 		(ndr_push_flags_fn_t) ndr_push_w32time_QueryProviderStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_w32time_QueryProviderStatus,
-		(ndr_print_function_t) ndr_print_w32time_QueryProviderStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_wbint_c.c samba3/source3/librpc/gen_ndr/ndr_wbint_c.c
--- samba3/source3/librpc/gen_ndr/ndr_wbint_c.c	2015-02-22 15:16:56.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_wbint_c.c	2024-09-12 23:44:50.000000000 +0200
@@ -307,8 +307,8 @@
 					       struct dcerpc_binding_handle *h,
 					       struct dom_sid *_sid /* [in] [ref] */,
 					       enum lsa_SidType *_type /* [out] [ref] */,
-					       const char **_domain /* [out] [charset(UTF8),ref] */,
-					       const char **_name /* [out] [charset(UTF8),ref] */)
+					       const char **_domain /* [out] [ref,charset(UTF8)] */,
+					       const char **_name /* [out] [ref,charset(UTF8)] */)
 {
 	struct tevent_req *req;
 	struct dcerpc_wbint_LookupSid_state *state;
@@ -412,8 +412,8 @@
 				TALLOC_CTX *mem_ctx,
 				struct dom_sid *_sid /* [in] [ref] */,
 				enum lsa_SidType *_type /* [out] [ref] */,
-				const char **_domain /* [out] [charset(UTF8),ref] */,
-				const char **_name /* [out] [charset(UTF8),ref] */,
+				const char **_domain /* [out] [ref,charset(UTF8)] */,
+				const char **_name /* [out] [ref,charset(UTF8)] */,
 				NTSTATUS *result)
 {
 	struct wbint_LookupSid r;
@@ -752,7 +752,7 @@
 struct tevent_req *dcerpc_wbint_LookupName_send(TALLOC_CTX *mem_ctx,
 						struct tevent_context *ev,
 						struct dcerpc_binding_handle *h,
-						const char *_domain /* [in] [charset(UTF8),ref] */,
+						const char *_domain /* [in] [ref,charset(UTF8)] */,
 						const char *_name /* [in] [ref,charset(UTF8)] */,
 						uint32_t _flags /* [in]  */,
 						enum lsa_SidType *_type /* [out] [ref] */,
@@ -858,7 +858,7 @@
 
 NTSTATUS dcerpc_wbint_LookupName(struct dcerpc_binding_handle *h,
 				 TALLOC_CTX *mem_ctx,
-				 const char *_domain /* [in] [charset(UTF8),ref] */,
+				 const char *_domain /* [in] [ref,charset(UTF8)] */,
 				 const char *_name /* [in] [ref,charset(UTF8)] */,
 				 uint32_t _flags /* [in]  */,
 				 enum lsa_SidType *_type /* [out] [ref] */,
@@ -981,7 +981,7 @@
 struct tevent_req *dcerpc_wbint_Sid2Uid_send(TALLOC_CTX *mem_ctx,
 					     struct tevent_context *ev,
 					     struct dcerpc_binding_handle *h,
-					     const char *_dom_name /* [in] [charset(UTF8),unique] */,
+					     const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 					     struct dom_sid *_sid /* [in] [ref] */,
 					     uint64_t *_uid /* [out] [ref] */)
 {
@@ -1082,7 +1082,7 @@
 
 NTSTATUS dcerpc_wbint_Sid2Uid(struct dcerpc_binding_handle *h,
 			      TALLOC_CTX *mem_ctx,
-			      const char *_dom_name /* [in] [charset(UTF8),unique] */,
+			      const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 			      struct dom_sid *_sid /* [in] [ref] */,
 			      uint64_t *_uid /* [out] [ref] */,
 			      NTSTATUS *result)
@@ -1201,7 +1201,7 @@
 struct tevent_req *dcerpc_wbint_Sid2Gid_send(TALLOC_CTX *mem_ctx,
 					     struct tevent_context *ev,
 					     struct dcerpc_binding_handle *h,
-					     const char *_dom_name /* [in] [charset(UTF8),unique] */,
+					     const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 					     struct dom_sid *_sid /* [in] [ref] */,
 					     uint64_t *_gid /* [out] [ref] */)
 {
@@ -1302,7 +1302,7 @@
 
 NTSTATUS dcerpc_wbint_Sid2Gid(struct dcerpc_binding_handle *h,
 			      TALLOC_CTX *mem_ctx,
-			      const char *_dom_name /* [in] [charset(UTF8),unique] */,
+			      const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 			      struct dom_sid *_sid /* [in] [ref] */,
 			      uint64_t *_gid /* [out] [ref] */,
 			      NTSTATUS *result)
diff -daurN samba3/source3/librpc/gen_ndr/ndr_wbint_c.h samba3/source3/librpc/gen_ndr/ndr_wbint_c.h
--- samba3/source3/librpc/gen_ndr/ndr_wbint_c.h	2015-02-22 15:16:56.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_wbint_c.h	2024-09-12 23:44:50.000000000 +0200
@@ -34,8 +34,8 @@
 					       struct dcerpc_binding_handle *h,
 					       struct dom_sid *_sid /* [in] [ref] */,
 					       enum lsa_SidType *_type /* [out] [ref] */,
-					       const char **_domain /* [out] [charset(UTF8),ref] */,
-					       const char **_name /* [out] [charset(UTF8),ref] */);
+					       const char **_domain /* [out] [ref,charset(UTF8)] */,
+					       const char **_name /* [out] [ref,charset(UTF8)] */);
 NTSTATUS dcerpc_wbint_LookupSid_recv(struct tevent_req *req,
 				     TALLOC_CTX *mem_ctx,
 				     NTSTATUS *result);
@@ -43,8 +43,8 @@
 				TALLOC_CTX *mem_ctx,
 				struct dom_sid *_sid /* [in] [ref] */,
 				enum lsa_SidType *_type /* [out] [ref] */,
-				const char **_domain /* [out] [charset(UTF8),ref] */,
-				const char **_name /* [out] [charset(UTF8),ref] */,
+				const char **_domain /* [out] [ref,charset(UTF8)] */,
+				const char **_name /* [out] [ref,charset(UTF8)] */,
 				NTSTATUS *result);
 
 struct tevent_req *dcerpc_wbint_LookupSids_r_send(TALLOC_CTX *mem_ctx,
@@ -78,7 +78,7 @@
 struct tevent_req *dcerpc_wbint_LookupName_send(TALLOC_CTX *mem_ctx,
 						struct tevent_context *ev,
 						struct dcerpc_binding_handle *h,
-						const char *_domain /* [in] [charset(UTF8),ref] */,
+						const char *_domain /* [in] [ref,charset(UTF8)] */,
 						const char *_name /* [in] [ref,charset(UTF8)] */,
 						uint32_t _flags /* [in]  */,
 						enum lsa_SidType *_type /* [out] [ref] */,
@@ -88,7 +88,7 @@
 				      NTSTATUS *result);
 NTSTATUS dcerpc_wbint_LookupName(struct dcerpc_binding_handle *h,
 				 TALLOC_CTX *mem_ctx,
-				 const char *_domain /* [in] [charset(UTF8),ref] */,
+				 const char *_domain /* [in] [ref,charset(UTF8)] */,
 				 const char *_name /* [in] [ref,charset(UTF8)] */,
 				 uint32_t _flags /* [in]  */,
 				 enum lsa_SidType *_type /* [out] [ref] */,
@@ -104,7 +104,7 @@
 struct tevent_req *dcerpc_wbint_Sid2Uid_send(TALLOC_CTX *mem_ctx,
 					     struct tevent_context *ev,
 					     struct dcerpc_binding_handle *h,
-					     const char *_dom_name /* [in] [charset(UTF8),unique] */,
+					     const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 					     struct dom_sid *_sid /* [in] [ref] */,
 					     uint64_t *_uid /* [out] [ref] */);
 NTSTATUS dcerpc_wbint_Sid2Uid_recv(struct tevent_req *req,
@@ -112,7 +112,7 @@
 				   NTSTATUS *result);
 NTSTATUS dcerpc_wbint_Sid2Uid(struct dcerpc_binding_handle *h,
 			      TALLOC_CTX *mem_ctx,
-			      const char *_dom_name /* [in] [charset(UTF8),unique] */,
+			      const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 			      struct dom_sid *_sid /* [in] [ref] */,
 			      uint64_t *_uid /* [out] [ref] */,
 			      NTSTATUS *result);
@@ -126,7 +126,7 @@
 struct tevent_req *dcerpc_wbint_Sid2Gid_send(TALLOC_CTX *mem_ctx,
 					     struct tevent_context *ev,
 					     struct dcerpc_binding_handle *h,
-					     const char *_dom_name /* [in] [charset(UTF8),unique] */,
+					     const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 					     struct dom_sid *_sid /* [in] [ref] */,
 					     uint64_t *_gid /* [out] [ref] */);
 NTSTATUS dcerpc_wbint_Sid2Gid_recv(struct tevent_req *req,
@@ -134,7 +134,7 @@
 				   NTSTATUS *result);
 NTSTATUS dcerpc_wbint_Sid2Gid(struct dcerpc_binding_handle *h,
 			      TALLOC_CTX *mem_ctx,
-			      const char *_dom_name /* [in] [charset(UTF8),unique] */,
+			      const char *_dom_name /* [in] [unique,charset(UTF8)] */,
 			      struct dom_sid *_sid /* [in] [ref] */,
 			      uint64_t *_gid /* [out] [ref] */,
 			      NTSTATUS *result);
diff -daurN samba3/source3/librpc/gen_ndr/ndr_winreg.c samba3/source3/librpc/gen_ndr/ndr_winreg.c
--- samba3/source3/librpc/gen_ndr/ndr_winreg.c	2015-02-22 15:16:51.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_winreg.c	2024-08-04 17:52:53.000000000 +0200
@@ -4864,7 +4864,7 @@
 		sizeof(struct winreg_OpenHKCR),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKCR,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKCR,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKCR,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4873,7 +4873,7 @@
 		sizeof(struct winreg_OpenHKCU),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKCU,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKCU,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKCU,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4882,7 +4882,7 @@
 		sizeof(struct winreg_OpenHKLM),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKLM,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKLM,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKLM,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4891,7 +4891,7 @@
 		sizeof(struct winreg_OpenHKPD),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKPD,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKPD,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKPD,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4900,7 +4900,7 @@
 		sizeof(struct winreg_OpenHKU),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKU,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKU,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKU,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4909,7 +4909,7 @@
 		sizeof(struct winreg_CloseKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_CloseKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_CloseKey,
-		(ndr_print_function_t) ndr_print_winreg_CloseKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4918,7 +4918,7 @@
 		sizeof(struct winreg_CreateKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_CreateKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_CreateKey,
-		(ndr_print_function_t) ndr_print_winreg_CreateKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4927,7 +4927,7 @@
 		sizeof(struct winreg_DeleteKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_DeleteKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_DeleteKey,
-		(ndr_print_function_t) ndr_print_winreg_DeleteKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4936,7 +4936,7 @@
 		sizeof(struct winreg_DeleteValue),
 		(ndr_push_flags_fn_t) ndr_push_winreg_DeleteValue,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_DeleteValue,
-		(ndr_print_function_t) ndr_print_winreg_DeleteValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4945,7 +4945,7 @@
 		sizeof(struct winreg_EnumKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_EnumKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_EnumKey,
-		(ndr_print_function_t) ndr_print_winreg_EnumKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4954,7 +4954,7 @@
 		sizeof(struct winreg_EnumValue),
 		(ndr_push_flags_fn_t) ndr_push_winreg_EnumValue,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_EnumValue,
-		(ndr_print_function_t) ndr_print_winreg_EnumValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4963,7 +4963,7 @@
 		sizeof(struct winreg_FlushKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_FlushKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_FlushKey,
-		(ndr_print_function_t) ndr_print_winreg_FlushKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4972,7 +4972,7 @@
 		sizeof(struct winreg_GetKeySecurity),
 		(ndr_push_flags_fn_t) ndr_push_winreg_GetKeySecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_GetKeySecurity,
-		(ndr_print_function_t) ndr_print_winreg_GetKeySecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4981,7 +4981,7 @@
 		sizeof(struct winreg_LoadKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_LoadKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_LoadKey,
-		(ndr_print_function_t) ndr_print_winreg_LoadKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4990,7 +4990,7 @@
 		sizeof(struct winreg_NotifyChangeKeyValue),
 		(ndr_push_flags_fn_t) ndr_push_winreg_NotifyChangeKeyValue,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_NotifyChangeKeyValue,
-		(ndr_print_function_t) ndr_print_winreg_NotifyChangeKeyValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4999,7 +4999,7 @@
 		sizeof(struct winreg_OpenKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenKey,
-		(ndr_print_function_t) ndr_print_winreg_OpenKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5008,7 +5008,7 @@
 		sizeof(struct winreg_QueryInfoKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_QueryInfoKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_QueryInfoKey,
-		(ndr_print_function_t) ndr_print_winreg_QueryInfoKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5017,7 +5017,7 @@
 		sizeof(struct winreg_QueryValue),
 		(ndr_push_flags_fn_t) ndr_push_winreg_QueryValue,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_QueryValue,
-		(ndr_print_function_t) ndr_print_winreg_QueryValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5026,7 +5026,7 @@
 		sizeof(struct winreg_ReplaceKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_ReplaceKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_ReplaceKey,
-		(ndr_print_function_t) ndr_print_winreg_ReplaceKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5035,7 +5035,7 @@
 		sizeof(struct winreg_RestoreKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_RestoreKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_RestoreKey,
-		(ndr_print_function_t) ndr_print_winreg_RestoreKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5044,7 +5044,7 @@
 		sizeof(struct winreg_SaveKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_SaveKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_SaveKey,
-		(ndr_print_function_t) ndr_print_winreg_SaveKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5053,7 +5053,7 @@
 		sizeof(struct winreg_SetKeySecurity),
 		(ndr_push_flags_fn_t) ndr_push_winreg_SetKeySecurity,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_SetKeySecurity,
-		(ndr_print_function_t) ndr_print_winreg_SetKeySecurity,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5062,7 +5062,7 @@
 		sizeof(struct winreg_SetValue),
 		(ndr_push_flags_fn_t) ndr_push_winreg_SetValue,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_SetValue,
-		(ndr_print_function_t) ndr_print_winreg_SetValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5071,7 +5071,7 @@
 		sizeof(struct winreg_UnLoadKey),
 		(ndr_push_flags_fn_t) ndr_push_winreg_UnLoadKey,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_UnLoadKey,
-		(ndr_print_function_t) ndr_print_winreg_UnLoadKey,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5080,7 +5080,7 @@
 		sizeof(struct winreg_InitiateSystemShutdown),
 		(ndr_push_flags_fn_t) ndr_push_winreg_InitiateSystemShutdown,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_InitiateSystemShutdown,
-		(ndr_print_function_t) ndr_print_winreg_InitiateSystemShutdown,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5089,7 +5089,7 @@
 		sizeof(struct winreg_AbortSystemShutdown),
 		(ndr_push_flags_fn_t) ndr_push_winreg_AbortSystemShutdown,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_AbortSystemShutdown,
-		(ndr_print_function_t) ndr_print_winreg_AbortSystemShutdown,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5098,7 +5098,7 @@
 		sizeof(struct winreg_GetVersion),
 		(ndr_push_flags_fn_t) ndr_push_winreg_GetVersion,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_GetVersion,
-		(ndr_print_function_t) ndr_print_winreg_GetVersion,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5107,7 +5107,7 @@
 		sizeof(struct winreg_OpenHKCC),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKCC,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKCC,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKCC,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5116,7 +5116,7 @@
 		sizeof(struct winreg_OpenHKDD),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKDD,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKDD,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKDD,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5125,7 +5125,7 @@
 		sizeof(struct winreg_QueryMultipleValues),
 		(ndr_push_flags_fn_t) ndr_push_winreg_QueryMultipleValues,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_QueryMultipleValues,
-		(ndr_print_function_t) ndr_print_winreg_QueryMultipleValues,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5134,7 +5134,7 @@
 		sizeof(struct winreg_InitiateSystemShutdownEx),
 		(ndr_push_flags_fn_t) ndr_push_winreg_InitiateSystemShutdownEx,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_InitiateSystemShutdownEx,
-		(ndr_print_function_t) ndr_print_winreg_InitiateSystemShutdownEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5143,7 +5143,7 @@
 		sizeof(struct winreg_SaveKeyEx),
 		(ndr_push_flags_fn_t) ndr_push_winreg_SaveKeyEx,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_SaveKeyEx,
-		(ndr_print_function_t) ndr_print_winreg_SaveKeyEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5152,7 +5152,7 @@
 		sizeof(struct winreg_OpenHKPT),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKPT,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKPT,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKPT,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5161,7 +5161,7 @@
 		sizeof(struct winreg_OpenHKPN),
 		(ndr_push_flags_fn_t) ndr_push_winreg_OpenHKPN,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_OpenHKPN,
-		(ndr_print_function_t) ndr_print_winreg_OpenHKPN,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5170,7 +5170,7 @@
 		sizeof(struct winreg_QueryMultipleValues2),
 		(ndr_push_flags_fn_t) ndr_push_winreg_QueryMultipleValues2,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_QueryMultipleValues2,
-		(ndr_print_function_t) ndr_print_winreg_QueryMultipleValues2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5179,7 +5179,7 @@
 		sizeof(struct winreg_DeleteKeyEx),
 		(ndr_push_flags_fn_t) ndr_push_winreg_DeleteKeyEx,
 		(ndr_pull_flags_fn_t) ndr_pull_winreg_DeleteKeyEx,
-		(ndr_print_function_t) ndr_print_winreg_DeleteKeyEx,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_wkssvc.c samba3/source3/librpc/gen_ndr/ndr_wkssvc.c
--- samba3/source3/librpc/gen_ndr/ndr_wkssvc.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_wkssvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -11005,7 +11005,7 @@
 		sizeof(struct wkssvc_NetWkstaGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetWkstaGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetWkstaGetInfo,
-		(ndr_print_function_t) ndr_print_wkssvc_NetWkstaGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11014,7 +11014,7 @@
 		sizeof(struct wkssvc_NetWkstaSetInfo),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetWkstaSetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetWkstaSetInfo,
-		(ndr_print_function_t) ndr_print_wkssvc_NetWkstaSetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11023,7 +11023,7 @@
 		sizeof(struct wkssvc_NetWkstaEnumUsers),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetWkstaEnumUsers,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetWkstaEnumUsers,
-		(ndr_print_function_t) ndr_print_wkssvc_NetWkstaEnumUsers,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11032,7 +11032,7 @@
 		sizeof(struct wkssvc_NetrWkstaUserGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrWkstaUserGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrWkstaUserGetInfo,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrWkstaUserGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11041,7 +11041,7 @@
 		sizeof(struct wkssvc_NetrWkstaUserSetInfo),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrWkstaUserSetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrWkstaUserSetInfo,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrWkstaUserSetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11050,7 +11050,7 @@
 		sizeof(struct wkssvc_NetWkstaTransportEnum),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetWkstaTransportEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetWkstaTransportEnum,
-		(ndr_print_function_t) ndr_print_wkssvc_NetWkstaTransportEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11059,7 +11059,7 @@
 		sizeof(struct wkssvc_NetrWkstaTransportAdd),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrWkstaTransportAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrWkstaTransportAdd,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrWkstaTransportAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11068,7 +11068,7 @@
 		sizeof(struct wkssvc_NetrWkstaTransportDel),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrWkstaTransportDel,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrWkstaTransportDel,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrWkstaTransportDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11077,7 +11077,7 @@
 		sizeof(struct wkssvc_NetrUseAdd),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUseAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUseAdd,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUseAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11086,7 +11086,7 @@
 		sizeof(struct wkssvc_NetrUseGetInfo),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUseGetInfo,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUseGetInfo,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUseGetInfo,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11095,7 +11095,7 @@
 		sizeof(struct wkssvc_NetrUseDel),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUseDel,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUseDel,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUseDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11104,7 +11104,7 @@
 		sizeof(struct wkssvc_NetrUseEnum),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUseEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUseEnum,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUseEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11113,7 +11113,7 @@
 		sizeof(struct wkssvc_NetrMessageBufferSend),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrMessageBufferSend,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrMessageBufferSend,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrMessageBufferSend,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11122,7 +11122,7 @@
 		sizeof(struct wkssvc_NetrWorkstationStatisticsGet),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrWorkstationStatisticsGet,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrWorkstationStatisticsGet,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrWorkstationStatisticsGet,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11131,7 +11131,7 @@
 		sizeof(struct wkssvc_NetrLogonDomainNameAdd),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrLogonDomainNameAdd,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrLogonDomainNameAdd,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrLogonDomainNameAdd,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11140,7 +11140,7 @@
 		sizeof(struct wkssvc_NetrLogonDomainNameDel),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrLogonDomainNameDel,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrLogonDomainNameDel,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrLogonDomainNameDel,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11149,7 +11149,7 @@
 		sizeof(struct wkssvc_NetrJoinDomain),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrJoinDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrJoinDomain,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrJoinDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11158,7 +11158,7 @@
 		sizeof(struct wkssvc_NetrUnjoinDomain),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUnjoinDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUnjoinDomain,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUnjoinDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11167,7 +11167,7 @@
 		sizeof(struct wkssvc_NetrRenameMachineInDomain),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrRenameMachineInDomain,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrRenameMachineInDomain,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrRenameMachineInDomain,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11176,7 +11176,7 @@
 		sizeof(struct wkssvc_NetrValidateName),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrValidateName,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrValidateName,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrValidateName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11185,7 +11185,7 @@
 		sizeof(struct wkssvc_NetrGetJoinInformation),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrGetJoinInformation,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrGetJoinInformation,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrGetJoinInformation,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11194,7 +11194,7 @@
 		sizeof(struct wkssvc_NetrGetJoinableOus),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrGetJoinableOus,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrGetJoinableOus,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrGetJoinableOus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11203,7 +11203,7 @@
 		sizeof(struct wkssvc_NetrJoinDomain2),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrJoinDomain2,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrJoinDomain2,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrJoinDomain2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11212,7 +11212,7 @@
 		sizeof(struct wkssvc_NetrUnjoinDomain2),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrUnjoinDomain2,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrUnjoinDomain2,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrUnjoinDomain2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11221,7 +11221,7 @@
 		sizeof(struct wkssvc_NetrRenameMachineInDomain2),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrRenameMachineInDomain2,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrRenameMachineInDomain2,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrRenameMachineInDomain2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11230,7 +11230,7 @@
 		sizeof(struct wkssvc_NetrValidateName2),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrValidateName2,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrValidateName2,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrValidateName2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11239,7 +11239,7 @@
 		sizeof(struct wkssvc_NetrGetJoinableOus2),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrGetJoinableOus2,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrGetJoinableOus2,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrGetJoinableOus2,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11248,7 +11248,7 @@
 		sizeof(struct wkssvc_NetrAddAlternateComputerName),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrAddAlternateComputerName,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrAddAlternateComputerName,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrAddAlternateComputerName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11257,7 +11257,7 @@
 		sizeof(struct wkssvc_NetrRemoveAlternateComputerName),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrRemoveAlternateComputerName,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrRemoveAlternateComputerName,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrRemoveAlternateComputerName,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11266,7 +11266,7 @@
 		sizeof(struct wkssvc_NetrSetPrimaryComputername),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrSetPrimaryComputername,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrSetPrimaryComputername,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrSetPrimaryComputername,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -11275,7 +11275,7 @@
 		sizeof(struct wkssvc_NetrEnumerateComputerNames),
 		(ndr_push_flags_fn_t) ndr_push_wkssvc_NetrEnumerateComputerNames,
 		(ndr_pull_flags_fn_t) ndr_pull_wkssvc_NetrEnumerateComputerNames,
-		(ndr_print_function_t) ndr_print_wkssvc_NetrEnumerateComputerNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_wmi.c samba3/source3/librpc/gen_ndr/ndr_wmi.c
--- samba3/source3/librpc/gen_ndr/ndr_wmi.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_wmi.c	2024-08-04 17:52:53.000000000 +0200
@@ -139,7 +139,7 @@
 		sizeof(struct Delete),
 		(ndr_push_flags_fn_t) ndr_push_Delete,
 		(ndr_pull_flags_fn_t) ndr_pull_Delete,
-		(ndr_print_function_t) ndr_print_Delete,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3704,7 +3704,7 @@
 		sizeof(struct OpenNamespace),
 		(ndr_push_flags_fn_t) ndr_push_OpenNamespace,
 		(ndr_pull_flags_fn_t) ndr_pull_OpenNamespace,
-		(ndr_print_function_t) ndr_print_OpenNamespace,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3713,7 +3713,7 @@
 		sizeof(struct CancelAsyncCall),
 		(ndr_push_flags_fn_t) ndr_push_CancelAsyncCall,
 		(ndr_pull_flags_fn_t) ndr_pull_CancelAsyncCall,
-		(ndr_print_function_t) ndr_print_CancelAsyncCall,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3722,7 +3722,7 @@
 		sizeof(struct QueryObjectSink),
 		(ndr_push_flags_fn_t) ndr_push_QueryObjectSink,
 		(ndr_pull_flags_fn_t) ndr_pull_QueryObjectSink,
-		(ndr_print_function_t) ndr_print_QueryObjectSink,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3731,7 +3731,7 @@
 		sizeof(struct GetObject),
 		(ndr_push_flags_fn_t) ndr_push_GetObject,
 		(ndr_pull_flags_fn_t) ndr_pull_GetObject,
-		(ndr_print_function_t) ndr_print_GetObject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3740,7 +3740,7 @@
 		sizeof(struct GetObjectAsync),
 		(ndr_push_flags_fn_t) ndr_push_GetObjectAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_GetObjectAsync,
-		(ndr_print_function_t) ndr_print_GetObjectAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3749,7 +3749,7 @@
 		sizeof(struct PutClass),
 		(ndr_push_flags_fn_t) ndr_push_PutClass,
 		(ndr_pull_flags_fn_t) ndr_pull_PutClass,
-		(ndr_print_function_t) ndr_print_PutClass,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3758,7 +3758,7 @@
 		sizeof(struct PutClassAsync),
 		(ndr_push_flags_fn_t) ndr_push_PutClassAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_PutClassAsync,
-		(ndr_print_function_t) ndr_print_PutClassAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3767,7 +3767,7 @@
 		sizeof(struct DeleteClass),
 		(ndr_push_flags_fn_t) ndr_push_DeleteClass,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteClass,
-		(ndr_print_function_t) ndr_print_DeleteClass,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3776,7 +3776,7 @@
 		sizeof(struct DeleteClassAsync),
 		(ndr_push_flags_fn_t) ndr_push_DeleteClassAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteClassAsync,
-		(ndr_print_function_t) ndr_print_DeleteClassAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3785,7 +3785,7 @@
 		sizeof(struct CreateClassEnum),
 		(ndr_push_flags_fn_t) ndr_push_CreateClassEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_CreateClassEnum,
-		(ndr_print_function_t) ndr_print_CreateClassEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3794,7 +3794,7 @@
 		sizeof(struct CreateClassEnumAsync),
 		(ndr_push_flags_fn_t) ndr_push_CreateClassEnumAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_CreateClassEnumAsync,
-		(ndr_print_function_t) ndr_print_CreateClassEnumAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3803,7 +3803,7 @@
 		sizeof(struct PutInstance),
 		(ndr_push_flags_fn_t) ndr_push_PutInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_PutInstance,
-		(ndr_print_function_t) ndr_print_PutInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3812,7 +3812,7 @@
 		sizeof(struct PutInstanceAsync),
 		(ndr_push_flags_fn_t) ndr_push_PutInstanceAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_PutInstanceAsync,
-		(ndr_print_function_t) ndr_print_PutInstanceAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3821,7 +3821,7 @@
 		sizeof(struct DeleteInstance),
 		(ndr_push_flags_fn_t) ndr_push_DeleteInstance,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteInstance,
-		(ndr_print_function_t) ndr_print_DeleteInstance,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3830,7 +3830,7 @@
 		sizeof(struct DeleteInstanceAsync),
 		(ndr_push_flags_fn_t) ndr_push_DeleteInstanceAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteInstanceAsync,
-		(ndr_print_function_t) ndr_print_DeleteInstanceAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3839,7 +3839,7 @@
 		sizeof(struct CreateInstanceEnum),
 		(ndr_push_flags_fn_t) ndr_push_CreateInstanceEnum,
 		(ndr_pull_flags_fn_t) ndr_pull_CreateInstanceEnum,
-		(ndr_print_function_t) ndr_print_CreateInstanceEnum,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3848,7 +3848,7 @@
 		sizeof(struct CreateInstanceEnumAsync),
 		(ndr_push_flags_fn_t) ndr_push_CreateInstanceEnumAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_CreateInstanceEnumAsync,
-		(ndr_print_function_t) ndr_print_CreateInstanceEnumAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3857,7 +3857,7 @@
 		sizeof(struct ExecQuery),
 		(ndr_push_flags_fn_t) ndr_push_ExecQuery,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecQuery,
-		(ndr_print_function_t) ndr_print_ExecQuery,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3866,7 +3866,7 @@
 		sizeof(struct ExecQueryAsync),
 		(ndr_push_flags_fn_t) ndr_push_ExecQueryAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecQueryAsync,
-		(ndr_print_function_t) ndr_print_ExecQueryAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3875,7 +3875,7 @@
 		sizeof(struct ExecNotificationQuery),
 		(ndr_push_flags_fn_t) ndr_push_ExecNotificationQuery,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecNotificationQuery,
-		(ndr_print_function_t) ndr_print_ExecNotificationQuery,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3884,7 +3884,7 @@
 		sizeof(struct ExecNotificationQueryAsync),
 		(ndr_push_flags_fn_t) ndr_push_ExecNotificationQueryAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecNotificationQueryAsync,
-		(ndr_print_function_t) ndr_print_ExecNotificationQueryAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3893,7 +3893,7 @@
 		sizeof(struct ExecMethod),
 		(ndr_push_flags_fn_t) ndr_push_ExecMethod,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecMethod,
-		(ndr_print_function_t) ndr_print_ExecMethod,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -3902,7 +3902,7 @@
 		sizeof(struct ExecMethodAsync),
 		(ndr_push_flags_fn_t) ndr_push_ExecMethodAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_ExecMethodAsync,
-		(ndr_print_function_t) ndr_print_ExecMethodAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4434,7 +4434,7 @@
 		sizeof(struct Reset),
 		(ndr_push_flags_fn_t) ndr_push_Reset,
 		(ndr_pull_flags_fn_t) ndr_pull_Reset,
-		(ndr_print_function_t) ndr_print_Reset,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4443,7 +4443,7 @@
 		sizeof(struct IEnumWbemClassObject_Next),
 		(ndr_push_flags_fn_t) ndr_push_IEnumWbemClassObject_Next,
 		(ndr_pull_flags_fn_t) ndr_pull_IEnumWbemClassObject_Next,
-		(ndr_print_function_t) ndr_print_IEnumWbemClassObject_Next,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4452,7 +4452,7 @@
 		sizeof(struct NextAsync),
 		(ndr_push_flags_fn_t) ndr_push_NextAsync,
 		(ndr_pull_flags_fn_t) ndr_pull_NextAsync,
-		(ndr_print_function_t) ndr_print_NextAsync,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4461,7 +4461,7 @@
 		sizeof(struct IEnumWbemClassObject_Clone),
 		(ndr_push_flags_fn_t) ndr_push_IEnumWbemClassObject_Clone,
 		(ndr_pull_flags_fn_t) ndr_pull_IEnumWbemClassObject_Clone,
-		(ndr_print_function_t) ndr_print_IEnumWbemClassObject_Clone,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -4470,7 +4470,7 @@
 		sizeof(struct Skip),
 		(ndr_push_flags_fn_t) ndr_push_Skip,
 		(ndr_pull_flags_fn_t) ndr_pull_Skip,
-		(ndr_print_function_t) ndr_print_Skip,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5143,7 +5143,7 @@
 		sizeof(struct Clone),
 		(ndr_push_flags_fn_t) ndr_push_Clone,
 		(ndr_pull_flags_fn_t) ndr_pull_Clone,
-		(ndr_print_function_t) ndr_print_Clone,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5152,7 +5152,7 @@
 		sizeof(struct GetNames),
 		(ndr_push_flags_fn_t) ndr_push_GetNames,
 		(ndr_pull_flags_fn_t) ndr_pull_GetNames,
-		(ndr_print_function_t) ndr_print_GetNames,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5161,7 +5161,7 @@
 		sizeof(struct BeginEnumeration),
 		(ndr_push_flags_fn_t) ndr_push_BeginEnumeration,
 		(ndr_pull_flags_fn_t) ndr_pull_BeginEnumeration,
-		(ndr_print_function_t) ndr_print_BeginEnumeration,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5170,7 +5170,7 @@
 		sizeof(struct Next),
 		(ndr_push_flags_fn_t) ndr_push_Next,
 		(ndr_pull_flags_fn_t) ndr_pull_Next,
-		(ndr_print_function_t) ndr_print_Next,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5179,7 +5179,7 @@
 		sizeof(struct EndEnumeration),
 		(ndr_push_flags_fn_t) ndr_push_EndEnumeration,
 		(ndr_pull_flags_fn_t) ndr_pull_EndEnumeration,
-		(ndr_print_function_t) ndr_print_EndEnumeration,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5188,7 +5188,7 @@
 		sizeof(struct SetValue),
 		(ndr_push_flags_fn_t) ndr_push_SetValue,
 		(ndr_pull_flags_fn_t) ndr_pull_SetValue,
-		(ndr_print_function_t) ndr_print_SetValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5197,7 +5197,7 @@
 		sizeof(struct GetValue),
 		(ndr_push_flags_fn_t) ndr_push_GetValue,
 		(ndr_pull_flags_fn_t) ndr_pull_GetValue,
-		(ndr_print_function_t) ndr_print_GetValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5206,7 +5206,7 @@
 		sizeof(struct DeleteValue),
 		(ndr_push_flags_fn_t) ndr_push_DeleteValue,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteValue,
-		(ndr_print_function_t) ndr_print_DeleteValue,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5215,7 +5215,7 @@
 		sizeof(struct DeleteAll),
 		(ndr_push_flags_fn_t) ndr_push_DeleteAll,
 		(ndr_pull_flags_fn_t) ndr_pull_DeleteAll,
-		(ndr_print_function_t) ndr_print_DeleteAll,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5963,7 +5963,7 @@
 		sizeof(struct EstablishPosition),
 		(ndr_push_flags_fn_t) ndr_push_EstablishPosition,
 		(ndr_pull_flags_fn_t) ndr_pull_EstablishPosition,
-		(ndr_print_function_t) ndr_print_EstablishPosition,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5972,7 +5972,7 @@
 		sizeof(struct RequestChallenge),
 		(ndr_push_flags_fn_t) ndr_push_RequestChallenge,
 		(ndr_pull_flags_fn_t) ndr_pull_RequestChallenge,
-		(ndr_print_function_t) ndr_print_RequestChallenge,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5981,7 +5981,7 @@
 		sizeof(struct WBEMLogin),
 		(ndr_push_flags_fn_t) ndr_push_WBEMLogin,
 		(ndr_pull_flags_fn_t) ndr_pull_WBEMLogin,
-		(ndr_print_function_t) ndr_print_WBEMLogin,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -5990,7 +5990,7 @@
 		sizeof(struct NTLMLogin),
 		(ndr_push_flags_fn_t) ndr_push_NTLMLogin,
 		(ndr_pull_flags_fn_t) ndr_pull_NTLMLogin,
-		(ndr_print_function_t) ndr_print_NTLMLogin,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6225,7 +6225,7 @@
 		sizeof(struct IWbemWCOSmartEnum_Next),
 		(ndr_push_flags_fn_t) ndr_push_IWbemWCOSmartEnum_Next,
 		(ndr_pull_flags_fn_t) ndr_pull_IWbemWCOSmartEnum_Next,
-		(ndr_print_function_t) ndr_print_IWbemWCOSmartEnum_Next,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6479,7 +6479,7 @@
 		sizeof(struct Fetch),
 		(ndr_push_flags_fn_t) ndr_push_Fetch,
 		(ndr_pull_flags_fn_t) ndr_pull_Fetch,
-		(ndr_print_function_t) ndr_print_Fetch,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6488,7 +6488,7 @@
 		sizeof(struct Test),
 		(ndr_push_flags_fn_t) ndr_push_Test,
 		(ndr_pull_flags_fn_t) ndr_pull_Test,
-		(ndr_print_function_t) ndr_print_Test,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6920,7 +6920,7 @@
 		sizeof(struct GetResultObject),
 		(ndr_push_flags_fn_t) ndr_push_GetResultObject,
 		(ndr_pull_flags_fn_t) ndr_pull_GetResultObject,
-		(ndr_print_function_t) ndr_print_GetResultObject,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6929,7 +6929,7 @@
 		sizeof(struct GetResultString),
 		(ndr_push_flags_fn_t) ndr_push_GetResultString,
 		(ndr_pull_flags_fn_t) ndr_pull_GetResultString,
-		(ndr_print_function_t) ndr_print_GetResultString,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6938,7 +6938,7 @@
 		sizeof(struct GetResultServices),
 		(ndr_push_flags_fn_t) ndr_push_GetResultServices,
 		(ndr_pull_flags_fn_t) ndr_pull_GetResultServices,
-		(ndr_print_function_t) ndr_print_GetResultServices,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -6947,7 +6947,7 @@
 		sizeof(struct GetCallStatus),
 		(ndr_push_flags_fn_t) ndr_push_GetCallStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_GetCallStatus,
-		(ndr_print_function_t) ndr_print_GetCallStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7211,7 +7211,7 @@
 		sizeof(struct SetStatus),
 		(ndr_push_flags_fn_t) ndr_push_SetStatus,
 		(ndr_pull_flags_fn_t) ndr_pull_SetStatus,
-		(ndr_print_function_t) ndr_print_SetStatus,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -7220,7 +7220,7 @@
 		sizeof(struct Indicate),
 		(ndr_push_flags_fn_t) ndr_push_Indicate,
 		(ndr_pull_flags_fn_t) ndr_pull_Indicate,
-		(ndr_print_function_t) ndr_print_Indicate,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_wzcsvc.c samba3/source3/librpc/gen_ndr/ndr_wzcsvc.c
--- samba3/source3/librpc/gen_ndr/ndr_wzcsvc.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_wzcsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -711,7 +711,7 @@
 		sizeof(struct wzcsvc_EnumInterfaces),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EnumInterfaces,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EnumInterfaces,
-		(ndr_print_function_t) ndr_print_wzcsvc_EnumInterfaces,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -720,7 +720,7 @@
 		sizeof(struct wzcsvc_QueryInterface),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_QueryInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_QueryInterface,
-		(ndr_print_function_t) ndr_print_wzcsvc_QueryInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -729,7 +729,7 @@
 		sizeof(struct wzcsvc_SetInterface),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_SetInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_SetInterface,
-		(ndr_print_function_t) ndr_print_wzcsvc_SetInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -738,7 +738,7 @@
 		sizeof(struct wzcsvc_RefreshInterface),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_RefreshInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_RefreshInterface,
-		(ndr_print_function_t) ndr_print_wzcsvc_RefreshInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -747,7 +747,7 @@
 		sizeof(struct wzcsvc_QueryContext),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_QueryContext,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_QueryContext,
-		(ndr_print_function_t) ndr_print_wzcsvc_QueryContext,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -756,7 +756,7 @@
 		sizeof(struct wzcsvc_SetContext),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_SetContext,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_SetContext,
-		(ndr_print_function_t) ndr_print_wzcsvc_SetContext,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -765,7 +765,7 @@
 		sizeof(struct wzcsvc_EapolUIResponse),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolUIResponse,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolUIResponse,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolUIResponse,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -774,7 +774,7 @@
 		sizeof(struct wzcsvc_EapolGetCustomAuthData),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolGetCustomAuthData,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolGetCustomAuthData,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolGetCustomAuthData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -783,7 +783,7 @@
 		sizeof(struct wzcsvc_EapolSetCustomAuthData),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolSetCustomAuthData,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolSetCustomAuthData,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolSetCustomAuthData,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -792,7 +792,7 @@
 		sizeof(struct wzcsvc_EapolGetInterfaceParams),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolGetInterfaceParams,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolGetInterfaceParams,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolGetInterfaceParams,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -801,7 +801,7 @@
 		sizeof(struct wzcsvc_EapolSetInterfaceParams),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolSetInterfaceParams,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolSetInterfaceParams,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolSetInterfaceParams,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -810,7 +810,7 @@
 		sizeof(struct wzcsvc_EapolReAuthenticateInterface),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolReAuthenticateInterface,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolReAuthenticateInterface,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolReAuthenticateInterface,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -819,7 +819,7 @@
 		sizeof(struct wzcsvc_EapolQueryInterfaceState),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EapolQueryInterfaceState,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EapolQueryInterfaceState,
-		(ndr_print_function_t) ndr_print_wzcsvc_EapolQueryInterfaceState,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -828,7 +828,7 @@
 		sizeof(struct wzcsvc_OpenWZCDbLogSession),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_OpenWZCDbLogSession,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_OpenWZCDbLogSession,
-		(ndr_print_function_t) ndr_print_wzcsvc_OpenWZCDbLogSession,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -837,7 +837,7 @@
 		sizeof(struct wzcsvc_CloseWZCDbLogSession),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_CloseWZCDbLogSession,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_CloseWZCDbLogSession,
-		(ndr_print_function_t) ndr_print_wzcsvc_CloseWZCDbLogSession,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -846,7 +846,7 @@
 		sizeof(struct wzcsvc_EnumWZCDbLogRecords),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_EnumWZCDbLogRecords,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_EnumWZCDbLogRecords,
-		(ndr_print_function_t) ndr_print_wzcsvc_EnumWZCDbLogRecords,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -855,7 +855,7 @@
 		sizeof(struct wzcsvc_FlushWZCdbLog),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_FlushWZCdbLog,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_FlushWZCdbLog,
-		(ndr_print_function_t) ndr_print_wzcsvc_FlushWZCdbLog,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
@@ -864,7 +864,7 @@
 		sizeof(struct wzcsvc_GetWZCDbLogRecord),
 		(ndr_push_flags_fn_t) ndr_push_wzcsvc_GetWZCDbLogRecord,
 		(ndr_pull_flags_fn_t) ndr_pull_wzcsvc_GetWZCDbLogRecord,
-		(ndr_print_function_t) ndr_print_wzcsvc_GetWZCDbLogRecord,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/ndr_xattr.c samba3/source3/librpc/gen_ndr/ndr_xattr.c
--- samba3/source3/librpc/gen_ndr/ndr_xattr.c	2015-02-22 15:16:53.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/ndr_xattr.c	2024-08-04 17:52:53.000000000 +0200
@@ -1101,7 +1101,7 @@
 		sizeof(struct xattr_parse_DOSATTRIB),
 		(ndr_push_flags_fn_t) ndr_push_xattr_parse_DOSATTRIB,
 		(ndr_pull_flags_fn_t) ndr_pull_xattr_parse_DOSATTRIB,
-		(ndr_print_function_t) ndr_print_xattr_parse_DOSATTRIB,
+		(ndr_print_function_t) ndr_print_disabled,
 		{ 0, NULL },
 		{ 0, NULL },
 	},
diff -daurN samba3/source3/librpc/gen_ndr/py_dcerpc.c samba3/source3/librpc/gen_ndr/py_dcerpc.c
--- samba3/source3/librpc/gen_ndr/py_dcerpc.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/py_dcerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -52,10 +52,15 @@
 staticforward PyTypeObject dcerpc_rts_Type;
 staticforward PyTypeObject ncacn_packet_Type;
 staticforward PyTypeObject ncadg_packet_Type;
+staticforward PyTypeObject dcerpc_sec_vt_pcontext_Type;
+staticforward PyTypeObject dcerpc_sec_vt_header2_Type;
+staticforward PyTypeObject dcerpc_sec_vt_Type;
+staticforward PyTypeObject dcerpc_sec_vt_count_Type;
+staticforward PyTypeObject dcerpc_sec_verification_trailer_Type;
 
-void initdcerpc(void);static PyTypeObject *Object_Type;
+void initdcerpc(void);static PyTypeObject *ndr_syntax_id_Type;
+static PyTypeObject *Object_Type;
 static PyTypeObject *GUID_Type;
-static PyTypeObject *ndr_syntax_id_Type;
 
 static PyObject *py_dcerpc_ctx_list_get_context_id(PyObject *obj, void *closure)
 {
@@ -5068,8 +5073,15 @@
 static int py_ncacn_packet_set_pfc_flags(PyObject *py_obj, PyObject *value, void *closure)
 {
 	struct ncacn_packet *object = (struct ncacn_packet *)py_talloc_get_ptr(py_obj);
-	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
-	object->pfc_flags = PyInt_AsLong(value);
+	if (PyLong_Check(value)) {
+		object->pfc_flags = PyLong_AsLongLong(value);
+	} else if (PyInt_Check(value)) {
+		object->pfc_flags = PyInt_AsLong(value);
+	} else {
+		PyErr_Format(PyExc_TypeError, "Expected type %s or %s",\
+		  PyInt_Type.tp_name, PyLong_Type.tp_name);
+		return -1;
+	}
 	return 0;
 }
 
@@ -5709,6 +5721,646 @@
 	.tp_new = py_ncadg_packet_new,
 };
 
+
+static PyObject *py_dcerpc_sec_vt_pcontext_get_abstract_syntax(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_pcontext *object = (struct dcerpc_sec_vt_pcontext *)py_talloc_get_ptr(obj);
+	PyObject *py_abstract_syntax;
+	py_abstract_syntax = py_talloc_reference_ex(ndr_syntax_id_Type, py_talloc_get_mem_ctx(obj), &object->abstract_syntax);
+	return py_abstract_syntax;
+}
+
+static int py_dcerpc_sec_vt_pcontext_set_abstract_syntax(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_pcontext *object = (struct dcerpc_sec_vt_pcontext *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(ndr_syntax_id_Type, value, return -1;);
+	if (talloc_reference(py_talloc_get_mem_ctx(py_obj), py_talloc_get_mem_ctx(value)) == NULL) {
+		PyErr_NoMemory();
+		return -1;
+	}
+	object->abstract_syntax = *(struct ndr_syntax_id *)py_talloc_get_ptr(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_pcontext_get_transfer_syntax(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_pcontext *object = (struct dcerpc_sec_vt_pcontext *)py_talloc_get_ptr(obj);
+	PyObject *py_transfer_syntax;
+	py_transfer_syntax = py_talloc_reference_ex(ndr_syntax_id_Type, py_talloc_get_mem_ctx(obj), &object->transfer_syntax);
+	return py_transfer_syntax;
+}
+
+static int py_dcerpc_sec_vt_pcontext_set_transfer_syntax(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_pcontext *object = (struct dcerpc_sec_vt_pcontext *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(ndr_syntax_id_Type, value, return -1;);
+	if (talloc_reference(py_talloc_get_mem_ctx(py_obj), py_talloc_get_mem_ctx(value)) == NULL) {
+		PyErr_NoMemory();
+		return -1;
+	}
+	object->transfer_syntax = *(struct ndr_syntax_id *)py_talloc_get_ptr(value);
+	return 0;
+}
+
+static PyGetSetDef py_dcerpc_sec_vt_pcontext_getsetters[] = {
+	{ discard_const_p(char, "abstract_syntax"), py_dcerpc_sec_vt_pcontext_get_abstract_syntax, py_dcerpc_sec_vt_pcontext_set_abstract_syntax },
+	{ discard_const_p(char, "transfer_syntax"), py_dcerpc_sec_vt_pcontext_get_transfer_syntax, py_dcerpc_sec_vt_pcontext_set_transfer_syntax },
+	{ NULL }
+};
+
+static PyObject *py_dcerpc_sec_vt_pcontext_new(PyTypeObject *type, PyObject *args, PyObject *kwargs)
+{
+	return py_talloc_new(struct dcerpc_sec_vt_pcontext, type);
+}
+
+
+static PyTypeObject dcerpc_sec_vt_pcontext_Type = {
+	PyObject_HEAD_INIT(NULL) 0,
+	.tp_name = "dcerpc.sec_vt_pcontext",
+	.tp_getset = py_dcerpc_sec_vt_pcontext_getsetters,
+	.tp_methods = NULL,
+	.tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE,
+	.tp_basicsize = sizeof(py_talloc_Object),
+	.tp_new = py_dcerpc_sec_vt_pcontext_new,
+};
+
+
+static PyObject *py_dcerpc_sec_vt_header2_get_ptype(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_ptype;
+	py_ptype = PyInt_FromLong(object->ptype);
+	return py_ptype;
+}
+
+static int py_dcerpc_sec_vt_header2_set_ptype(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	if (PyLong_Check(value)) {
+		object->ptype = PyLong_AsLongLong(value);
+	} else if (PyInt_Check(value)) {
+		object->ptype = PyInt_AsLong(value);
+	} else {
+		PyErr_Format(PyExc_TypeError, "Expected type %s or %s",\
+		  PyInt_Type.tp_name, PyLong_Type.tp_name);
+		return -1;
+	}
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_reserved1(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_reserved1;
+	py_reserved1 = PyInt_FromLong(object->reserved1);
+	return py_reserved1;
+}
+
+static int py_dcerpc_sec_vt_header2_set_reserved1(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->reserved1 = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_reserved2(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_reserved2;
+	py_reserved2 = PyInt_FromLong(object->reserved2);
+	return py_reserved2;
+}
+
+static int py_dcerpc_sec_vt_header2_set_reserved2(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->reserved2 = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_drep(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_drep;
+	py_drep = PyList_New(4);
+	if (py_drep == NULL) {
+		return NULL;
+	}
+	{
+		int drep_cntr_0;
+		for (drep_cntr_0 = 0; drep_cntr_0 < 4; drep_cntr_0++) {
+			PyObject *py_drep_0;
+			py_drep_0 = PyInt_FromLong(object->drep[drep_cntr_0]);
+			PyList_SetItem(py_drep, drep_cntr_0, py_drep_0);
+		}
+	}
+	return py_drep;
+}
+
+static int py_dcerpc_sec_vt_header2_set_drep(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyList_Type, value, return -1;);
+	{
+		int drep_cntr_0;
+		for (drep_cntr_0 = 0; drep_cntr_0 < PyList_GET_SIZE(value); drep_cntr_0++) {
+			PY_CHECK_TYPE(&PyInt_Type, PyList_GET_ITEM(value, drep_cntr_0), return -1;);
+			object->drep[drep_cntr_0] = PyInt_AsLong(PyList_GET_ITEM(value, drep_cntr_0));
+		}
+	}
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_call_id(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_call_id;
+	py_call_id = PyInt_FromLong(object->call_id);
+	return py_call_id;
+}
+
+static int py_dcerpc_sec_vt_header2_set_call_id(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->call_id = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_context_id(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_context_id;
+	py_context_id = PyInt_FromLong(object->context_id);
+	return py_context_id;
+}
+
+static int py_dcerpc_sec_vt_header2_set_context_id(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->context_id = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_header2_get_opnum(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(obj);
+	PyObject *py_opnum;
+	py_opnum = PyInt_FromLong(object->opnum);
+	return py_opnum;
+}
+
+static int py_dcerpc_sec_vt_header2_set_opnum(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_header2 *object = (struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->opnum = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyGetSetDef py_dcerpc_sec_vt_header2_getsetters[] = {
+	{ discard_const_p(char, "ptype"), py_dcerpc_sec_vt_header2_get_ptype, py_dcerpc_sec_vt_header2_set_ptype },
+	{ discard_const_p(char, "reserved1"), py_dcerpc_sec_vt_header2_get_reserved1, py_dcerpc_sec_vt_header2_set_reserved1 },
+	{ discard_const_p(char, "reserved2"), py_dcerpc_sec_vt_header2_get_reserved2, py_dcerpc_sec_vt_header2_set_reserved2 },
+	{ discard_const_p(char, "drep"), py_dcerpc_sec_vt_header2_get_drep, py_dcerpc_sec_vt_header2_set_drep },
+	{ discard_const_p(char, "call_id"), py_dcerpc_sec_vt_header2_get_call_id, py_dcerpc_sec_vt_header2_set_call_id },
+	{ discard_const_p(char, "context_id"), py_dcerpc_sec_vt_header2_get_context_id, py_dcerpc_sec_vt_header2_set_context_id },
+	{ discard_const_p(char, "opnum"), py_dcerpc_sec_vt_header2_get_opnum, py_dcerpc_sec_vt_header2_set_opnum },
+	{ NULL }
+};
+
+static PyObject *py_dcerpc_sec_vt_header2_new(PyTypeObject *type, PyObject *args, PyObject *kwargs)
+{
+	return py_talloc_new(struct dcerpc_sec_vt_header2, type);
+}
+
+
+static PyTypeObject dcerpc_sec_vt_header2_Type = {
+	PyObject_HEAD_INIT(NULL) 0,
+	.tp_name = "dcerpc.sec_vt_header2",
+	.tp_getset = py_dcerpc_sec_vt_header2_getsetters,
+	.tp_methods = NULL,
+	.tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE,
+	.tp_basicsize = sizeof(py_talloc_Object),
+	.tp_new = py_dcerpc_sec_vt_header2_new,
+};
+
+PyObject *py_import_dcerpc_sec_vt_union(TALLOC_CTX *mem_ctx, int level, union dcerpc_sec_vt_union *in)
+{
+	PyObject *ret;
+
+	switch (level) {
+		case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			ret = PyInt_FromLong(in->bitmask1);
+			return ret;
+
+		case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			ret = py_talloc_reference_ex(&dcerpc_sec_vt_pcontext_Type, mem_ctx, &in->pcontext);
+			return ret;
+
+		case DCERPC_SEC_VT_COMMAND_HEADER2:
+			ret = py_talloc_reference_ex(&dcerpc_sec_vt_header2_Type, mem_ctx, &in->header2);
+			return ret;
+
+		default:
+			ret = PyString_FromStringAndSize((char *)(in->_unknown).data, (in->_unknown).length);
+			return ret;
+
+	}
+	PyErr_SetString(PyExc_TypeError, "unknown union level");
+	return NULL;
+}
+
+union dcerpc_sec_vt_union *py_export_dcerpc_sec_vt_union(TALLOC_CTX *mem_ctx, int level, PyObject *in)
+{
+	union dcerpc_sec_vt_union *ret = talloc_zero(mem_ctx, union dcerpc_sec_vt_union);
+	switch (level) {
+		case DCERPC_SEC_VT_COMMAND_BITMASK1:
+			if (PyLong_Check(in)) {
+				ret->bitmask1 = PyLong_AsLongLong(in);
+			} else if (PyInt_Check(in)) {
+				ret->bitmask1 = PyInt_AsLong(in);
+			} else {
+				PyErr_Format(PyExc_TypeError, "Expected type %s or %s",\
+				  PyInt_Type.tp_name, PyLong_Type.tp_name);
+				talloc_free(ret); return NULL;
+			}
+			break;
+
+		case DCERPC_SEC_VT_COMMAND_PCONTEXT:
+			PY_CHECK_TYPE(&dcerpc_sec_vt_pcontext_Type, in, talloc_free(ret); return NULL;);
+			if (talloc_reference(mem_ctx, py_talloc_get_mem_ctx(in)) == NULL) {
+				PyErr_NoMemory();
+				talloc_free(ret); return NULL;
+			}
+			ret->pcontext = *(struct dcerpc_sec_vt_pcontext *)py_talloc_get_ptr(in);
+			break;
+
+		case DCERPC_SEC_VT_COMMAND_HEADER2:
+			PY_CHECK_TYPE(&dcerpc_sec_vt_header2_Type, in, talloc_free(ret); return NULL;);
+			if (talloc_reference(mem_ctx, py_talloc_get_mem_ctx(in)) == NULL) {
+				PyErr_NoMemory();
+				talloc_free(ret); return NULL;
+			}
+			ret->header2 = *(struct dcerpc_sec_vt_header2 *)py_talloc_get_ptr(in);
+			break;
+
+		default:
+			ret->_unknown = data_blob_talloc(mem_ctx, PyString_AS_STRING(in), PyString_GET_SIZE(in));
+			break;
+
+	}
+
+	return ret;
+}
+
+
+static PyObject *py_dcerpc_sec_vt_get_command(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt *object = (struct dcerpc_sec_vt *)py_talloc_get_ptr(obj);
+	PyObject *py_command;
+	py_command = PyInt_FromLong(object->command);
+	return py_command;
+}
+
+static int py_dcerpc_sec_vt_set_command(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt *object = (struct dcerpc_sec_vt *)py_talloc_get_ptr(py_obj);
+	if (PyLong_Check(value)) {
+		object->command = PyLong_AsLongLong(value);
+	} else if (PyInt_Check(value)) {
+		object->command = PyInt_AsLong(value);
+	} else {
+		PyErr_Format(PyExc_TypeError, "Expected type %s or %s",\
+		  PyInt_Type.tp_name, PyLong_Type.tp_name);
+		return -1;
+	}
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_vt_get_u(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt *object = (struct dcerpc_sec_vt *)py_talloc_get_ptr(obj);
+	PyObject *py_u;
+	py_u = py_import_dcerpc_sec_vt_union(py_talloc_get_mem_ctx(obj), object->command & DCERPC_SEC_VT_COMMAND_ENUM, &object->u);
+	if (py_u == NULL) {
+		return NULL;
+	}
+	return py_u;
+}
+
+static int py_dcerpc_sec_vt_set_u(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt *object = (struct dcerpc_sec_vt *)py_talloc_get_ptr(py_obj);
+	{
+		union dcerpc_sec_vt_union *u_switch_1;
+		u_switch_1 = py_export_dcerpc_sec_vt_union(py_talloc_get_mem_ctx(py_obj), object->command & DCERPC_SEC_VT_COMMAND_ENUM, value);
+		if (u_switch_1 == NULL) {
+			return -1;
+		}
+		object->u = *u_switch_1;
+	}
+	return 0;
+}
+
+static PyGetSetDef py_dcerpc_sec_vt_getsetters[] = {
+	{ discard_const_p(char, "command"), py_dcerpc_sec_vt_get_command, py_dcerpc_sec_vt_set_command },
+	{ discard_const_p(char, "u"), py_dcerpc_sec_vt_get_u, py_dcerpc_sec_vt_set_u },
+	{ NULL }
+};
+
+static PyObject *py_dcerpc_sec_vt_new(PyTypeObject *type, PyObject *args, PyObject *kwargs)
+{
+	return py_talloc_new(struct dcerpc_sec_vt, type);
+}
+
+
+static PyTypeObject dcerpc_sec_vt_Type = {
+	PyObject_HEAD_INIT(NULL) 0,
+	.tp_name = "dcerpc.sec_vt",
+	.tp_getset = py_dcerpc_sec_vt_getsetters,
+	.tp_methods = NULL,
+	.tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE,
+	.tp_basicsize = sizeof(py_talloc_Object),
+	.tp_new = py_dcerpc_sec_vt_new,
+};
+
+
+static PyObject *py_dcerpc_sec_vt_count_get_count(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_vt_count *object = (struct dcerpc_sec_vt_count *)py_talloc_get_ptr(obj);
+	PyObject *py_count;
+	py_count = PyInt_FromLong(object->count);
+	return py_count;
+}
+
+static int py_dcerpc_sec_vt_count_set_count(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_vt_count *object = (struct dcerpc_sec_vt_count *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyInt_Type, value, return -1;);
+	object->count = PyInt_AsLong(value);
+	return 0;
+}
+
+static PyGetSetDef py_dcerpc_sec_vt_count_getsetters[] = {
+	{ discard_const_p(char, "count"), py_dcerpc_sec_vt_count_get_count, py_dcerpc_sec_vt_count_set_count },
+	{ NULL }
+};
+
+static PyObject *py_dcerpc_sec_vt_count_new(PyTypeObject *type, PyObject *args, PyObject *kwargs)
+{
+	return py_talloc_new(struct dcerpc_sec_vt_count, type);
+}
+
+static PyObject *py_dcerpc_sec_vt_count_ndr_pack(PyObject *py_obj)
+{
+	struct dcerpc_sec_vt_count *object = (struct dcerpc_sec_vt_count *)py_talloc_get_ptr(py_obj);
+	DATA_BLOB blob;
+	enum ndr_err_code err;
+	err = ndr_push_struct_blob(&blob, py_talloc_get_mem_ctx(py_obj), object, (ndr_push_flags_fn_t)ndr_push_dcerpc_sec_vt_count);
+	if (err != NDR_ERR_SUCCESS) {
+		PyErr_SetNdrError(err);
+		return NULL;
+	}
+
+	return PyString_FromStringAndSize((char *)blob.data, blob.length);
+}
+
+static PyObject *py_dcerpc_sec_vt_count_ndr_unpack(PyObject *py_obj, PyObject *args)
+{
+	struct dcerpc_sec_vt_count *object = (struct dcerpc_sec_vt_count *)py_talloc_get_ptr(py_obj);
+	DATA_BLOB blob;
+	enum ndr_err_code err;
+	if (!PyArg_ParseTuple(args, "s#:__ndr_unpack__", &blob.data, &blob.length))
+		return NULL;
+
+	err = ndr_pull_struct_blob_all(&blob, py_talloc_get_mem_ctx(py_obj), object, (ndr_pull_flags_fn_t)ndr_pull_dcerpc_sec_vt_count);
+	if (err != NDR_ERR_SUCCESS) {
+		PyErr_SetNdrError(err);
+		return NULL;
+	}
+
+	Py_RETURN_NONE;
+}
+
+static PyObject *py_dcerpc_sec_vt_count_ndr_print(PyObject *py_obj)
+{
+	struct dcerpc_sec_vt_count *object = (struct dcerpc_sec_vt_count *)py_talloc_get_ptr(py_obj);
+	PyObject *ret;
+	char *retstr;
+
+	retstr = ndr_print_struct_string(py_talloc_get_mem_ctx(py_obj), (ndr_print_fn_t)ndr_print_dcerpc_sec_vt_count, "dcerpc_sec_vt_count", object);
+	ret = PyString_FromString(retstr);
+	talloc_free(retstr);
+
+	return ret;
+}
+
+static PyMethodDef py_dcerpc_sec_vt_count_methods[] = {
+	{ "__ndr_pack__", (PyCFunction)py_dcerpc_sec_vt_count_ndr_pack, METH_NOARGS, "S.ndr_pack(object) -> blob\nNDR pack" },
+	{ "__ndr_unpack__", (PyCFunction)py_dcerpc_sec_vt_count_ndr_unpack, METH_VARARGS, "S.ndr_unpack(class, blob) -> None\nNDR unpack" },
+	{ "__ndr_print__", (PyCFunction)py_dcerpc_sec_vt_count_ndr_print, METH_VARARGS, "S.ndr_print(object) -> None\nNDR print" },
+	{ NULL, NULL, 0, NULL }
+};
+
+
+static PyTypeObject dcerpc_sec_vt_count_Type = {
+	PyObject_HEAD_INIT(NULL) 0,
+	.tp_name = "dcerpc.sec_vt_count",
+	.tp_getset = py_dcerpc_sec_vt_count_getsetters,
+	.tp_methods = py_dcerpc_sec_vt_count_methods,
+	.tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE,
+	.tp_basicsize = sizeof(py_talloc_Object),
+	.tp_new = py_dcerpc_sec_vt_count_new,
+};
+
+
+static PyObject *py_dcerpc_sec_verification_trailer_get__pad(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(obj);
+	PyObject *py__pad;
+	py__pad = PyString_FromStringAndSize((char *)(object->_pad).data, (object->_pad).length);
+	return py__pad;
+}
+
+static int py_dcerpc_sec_verification_trailer_set__pad(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	object->_pad = data_blob_talloc(py_talloc_get_mem_ctx(py_obj), PyString_AS_STRING(value), PyString_GET_SIZE(value));
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_get_magic(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(obj);
+	PyObject *py_magic;
+	py_magic = PyList_New(8);
+	if (py_magic == NULL) {
+		return NULL;
+	}
+	{
+		int magic_cntr_0;
+		for (magic_cntr_0 = 0; magic_cntr_0 < 8; magic_cntr_0++) {
+			PyObject *py_magic_0;
+			py_magic_0 = PyInt_FromLong(object->magic[magic_cntr_0]);
+			PyList_SetItem(py_magic, magic_cntr_0, py_magic_0);
+		}
+	}
+	return py_magic;
+}
+
+static int py_dcerpc_sec_verification_trailer_set_magic(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyList_Type, value, return -1;);
+	{
+		int magic_cntr_0;
+		for (magic_cntr_0 = 0; magic_cntr_0 < PyList_GET_SIZE(value); magic_cntr_0++) {
+			PY_CHECK_TYPE(&PyInt_Type, PyList_GET_ITEM(value, magic_cntr_0), return -1;);
+			object->magic[magic_cntr_0] = PyInt_AsLong(PyList_GET_ITEM(value, magic_cntr_0));
+		}
+	}
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_get_count(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(obj);
+	PyObject *py_count;
+	py_count = py_talloc_reference_ex(&dcerpc_sec_vt_count_Type, py_talloc_get_mem_ctx(obj), &object->count);
+	return py_count;
+}
+
+static int py_dcerpc_sec_verification_trailer_set_count(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&dcerpc_sec_vt_count_Type, value, return -1;);
+	if (talloc_reference(py_talloc_get_mem_ctx(py_obj), py_talloc_get_mem_ctx(value)) == NULL) {
+		PyErr_NoMemory();
+		return -1;
+	}
+	object->count = *(struct dcerpc_sec_vt_count *)py_talloc_get_ptr(value);
+	return 0;
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_get_commands(PyObject *obj, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(obj);
+	PyObject *py_commands;
+	py_commands = PyList_New(object->count.count);
+	if (py_commands == NULL) {
+		return NULL;
+	}
+	{
+		int commands_cntr_0;
+		for (commands_cntr_0 = 0; commands_cntr_0 < object->count.count; commands_cntr_0++) {
+			PyObject *py_commands_0;
+			py_commands_0 = py_talloc_reference_ex(&dcerpc_sec_vt_Type, object->commands, &object->commands[commands_cntr_0]);
+			PyList_SetItem(py_commands, commands_cntr_0, py_commands_0);
+		}
+	}
+	return py_commands;
+}
+
+static int py_dcerpc_sec_verification_trailer_set_commands(PyObject *py_obj, PyObject *value, void *closure)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	PY_CHECK_TYPE(&PyList_Type, value, return -1;);
+	{
+		int commands_cntr_0;
+		object->commands = talloc_array_ptrtype(py_talloc_get_mem_ctx(py_obj), object->commands, PyList_GET_SIZE(value));
+		if (!object->commands) { return -1;; }
+		talloc_set_name_const(object->commands, "ARRAY: object->commands");
+		for (commands_cntr_0 = 0; commands_cntr_0 < PyList_GET_SIZE(value); commands_cntr_0++) {
+			PY_CHECK_TYPE(&dcerpc_sec_vt_Type, PyList_GET_ITEM(value, commands_cntr_0), return -1;);
+			if (talloc_reference(object->commands, py_talloc_get_mem_ctx(PyList_GET_ITEM(value, commands_cntr_0))) == NULL) {
+				PyErr_NoMemory();
+				return -1;
+			}
+			object->commands[commands_cntr_0] = *(struct dcerpc_sec_vt *)py_talloc_get_ptr(PyList_GET_ITEM(value, commands_cntr_0));
+		}
+	}
+	return 0;
+}
+
+static PyGetSetDef py_dcerpc_sec_verification_trailer_getsetters[] = {
+	{ discard_const_p(char, "_pad"), py_dcerpc_sec_verification_trailer_get__pad, py_dcerpc_sec_verification_trailer_set__pad },
+	{ discard_const_p(char, "magic"), py_dcerpc_sec_verification_trailer_get_magic, py_dcerpc_sec_verification_trailer_set_magic },
+	{ discard_const_p(char, "count"), py_dcerpc_sec_verification_trailer_get_count, py_dcerpc_sec_verification_trailer_set_count },
+	{ discard_const_p(char, "commands"), py_dcerpc_sec_verification_trailer_get_commands, py_dcerpc_sec_verification_trailer_set_commands },
+	{ NULL }
+};
+
+static PyObject *py_dcerpc_sec_verification_trailer_new(PyTypeObject *type, PyObject *args, PyObject *kwargs)
+{
+	return py_talloc_new(struct dcerpc_sec_verification_trailer, type);
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_ndr_pack(PyObject *py_obj)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	DATA_BLOB blob;
+	enum ndr_err_code err;
+	err = ndr_push_struct_blob(&blob, py_talloc_get_mem_ctx(py_obj), object, (ndr_push_flags_fn_t)ndr_push_dcerpc_sec_verification_trailer);
+	if (err != NDR_ERR_SUCCESS) {
+		PyErr_SetNdrError(err);
+		return NULL;
+	}
+
+	return PyString_FromStringAndSize((char *)blob.data, blob.length);
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_ndr_unpack(PyObject *py_obj, PyObject *args)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	DATA_BLOB blob;
+	enum ndr_err_code err;
+	if (!PyArg_ParseTuple(args, "s#:__ndr_unpack__", &blob.data, &blob.length))
+		return NULL;
+
+	err = ndr_pull_struct_blob_all(&blob, py_talloc_get_mem_ctx(py_obj), object, (ndr_pull_flags_fn_t)ndr_pull_dcerpc_sec_verification_trailer);
+	if (err != NDR_ERR_SUCCESS) {
+		PyErr_SetNdrError(err);
+		return NULL;
+	}
+
+	Py_RETURN_NONE;
+}
+
+static PyObject *py_dcerpc_sec_verification_trailer_ndr_print(PyObject *py_obj)
+{
+	struct dcerpc_sec_verification_trailer *object = (struct dcerpc_sec_verification_trailer *)py_talloc_get_ptr(py_obj);
+	PyObject *ret;
+	char *retstr;
+
+	retstr = ndr_print_struct_string(py_talloc_get_mem_ctx(py_obj), (ndr_print_fn_t)ndr_print_dcerpc_sec_verification_trailer, "dcerpc_sec_verification_trailer", object);
+	ret = PyString_FromString(retstr);
+	talloc_free(retstr);
+
+	return ret;
+}
+
+static PyMethodDef py_dcerpc_sec_verification_trailer_methods[] = {
+	{ "__ndr_pack__", (PyCFunction)py_dcerpc_sec_verification_trailer_ndr_pack, METH_NOARGS, "S.ndr_pack(object) -> blob\nNDR pack" },
+	{ "__ndr_unpack__", (PyCFunction)py_dcerpc_sec_verification_trailer_ndr_unpack, METH_VARARGS, "S.ndr_unpack(class, blob) -> None\nNDR unpack" },
+	{ "__ndr_print__", (PyCFunction)py_dcerpc_sec_verification_trailer_ndr_print, METH_VARARGS, "S.ndr_print(object) -> None\nNDR print" },
+	{ NULL, NULL, 0, NULL }
+};
+
+
+static PyTypeObject dcerpc_sec_verification_trailer_Type = {
+	PyObject_HEAD_INIT(NULL) 0,
+	.tp_name = "dcerpc.sec_verification_trailer",
+	.tp_getset = py_dcerpc_sec_verification_trailer_getsetters,
+	.tp_methods = py_dcerpc_sec_verification_trailer_methods,
+	.tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE,
+	.tp_basicsize = sizeof(py_talloc_Object),
+	.tp_new = py_dcerpc_sec_verification_trailer_new,
+};
+
 static PyMethodDef dcerpc_methods[] = {
 	{ NULL, NULL, 0, NULL }
 };
@@ -5716,15 +6368,19 @@
 void initdcerpc(void)
 {
 	PyObject *m;
-	PyObject *dep_samba_dcerpc_misc;
 	PyObject *dep_talloc;
+	PyObject *dep_samba_dcerpc_misc;
+
+	dep_talloc = PyImport_ImportModule("talloc");
+	if (dep_talloc == NULL)
+		return;
 
 	dep_samba_dcerpc_misc = PyImport_ImportModule("samba.dcerpc.misc");
 	if (dep_samba_dcerpc_misc == NULL)
 		return;
 
-	dep_talloc = PyImport_ImportModule("talloc");
-	if (dep_talloc == NULL)
+	ndr_syntax_id_Type = (PyTypeObject *)PyObject_GetAttrString(dep_samba_dcerpc_misc, "ndr_syntax_id");
+	if (ndr_syntax_id_Type == NULL)
 		return;
 
 	Object_Type = (PyTypeObject *)PyObject_GetAttrString(dep_talloc, "Object");
@@ -5735,10 +6391,6 @@
 	if (GUID_Type == NULL)
 		return;
 
-	ndr_syntax_id_Type = (PyTypeObject *)PyObject_GetAttrString(dep_samba_dcerpc_misc, "ndr_syntax_id");
-	if (ndr_syntax_id_Type == NULL)
-		return;
-
 	dcerpc_ctx_list_Type.tp_base = Object_Type;
 
 	dcerpc_bind_Type.tp_base = Object_Type;
@@ -5825,6 +6477,16 @@
 
 	ncadg_packet_Type.tp_base = Object_Type;
 
+	dcerpc_sec_vt_pcontext_Type.tp_base = Object_Type;
+
+	dcerpc_sec_vt_header2_Type.tp_base = Object_Type;
+
+	dcerpc_sec_vt_Type.tp_base = Object_Type;
+
+	dcerpc_sec_vt_count_Type.tp_base = Object_Type;
+
+	dcerpc_sec_verification_trailer_Type.tp_base = Object_Type;
+
 	if (PyType_Ready(&dcerpc_ctx_list_Type) < 0)
 		return;
 	if (PyType_Ready(&dcerpc_bind_Type) < 0)
@@ -5911,6 +6573,16 @@
 		return;
 	if (PyType_Ready(&ncadg_packet_Type) < 0)
 		return;
+	if (PyType_Ready(&dcerpc_sec_vt_pcontext_Type) < 0)
+		return;
+	if (PyType_Ready(&dcerpc_sec_vt_header2_Type) < 0)
+		return;
+	if (PyType_Ready(&dcerpc_sec_vt_Type) < 0)
+		return;
+	if (PyType_Ready(&dcerpc_sec_vt_count_Type) < 0)
+		return;
+	if (PyType_Ready(&dcerpc_sec_verification_trailer_Type) < 0)
+		return;
 #ifdef PY_CTX_LIST_PATCH
 	PY_CTX_LIST_PATCH(&dcerpc_ctx_list_Type);
 #endif
@@ -6040,142 +6712,169 @@
 #ifdef PY_NCADG_PACKET_PATCH
 	PY_NCADG_PACKET_PATCH(&ncadg_packet_Type);
 #endif
+#ifdef PY_SEC_VT_PCONTEXT_PATCH
+	PY_SEC_VT_PCONTEXT_PATCH(&dcerpc_sec_vt_pcontext_Type);
+#endif
+#ifdef PY_SEC_VT_HEADER2_PATCH
+	PY_SEC_VT_HEADER2_PATCH(&dcerpc_sec_vt_header2_Type);
+#endif
+#ifdef PY_SEC_VT_PATCH
+	PY_SEC_VT_PATCH(&dcerpc_sec_vt_Type);
+#endif
+#ifdef PY_SEC_VT_COUNT_PATCH
+	PY_SEC_VT_COUNT_PATCH(&dcerpc_sec_vt_count_Type);
+#endif
+#ifdef PY_SEC_VERIFICATION_TRAILER_PATCH
+	PY_SEC_VERIFICATION_TRAILER_PATCH(&dcerpc_sec_verification_trailer_Type);
+#endif
 
 	m = Py_InitModule3("dcerpc", dcerpc_methods, "dcerpc DCE/RPC");
 	if (m == NULL)
 		return;
 
-	PyModule_AddObject(m, "DCERPC_PKT_CL_CANCEL", PyInt_FromLong(DCERPC_PKT_CL_CANCEL));
-	PyModule_AddObject(m, "DCERPC_FAULT_OP_RNG_ERROR", PyInt_FromLong(0x1c010002));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_MAYBE", PyInt_FromLong(0x40));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_SCHANNEL", PyInt_FromLong(DCERPC_AUTH_TYPE_SCHANNEL));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INT_OVERFLOW", PyInt_FromLong(DCERPC_NCA_S_FAULT_INT_OVERFLOW));
+	PyModule_AddObject(m, "DCERPC_PKT_ORPHANED", PyInt_FromLong(DCERPC_PKT_ORPHANED));
+	PyModule_AddObject(m, "RTS_FLAG_ECHO", PyInt_FromLong(RTS_FLAG_ECHO));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING", PyInt_FromLong(DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_COMMAND_END", PyInt_FromLong(DCERPC_SEC_VT_COMMAND_END));
+	PyModule_AddObject(m, "DCERPC_PKT_WORKING", PyInt_FromLong(DCERPC_PKT_WORKING));
+	PyModule_AddObject(m, "DCERPC_FAULT_TODO", PyInt_FromLong(0x00000042));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_ADDR_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_ADDR_ERROR));
+	PyModule_AddObject(m, "DCERPC_FAULT_ACCESS_DENIED", PyInt_FromLong(0x00000005));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_KRB5", PyInt_FromLong(DCERPC_AUTH_TYPE_KRB5));
+	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_CRC", PyInt_FromLong(DCERPC_NCA_S_INVALID_CRC));
+	PyModule_AddObject(m, "DCERPC_BIND_PROVIDER_REJECT", PyInt_FromLong(2));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEN_OFFSET", PyInt_FromLong(10));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_RPC_VERSION_MISMATCH", PyInt_FromLong(DCERPC_NCA_S_FAULT_RPC_VERSION_MISMATCH));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INVALID_TAG", PyInt_FromLong(DCERPC_NCA_S_FAULT_INVALID_TAG));
+	PyModule_AddObject(m, "DCERPC_FAULT_CANT_PERFORM", PyInt_FromLong(0x000006d8));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_DIGEST", PyInt_FromLong(DCERPC_AUTH_TYPE_DIGEST));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN", NULL);
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_COMM_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_COMM_ERROR));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NONE", PyInt_FromLong(DCERPC_AUTH_TYPE_NONE));
 	PyModule_AddObject(m, "DCERPC_NCA_S_OP_RNG_ERROR", PyInt_FromLong(DCERPC_NCA_S_OP_RNG_ERROR));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_ORDER", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_ORDER));
-	PyModule_AddObject(m, "RTS_FLAG_NONE", PyInt_FromLong(RTS_FLAG_NONE));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_DPA", PyInt_FromLong(DCERPC_AUTH_TYPE_DPA));
+	PyModule_AddObject(m, "FDInProxy", PyInt_FromLong(FDInProxy));
+	PyModule_AddObject(m, "RTS_FLAG_OUT_CHANNEL", PyInt_FromLong(RTS_FLAG_OUT_CHANNEL));
+	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_CHECKSUM", PyInt_FromLong(DCERPC_NCA_S_INVALID_CHECKSUM));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_DID_NOT_EXECUTE", PyInt_FromLong(DCERPC_PFC_FLAG_DID_NOT_EXECUTE));
+	PyModule_AddObject(m, "RTS_FLAG_EOF", PyInt_FromLong(RTS_FLAG_EOF));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_DEFAULT", PyInt_FromLong(DCERPC_AUTH_LEVEL_CONNECT));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_TX_OPEN_FAILED", PyInt_FromLong(DCERPC_NCA_S_FAULT_TX_OPEN_FAILED));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_EMPTY", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_EMPTY));
+	PyModule_AddObject(m, "DCERPC_NCA_S_WRONG_BOOT_TIME", PyInt_FromLong(DCERPC_NCA_S_WRONG_BOOT_TIME));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_NO_CLIENT_STUB", PyInt_FromLong(DCERPC_NCA_S_FAULT_NO_CLIENT_STUB));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_DISCIPLINE", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_DISCIPLINE));
+	PyModule_AddObject(m, "DCERPC_PKT_RTS", PyInt_FromLong(DCERPC_PKT_RTS));
+	PyModule_AddObject(m, "DCERPC_BIND_REASON_ASYNTAX", PyInt_FromLong(1));
 	PyModule_AddObject(m, "DCERPC_PKT_SHUTDOWN", PyInt_FromLong(DCERPC_PKT_SHUTDOWN));
 	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_CALL", PyInt_FromLong(DCERPC_AUTH_LEVEL_CALL));
-	PyModule_AddObject(m, "DCERPC_PKT_RTS", PyInt_FromLong(DCERPC_PKT_RTS));
-	PyModule_AddObject(m, "DCERPC_NCA_S_UNSUPPORTED_TYPE", PyInt_FromLong(DCERPC_NCA_S_UNSUPPORTED_TYPE));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_NONE", PyInt_FromLong(DCERPC_AUTH_LEVEL_NONE));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_DIV_BY_ZERO", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_DIV_BY_ZERO));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_MANAGER_NOT_ENTERED", PyInt_FromLong(DCERPC_NCA_S_FAULT_MANAGER_NOT_ENTERED));
+	PyModule_AddObject(m, "RTS_FLAG_NONE", PyInt_FromLong(RTS_FLAG_NONE));
+	PyModule_AddObject(m, "DCERPC_FRAG_LEN_OFFSET", PyInt_FromLong(8));
+	PyModule_AddObject(m, "DCERPC_DREP_LE", PyInt_FromLong(0x10));
+	PyModule_AddObject(m, "DCERPC_NCA_S_YOU_CRASHED", PyInt_FromLong(DCERPC_NCA_S_YOU_CRASHED));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_UNDERFLOW", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_UNDERFLOW));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN", PyInt_FromLong(DCERPC_PFC_FLAG_PENDING_CANCEL));
-	PyModule_AddObject(m, "RTS_FLAG_PING", PyInt_FromLong(RTS_FLAG_PING));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_ILL_INST", PyInt_FromLong(DCERPC_NCA_S_FAULT_ILL_INST));
-	PyModule_AddObject(m, "DCERPC_FAULT_INVALID_TAG", PyInt_FromLong(0x1c000006));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_ERROR));
-	PyModule_AddObject(m, "DCERPC_PKT_ORPHANED", PyInt_FromLong(DCERPC_PKT_ORPHANED));
-	PyModule_AddObject(m, "DCERPC_BIND_REASON_INVALID_AUTH_TYPE", PyInt_FromLong(8));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_DPA", PyInt_FromLong(DCERPC_AUTH_TYPE_DPA));
-	PyModule_AddObject(m, "DCERPC_DREP_OFFSET", PyInt_FromLong(4));
-	PyModule_AddObject(m, "FDOutProxy", PyInt_FromLong(FDOutProxy));
-	PyModule_AddObject(m, "RTS_FLAG_RECYCLE_CHANNEL", PyInt_FromLong(RTS_FLAG_RECYCLE_CHANNEL));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_UNSPEC", PyInt_FromLong(DCERPC_NCA_S_FAULT_UNSPEC));
-	PyModule_AddObject(m, "DCERPC_PKT_AUTH3", PyInt_FromLong(DCERPC_PKT_AUTH3));
-	PyModule_AddObject(m, "DCERPC_NCA_S_UNKNOWN_IF", PyInt_FromLong(DCERPC_NCA_S_UNKNOWN_IF));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_DEFAULT", PyInt_FromLong(DCERPC_AUTH_LEVEL_CONNECT));
-	PyModule_AddObject(m, "DCERPC_BIND_PROVIDER_REJECT", PyInt_FromLong(2));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_LAST", PyInt_FromLong(DCERPC_PFC_FLAG_LAST));
+	PyModule_AddObject(m, "DCERPC_FAULT_UNK_IF", PyInt_FromLong(0x1c010003));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_MAX_SIZE", PyInt_FromLong(1024));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_REMOTE_NO_MEMORY", PyInt_FromLong(DCERPC_NCA_S_FAULT_REMOTE_NO_MEMORY));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_REMOTE_COMM_FAILURE", PyInt_FromLong(DCERPC_NCA_S_FAULT_REMOTE_COMM_FAILURE));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_INTEGRITY", PyInt_FromLong(DCERPC_AUTH_LEVEL_INTEGRITY));
+	PyModule_AddObject(m, "DCERPC_PKT_FACK", PyInt_FromLong(DCERPC_PKT_FACK));
 	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_PRIVACY", PyInt_FromLong(DCERPC_AUTH_LEVEL_PRIVACY));
-	PyModule_AddObject(m, "DCERPC_CALL_ID_OFFSET", PyInt_FromLong(12));
-	PyModule_AddObject(m, "DECRPC_BIND_PROTOCOL_VERSION_NOT_SUPPORTED", PyInt_FromLong(4));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_LAST", PyInt_FromLong(0x02));
-	PyModule_AddObject(m, "DCERPC_PKT_WORKING", PyInt_FromLong(DCERPC_PKT_WORKING));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_SCHANNEL", PyInt_FromLong(DCERPC_AUTH_TYPE_SCHANNEL));
-	PyModule_AddObject(m, "DCERPC_FRAG_LEN_OFFSET", PyInt_FromLong(8));
-	PyModule_AddObject(m, "DCERPC_PKT_CANCEL_ACK", PyInt_FromLong(DCERPC_PKT_CANCEL_ACK));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_DIGEST", PyInt_FromLong(DCERPC_AUTH_TYPE_DIGEST));
-	PyModule_AddObject(m, "RTS_FLAG_OUT_CHANNEL", PyInt_FromLong(RTS_FLAG_OUT_CHANNEL));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_COMM_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_COMM_ERROR));
-	PyModule_AddObject(m, "DCERPC_FAULT_SEC_PKG_ERROR", PyInt_FromLong(0x00000721));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_PACKET", PyInt_FromLong(DCERPC_AUTH_LEVEL_PACKET));
-	PyModule_AddObject(m, "DCERPC_PKT_REJECT", PyInt_FromLong(DCERPC_PKT_REJECT));
-	PyModule_AddObject(m, "DCERPC_NCA_S_COMM_FAILURE", PyInt_FromLong(DCERPC_NCA_S_COMM_FAILURE));
-	PyModule_AddObject(m, "DCERPC_FAULT_CONTEXT_MISMATCH", PyInt_FromLong(0x1c00001a));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_USER_DEFINED", PyInt_FromLong(DCERPC_NCA_S_FAULT_USER_DEFINED));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_MAYBE", PyInt_FromLong(DCERPC_PFC_FLAG_MAYBE));
 	PyModule_AddObject(m, "DCERPC_FAULT_NDR", PyInt_FromLong(0x000006f7));
-	PyModule_AddObject(m, "DCERPC_PKT_BIND", PyInt_FromLong(DCERPC_PKT_BIND));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_FIRST", PyInt_FromLong(0x01));
 	PyModule_AddObject(m, "RTS_FLAG_IN_CHANNEL", PyInt_FromLong(RTS_FLAG_IN_CHANNEL));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INVALID_BOUND", PyInt_FromLong(DCERPC_NCA_S_FAULT_INVALID_BOUND));
-	PyModule_AddObject(m, "DCERPC_NCA_S_WRONG_BOOT_TIME", PyInt_FromLong(DCERPC_NCA_S_WRONG_BOOT_TIME));
-	PyModule_AddObject(m, "RTS_FLAG_OTHER_CMD", PyInt_FromLong(RTS_FLAG_OTHER_CMD));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_WHO_ARE_YOU_FAILED", PyInt_FromLong(DCERPC_NCA_S_FAULT_WHO_ARE_YOU_FAILED));
-	PyModule_AddObject(m, "DCERPC_PKT_FACK", PyInt_FromLong(DCERPC_PKT_FACK));
-	PyModule_AddObject(m, "DCERPC_RESPONSE_LENGTH", PyInt_FromLong(24));
+	PyModule_AddObject(m, "DCERPC_CALL_ID_OFFSET", PyInt_FromLong(12));
 	PyModule_AddObject(m, "DCERPC_NCA_S_UNUSED_1C00001E", PyInt_FromLong(DCERPC_NCA_S_UNUSED_1C00001E));
-	PyModule_AddObject(m, "DCERPC_NCA_S_YOU_CRASHED", PyInt_FromLong(DCERPC_NCA_S_YOU_CRASHED));
-	PyModule_AddObject(m, "DCERPC_PKT_BIND_NAK", PyInt_FromLong(DCERPC_PKT_BIND_NAK));
-	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_CHECKSUM", PyInt_FromLong(DCERPC_NCA_S_INVALID_CHECKSUM));
-	PyModule_AddObject(m, "RTS_IPV6", PyInt_FromLong(RTS_IPV6));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_NO_CLIENT_STUB", PyInt_FromLong(DCERPC_NCA_S_FAULT_NO_CLIENT_STUB));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INT_DIV_BY_ZERO", PyInt_FromLong(DCERPC_NCA_S_FAULT_INT_DIV_BY_ZERO));
-	PyModule_AddObject(m, "DCERPC_FAULT_OTHER", PyInt_FromLong(0x00000001));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_MANAGER_NOT_ENTERED", PyInt_FromLong(DCERPC_NCA_S_FAULT_MANAGER_NOT_ENTERED));
-	PyModule_AddObject(m, "DCERPC_PFC_OFFSET", PyInt_FromLong(3));
+	PyModule_AddObject(m, "DCERPC_PKT_ALTER_RESP", PyInt_FromLong(DCERPC_PKT_ALTER_RESP));
 	PyModule_AddObject(m, "DCERPC_PKT_PING", PyInt_FromLong(DCERPC_PKT_PING));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_EMPTY", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_EMPTY));
-	PyModule_AddObject(m, "DCERPC_NCA_S_PROTO_ERROR", PyInt_FromLong(DCERPC_NCA_S_PROTO_ERROR));
-	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_CRC", PyInt_FromLong(DCERPC_NCA_S_INVALID_CRC));
-	PyModule_AddObject(m, "DCERPC_PKT_RESPONSE", PyInt_FromLong(DCERPC_PKT_RESPONSE));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEN_OFFSET", PyInt_FromLong(10));
+	PyModule_AddObject(m, "DCERPC_REQUEST_LENGTH", PyInt_FromLong(24));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_UNSPEC_REJECT", PyInt_FromLong(DCERPC_NCA_S_FAULT_UNSPEC_REJECT));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_OBJECT_NOT_FOUND", PyInt_FromLong(DCERPC_NCA_S_FAULT_OBJECT_NOT_FOUND));
-	PyModule_AddObject(m, "FDClient", PyInt_FromLong(FDClient));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_CODESET_CONV_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_CODESET_CONV_ERROR));
+	PyModule_AddObject(m, "DCERPC_NCA_S_UNSUPPORTED_AUTHN_LEVEL", PyInt_FromLong(DCERPC_NCA_S_UNSUPPORTED_AUTHN_LEVEL));
+	PyModule_AddObject(m, "DCERPC_PKT_NOCALL", PyInt_FromLong(DCERPC_PKT_NOCALL));
+	PyModule_AddObject(m, "DCERPC_NCACN_PAYLOAD_OFFSET", PyInt_FromLong(16));
+	PyModule_AddObject(m, "DCERPC_FAULT_OP_RNG_ERROR", PyInt_FromLong(0x1c010002));
+	PyModule_AddObject(m, "DCERPC_NCA_S_COMM_FAILURE", PyInt_FromLong(DCERPC_NCA_S_COMM_FAILURE));
+	PyModule_AddObject(m, "DCERPC_NCA_S_UNKNOWN_IF", PyInt_FromLong(DCERPC_NCA_S_UNKNOWN_IF));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_ERROR));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_OBJECT_UUID", PyInt_FromLong(DCERPC_PFC_FLAG_OBJECT_UUID));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_ORDER", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_ORDER));
 	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_MSMQ", PyInt_FromLong(DCERPC_AUTH_TYPE_MSMQ));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_USER_DEFINED", PyInt_FromLong(DCERPC_NCA_S_FAULT_USER_DEFINED));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_OBJECT_UUID", PyInt_FromLong(0x80));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_CONNECT", PyInt_FromLong(DCERPC_AUTH_LEVEL_CONNECT));
+	PyModule_AddObject(m, "DCERPC_NCA_S_OUT_ARGS_TOO_BIG", PyInt_FromLong(DCERPC_NCA_S_OUT_ARGS_TOO_BIG));
+	PyModule_AddObject(m, "DCERPC_PKT_CO_CANCEL", PyInt_FromLong(DCERPC_PKT_CO_CANCEL));
+	PyModule_AddObject(m, "DCERPC_FAULT_CONTEXT_MISMATCH", PyInt_FromLong(0x1c00001a));
+	PyModule_AddObject(m, "DCERPC_PKT_BIND_NAK", PyInt_FromLong(DCERPC_PKT_BIND_NAK));
+	PyModule_AddObject(m, "FDServer", PyInt_FromLong(FDServer));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_ILL_INST", PyInt_FromLong(DCERPC_NCA_S_FAULT_ILL_INST));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_FIRST", PyInt_FromLong(DCERPC_PFC_FLAG_FIRST));
+	PyModule_AddObject(m, "FDClient", PyInt_FromLong(FDClient));
+	PyModule_AddObject(m, "DCERPC_PKT_CL_CANCEL", PyInt_FromLong(DCERPC_PKT_CL_CANCEL));
+	PyModule_AddObject(m, "DCERPC_PKT_FAULT", PyInt_FromLong(DCERPC_PKT_FAULT));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_COMMAND_HEADER2", PyInt_FromLong(DCERPC_SEC_VT_COMMAND_HEADER2));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INT_DIV_BY_ZERO", PyInt_FromLong(DCERPC_NCA_S_FAULT_INT_DIV_BY_ZERO));
+	PyModule_AddObject(m, "DCERPC_FRAG_MAX_SIZE", PyInt_FromLong(5840));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_MSN", PyInt_FromLong(DCERPC_AUTH_TYPE_MSN));
 	PyModule_AddObject(m, "DCERPC_PKT_ACK", PyInt_FromLong(DCERPC_PKT_ACK));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_KRB5", PyInt_FromLong(DCERPC_AUTH_TYPE_KRB5));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_CONTEXT_MISMATCH", PyInt_FromLong(DCERPC_NCA_S_FAULT_CONTEXT_MISMATCH));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_STRING_TOO_LARGE", PyInt_FromLong(DCERPC_NCA_S_FAULT_STRING_TOO_LARGE));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INT_OVERFLOW", PyInt_FromLong(DCERPC_NCA_S_FAULT_INT_OVERFLOW));
-	PyModule_AddObject(m, "DCERPC_REQUEST_LENGTH", PyInt_FromLong(24));
-	PyModule_AddObject(m, "FDInProxy", PyInt_FromLong(FDInProxy));
-	PyModule_AddObject(m, "DCERPC_PKT_ALTER", PyInt_FromLong(DCERPC_PKT_ALTER));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_REMOTE_NO_MEMORY", PyInt_FromLong(DCERPC_NCA_S_FAULT_REMOTE_NO_MEMORY));
-	PyModule_AddObject(m, "RTS_FLAG_ECHO", PyInt_FromLong(RTS_FLAG_ECHO));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_REMOTE_COMM_FAILURE", PyInt_FromLong(DCERPC_NCA_S_FAULT_REMOTE_COMM_FAILURE));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_TX_OPEN_FAILED", PyInt_FromLong(DCERPC_NCA_S_FAULT_TX_OPEN_FAILED));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_MSN", PyInt_FromLong(DCERPC_AUTH_TYPE_MSN));
-	PyModule_AddObject(m, "DCERPC_PKT_NOCALL", PyInt_FromLong(DCERPC_PKT_NOCALL));
+	PyModule_AddObject(m, "DCERPC_AUTH_TRAILER_LENGTH", PyInt_FromLong(8));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_CANCEL", PyInt_FromLong(DCERPC_NCA_S_FAULT_CANCEL));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_DIV_BY_ZERO", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_DIV_BY_ZERO));
-	PyModule_AddObject(m, "DCERPC_FAULT_ACCESS_DENIED", PyInt_FromLong(0x00000005));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NONE", PyInt_FromLong(DCERPC_AUTH_TYPE_NONE));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NTLMSSP", PyInt_FromLong(DCERPC_AUTH_TYPE_NTLMSSP));
-	PyModule_AddObject(m, "DCERPC_FAULT_CANT_PERFORM", PyInt_FromLong(0x000006d8));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_ADDR_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_ADDR_ERROR));
-	PyModule_AddObject(m, "DCERPC_NCA_S_OUT_ARGS_TOO_BIG", PyInt_FromLong(DCERPC_NCA_S_OUT_ARGS_TOO_BIG));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_DISCIPLINE", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_DISCIPLINE));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_RPC_VERSION_MISMATCH", PyInt_FromLong(DCERPC_NCA_S_FAULT_RPC_VERSION_MISMATCH));
-	PyModule_AddObject(m, "DCERPC_NCA_S_SERVER_TOO_BUSY", PyInt_FromLong(DCERPC_NCA_S_SERVER_TOO_BUSY));
-	PyModule_AddObject(m, "DCERPC_FAULT_UNK_IF", PyInt_FromLong(0x1c010003));
-	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_PRES_CONTEXT_ID", PyInt_FromLong(DCERPC_NCA_S_INVALID_PRES_CONTEXT_ID));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_NONE", PyInt_FromLong(DCERPC_AUTH_LEVEL_NONE));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_CONNECT", PyInt_FromLong(DCERPC_AUTH_LEVEL_CONNECT));
-	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_INTEGRITY", PyInt_FromLong(DCERPC_AUTH_LEVEL_INTEGRITY));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_CONTEXT_MISMATCH", PyInt_FromLong(DCERPC_NCA_S_FAULT_CONTEXT_MISMATCH));
-	PyModule_AddObject(m, "DCERPC_BIND_REASON_ASYNTAX", PyInt_FromLong(1));
+	PyModule_AddObject(m, "DCERPC_DREP_OFFSET", PyInt_FromLong(4));
+	PyModule_AddObject(m, "DCERPC_AUTH_LEVEL_PACKET", PyInt_FromLong(DCERPC_AUTH_LEVEL_PACKET));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_COMMAND_ENUM", PyInt_FromLong(DCERPC_SEC_VT_COMMAND_ENUM));
+	PyModule_AddObject(m, "RTS_FLAG_PING", PyInt_FromLong(RTS_FLAG_PING));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_FP_OVERRFLOW", PyInt_FromLong(DCERPC_NCA_S_FAULT_FP_OVERRFLOW));
-	PyModule_AddObject(m, "DCERPC_AUTH_TRAILER_LENGTH", PyInt_FromLong(8));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_MEMORY", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_MEMORY));
-	PyModule_AddObject(m, "DCERPC_PKT_REQUEST", PyInt_FromLong(DCERPC_PKT_REQUEST));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_PENDING_CANCEL", PyInt_FromLong(0x04));
-	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM", PyInt_FromLong(DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM));
-	PyModule_AddObject(m, "DCERPC_FAULT_TODO", PyInt_FromLong(0x00000042));
-	PyModule_AddObject(m, "FDServer", PyInt_FromLong(FDServer));
-	PyModule_AddObject(m, "RTS_IPV4", PyInt_FromLong(RTS_IPV4));
+	PyModule_AddObject(m, "DCERPC_FAULT_INVALID_TAG", PyInt_FromLong(0x1c000006));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_COMMAND_PCONTEXT", PyInt_FromLong(DCERPC_SEC_VT_COMMAND_PCONTEXT));
+	PyModule_AddObject(m, "DCERPC_NCA_S_INVALID_PRES_CONTEXT_ID", PyInt_FromLong(DCERPC_NCA_S_INVALID_PRES_CONTEXT_ID));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING", PyInt_FromLong(DCERPC_SEC_VT_CLIENT_SUPPORTS_HEADER_SIGNING));
+	PyModule_AddObject(m, "DCERPC_NCA_S_UNUSED_1C000011", PyInt_FromLong(DCERPC_NCA_S_UNUSED_1C000011));
+	PyModule_AddObject(m, "DCERPC_RESPONSE_LENGTH", PyInt_FromLong(24));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_WHO_ARE_YOU_FAILED", PyInt_FromLong(DCERPC_NCA_S_FAULT_WHO_ARE_YOU_FAILED));
+	PyModule_AddObject(m, "DCERPC_PKT_ALTER", PyInt_FromLong(DCERPC_PKT_ALTER));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INVALID_BOUND", PyInt_FromLong(DCERPC_NCA_S_FAULT_INVALID_BOUND));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_OBJECT_NOT_FOUND", PyInt_FromLong(DCERPC_NCA_S_FAULT_OBJECT_NOT_FOUND));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NTLMSSP", PyInt_FromLong(DCERPC_AUTH_TYPE_NTLMSSP));
+	PyModule_AddObject(m, "RTS_FLAG_RECYCLE_CHANNEL", PyInt_FromLong(RTS_FLAG_RECYCLE_CHANNEL));
+	PyModule_AddObject(m, "DCERPC_NCA_S_SERVER_TOO_BUSY", PyInt_FromLong(DCERPC_NCA_S_SERVER_TOO_BUSY));
+	PyModule_AddObject(m, "DCERPC_BIND_REASON_INVALID_AUTH_TYPE", PyInt_FromLong(8));
+	PyModule_AddObject(m, "DECRPC_BIND_PROTOCOL_VERSION_NOT_SUPPORTED", PyInt_FromLong(4));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_PIPE_CLOSED", PyInt_FromLong(DCERPC_NCA_S_FAULT_PIPE_CLOSED));
-	PyModule_AddObject(m, "DCERPC_PKT_ALTER_RESP", PyInt_FromLong(DCERPC_PKT_ALTER_RESP));
-	PyModule_AddObject(m, "DCERPC_DREP_LE", PyInt_FromLong(0x10));
-	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_INVALID_TAG", PyInt_FromLong(DCERPC_NCA_S_FAULT_INVALID_TAG));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_CONC_MPX", PyInt_FromLong(0x10));
+	PyModule_AddObject(m, "DCERPC_NCA_S_PROTO_ERROR", PyInt_FromLong(DCERPC_NCA_S_PROTO_ERROR));
 	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_BAD_ACTID", PyInt_FromLong(DCERPC_NCA_S_FAULT_BAD_ACTID));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_COMMAND_BITMASK1", PyInt_FromLong(DCERPC_SEC_VT_COMMAND_BITMASK1));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_UNSPEC", PyInt_FromLong(DCERPC_NCA_S_FAULT_UNSPEC));
+	PyModule_AddObject(m, "DCERPC_PKT_RESPONSE", PyInt_FromLong(DCERPC_PKT_RESPONSE));
+	PyModule_AddObject(m, "DCERPC_PKT_CANCEL_ACK", PyInt_FromLong(DCERPC_PKT_CANCEL_ACK));
+	PyModule_AddObject(m, "DCERPC_FAULT_OTHER", PyInt_FromLong(0x00000001));
+	PyModule_AddObject(m, "DCERPC_PKT_REQUEST", PyInt_FromLong(DCERPC_PKT_REQUEST));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_CONC_MPX", PyInt_FromLong(DCERPC_PFC_FLAG_CONC_MPX));
+	PyModule_AddObject(m, "RTS_IPV4", PyInt_FromLong(RTS_IPV4));
+	PyModule_AddObject(m, "DCERPC_PFC_OFFSET", PyInt_FromLong(3));
+	PyModule_AddObject(m, "DCERPC_SEC_VT_MUST_PROCESS", PyInt_FromLong(DCERPC_SEC_VT_MUST_PROCESS));
+	PyModule_AddObject(m, "FDOutProxy", PyInt_FromLong(FDOutProxy));
+	PyModule_AddObject(m, "DCERPC_NCACN_PAYLOAD_MAX_SIZE", PyInt_FromLong(0x400000));
+	PyModule_AddObject(m, "DCERPC_PKT_BIND", PyInt_FromLong(DCERPC_PKT_BIND));
+	PyModule_AddObject(m, "DCERPC_PKT_BIND_ACK", PyInt_FromLong(DCERPC_PKT_BIND_ACK));
+	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM", PyInt_FromLong(DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM));
+	PyModule_AddObject(m, "RTS_IPV6", PyInt_FromLong(RTS_IPV6));
+	PyModule_AddObject(m, "RTS_FLAG_OTHER_CMD", PyInt_FromLong(RTS_FLAG_OTHER_CMD));
+	PyModule_AddObject(m, "DCERPC_NCA_S_UNSUPPORTED_TYPE", PyInt_FromLong(DCERPC_NCA_S_UNSUPPORTED_TYPE));
+	PyModule_AddObject(m, "DCERPC_PKT_AUTH3", PyInt_FromLong(DCERPC_PKT_AUTH3));
+	PyModule_AddObject(m, "DCERPC_PFC_FLAG_PENDING_CANCEL", PyInt_FromLong(DCERPC_PFC_FLAG_PENDING_CANCEL_OR_HDR_SIGNING));
 	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_KRB5_1", PyInt_FromLong(DCERPC_AUTH_TYPE_KRB5_1));
-	PyModule_AddObject(m, "DCERPC_PKT_FAULT", PyInt_FromLong(DCERPC_PKT_FAULT));
+	PyModule_AddObject(m, "DCERPC_FAULT_SEC_PKG_ERROR", PyInt_FromLong(0x00000721));
 	PyModule_AddObject(m, "DCERPC_AUTH_TYPE_SPNEGO", PyInt_FromLong(DCERPC_AUTH_TYPE_SPNEGO));
-	PyModule_AddObject(m, "RTS_FLAG_EOF", PyInt_FromLong(RTS_FLAG_EOF));
-	PyModule_AddObject(m, "DCERPC_NCA_S_UNSUPPORTED_AUTHN_LEVEL", PyInt_FromLong(DCERPC_NCA_S_UNSUPPORTED_AUTHN_LEVEL));
-	PyModule_AddObject(m, "DCERPC_PKT_CO_CANCEL", PyInt_FromLong(DCERPC_PKT_CO_CANCEL));
-	PyModule_AddObject(m, "DCERPC_PFC_FLAG_DID_NOT_EXECUTE", PyInt_FromLong(0x20));
-	PyModule_AddObject(m, "DCERPC_PKT_BIND_ACK", PyInt_FromLong(DCERPC_PKT_BIND_ACK));
-	PyModule_AddObject(m, "DCERPC_NCA_S_UNUSED_1C000011", PyInt_FromLong(DCERPC_NCA_S_UNUSED_1C000011));
+	PyModule_AddObject(m, "DCERPC_PKT_REJECT", PyInt_FromLong(DCERPC_PKT_REJECT));
+	PyModule_AddObject(m, "DCERPC_NCA_S_FAULT_CODESET_CONV_ERROR", PyInt_FromLong(DCERPC_NCA_S_FAULT_CODESET_CONV_ERROR));
 	Py_INCREF((PyObject *)(void *)&dcerpc_ctx_list_Type);
 	PyModule_AddObject(m, "ctx_list", (PyObject *)(void *)&dcerpc_ctx_list_Type);
 	Py_INCREF((PyObject *)(void *)&dcerpc_bind_Type);
@@ -6262,6 +6961,16 @@
 	PyModule_AddObject(m, "ncacn_packet", (PyObject *)(void *)&ncacn_packet_Type);
 	Py_INCREF((PyObject *)(void *)&ncadg_packet_Type);
 	PyModule_AddObject(m, "ncadg_packet", (PyObject *)(void *)&ncadg_packet_Type);
+	Py_INCREF((PyObject *)(void *)&dcerpc_sec_vt_pcontext_Type);
+	PyModule_AddObject(m, "sec_vt_pcontext", (PyObject *)(void *)&dcerpc_sec_vt_pcontext_Type);
+	Py_INCREF((PyObject *)(void *)&dcerpc_sec_vt_header2_Type);
+	PyModule_AddObject(m, "sec_vt_header2", (PyObject *)(void *)&dcerpc_sec_vt_header2_Type);
+	Py_INCREF((PyObject *)(void *)&dcerpc_sec_vt_Type);
+	PyModule_AddObject(m, "sec_vt", (PyObject *)(void *)&dcerpc_sec_vt_Type);
+	Py_INCREF((PyObject *)(void *)&dcerpc_sec_vt_count_Type);
+	PyModule_AddObject(m, "sec_vt_count", (PyObject *)(void *)&dcerpc_sec_vt_count_Type);
+	Py_INCREF((PyObject *)(void *)&dcerpc_sec_verification_trailer_Type);
+	PyModule_AddObject(m, "sec_verification_trailer", (PyObject *)(void *)&dcerpc_sec_verification_trailer_Type);
 #ifdef PY_MOD_DCERPC_PATCH
 	PY_MOD_DCERPC_PATCH(m);
 #endif
diff -daurN samba3/source3/librpc/gen_ndr/secrets.h samba3/source3/librpc/gen_ndr/secrets.h
--- samba3/source3/librpc/gen_ndr/secrets.h	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/secrets.h	2024-09-12 20:44:06.000000000 +0200
@@ -18,7 +18,7 @@
 	const char * pass;/* [flag(LIBNDR_FLAG_STR_ASCII|LIBNDR_FLAG_STR_NULLTERM)] */
 	time_t mod_time;
 	struct dom_sid domain_sid;
-}/* [flag(LIBNDR_FLAG_NOALIGN),public] */;
+}/* [public,flag(LIBNDR_FLAG_NOALIGN)] */;
 
 #endif /* _HEADER_secrets */
 #endif /* _PIDL_HEADER_secrets */
diff -daurN samba3/source3/librpc/gen_ndr/srv_atsvc.c samba3/source3/librpc/gen_ndr/srv_atsvc.c
--- samba3/source3/librpc/gen_ndr/srv_atsvc.c	2015-02-22 15:16:24.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_atsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _atsvc_JobAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@
 
 	r->out.result = _atsvc_JobDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -206,7 +206,7 @@
 
 	r->out.result = _atsvc_JobEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -286,7 +286,7 @@
 
 	r->out.result = _atsvc_JobGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_audiosrv.c samba3/source3/librpc/gen_ndr/srv_audiosrv.c
--- samba3/source3/librpc/gen_ndr/srv_audiosrv.c	2015-02-22 15:16:24.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_audiosrv.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_audiosrv_CreatezoneFactoriesList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_audiosrv_CreateGfxFactoriesList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_audiosrv_CreateGfxList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_audiosrv_RemoveGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_audiosrv_AddGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@
 
 	_audiosrv_ModifyGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@
 
 	_audiosrv_OpenGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@
 
 	_audiosrv_Logon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@
 
 	_audiosrv_Logoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@
 
 	_audiosrv_RegisterSessionNotificationEvent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@
 
 	_audiosrv_UnregisterSessionNotificationEvent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@
 
 	_audiosrv_SessionConnectState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@
 
 	_audiosrv_DriverOpenDrvRegKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@
 
 	_audiosrv_AdvisePreferredDeviceChange(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@
 
 	_audiosrv_GetPnpInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_backupkey.c samba3/source3/librpc/gen_ndr/srv_backupkey.c
--- samba3/source3/librpc/gen_ndr/srv_backupkey.c	2015-02-22 15:16:26.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_backupkey.c	2024-08-04 17:52:53.000000000 +0200
@@ -57,7 +57,7 @@
 
 	r->out.result = _bkrp_BackupKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_browser.c samba3/source3/librpc/gen_ndr/srv_browser.c
--- samba3/source3/librpc/gen_ndr/srv_browser.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_browser.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_BrowserrServerEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_BrowserrDebugCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -198,7 +198,7 @@
 
 	r->out.result = _BrowserrQueryOtherDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -271,7 +271,7 @@
 
 	_BrowserrResetNetlogonState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -344,7 +344,7 @@
 
 	_BrowserrDebugTrace(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -417,7 +417,7 @@
 
 	_BrowserrQueryStatistics(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -490,7 +490,7 @@
 
 	_BrowserResetStatistics(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -563,7 +563,7 @@
 
 	_NetrBrowserStatisticsClear(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -636,7 +636,7 @@
 
 	_NetrBrowserStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -709,7 +709,7 @@
 
 	_BrowserrSetNetlogonState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -782,7 +782,7 @@
 
 	_BrowserrQueryEmulatedDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -855,7 +855,7 @@
 
 	_BrowserrServerEnumEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dbgidl.c samba3/source3/librpc/gen_ndr/srv_dbgidl.c
--- samba3/source3/librpc/gen_ndr/srv_dbgidl.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dbgidl.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_dummy_dbgidl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dcom.c samba3/source3/librpc/gen_ndr/srv_dcom.c
--- samba3/source3/librpc/gen_ndr/srv_dcom.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dcom.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_UseProtSeq(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_GetCustomProtseqInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_UpdateResolverBindings(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -300,7 +300,7 @@
 
 	r->out.result = _QueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -380,7 +380,7 @@
 
 	r->out.result = _AddRef(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -460,7 +460,7 @@
 
 	r->out.result = _Release(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -570,7 +570,7 @@
 
 	r->out.result = _CreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -650,7 +650,7 @@
 
 	r->out.result = _RemoteCreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -730,7 +730,7 @@
 
 	r->out.result = _LockServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -810,7 +810,7 @@
 
 	r->out.result = _RemoteLockServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -921,7 +921,7 @@
 
 	r->out.result = _RemQueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1007,7 +1007,7 @@
 
 	r->out.result = _RemAddRef(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1087,7 +1087,7 @@
 
 	r->out.result = _RemRelease(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1197,7 +1197,7 @@
 
 	_GetClassObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1299,7 +1299,7 @@
 
 	r->out.result = _ISCMLocalActivator_CreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1394,7 +1394,7 @@
 
 	r->out.result = _IMachineLocalActivator_foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1489,7 +1489,7 @@
 
 	r->out.result = _ILocalObjectExporter_Foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1603,7 +1603,7 @@
 
 	r->out.result = _ISystemActivatorRemoteCreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1717,7 +1717,7 @@
 
 	r->out.result = _RemQueryInterface2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1825,7 +1825,7 @@
 
 	r->out.result = _GetTypeInfoCount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1911,7 +1911,7 @@
 
 	r->out.result = _GetTypeInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1997,7 +1997,7 @@
 
 	r->out.result = _GetIDsOfNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2096,7 +2096,7 @@
 
 	r->out.result = _Invoke(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2201,7 +2201,7 @@
 
 	r->out.result = _MarshalInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2281,7 +2281,7 @@
 
 	r->out.result = _UnMarshalInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2384,7 +2384,7 @@
 
 	r->out.result = _MakeCoffee(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2498,7 +2498,7 @@
 
 	r->out.result = _Read(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2584,7 +2584,7 @@
 
 	r->out.result = _Write(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dfsblobs.c samba3/source3/librpc/gen_ndr/srv_dfsblobs.c
--- samba3/source3/librpc/gen_ndr/srv_dfsblobs.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dfsblobs.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	_dfs_GetDFSReferral(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dfs.c samba3/source3/librpc/gen_ndr/srv_dfs.c
--- samba3/source3/librpc/gen_ndr/srv_dfs.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dfs.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	_dfs_GetManagerVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@
 
 	r->out.result = _dfs_Add(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@
 
 	r->out.result = _dfs_Remove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@
 
 	r->out.result = _dfs_SetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -350,7 +350,7 @@
 
 	r->out.result = _dfs_GetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -426,7 +426,7 @@
 	r->out.total = r->in.total;
 	r->out.result = _dfs_Enum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -499,7 +499,7 @@
 
 	r->out.result = _dfs_Rename(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -572,7 +572,7 @@
 
 	r->out.result = _dfs_Move(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -645,7 +645,7 @@
 
 	r->out.result = _dfs_ManagerGetConfigInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -718,7 +718,7 @@
 
 	r->out.result = _dfs_ManagerSendSiteInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -793,7 +793,7 @@
 	r->out.unknown2 = r->in.unknown2;
 	r->out.result = _dfs_AddFtRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -868,7 +868,7 @@
 	r->out.unknown = r->in.unknown;
 	r->out.result = _dfs_RemoveFtRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -941,7 +941,7 @@
 
 	r->out.result = _dfs_AddStdRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1014,7 +1014,7 @@
 
 	r->out.result = _dfs_RemoveStdRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1087,7 +1087,7 @@
 
 	r->out.result = _dfs_ManagerInitialize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1160,7 +1160,7 @@
 
 	r->out.result = _dfs_AddStdRootForced(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1237,7 +1237,7 @@
 	r->out.ttl = r->in.ttl;
 	r->out.result = _dfs_GetDcAddress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1310,7 +1310,7 @@
 
 	r->out.result = _dfs_SetDcAddress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1383,7 +1383,7 @@
 
 	r->out.result = _dfs_FlushFtTable(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1456,7 +1456,7 @@
 
 	r->out.result = _dfs_Add2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1529,7 +1529,7 @@
 
 	r->out.result = _dfs_Remove2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1605,7 +1605,7 @@
 	r->out.total = r->in.total;
 	r->out.result = _dfs_EnumEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1678,7 +1678,7 @@
 
 	r->out.result = _dfs_SetInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dns.c samba3/source3/librpc/gen_ndr/srv_dns.c
--- samba3/source3/librpc/gen_ndr/srv_dns.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dns.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_dns_name_packet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dnsp.c samba3/source3/librpc/gen_ndr/srv_dnsp.c
--- samba3/source3/librpc/gen_ndr/srv_dnsp.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dnsp.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_DnssrvRpcRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dnsserver.c samba3/source3/librpc/gen_ndr/srv_dnsserver.c
--- samba3/source3/librpc/gen_ndr/srv_dnsserver.c	2015-02-22 15:16:27.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dnsserver.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_dnsserver_foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_drsblobs.c samba3/source3/librpc/gen_ndr/srv_drsblobs.c
--- samba3/source3/librpc/gen_ndr/srv_drsblobs.c	2015-02-22 15:16:30.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_drsblobs.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_replPropertyMetaData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_decode_replUpToDateVector(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_decode_repsFromTo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_decode_partialAttributeSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_decode_prefixMap(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@
 
 	_decode_ldapControlDirSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@
 
 	_decode_supplementalCredentials(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@
 
 	_decode_Packages(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@
 
 	_decode_PrimaryKerberos(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@
 
 	_decode_PrimaryCLEARTEXT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@
 
 	_decode_PrimaryWDigest(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@
 
 	_decode_trustAuthInOut(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@
 
 	_decode_trustDomainPasswords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@
 
 	_decode_ExtendedErrorInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@
 
 	_decode_ForestTrustInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_drsuapi.c samba3/source3/librpc/gen_ndr/srv_drsuapi.c
--- samba3/source3/librpc/gen_ndr/srv_drsuapi.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_drsuapi.c	2024-08-04 17:52:53.000000000 +0200
@@ -52,7 +52,7 @@
 
 	r->out.result = _drsuapi_DsBind(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -127,7 +127,7 @@
 	r->out.bind_handle = r->in.bind_handle;
 	r->out.result = _drsuapi_DsUnbind(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -200,7 +200,7 @@
 
 	r->out.result = _drsuapi_DsReplicaSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -286,7 +286,7 @@
 
 	r->out.result = _drsuapi_DsGetNCChanges(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -359,7 +359,7 @@
 
 	r->out.result = _drsuapi_DsReplicaUpdateRefs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -432,7 +432,7 @@
 
 	r->out.result = _drsuapi_DsReplicaAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -505,7 +505,7 @@
 
 	r->out.result = _drsuapi_DsReplicaDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -578,7 +578,7 @@
 
 	r->out.result = _drsuapi_DsReplicaMod(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -651,7 +651,7 @@
 
 	r->out.result = _DRSUAPI_VERIFY_NAMES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -737,7 +737,7 @@
 
 	r->out.result = _drsuapi_DsGetMemberships(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -810,7 +810,7 @@
 
 	r->out.result = _DRSUAPI_INTER_DOMAIN_MOVE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -896,7 +896,7 @@
 
 	r->out.result = _drsuapi_DsGetNT4ChangeLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -982,7 +982,7 @@
 
 	r->out.result = _drsuapi_DsCrackNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1068,7 +1068,7 @@
 
 	r->out.result = _drsuapi_DsWriteAccountSpn(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1154,7 +1154,7 @@
 
 	r->out.result = _drsuapi_DsRemoveDSServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1227,7 +1227,7 @@
 
 	r->out.result = _DRSUAPI_REMOVE_DS_DOMAIN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1313,7 +1313,7 @@
 
 	r->out.result = _drsuapi_DsGetDomainControllerInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1399,7 +1399,7 @@
 
 	r->out.result = _drsuapi_DsAddEntry(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1472,7 +1472,7 @@
 
 	r->out.result = _drsuapi_DsExecuteKCC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1558,7 +1558,7 @@
 
 	r->out.result = _drsuapi_DsReplicaGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1631,7 +1631,7 @@
 
 	r->out.result = _DRSUAPI_ADD_SID_HISTORY(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1717,7 +1717,7 @@
 
 	r->out.result = _drsuapi_DsGetMemberships2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1790,7 +1790,7 @@
 
 	r->out.result = _DRSUAPI_REPLICA_VERIFY_OBJECTS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1863,7 +1863,7 @@
 
 	r->out.result = _DRSUAPI_GET_OBJECT_EXISTENCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1949,7 +1949,7 @@
 
 	r->out.result = _drsuapi_QuerySitesByCost(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dsbackup.c samba3/source3/librpc/gen_ndr/srv_dsbackup.c
--- samba3/source3/librpc/gen_ndr/srv_dsbackup.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dsbackup.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_HrRBackupPrepare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_HrRBackupEnd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_HrRBackupGetAttachmentInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_HrRBackupOpenFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_HrRBackupRead(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@
 
 	_HrRBackupClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@
 
 	_HrRBackupGetBackupLogs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@
 
 	_HrRBackupTruncateLogs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@
 
 	_HrRBackupPing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -731,7 +731,7 @@
 
 	_HrRIsNTDSOnline(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -804,7 +804,7 @@
 
 	_HrRRestorePrepare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -877,7 +877,7 @@
 
 	_HrRRestoreRegister(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -950,7 +950,7 @@
 
 	_HrRRestoreRegisterComplete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1023,7 +1023,7 @@
 
 	_HrRRestoreGetDatabaseLocations(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1096,7 +1096,7 @@
 
 	_HrRRestoreEnd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1169,7 +1169,7 @@
 
 	_HrRRestoreSetCurrentLogNumber(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1242,7 +1242,7 @@
 
 	_HrRRestoreCheckLogsForBackup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_dssetup.c samba3/source3/librpc/gen_ndr/srv_dssetup.c
--- samba3/source3/librpc/gen_ndr/srv_dssetup.c	2015-02-22 15:16:31.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_dssetup.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _dssetup_DsRoleGetPrimaryDomainInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@
 
 	r->out.result = _dssetup_DsRoleDnsNameToFlatName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@
 
 	r->out.result = _dssetup_DsRoleDcAsDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@
 
 	r->out.result = _dssetup_DsRoleDcAsReplica(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -343,7 +343,7 @@
 
 	r->out.result = _dssetup_DsRoleDemoteDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -416,7 +416,7 @@
 
 	r->out.result = _dssetup_DsRoleGetDcOperationProgress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -489,7 +489,7 @@
 
 	r->out.result = _dssetup_DsRoleGetDcOperationResults(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -562,7 +562,7 @@
 
 	r->out.result = _dssetup_DsRoleCancel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -635,7 +635,7 @@
 
 	r->out.result = _dssetup_DsRoleServerSaveStateForUpgrade(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -708,7 +708,7 @@
 
 	r->out.result = _dssetup_DsRoleUpgradeDownlevelServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -781,7 +781,7 @@
 
 	r->out.result = _dssetup_DsRoleAbortDownlevelServerUpgrade(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_echo.c samba3/source3/librpc/gen_ndr/srv_echo.c
--- samba3/source3/librpc/gen_ndr/srv_echo.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_echo.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	_echo_AddOne(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@
 
 	_echo_EchoData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -204,7 +204,7 @@
 
 	_echo_SinkData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -284,7 +284,7 @@
 
 	_echo_SourceData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -364,7 +364,7 @@
 
 	_echo_TestCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -444,7 +444,7 @@
 
 	r->out.result = _echo_TestCall2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -517,7 +517,7 @@
 
 	r->out.result = _echo_TestSleep(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -594,7 +594,7 @@
 	r->out.foo3 = r->in.foo3;
 	_echo_TestEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -669,7 +669,7 @@
 	r->out.data = r->in.data;
 	_echo_TestSurrounding(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -742,7 +742,7 @@
 
 	r->out.result = _echo_TestDoublePointer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_efs.c samba3/source3/librpc/gen_ndr/srv_efs.c
--- samba3/source3/librpc/gen_ndr/srv_efs.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_efs.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _EfsRpcOpenFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@
 
 	r->out.result = _EfsRpcReadFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@
 
 	r->out.result = _EfsRpcWriteFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -272,7 +272,7 @@
 	r->out.pvContext = r->in.pvContext;
 	_EfsRpcCloseRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -345,7 +345,7 @@
 
 	r->out.result = _EfsRpcEncryptFileSrv(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -418,7 +418,7 @@
 
 	r->out.result = _EfsRpcDecryptFileSrv(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -498,7 +498,7 @@
 
 	r->out.result = _EfsRpcQueryUsersOnFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -578,7 +578,7 @@
 
 	r->out.result = _EfsRpcQueryRecoveryAgents(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -651,7 +651,7 @@
 
 	r->out.result = _EfsRpcRemoveUsersFromFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -724,7 +724,7 @@
 
 	r->out.result = _EfsRpcAddUsersToFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -797,7 +797,7 @@
 
 	r->out.result = _EfsRpcSetFileEncryptionKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -870,7 +870,7 @@
 
 	r->out.result = _EfsRpcNotSupported(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -943,7 +943,7 @@
 
 	r->out.result = _EfsRpcFileKeyInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1016,7 +1016,7 @@
 
 	r->out.result = _EfsRpcDuplicateEncryptionInfoFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_epmapper.c samba3/source3/librpc/gen_ndr/srv_epmapper.c
--- samba3/source3/librpc/gen_ndr/srv_epmapper.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_epmapper.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _epm_Insert(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _epm_Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -204,7 +204,7 @@
 
 	r->out.result = _epm_Lookup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@
 
 	r->out.result = _epm_Map(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -366,7 +366,7 @@
 	r->out.entry_handle = r->in.entry_handle;
 	r->out.result = _epm_LookupHandleFree(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -439,7 +439,7 @@
 
 	r->out.result = _epm_InqObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -512,7 +512,7 @@
 
 	r->out.result = _epm_MgmtDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -585,7 +585,7 @@
 
 	r->out.result = _epm_MapAuth(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_eventlog6.c samba3/source3/librpc/gen_ndr/srv_eventlog6.c
--- samba3/source3/librpc/gen_ndr/srv_eventlog6.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_eventlog6.c	2024-08-04 17:52:53.000000000 +0200
@@ -75,7 +75,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRegisterRemoteSubscription(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -179,7 +179,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionNextAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -283,7 +283,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionNext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -356,7 +356,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionWaitAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -436,7 +436,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRegisterControllableOperation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -540,7 +540,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRegisterLogQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -620,7 +620,7 @@
 
 	r->out.result = _eventlog6_EvtRpcClearLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -700,7 +700,7 @@
 
 	r->out.result = _eventlog6_EvtRpcExportLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -780,7 +780,7 @@
 
 	r->out.result = _eventlog6_EvtRpcLocalizeExportLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -878,7 +878,7 @@
 
 	r->out.result = _eventlog6_EvtRpcMessageRender(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@
 
 	r->out.result = _eventlog6_EvtRpcMessageRenderDefault(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1080,7 +1080,7 @@
 
 	r->out.result = _eventlog6_EvtRpcQueryNext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1160,7 +1160,7 @@
 
 	r->out.result = _eventlog6_EvtRpcQuerySeek(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1235,7 +1235,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog6_EvtRpcClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1308,7 +1308,7 @@
 
 	r->out.result = _eventlog6_EvtRpcCancel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1381,7 +1381,7 @@
 
 	r->out.result = _eventlog6_EvtRpcAssertConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1454,7 +1454,7 @@
 
 	r->out.result = _eventlog6_EvtRpcRetractConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1540,7 +1540,7 @@
 
 	r->out.result = _eventlog6_EvtRpcOpenLogHandle(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1626,7 +1626,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetLogFileInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1712,7 +1712,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetChannelList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1792,7 +1792,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetChannelConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1872,7 +1872,7 @@
 
 	r->out.result = _eventlog6_EvtRpcPutChannelConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1958,7 +1958,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2044,7 +2044,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherListForChannel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2130,7 +2130,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2210,7 +2210,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherResourceMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2290,7 +2290,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetEventMetadataEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2376,7 +2376,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetNextEventMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2456,7 +2456,7 @@
 
 	r->out.result = _eventlog6_EvtRpcGetClassicLogDisplayName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_eventlog.c samba3/source3/librpc/gen_ndr/srv_eventlog.c
--- samba3/source3/librpc/gen_ndr/srv_eventlog.c	2015-02-22 15:16:32.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_eventlog.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _eventlog_ClearEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _eventlog_BackupEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -192,7 +192,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog_CloseEventLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -267,7 +267,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog_DeregisterEventSource(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -347,7 +347,7 @@
 
 	r->out.result = _eventlog_GetNumRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -427,7 +427,7 @@
 
 	r->out.result = _eventlog_GetOldestRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -500,7 +500,7 @@
 
 	r->out.result = _eventlog_ChangeNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -580,7 +580,7 @@
 
 	r->out.result = _eventlog_OpenEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -660,7 +660,7 @@
 
 	r->out.result = _eventlog_RegisterEventSourceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -740,7 +740,7 @@
 
 	r->out.result = _eventlog_OpenBackupEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -832,7 +832,7 @@
 
 	r->out.result = _eventlog_ReadEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -908,7 +908,7 @@
 	r->out.time_written = r->in.time_written;
 	r->out.result = _eventlog_ReportEventW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -981,7 +981,7 @@
 
 	r->out.result = _eventlog_ClearEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1054,7 +1054,7 @@
 
 	r->out.result = _eventlog_BackupEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1127,7 +1127,7 @@
 
 	r->out.result = _eventlog_OpenEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1200,7 +1200,7 @@
 
 	r->out.result = _eventlog_RegisterEventSourceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1273,7 +1273,7 @@
 
 	r->out.result = _eventlog_OpenBackupEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1346,7 +1346,7 @@
 
 	r->out.result = _eventlog_ReadEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1419,7 +1419,7 @@
 
 	r->out.result = _eventlog_ReportEventA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1492,7 +1492,7 @@
 
 	r->out.result = _eventlog_RegisterClusterSvc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1565,7 +1565,7 @@
 
 	r->out.result = _eventlog_DeregisterClusterSvc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1638,7 +1638,7 @@
 
 	r->out.result = _eventlog_WriteClusterEvents(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1724,7 +1724,7 @@
 
 	r->out.result = _eventlog_GetLogInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1797,7 +1797,7 @@
 
 	r->out.result = _eventlog_FlushEventLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1873,7 +1873,7 @@
 	r->out.time_written = r->in.time_written;
 	r->out.result = _eventlog_ReportEventAndSourceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_frsapi.c samba3/source3/librpc/gen_ndr/srv_frsapi.c
--- samba3/source3/librpc/gen_ndr/srv_frsapi.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_frsapi.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_FRSAPI_VERIFY_PROMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_FRSAPI_PROMOTION_STATUS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_FRSAPI_START_DEMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_FRSAPI_COMMIT_DEMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	r->out.result = _frsapi_SetDsPollingIntervalW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -428,7 +428,7 @@
 
 	r->out.result = _frsapi_GetDsPollingIntervalW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -501,7 +501,7 @@
 
 	_FRSAPI_VERIFY_PROMOTION_W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -576,7 +576,7 @@
 	r->out.info = r->in.info;
 	r->out.result = _frsapi_InfoW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -674,7 +674,7 @@
 
 	r->out.result = _frsapi_IsPathReplicated(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -747,7 +747,7 @@
 
 	r->out.result = _frsapi_WriterCommand(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -820,7 +820,7 @@
 
 	r->out.result = _frsapi_ForceReplication(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_frsrpc.c samba3/source3/librpc/gen_ndr/srv_frsrpc.c
--- samba3/source3/librpc/gen_ndr/srv_frsrpc.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_frsrpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _frsrpc_FrsSendCommPkt(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _frsrpc_FrsVerifyPromotionParent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -192,7 +192,7 @@
 	r->out.parent_guid = r->in.parent_guid;
 	r->out.result = _frsrpc_FrsStartPromotionParent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -265,7 +265,7 @@
 
 	r->out.result = _frsrpc_FrsNOP(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -338,7 +338,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -411,7 +411,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE_5(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -484,7 +484,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE_6(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -557,7 +557,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE_7(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -630,7 +630,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE_8(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -703,7 +703,7 @@
 
 	_FRSRPC_BACKUP_COMPLETE_9(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -776,7 +776,7 @@
 
 	_FRSRPC_VERIFY_PROMOTION_PARENT_EX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_frstrans.c samba3/source3/librpc/gen_ndr/srv_frstrans.c
--- samba3/source3/librpc/gen_ndr/srv_frstrans.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_frstrans.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _frstrans_CheckConnectivity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -130,7 +130,7 @@
 
 	r->out.result = _frstrans_EstablishConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -203,7 +203,7 @@
 
 	r->out.result = _frstrans_EstablishSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -307,7 +307,7 @@
 
 	r->out.result = _frstrans_RequestUpdates(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -380,7 +380,7 @@
 
 	r->out.result = _frstrans_RequestVersionVector(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -460,7 +460,7 @@
 
 	r->out.result = _frstrans_AsyncPoll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -533,7 +533,7 @@
 
 	_FRSTRANS_REQUEST_RECORDS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -606,7 +606,7 @@
 
 	_FRSTRANS_UPDATE_CANCEL(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -679,7 +679,7 @@
 
 	_FRSTRANS_RAW_GET_FILE_DATA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -752,7 +752,7 @@
 
 	_FRSTRANS_RDC_GET_SIGNATURES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -825,7 +825,7 @@
 
 	_FRSTRANS_RDC_PUSH_SOURCE_NEEDS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -898,7 +898,7 @@
 
 	_FRSTRANS_RDC_GET_FILE_DATA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -971,7 +971,7 @@
 
 	_FRSTRANS_RDC_CLOSE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1077,7 +1077,7 @@
 
 	r->out.result = _frstrans_InitializeFileTransferAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1150,7 +1150,7 @@
 
 	_FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1230,7 +1230,7 @@
 
 	r->out.result = _frstrans_RawGetFileDataAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1310,7 +1310,7 @@
 
 	r->out.result = _frstrans_RdcGetFileDataAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_initshutdown.c samba3/source3/librpc/gen_ndr/srv_initshutdown.c
--- samba3/source3/librpc/gen_ndr/srv_initshutdown.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_initshutdown.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _initshutdown_Init(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _initshutdown_Abort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	r->out.result = _initshutdown_InitEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_keysvc.c samba3/source3/librpc/gen_ndr/srv_keysvc.c
--- samba3/source3/librpc/gen_ndr/srv_keysvc.c	2015-02-22 15:16:33.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_keysvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _keysvc_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_krb5pac.c samba3/source3/librpc/gen_ndr/srv_krb5pac.c
--- samba3/source3/librpc/gen_ndr/srv_krb5pac.c	2015-02-22 15:16:35.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_krb5pac.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_pac(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_decode_pac_raw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_decode_login_info(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_decode_login_info_ctr(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_decode_pac_validate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_libnetapi.c samba3/source3/librpc/gen_ndr/srv_libnetapi.c
--- samba3/source3/librpc/gen_ndr/srv_libnetapi.c	2015-02-22 15:16:54.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_libnetapi.c	2024-09-12 20:44:02.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _NetJoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _NetUnjoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -203,7 +203,7 @@
 
 	r->out.result = _NetGetJoinInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -289,7 +289,7 @@
 
 	r->out.result = _NetGetJoinableOUs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -362,7 +362,7 @@
 
 	r->out.result = _NetRenameMachineInDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -442,7 +442,7 @@
 
 	r->out.result = _NetServerGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -522,7 +522,7 @@
 
 	r->out.result = _NetServerSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -602,7 +602,7 @@
 
 	r->out.result = _NetGetDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -682,7 +682,7 @@
 
 	r->out.result = _NetGetAnyDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -762,7 +762,7 @@
 
 	r->out.result = _DsGetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -842,7 +842,7 @@
 
 	r->out.result = _NetUserAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -915,7 +915,7 @@
 
 	r->out.result = _NetUserDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1008,7 +1008,7 @@
 
 	r->out.result = _NetUserEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1081,7 +1081,7 @@
 
 	r->out.result = _NetUserChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1161,7 +1161,7 @@
 
 	r->out.result = _NetUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1241,7 +1241,7 @@
 
 	r->out.result = _NetUserSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1333,7 +1333,7 @@
 
 	r->out.result = _NetUserGetGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1406,7 +1406,7 @@
 
 	r->out.result = _NetUserSetGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1498,7 +1498,7 @@
 
 	r->out.result = _NetUserGetLocalGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1578,7 +1578,7 @@
 
 	r->out.result = _NetUserModalsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1658,7 +1658,7 @@
 
 	r->out.result = _NetUserModalsSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1744,7 +1744,7 @@
 
 	r->out.result = _NetQueryDisplayInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1824,7 +1824,7 @@
 
 	r->out.result = _NetGroupAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1897,7 +1897,7 @@
 
 	r->out.result = _NetGroupDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1990,7 +1990,7 @@
 
 	r->out.result = _NetGroupEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2070,7 +2070,7 @@
 
 	r->out.result = _NetGroupSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2150,7 +2150,7 @@
 
 	r->out.result = _NetGroupGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2223,7 +2223,7 @@
 
 	r->out.result = _NetGroupAddUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2296,7 +2296,7 @@
 
 	r->out.result = _NetGroupDelUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2389,7 +2389,7 @@
 
 	r->out.result = _NetGroupGetUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2462,7 +2462,7 @@
 
 	r->out.result = _NetGroupSetUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2542,7 +2542,7 @@
 
 	r->out.result = _NetLocalGroupAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2615,7 +2615,7 @@
 
 	r->out.result = _NetLocalGroupDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2695,7 +2695,7 @@
 
 	r->out.result = _NetLocalGroupGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2775,7 +2775,7 @@
 
 	r->out.result = _NetLocalGroupSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2868,7 +2868,7 @@
 
 	r->out.result = _NetLocalGroupEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2941,7 +2941,7 @@
 
 	r->out.result = _NetLocalGroupAddMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3014,7 +3014,7 @@
 
 	r->out.result = _NetLocalGroupDelMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3107,7 +3107,7 @@
 
 	r->out.result = _NetLocalGroupGetMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3180,7 +3180,7 @@
 
 	r->out.result = _NetLocalGroupSetMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3260,7 +3260,7 @@
 
 	r->out.result = _NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3340,7 +3340,7 @@
 
 	r->out.result = _NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3413,7 +3413,7 @@
 
 	r->out.result = _NetShareDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3506,7 +3506,7 @@
 
 	r->out.result = _NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3586,7 +3586,7 @@
 
 	r->out.result = _NetShareGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3666,7 +3666,7 @@
 
 	r->out.result = _NetShareSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3739,7 +3739,7 @@
 
 	r->out.result = _NetFileClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3819,7 +3819,7 @@
 
 	r->out.result = _NetFileGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3912,7 +3912,7 @@
 
 	r->out.result = _NetFileEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3985,7 +3985,7 @@
 
 	r->out.result = _NetShutdownInit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4058,7 +4058,7 @@
 
 	r->out.result = _NetShutdownAbort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4138,7 +4138,7 @@
 
 	r->out.result = _I_NetLogonControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4218,7 +4218,7 @@
 
 	r->out.result = _I_NetLogonControl2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_lsa.c samba3/source3/librpc/gen_ndr/srv_lsa.c
--- samba3/source3/librpc/gen_ndr/srv_lsa.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_lsa.c	2024-08-04 17:52:53.000000000 +0200
@@ -46,7 +46,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_Close(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -119,7 +119,7 @@
 
 	r->out.result = _lsa_Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -200,7 +200,7 @@
 
 	r->out.result = _lsa_EnumPrivs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -280,7 +280,7 @@
 
 	r->out.result = _lsa_QuerySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -353,7 +353,7 @@
 
 	r->out.result = _lsa_SetSecObj(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -426,7 +426,7 @@
 
 	r->out.result = _lsa_ChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -506,7 +506,7 @@
 
 	r->out.result = _lsa_OpenPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -586,7 +586,7 @@
 
 	r->out.result = _lsa_QueryInfoPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -659,7 +659,7 @@
 
 	r->out.result = _lsa_SetInfoPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -732,7 +732,7 @@
 
 	r->out.result = _lsa_ClearAuditLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -812,7 +812,7 @@
 
 	r->out.result = _lsa_CreateAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -893,7 +893,7 @@
 
 	r->out.result = _lsa_EnumAccounts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -973,7 +973,7 @@
 
 	r->out.result = _lsa_CreateTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1054,7 +1054,7 @@
 
 	r->out.result = _lsa_EnumTrustDom(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@
 
 	r->out.result = _lsa_LookupNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1218,7 +1218,7 @@
 
 	r->out.result = _lsa_LookupSids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1298,7 +1298,7 @@
 
 	r->out.result = _lsa_CreateSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1378,7 +1378,7 @@
 
 	r->out.result = _lsa_OpenAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1458,7 +1458,7 @@
 
 	r->out.result = _lsa_EnumPrivsAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1531,7 +1531,7 @@
 
 	r->out.result = _lsa_AddPrivilegesToAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1604,7 +1604,7 @@
 
 	r->out.result = _lsa_RemovePrivilegesFromAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1677,7 +1677,7 @@
 
 	r->out.result = _lsa_GetQuotasForAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1750,7 +1750,7 @@
 
 	r->out.result = _lsa_SetQuotasForAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1830,7 +1830,7 @@
 
 	r->out.result = _lsa_GetSystemAccessAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1903,7 +1903,7 @@
 
 	r->out.result = _lsa_SetSystemAccessAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1983,7 +1983,7 @@
 
 	r->out.result = _lsa_OpenTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2063,7 +2063,7 @@
 
 	r->out.result = _lsa_QueryTrustedDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2136,7 +2136,7 @@
 
 	r->out.result = _lsa_SetInformationTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2216,7 +2216,7 @@
 
 	r->out.result = _lsa_OpenSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2289,7 +2289,7 @@
 
 	r->out.result = _lsa_SetSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2367,7 +2367,7 @@
 	r->out.old_mtime = r->in.old_mtime;
 	r->out.result = _lsa_QuerySecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2447,7 +2447,7 @@
 
 	r->out.result = _lsa_LookupPrivValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2527,7 +2527,7 @@
 
 	r->out.result = _lsa_LookupPrivName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2613,7 +2613,7 @@
 
 	r->out.result = _lsa_LookupPrivDisplayName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2688,7 +2688,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_DeleteObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2768,7 +2768,7 @@
 
 	r->out.result = _lsa_EnumAccountsWithUserRight(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2848,7 +2848,7 @@
 
 	r->out.result = _lsa_EnumAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2921,7 +2921,7 @@
 
 	r->out.result = _lsa_AddAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2994,7 +2994,7 @@
 
 	r->out.result = _lsa_RemoveAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3074,7 +3074,7 @@
 
 	r->out.result = _lsa_QueryTrustedDomainInfoBySid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3147,7 +3147,7 @@
 
 	r->out.result = _lsa_SetTrustedDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3220,7 +3220,7 @@
 
 	r->out.result = _lsa_DeleteTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3293,7 +3293,7 @@
 
 	r->out.result = _lsa_StorePrivateData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3368,7 +3368,7 @@
 	r->out.val = r->in.val;
 	r->out.result = _lsa_RetrievePrivateData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3448,7 +3448,7 @@
 
 	r->out.result = _lsa_OpenPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3524,7 +3524,7 @@
 	r->out.authority_name = r->in.authority_name;
 	r->out.result = _lsa_GetUserName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3604,7 +3604,7 @@
 
 	r->out.result = _lsa_QueryInfoPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3677,7 +3677,7 @@
 
 	r->out.result = _lsa_SetInfoPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3757,7 +3757,7 @@
 
 	r->out.result = _lsa_QueryTrustedDomainInfoByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3830,7 +3830,7 @@
 
 	r->out.result = _lsa_SetTrustedDomainInfoByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3911,7 +3911,7 @@
 
 	r->out.result = _lsa_EnumTrustedDomainsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3991,7 +3991,7 @@
 
 	r->out.result = _lsa_CreateTrustedDomainEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4066,7 +4066,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_CloseTrustedDomainEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4146,7 +4146,7 @@
 
 	r->out.result = _lsa_QueryDomainInformationPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4219,7 +4219,7 @@
 
 	r->out.result = _lsa_SetDomainInformationPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4299,7 +4299,7 @@
 
 	r->out.result = _lsa_OpenTrustedDomainByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4372,7 +4372,7 @@
 
 	r->out.result = _lsa_TestCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4454,7 +4454,7 @@
 
 	r->out.result = _lsa_LookupSids2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4536,7 +4536,7 @@
 
 	r->out.result = _lsa_LookupNames2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4616,7 +4616,7 @@
 
 	r->out.result = _lsa_CreateTrustedDomainEx2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4689,7 +4689,7 @@
 
 	r->out.result = _lsa_CREDRWRITE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4762,7 +4762,7 @@
 
 	r->out.result = _lsa_CREDRREAD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4835,7 +4835,7 @@
 
 	r->out.result = _lsa_CREDRENUMERATE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4908,7 +4908,7 @@
 
 	r->out.result = _lsa_CREDRWRITEDOMAINCREDENTIALS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4981,7 +4981,7 @@
 
 	r->out.result = _lsa_CREDRREADDOMAINCREDENTIALS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5054,7 +5054,7 @@
 
 	r->out.result = _lsa_CREDRDELETE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5127,7 +5127,7 @@
 
 	r->out.result = _lsa_CREDRGETTARGETINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5200,7 +5200,7 @@
 
 	r->out.result = _lsa_CREDRPROFILELOADED(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5282,7 +5282,7 @@
 
 	r->out.result = _lsa_LookupNames3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5355,7 +5355,7 @@
 
 	r->out.result = _lsa_CREDRGETSESSIONTYPES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5428,7 +5428,7 @@
 
 	r->out.result = _lsa_LSARREGISTERAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5501,7 +5501,7 @@
 
 	r->out.result = _lsa_LSARGENAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5574,7 +5574,7 @@
 
 	r->out.result = _lsa_LSARUNREGISTERAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5654,7 +5654,7 @@
 
 	r->out.result = _lsa_lsaRQueryForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5734,7 +5734,7 @@
 
 	r->out.result = _lsa_lsaRSetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5807,7 +5807,7 @@
 
 	r->out.result = _lsa_CREDRRENAME(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5889,7 +5889,7 @@
 
 	r->out.result = _lsa_LookupSids3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5971,7 +5971,7 @@
 
 	r->out.result = _lsa_LookupNames4(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6044,7 +6044,7 @@
 
 	r->out.result = _lsa_LSAROPENPOLICYSCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6117,7 +6117,7 @@
 
 	r->out.result = _lsa_LSARADTREGISTERSECURITYEVENTSOURCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6190,7 +6190,7 @@
 
 	r->out.result = _lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6263,7 +6263,7 @@
 
 	r->out.result = _lsa_LSARADTREPORTSECURITYEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_mgmt.c samba3/source3/librpc/gen_ndr/srv_mgmt.c
--- samba3/source3/librpc/gen_ndr/srv_mgmt.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_mgmt.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _mgmt_inq_if_ids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@
 
 	r->out.result = _mgmt_inq_stats(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@
 
 	r->out.result = _mgmt_is_server_listening(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -284,7 +284,7 @@
 
 	r->out.result = _mgmt_stop_server_listening(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -364,7 +364,7 @@
 
 	r->out.result = _mgmt_inq_princ_name(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_msgsvc.c samba3/source3/librpc/gen_ndr/srv_msgsvc.c
--- samba3/source3/librpc/gen_ndr/srv_msgsvc.c	2015-02-22 15:16:36.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_msgsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_NetrMessageNameAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_NetrMessageNameEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_NetrMessageNameGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_NetrMessageNameDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -361,7 +361,7 @@
 
 	_NetrSendMessage(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_nbt.c samba3/source3/librpc/gen_ndr/srv_nbt.c
--- samba3/source3/librpc/gen_ndr/srv_nbt.c	2015-02-22 15:16:41.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_nbt.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_nbt_netlogon_packet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_netlogon.c samba3/source3/librpc/gen_ndr/srv_netlogon.c
--- samba3/source3/librpc/gen_ndr/srv_netlogon.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_netlogon.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _netr_LogonUasLogon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@
 
 	r->out.result = _netr_LogonUasLogoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -218,7 +218,7 @@
 
 	r->out.result = _netr_LogonSamLogon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -293,7 +293,7 @@
 	r->out.return_authenticator = r->in.return_authenticator;
 	r->out.result = _netr_LogonSamLogoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -373,7 +373,7 @@
 
 	r->out.result = _netr_ServerReqChallenge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -453,7 +453,7 @@
 
 	r->out.result = _netr_ServerAuthenticate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -533,7 +533,7 @@
 
 	r->out.result = _netr_ServerPasswordSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -615,7 +615,7 @@
 
 	r->out.result = _netr_DatabaseDeltas(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -697,7 +697,7 @@
 
 	r->out.result = _netr_DatabaseSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -796,7 +796,7 @@
 
 	r->out.result = _netr_AccountDeltas(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -896,7 +896,7 @@
 
 	r->out.result = _netr_AccountSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@
 
 	r->out.result = _netr_GetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1056,7 +1056,7 @@
 
 	r->out.result = _netr_LogonControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@
 
 	r->out.result = _netr_GetAnyDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1216,7 +1216,7 @@
 
 	r->out.result = _netr_LogonControl2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1297,7 +1297,7 @@
 
 	r->out.result = _netr_ServerAuthenticate2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1379,7 +1379,7 @@
 
 	r->out.result = _netr_DatabaseSync2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1460,7 +1460,7 @@
 
 	r->out.result = _netr_DatabaseRedo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1540,7 +1540,7 @@
 
 	r->out.result = _netr_LogonControl2Ex(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1620,7 +1620,7 @@
 
 	r->out.result = _netr_NetrEnumerateTrustedDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1700,7 +1700,7 @@
 
 	r->out.result = _netr_DsRGetDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1781,7 +1781,7 @@
 
 	r->out.result = _netr_LogonGetCapabilities(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1854,7 +1854,7 @@
 
 	r->out.result = _netr_NETRLOGONSETSERVICEBITS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1934,7 +1934,7 @@
 
 	r->out.result = _netr_LogonGetTrustRid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2007,7 +2007,7 @@
 
 	r->out.result = _netr_NETRLOGONCOMPUTESERVERDIGEST(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2080,7 +2080,7 @@
 
 	r->out.result = _netr_NETRLOGONCOMPUTECLIENTDIGEST(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2167,7 +2167,7 @@
 
 	r->out.result = _netr_ServerAuthenticate3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2247,7 +2247,7 @@
 
 	r->out.result = _netr_DsRGetDCNameEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2327,7 +2327,7 @@
 
 	r->out.result = _netr_DsRGetSiteName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2408,7 +2408,7 @@
 
 	r->out.result = _netr_LogonGetDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2488,7 +2488,7 @@
 
 	r->out.result = _netr_ServerPasswordSet2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2574,7 +2574,7 @@
 
 	r->out.result = _netr_ServerPasswordGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2647,7 +2647,7 @@
 
 	r->out.result = _netr_NETRLOGONSENDTOSAM(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2727,7 +2727,7 @@
 
 	r->out.result = _netr_DsRAddressToSitenamesW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2807,7 +2807,7 @@
 
 	r->out.result = _netr_DsRGetDCNameEx2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2880,7 +2880,7 @@
 
 	r->out.result = _netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2960,7 +2960,7 @@
 
 	r->out.result = _netr_NetrEnumerateTrustedDomainsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3040,7 +3040,7 @@
 
 	r->out.result = _netr_DsRAddressToSitenamesExW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3120,7 +3120,7 @@
 
 	r->out.result = _netr_DsrGetDcSiteCoverageW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3207,7 +3207,7 @@
 
 	r->out.result = _netr_LogonSamLogonEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3287,7 +3287,7 @@
 
 	r->out.result = _netr_DsrEnumerateDomainTrusts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3360,7 +3360,7 @@
 
 	r->out.result = _netr_DsrDeregisterDNSHostRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3452,7 +3452,7 @@
 
 	r->out.result = _netr_ServerTrustPasswordsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3532,7 +3532,7 @@
 
 	r->out.result = _netr_DsRGetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3618,7 +3618,7 @@
 
 	r->out.result = _netr_GetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3706,7 +3706,7 @@
 
 	r->out.result = _netr_LogonSamLogonWithFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3804,7 +3804,7 @@
 
 	r->out.result = _netr_ServerGetTrustInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3877,7 +3877,7 @@
 
 	r->out.result = _netr_Unused47(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3958,7 +3958,7 @@
 
 	r->out.result = _netr_DsrUpdateReadOnlyServerDnsRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_ntlmssp.c samba3/source3/librpc/gen_ndr/srv_ntlmssp.c
--- samba3/source3/librpc/gen_ndr/srv_ntlmssp.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_ntlmssp.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_NEGOTIATE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_decode_CHALLENGE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_decode_AUTHENTICATE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_decode_NTLMv2_CLIENT_CHALLENGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_decode_NTLMv2_RESPONSE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_ntprinting.c samba3/source3/librpc/gen_ndr/srv_ntprinting.c
--- samba3/source3/librpc/gen_ndr/srv_ntprinting.c	2015-02-22 15:16:42.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_ntprinting.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_ntprinting_form(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_decode_ntprinting_driver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_decode_ntprinting_printer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_ntsvcs.c samba3/source3/librpc/gen_ndr/srv_ntsvcs.c
--- samba3/source3/librpc/gen_ndr/srv_ntsvcs.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_ntsvcs.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _PNP_Disconnect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _PNP_Connect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@
 
 	r->out.result = _PNP_GetVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@
 
 	r->out.result = _PNP_GetGlobalState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -343,7 +343,7 @@
 
 	r->out.result = _PNP_InitDetection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -416,7 +416,7 @@
 
 	r->out.result = _PNP_ReportLogOn(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -489,7 +489,7 @@
 
 	r->out.result = _PNP_ValidateDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -562,7 +562,7 @@
 
 	r->out.result = _PNP_GetRootDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -635,7 +635,7 @@
 
 	r->out.result = _PNP_GetRelatedDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -708,7 +708,7 @@
 
 	r->out.result = _PNP_EnumerateSubKeys(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -789,7 +789,7 @@
 
 	r->out.result = _PNP_GetDeviceList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -869,7 +869,7 @@
 
 	r->out.result = _PNP_GetDeviceListSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -942,7 +942,7 @@
 
 	r->out.result = _PNP_GetDepth(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1025,7 +1025,7 @@
 
 	r->out.result = _PNP_GetDeviceRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1098,7 +1098,7 @@
 
 	r->out.result = _PNP_SetDeviceRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1171,7 +1171,7 @@
 
 	r->out.result = _PNP_GetClassInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1244,7 +1244,7 @@
 
 	r->out.result = _PNP_CreateKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1317,7 +1317,7 @@
 
 	r->out.result = _PNP_DeleteRegistryKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1390,7 +1390,7 @@
 
 	r->out.result = _PNP_GetClassCount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1463,7 +1463,7 @@
 
 	r->out.result = _PNP_GetClassName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1536,7 +1536,7 @@
 
 	r->out.result = _PNP_DeleteClassKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1609,7 +1609,7 @@
 
 	r->out.result = _PNP_GetInterfaceDeviceAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1682,7 +1682,7 @@
 
 	r->out.result = _PNP_GetInterfaceDeviceList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1755,7 +1755,7 @@
 
 	r->out.result = _PNP_GetInterfaceDeviceListSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1828,7 +1828,7 @@
 
 	r->out.result = _PNP_RegisterDeviceClassAssociation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1901,7 +1901,7 @@
 
 	r->out.result = _PNP_UnregisterDeviceClassAssociation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1974,7 +1974,7 @@
 
 	r->out.result = _PNP_GetClassRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2047,7 +2047,7 @@
 
 	r->out.result = _PNP_SetClassRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2120,7 +2120,7 @@
 
 	r->out.result = _PNP_CreateDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2193,7 +2193,7 @@
 
 	r->out.result = _PNP_DeviceInstanceAction(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2266,7 +2266,7 @@
 
 	r->out.result = _PNP_GetDeviceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2339,7 +2339,7 @@
 
 	r->out.result = _PNP_SetDeviceProblem(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2412,7 +2412,7 @@
 
 	r->out.result = _PNP_DisableDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2485,7 +2485,7 @@
 
 	r->out.result = _PNP_UninstallDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2558,7 +2558,7 @@
 
 	r->out.result = _PNP_AddID(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2631,7 +2631,7 @@
 
 	r->out.result = _PNP_RegisterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2704,7 +2704,7 @@
 
 	r->out.result = _PNP_QueryRemove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2777,7 +2777,7 @@
 
 	r->out.result = _PNP_RequestDeviceEject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2850,7 +2850,7 @@
 
 	r->out.result = _PNP_IsDockStationPresent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2923,7 +2923,7 @@
 
 	r->out.result = _PNP_RequestEjectPC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3005,7 +3005,7 @@
 
 	r->out.result = _PNP_HwProfFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3080,7 +3080,7 @@
 	r->out.info = r->in.info;
 	r->out.result = _PNP_GetHwProfInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3153,7 +3153,7 @@
 
 	r->out.result = _PNP_AddEmptyLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3226,7 +3226,7 @@
 
 	r->out.result = _PNP_FreeLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3299,7 +3299,7 @@
 
 	r->out.result = _PNP_GetFirstLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3372,7 +3372,7 @@
 
 	r->out.result = _PNP_GetNextLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3445,7 +3445,7 @@
 
 	r->out.result = _PNP_GetLogConfPriority(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3518,7 +3518,7 @@
 
 	r->out.result = _PNP_AddResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3591,7 +3591,7 @@
 
 	r->out.result = _PNP_FreeResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3664,7 +3664,7 @@
 
 	r->out.result = _PNP_GetNextResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3737,7 +3737,7 @@
 
 	r->out.result = _PNP_GetResDesData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3810,7 +3810,7 @@
 
 	r->out.result = _PNP_GetResDesDataSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3883,7 +3883,7 @@
 
 	r->out.result = _PNP_ModifyResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3956,7 +3956,7 @@
 
 	r->out.result = _PNP_DetectResourceLimit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4029,7 +4029,7 @@
 
 	r->out.result = _PNP_QueryResConfList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4102,7 +4102,7 @@
 
 	r->out.result = _PNP_SetHwProf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4175,7 +4175,7 @@
 
 	r->out.result = _PNP_QueryArbitratorFreeData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4248,7 +4248,7 @@
 
 	r->out.result = _PNP_QueryArbitratorFreeSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4321,7 +4321,7 @@
 
 	r->out.result = _PNP_RunDetection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4394,7 +4394,7 @@
 
 	r->out.result = _PNP_RegisterNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4467,7 +4467,7 @@
 
 	r->out.result = _PNP_UnregisterNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4540,7 +4540,7 @@
 
 	r->out.result = _PNP_GetCustomDevProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4613,7 +4613,7 @@
 
 	r->out.result = _PNP_GetVersionInternal(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4686,7 +4686,7 @@
 
 	r->out.result = _PNP_GetBlockedDriverInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4759,7 +4759,7 @@
 
 	r->out.result = _PNP_GetServerSideDeviceInstallFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_oxidresolver.c samba3/source3/librpc/gen_ndr/srv_oxidresolver.c
--- samba3/source3/librpc/gen_ndr/srv_oxidresolver.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_oxidresolver.c	2024-08-04 17:52:53.000000000 +0200
@@ -63,7 +63,7 @@
 
 	r->out.result = _ResolveOxid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -136,7 +136,7 @@
 
 	r->out.result = _SimplePing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -217,7 +217,7 @@
 
 	r->out.result = _ComplexPing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -290,7 +290,7 @@
 
 	r->out.result = _ServerAlive(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -388,7 +388,7 @@
 
 	r->out.result = _ResolveOxid2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -492,7 +492,7 @@
 
 	r->out.result = _ServerAlive2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_policyagent.c samba3/source3/librpc/gen_ndr/srv_policyagent.c
--- samba3/source3/librpc/gen_ndr/srv_policyagent.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_policyagent.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _policyagent_Dummy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_preg.c samba3/source3/librpc/gen_ndr/srv_preg.c
--- samba3/source3/librpc/gen_ndr/srv_preg.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_preg.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_decode_preg_file(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_rap.c samba3/source3/librpc/gen_ndr/srv_rap.c
--- samba3/source3/librpc/gen_ndr/srv_rap.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_rap.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	_rap_NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -125,7 +125,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -205,7 +205,7 @@
 
 	_rap_NetServerEnum2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_WserverGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -359,7 +359,7 @@
 
 	_rap_NetPrintQEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -433,7 +433,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -507,7 +507,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobPause(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -581,7 +581,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobContinue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -655,7 +655,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -729,7 +729,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueuePause(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -803,7 +803,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueueResume(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -877,7 +877,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueuePurge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -957,7 +957,7 @@
 
 	_rap_NetPrintJobEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1031,7 +1031,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1105,7 +1105,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1185,7 +1185,7 @@
 
 	_rap_NetPrintDestEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1259,7 +1259,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintDestGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1333,7 +1333,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetUserPasswordSet2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1407,7 +1407,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetOEMChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1481,7 +1481,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1561,7 +1561,7 @@
 
 	_rap_NetSessionEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1635,7 +1635,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetSessionGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1709,7 +1709,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetUserAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1783,7 +1783,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetUserDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1857,7 +1857,7 @@
 	ZERO_STRUCT(r->out);
 	_rap_NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_remact.c samba3/source3/librpc/gen_ndr/srv_remact.c
--- samba3/source3/librpc/gen_ndr/srv_remact.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_remact.c	2024-08-04 17:52:53.000000000 +0200
@@ -99,7 +99,7 @@
 
 	r->out.result = _RemoteActivation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_rot.c samba3/source3/librpc/gen_ndr/srv_rot.c
--- samba3/source3/librpc/gen_ndr/srv_rot.c	2015-02-22 15:16:43.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_rot.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _rot_add(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@
 
 	r->out.result = _rot_remove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@
 
 	r->out.result = _rot_is_listed(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -277,7 +277,7 @@
 
 	r->out.result = _rot_get_interface_pointer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -350,7 +350,7 @@
 
 	r->out.result = _rot_set_modification_time(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -430,7 +430,7 @@
 
 	r->out.result = _rot_get_modification_time(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -510,7 +510,7 @@
 
 	r->out.result = _rot_enum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_samr.c samba3/source3/librpc/gen_ndr/srv_samr.c
--- samba3/source3/librpc/gen_ndr/srv_samr.c	2015-02-22 15:16:44.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_samr.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _samr_Connect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _samr_Close(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -199,7 +199,7 @@
 
 	r->out.result = _samr_SetSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@
 
 	r->out.result = _samr_QuerySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -352,7 +352,7 @@
 
 	r->out.result = _samr_Shutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -432,7 +432,7 @@
 
 	r->out.result = _samr_LookupDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -519,7 +519,7 @@
 
 	r->out.result = _samr_EnumDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -599,7 +599,7 @@
 
 	r->out.result = _samr_OpenDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -679,7 +679,7 @@
 
 	r->out.result = _samr_QueryDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -752,7 +752,7 @@
 
 	r->out.result = _samr_SetDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -838,7 +838,7 @@
 
 	r->out.result = _samr_CreateDomainGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -925,7 +925,7 @@
 
 	r->out.result = _samr_EnumDomainGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1011,7 +1011,7 @@
 
 	r->out.result = _samr_CreateUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1098,7 +1098,7 @@
 
 	r->out.result = _samr_EnumDomainUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1184,7 +1184,7 @@
 
 	r->out.result = _samr_CreateDomAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1271,7 +1271,7 @@
 
 	r->out.result = _samr_EnumDomainAliases(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1351,7 +1351,7 @@
 
 	r->out.result = _samr_GetAliasMembership(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1437,7 +1437,7 @@
 
 	r->out.result = _samr_LookupNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1523,7 +1523,7 @@
 
 	r->out.result = _samr_LookupRids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1603,7 +1603,7 @@
 
 	r->out.result = _samr_OpenGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1683,7 +1683,7 @@
 
 	r->out.result = _samr_QueryGroupInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1756,7 +1756,7 @@
 
 	r->out.result = _samr_SetGroupInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1829,7 +1829,7 @@
 
 	r->out.result = _samr_AddGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1904,7 +1904,7 @@
 	r->out.group_handle = r->in.group_handle;
 	r->out.result = _samr_DeleteDomainGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1977,7 +1977,7 @@
 
 	r->out.result = _samr_DeleteGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2057,7 +2057,7 @@
 
 	r->out.result = _samr_QueryGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2130,7 +2130,7 @@
 
 	r->out.result = _samr_SetMemberAttributesOfGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2210,7 +2210,7 @@
 
 	r->out.result = _samr_OpenAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2290,7 +2290,7 @@
 
 	r->out.result = _samr_QueryAliasInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2363,7 +2363,7 @@
 
 	r->out.result = _samr_SetAliasInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2438,7 +2438,7 @@
 	r->out.alias_handle = r->in.alias_handle;
 	r->out.result = _samr_DeleteDomAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2511,7 +2511,7 @@
 
 	r->out.result = _samr_AddAliasMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2584,7 +2584,7 @@
 
 	r->out.result = _samr_DeleteAliasMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2664,7 +2664,7 @@
 
 	r->out.result = _samr_GetMembersInAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2744,7 +2744,7 @@
 
 	r->out.result = _samr_OpenUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2819,7 +2819,7 @@
 	r->out.user_handle = r->in.user_handle;
 	r->out.result = _samr_DeleteUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2899,7 +2899,7 @@
 
 	r->out.result = _samr_QueryUserInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2972,7 +2972,7 @@
 
 	r->out.result = _samr_SetUserInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3045,7 +3045,7 @@
 
 	r->out.result = _samr_ChangePasswordUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3125,7 +3125,7 @@
 
 	r->out.result = _samr_GetGroupsForUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3217,7 +3217,7 @@
 
 	r->out.result = _samr_QueryDisplayInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3297,7 +3297,7 @@
 
 	r->out.result = _samr_GetDisplayEnumerationIndex(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3370,7 +3370,7 @@
 
 	r->out.result = _samr_TestPrivateFunctionsDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3443,7 +3443,7 @@
 
 	r->out.result = _samr_TestPrivateFunctionsUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3523,7 +3523,7 @@
 
 	r->out.result = _samr_GetUserPwInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3596,7 +3596,7 @@
 
 	r->out.result = _samr_RemoveMemberFromForeignDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3676,7 +3676,7 @@
 
 	r->out.result = _samr_QueryDomainInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3756,7 +3756,7 @@
 
 	r->out.result = _samr_QueryUserInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3848,7 +3848,7 @@
 
 	r->out.result = _samr_QueryDisplayInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3928,7 +3928,7 @@
 
 	r->out.result = _samr_GetDisplayEnumerationIndex2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4020,7 +4020,7 @@
 
 	r->out.result = _samr_CreateUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4112,7 +4112,7 @@
 
 	r->out.result = _samr_QueryDisplayInfo3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4185,7 +4185,7 @@
 
 	r->out.result = _samr_AddMultipleMembersToAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4258,7 +4258,7 @@
 
 	r->out.result = _samr_RemoveMultipleMembersFromAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4331,7 +4331,7 @@
 
 	r->out.result = _samr_OemChangePasswordUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4404,7 +4404,7 @@
 
 	r->out.result = _samr_ChangePasswordUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4484,7 +4484,7 @@
 
 	r->out.result = _samr_GetDomPwInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4564,7 +4564,7 @@
 
 	r->out.result = _samr_Connect2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4637,7 +4637,7 @@
 
 	r->out.result = _samr_SetUserInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4710,7 +4710,7 @@
 
 	r->out.result = _samr_SetBootKeyInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4790,7 +4790,7 @@
 
 	r->out.result = _samr_GetBootKeyInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4870,7 +4870,7 @@
 
 	r->out.result = _samr_Connect3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4950,7 +4950,7 @@
 
 	r->out.result = _samr_Connect4(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5036,7 +5036,7 @@
 
 	r->out.result = _samr_ChangePasswordUser3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5128,7 +5128,7 @@
 
 	r->out.result = _samr_Connect5(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5208,7 +5208,7 @@
 
 	r->out.result = _samr_RidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5281,7 +5281,7 @@
 
 	r->out.result = _samr_SetDsrmPassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5361,7 +5361,7 @@
 
 	r->out.result = _samr_ValidatePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_scerpc.c samba3/source3/librpc/gen_ndr/srv_scerpc.c
--- samba3/source3/librpc/gen_ndr/srv_scerpc.c	2015-02-22 15:16:44.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_scerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _scerpc_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_spoolss.c samba3/source3/librpc/gen_ndr/srv_spoolss.c
--- samba3/source3/librpc/gen_ndr/srv_spoolss.c	2015-02-22 15:16:49.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_spoolss.c	2024-08-04 17:52:53.000000000 +0200
@@ -63,7 +63,7 @@
 
 	r->out.result = _spoolss_EnumPrinters(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -143,7 +143,7 @@
 
 	r->out.result = _spoolss_OpenPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -216,7 +216,7 @@
 
 	r->out.result = _spoolss_SetJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -302,7 +302,7 @@
 
 	r->out.result = _spoolss_GetJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -394,7 +394,7 @@
 
 	r->out.result = _spoolss_EnumJobs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -474,7 +474,7 @@
 
 	r->out.result = _spoolss_AddPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -547,7 +547,7 @@
 
 	r->out.result = _spoolss_DeletePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -620,7 +620,7 @@
 
 	r->out.result = _spoolss_SetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -706,7 +706,7 @@
 
 	r->out.result = _spoolss_GetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -779,7 +779,7 @@
 
 	r->out.result = _spoolss_AddPrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -871,7 +871,7 @@
 
 	r->out.result = _spoolss_EnumPrinterDrivers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -957,7 +957,7 @@
 
 	r->out.result = _spoolss_GetPrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1043,7 +1043,7 @@
 
 	r->out.result = _spoolss_GetPrinterDriverDirectory(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1116,7 +1116,7 @@
 
 	r->out.result = _spoolss_DeletePrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1189,7 +1189,7 @@
 
 	r->out.result = _spoolss_AddPrintProcessor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1281,7 +1281,7 @@
 
 	r->out.result = _spoolss_EnumPrintProcessors(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1367,7 +1367,7 @@
 
 	r->out.result = _spoolss_GetPrintProcessorDirectory(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1447,7 +1447,7 @@
 
 	r->out.result = _spoolss_StartDocPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1520,7 +1520,7 @@
 
 	r->out.result = _spoolss_StartPagePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1600,7 +1600,7 @@
 
 	r->out.result = _spoolss_WritePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1673,7 +1673,7 @@
 
 	r->out.result = _spoolss_EndPagePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1746,7 +1746,7 @@
 
 	r->out.result = _spoolss_AbortPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1832,7 +1832,7 @@
 
 	r->out.result = _spoolss_ReadPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1905,7 +1905,7 @@
 
 	r->out.result = _spoolss_EndDocPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1986,7 +1986,7 @@
 
 	r->out.result = _spoolss_AddJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2059,7 +2059,7 @@
 
 	r->out.result = _spoolss_ScheduleJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2151,7 +2151,7 @@
 
 	r->out.result = _spoolss_GetPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2224,7 +2224,7 @@
 
 	r->out.result = _spoolss_SetPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2297,7 +2297,7 @@
 
 	r->out.result = _spoolss_WaitForPrinterChange(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2372,7 +2372,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _spoolss_ClosePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2445,7 +2445,7 @@
 
 	r->out.result = _spoolss_AddForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2518,7 +2518,7 @@
 
 	r->out.result = _spoolss_DeleteForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2604,7 +2604,7 @@
 
 	r->out.result = _spoolss_GetForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2677,7 +2677,7 @@
 
 	r->out.result = _spoolss_SetForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2769,7 +2769,7 @@
 
 	r->out.result = _spoolss_EnumForms(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2861,7 +2861,7 @@
 
 	r->out.result = _spoolss_EnumPorts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2953,7 +2953,7 @@
 
 	r->out.result = _spoolss_EnumMonitors(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3026,7 +3026,7 @@
 
 	r->out.result = _spoolss_AddPort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3099,7 +3099,7 @@
 
 	r->out.result = _spoolss_ConfigurePort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3172,7 +3172,7 @@
 
 	r->out.result = _spoolss_DeletePort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3252,7 +3252,7 @@
 
 	r->out.result = _spoolss_CreatePrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3325,7 +3325,7 @@
 
 	r->out.result = _spoolss_PlayGDIScriptOnPrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3400,7 +3400,7 @@
 	r->out.gdi_handle = r->in.gdi_handle;
 	r->out.result = _spoolss_DeletePrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3473,7 +3473,7 @@
 
 	r->out.result = _spoolss_AddPrinterConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3546,7 +3546,7 @@
 
 	r->out.result = _spoolss_DeletePrinterConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3619,7 +3619,7 @@
 
 	r->out.result = _spoolss_PrinterMessageBox(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3692,7 +3692,7 @@
 
 	r->out.result = _spoolss_AddMonitor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3765,7 +3765,7 @@
 
 	r->out.result = _spoolss_DeleteMonitor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3838,7 +3838,7 @@
 
 	r->out.result = _spoolss_DeletePrintProcessor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3911,7 +3911,7 @@
 
 	r->out.result = _spoolss_AddPrintProvidor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3984,7 +3984,7 @@
 
 	r->out.result = _spoolss_DeletePrintProvidor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4076,7 +4076,7 @@
 
 	r->out.result = _spoolss_EnumPrintProcDataTypes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4149,7 +4149,7 @@
 
 	r->out.result = _spoolss_ResetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4247,7 +4247,7 @@
 
 	r->out.result = _spoolss_GetPrinterDriver2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4320,7 +4320,7 @@
 
 	r->out.result = _spoolss_FindFirstPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4393,7 +4393,7 @@
 
 	r->out.result = _spoolss_FindNextPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4466,7 +4466,7 @@
 
 	r->out.result = _spoolss_FindClosePrinterNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4539,7 +4539,7 @@
 
 	r->out.result = _spoolss_RouterFindFirstPrinterChangeNotificationOld(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4619,7 +4619,7 @@
 
 	r->out.result = _spoolss_ReplyOpenPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4692,7 +4692,7 @@
 
 	r->out.result = _spoolss_RouterReplyPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4767,7 +4767,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _spoolss_ReplyClosePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4840,7 +4840,7 @@
 
 	r->out.result = _spoolss_AddPortEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4913,7 +4913,7 @@
 
 	r->out.result = _spoolss_RouterFindFirstPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4986,7 +4986,7 @@
 
 	r->out.result = _spoolss_SpoolerInit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5059,7 +5059,7 @@
 
 	r->out.result = _spoolss_ResetPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5132,7 +5132,7 @@
 
 	r->out.result = _spoolss_RemoteFindFirstPrinterChangeNotifyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5212,7 +5212,7 @@
 
 	r->out.result = _spoolss_RouterReplyPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5292,7 +5292,7 @@
 
 	r->out.result = _spoolss_RouterRefreshPrinterChangeNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5365,7 +5365,7 @@
 
 	r->out.result = _spoolss_44(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5445,7 +5445,7 @@
 
 	r->out.result = _spoolss_OpenPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5525,7 +5525,7 @@
 
 	r->out.result = _spoolss_AddPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5598,7 +5598,7 @@
 
 	r->out.result = _spoolss_SetPort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5702,7 +5702,7 @@
 
 	r->out.result = _spoolss_EnumPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5775,7 +5775,7 @@
 
 	r->out.result = _spoolss_DeletePrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5848,7 +5848,7 @@
 
 	r->out.result = _spoolss_4a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5921,7 +5921,7 @@
 
 	r->out.result = _spoolss_4b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5994,7 +5994,7 @@
 
 	r->out.result = _spoolss_4c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6067,7 +6067,7 @@
 
 	r->out.result = _spoolss_SetPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6159,7 +6159,7 @@
 
 	r->out.result = _spoolss_GetPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6251,7 +6251,7 @@
 
 	r->out.result = _spoolss_EnumPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6343,7 +6343,7 @@
 
 	r->out.result = _spoolss_EnumPrinterKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6416,7 +6416,7 @@
 
 	r->out.result = _spoolss_DeletePrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6489,7 +6489,7 @@
 
 	r->out.result = _spoolss_DeletePrinterKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6562,7 +6562,7 @@
 
 	r->out.result = _spoolss_53(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6635,7 +6635,7 @@
 
 	r->out.result = _spoolss_DeletePrinterDriverEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6708,7 +6708,7 @@
 
 	r->out.result = _spoolss_AddPerMachineConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6781,7 +6781,7 @@
 
 	r->out.result = _spoolss_DeletePerMachineConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6854,7 +6854,7 @@
 
 	r->out.result = _spoolss_EnumPerMachineConnections(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6941,7 +6941,7 @@
 
 	r->out.result = _spoolss_XcvData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7014,7 +7014,7 @@
 
 	r->out.result = _spoolss_AddPrinterDriverEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7087,7 +7087,7 @@
 
 	r->out.result = _spoolss_5a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7160,7 +7160,7 @@
 
 	r->out.result = _spoolss_5b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7233,7 +7233,7 @@
 
 	r->out.result = _spoolss_5c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7306,7 +7306,7 @@
 
 	r->out.result = _spoolss_5d(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7379,7 +7379,7 @@
 
 	r->out.result = _spoolss_5e(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7452,7 +7452,7 @@
 
 	r->out.result = _spoolss_5f(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7525,7 +7525,7 @@
 
 	r->out.result = _spoolss_60(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7598,7 +7598,7 @@
 
 	r->out.result = _spoolss_61(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7671,7 +7671,7 @@
 
 	r->out.result = _spoolss_62(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7744,7 +7744,7 @@
 
 	r->out.result = _spoolss_63(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7817,7 +7817,7 @@
 
 	r->out.result = _spoolss_64(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7890,7 +7890,7 @@
 
 	r->out.result = _spoolss_65(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7970,7 +7970,7 @@
 
 	r->out.result = _spoolss_GetCorePrinterDrivers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8043,7 +8043,7 @@
 
 	r->out.result = _spoolss_67(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8124,7 +8124,7 @@
 
 	r->out.result = _spoolss_GetPrinterDriverPackagePath(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8197,7 +8197,7 @@
 
 	r->out.result = _spoolss_69(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8270,7 +8270,7 @@
 
 	r->out.result = _spoolss_6a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8343,7 +8343,7 @@
 
 	r->out.result = _spoolss_6b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8416,7 +8416,7 @@
 
 	r->out.result = _spoolss_6c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8489,7 +8489,7 @@
 
 	r->out.result = _spoolss_6d(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_srvsvc.c samba3/source3/librpc/gen_ndr/srv_srvsvc.c
--- samba3/source3/librpc/gen_ndr/srv_srvsvc.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_srvsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -53,7 +53,7 @@
 
 	r->out.result = _srvsvc_NetCharDevEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -133,7 +133,7 @@
 
 	r->out.result = _srvsvc_NetCharDevGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -206,7 +206,7 @@
 
 	r->out.result = _srvsvc_NetCharDevControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -288,7 +288,7 @@
 
 	r->out.result = _srvsvc_NetCharDevQEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -368,7 +368,7 @@
 
 	r->out.result = _srvsvc_NetCharDevQGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -443,7 +443,7 @@
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetCharDevQSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -516,7 +516,7 @@
 
 	r->out.result = _srvsvc_NetCharDevQPurge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -589,7 +589,7 @@
 
 	r->out.result = _srvsvc_NetCharDevQPurgeSelf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -671,7 +671,7 @@
 
 	r->out.result = _srvsvc_NetConnEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -753,7 +753,7 @@
 
 	r->out.result = _srvsvc_NetFileEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -833,7 +833,7 @@
 
 	r->out.result = _srvsvc_NetFileGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -906,7 +906,7 @@
 
 	r->out.result = _srvsvc_NetFileClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -988,7 +988,7 @@
 
 	r->out.result = _srvsvc_NetSessEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1061,7 +1061,7 @@
 
 	r->out.result = _srvsvc_NetSessDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1218,7 +1218,7 @@
 
 	r->out.result = _srvsvc_NetShareEnumAll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1298,7 +1298,7 @@
 
 	r->out.result = _srvsvc_NetShareGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1373,7 +1373,7 @@
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetShareSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1446,7 +1446,7 @@
 
 	r->out.result = _srvsvc_NetShareDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1519,7 +1519,7 @@
 
 	r->out.result = _srvsvc_NetShareDelSticky(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1599,7 +1599,7 @@
 
 	r->out.result = _srvsvc_NetShareCheck(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1679,7 +1679,7 @@
 
 	r->out.result = _srvsvc_NetSrvGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1754,7 +1754,7 @@
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetSrvSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1836,7 +1836,7 @@
 
 	r->out.result = _srvsvc_NetDiskEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1916,7 +1916,7 @@
 
 	r->out.result = _srvsvc_NetServerStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1989,7 +1989,7 @@
 
 	r->out.result = _srvsvc_NetTransportAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2071,7 +2071,7 @@
 
 	r->out.result = _srvsvc_NetTransportEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2144,7 +2144,7 @@
 
 	r->out.result = _srvsvc_NetTransportDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2224,7 +2224,7 @@
 
 	r->out.result = _srvsvc_NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2297,7 +2297,7 @@
 
 	r->out.result = _srvsvc_NetSetServiceBits(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2377,7 +2377,7 @@
 
 	r->out.result = _srvsvc_NetPathType(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2458,7 +2458,7 @@
 
 	r->out.result = _srvsvc_NetPathCanonicalize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2531,7 +2531,7 @@
 
 	r->out.result = _srvsvc_NetPathCompare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2604,7 +2604,7 @@
 
 	r->out.result = _srvsvc_NetNameValidate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2677,7 +2677,7 @@
 
 	r->out.result = _srvsvc_NETRPRNAMECANONICALIZE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2750,7 +2750,7 @@
 
 	r->out.result = _srvsvc_NetPRNameCompare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2832,7 +2832,7 @@
 
 	r->out.result = _srvsvc_NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2912,7 +2912,7 @@
 
 	r->out.result = _srvsvc_NetShareDelStart(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2987,7 +2987,7 @@
 	r->out.hnd = r->in.hnd;
 	r->out.result = _srvsvc_NetShareDelCommit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3067,7 +3067,7 @@
 
 	r->out.result = _srvsvc_NetGetFileSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3140,7 +3140,7 @@
 
 	r->out.result = _srvsvc_NetSetFileSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3213,7 +3213,7 @@
 
 	r->out.result = _srvsvc_NetServerTransportAddEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3286,7 +3286,7 @@
 
 	r->out.result = _srvsvc_NetServerSetServiceBitsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3359,7 +3359,7 @@
 
 	r->out.result = _srvsvc_NETRDFSGETVERSION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3432,7 +3432,7 @@
 
 	r->out.result = _srvsvc_NETRDFSCREATELOCALPARTITION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3505,7 +3505,7 @@
 
 	r->out.result = _srvsvc_NETRDFSDELETELOCALPARTITION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3578,7 +3578,7 @@
 
 	r->out.result = _srvsvc_NETRDFSSETLOCALVOLUMESTATE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3651,7 +3651,7 @@
 
 	r->out.result = _srvsvc_NETRDFSSETSERVERINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3724,7 +3724,7 @@
 
 	r->out.result = _srvsvc_NETRDFSCREATEEXITPOINT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3797,7 +3797,7 @@
 
 	r->out.result = _srvsvc_NETRDFSDELETEEXITPOINT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3870,7 +3870,7 @@
 
 	r->out.result = _srvsvc_NETRDFSMODIFYPREFIX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3943,7 +3943,7 @@
 
 	r->out.result = _srvsvc_NETRDFSFIXLOCALVOLUME(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4016,7 +4016,7 @@
 
 	r->out.result = _srvsvc_NETRDFSMANAGERREPORTSITEINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4089,7 +4089,7 @@
 
 	r->out.result = _srvsvc_NETRSERVERTRANSPORTDELEX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_svcctl.c samba3/source3/librpc/gen_ndr/srv_svcctl.c
--- samba3/source3/librpc/gen_ndr/srv_svcctl.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_svcctl.c	2024-08-04 17:52:53.000000000 +0200
@@ -46,7 +46,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _svcctl_CloseServiceHandle(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@
 
 	r->out.result = _svcctl_ControlService(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -199,7 +199,7 @@
 
 	r->out.result = _svcctl_DeleteService(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@
 
 	r->out.result = _svcctl_LockServiceDatabase(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -365,7 +365,7 @@
 
 	r->out.result = _svcctl_QueryServiceObjectSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -438,7 +438,7 @@
 
 	r->out.result = _svcctl_SetServiceObjectSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -518,7 +518,7 @@
 
 	r->out.result = _svcctl_QueryServiceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -591,7 +591,7 @@
 
 	r->out.result = _svcctl_SetServiceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -666,7 +666,7 @@
 	r->out.lock = r->in.lock;
 	r->out.result = _svcctl_UnlockServiceDatabase(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -739,7 +739,7 @@
 
 	r->out.result = _svcctl_NotifyBootConfigStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -812,7 +812,7 @@
 
 	r->out.result = _svcctl_SCSetServiceBitsW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -892,7 +892,7 @@
 
 	r->out.result = _svcctl_ChangeServiceConfigW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -973,7 +973,7 @@
 
 	r->out.result = _svcctl_CreateServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1065,7 +1065,7 @@
 
 	r->out.result = _svcctl_EnumDependentServicesW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1158,7 +1158,7 @@
 
 	r->out.result = _svcctl_EnumServicesStatusW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1238,7 +1238,7 @@
 
 	r->out.result = _svcctl_OpenSCManagerW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1318,7 +1318,7 @@
 
 	r->out.result = _svcctl_OpenServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1404,7 +1404,7 @@
 
 	r->out.result = _svcctl_QueryServiceConfigW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1490,7 +1490,7 @@
 
 	r->out.result = _svcctl_QueryServiceLockStatusW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1563,7 +1563,7 @@
 
 	r->out.result = _svcctl_StartServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1644,7 +1644,7 @@
 
 	r->out.result = _svcctl_GetServiceDisplayNameW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1725,7 +1725,7 @@
 
 	r->out.result = _svcctl_GetServiceKeyNameW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1798,7 +1798,7 @@
 
 	r->out.result = _svcctl_SCSetServiceBitsA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1878,7 +1878,7 @@
 
 	r->out.result = _svcctl_ChangeServiceConfigA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1958,7 +1958,7 @@
 
 	r->out.result = _svcctl_CreateServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2050,7 +2050,7 @@
 
 	r->out.result = _svcctl_EnumDependentServicesA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2143,7 +2143,7 @@
 
 	r->out.result = _svcctl_EnumServicesStatusA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2223,7 +2223,7 @@
 
 	r->out.result = _svcctl_OpenSCManagerA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2296,7 +2296,7 @@
 
 	r->out.result = _svcctl_OpenServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2382,7 +2382,7 @@
 
 	r->out.result = _svcctl_QueryServiceConfigA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2468,7 +2468,7 @@
 
 	r->out.result = _svcctl_QueryServiceLockStatusA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2541,7 +2541,7 @@
 
 	r->out.result = _svcctl_StartServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2622,7 +2622,7 @@
 
 	r->out.result = _svcctl_GetServiceDisplayNameA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2703,7 +2703,7 @@
 
 	r->out.result = _svcctl_GetServiceKeyNameA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2776,7 +2776,7 @@
 
 	r->out.result = _svcctl_GetCurrentGroupeStateW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2849,7 +2849,7 @@
 
 	r->out.result = _svcctl_EnumServiceGroupW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2922,7 +2922,7 @@
 
 	r->out.result = _svcctl_ChangeServiceConfig2A(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2995,7 +2995,7 @@
 
 	r->out.result = _svcctl_ChangeServiceConfig2W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3081,7 +3081,7 @@
 
 	r->out.result = _svcctl_QueryServiceConfig2A(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3167,7 +3167,7 @@
 
 	r->out.result = _svcctl_QueryServiceConfig2W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3253,7 +3253,7 @@
 
 	r->out.result = _svcctl_QueryServiceStatusEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3352,7 +3352,7 @@
 
 	r->out.result = _EnumServicesStatusExA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3445,7 +3445,7 @@
 
 	r->out.result = _EnumServicesStatusExW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3518,7 +3518,7 @@
 
 	r->out.result = _svcctl_SCSendTSMessage(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_trkwks.c samba3/source3/librpc/gen_ndr/srv_trkwks.c
--- samba3/source3/librpc/gen_ndr/srv_trkwks.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_trkwks.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _trkwks_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_unixinfo.c samba3/source3/librpc/gen_ndr/srv_unixinfo.c
--- samba3/source3/librpc/gen_ndr/srv_unixinfo.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_unixinfo.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _unixinfo_SidToUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@
 
 	r->out.result = _unixinfo_UidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@
 
 	r->out.result = _unixinfo_SidToGid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@
 
 	r->out.result = _unixinfo_GidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -372,7 +372,7 @@
 
 	r->out.result = _unixinfo_GetPWUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_w32time.c samba3/source3/librpc/gen_ndr/srv_w32time.c
--- samba3/source3/librpc/gen_ndr/srv_w32time.c	2015-02-22 15:16:50.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_w32time.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	r->out.result = _w32time_SyncTime(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	r->out.result = _w32time_GetNetLogonServiceBits(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	r->out.result = _w32time_QueryProviderStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_wbint.c samba3/source3/librpc/gen_ndr/srv_wbint.c
--- samba3/source3/librpc/gen_ndr/srv_wbint.c	2015-02-22 15:16:56.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_wbint.c	2024-09-12 20:44:05.000000000 +0200
@@ -51,7 +51,7 @@
 
 	_wbint_Ping(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -143,7 +143,7 @@
 
 	r->out.result = _wbint_LookupSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -229,7 +229,7 @@
 
 	r->out.result = _wbint_LookupSids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -315,7 +315,7 @@
 
 	r->out.result = _wbint_LookupName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -395,7 +395,7 @@
 
 	r->out.result = _wbint_Sid2Uid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -475,7 +475,7 @@
 
 	r->out.result = _wbint_Sid2Gid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -550,7 +550,7 @@
 	r->out.ids = r->in.ids;
 	r->out.result = _wbint_Sids2UnixIDs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -630,7 +630,7 @@
 
 	r->out.result = _wbint_Uid2Sid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -710,7 +710,7 @@
 
 	r->out.result = _wbint_Gid2Sid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -790,7 +790,7 @@
 
 	r->out.result = _wbint_AllocateUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -870,7 +870,7 @@
 
 	r->out.result = _wbint_AllocateGid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -950,7 +950,7 @@
 
 	r->out.result = _wbint_QueryUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1030,7 +1030,7 @@
 
 	r->out.result = _wbint_LookupUserAliases(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1110,7 +1110,7 @@
 
 	r->out.result = _wbint_LookupUserGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1190,7 +1190,7 @@
 
 	r->out.result = _wbint_QuerySequenceNumber(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1270,7 +1270,7 @@
 
 	r->out.result = _wbint_LookupGroupMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1350,7 +1350,7 @@
 
 	r->out.result = _wbint_QueryUserList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1430,7 +1430,7 @@
 
 	r->out.result = _wbint_QueryGroupList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1510,7 +1510,7 @@
 
 	r->out.result = _wbint_DsGetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1596,7 +1596,7 @@
 
 	r->out.result = _wbint_LookupRids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1669,7 +1669,7 @@
 
 	r->out.result = _wbint_CheckMachineAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1742,7 +1742,7 @@
 
 	r->out.result = _wbint_ChangeMachineAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1815,7 +1815,7 @@
 
 	r->out.result = _wbint_PingDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_winreg.c samba3/source3/librpc/gen_ndr/srv_winreg.c
--- samba3/source3/librpc/gen_ndr/srv_winreg.c	2015-02-22 15:16:51.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_winreg.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _winreg_OpenHKCR(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@
 
 	r->out.result = _winreg_OpenHKCU(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@
 
 	r->out.result = _winreg_OpenHKLM(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@
 
 	r->out.result = _winreg_OpenHKPD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -371,7 +371,7 @@
 
 	r->out.result = _winreg_OpenHKU(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -446,7 +446,7 @@
 	r->out.handle = r->in.handle;
 	r->out.result = _winreg_CloseKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -527,7 +527,7 @@
 
 	r->out.result = _winreg_CreateKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -600,7 +600,7 @@
 
 	r->out.result = _winreg_DeleteKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -673,7 +673,7 @@
 
 	r->out.result = _winreg_DeleteValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -750,7 +750,7 @@
 	r->out.last_changed_time = r->in.last_changed_time;
 	r->out.result = _winreg_EnumKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -829,7 +829,7 @@
 	r->out.length = r->in.length;
 	r->out.result = _winreg_EnumValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -902,7 +902,7 @@
 
 	r->out.result = _winreg_FlushKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -977,7 +977,7 @@
 	r->out.sd = r->in.sd;
 	r->out.result = _winreg_GetKeySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1050,7 +1050,7 @@
 
 	r->out.result = _winreg_LoadKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1123,7 +1123,7 @@
 
 	r->out.result = _winreg_NotifyChangeKeyValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1203,7 +1203,7 @@
 
 	r->out.result = _winreg_OpenKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1326,7 +1326,7 @@
 
 	r->out.result = _winreg_QueryInfoKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1404,7 +1404,7 @@
 	r->out.data_length = r->in.data_length;
 	r->out.result = _winreg_QueryValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1477,7 +1477,7 @@
 
 	r->out.result = _winreg_ReplaceKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1550,7 +1550,7 @@
 
 	r->out.result = _winreg_RestoreKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1623,7 +1623,7 @@
 
 	r->out.result = _winreg_SaveKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1696,7 +1696,7 @@
 
 	r->out.result = _winreg_SetKeySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1769,7 +1769,7 @@
 
 	r->out.result = _winreg_SetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1842,7 +1842,7 @@
 
 	r->out.result = _winreg_UnLoadKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1915,7 +1915,7 @@
 
 	r->out.result = _winreg_InitiateSystemShutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1988,7 +1988,7 @@
 
 	r->out.result = _winreg_AbortSystemShutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2068,7 +2068,7 @@
 
 	r->out.result = _winreg_GetVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2148,7 +2148,7 @@
 
 	r->out.result = _winreg_OpenHKCC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2228,7 +2228,7 @@
 
 	r->out.result = _winreg_OpenHKDD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2310,7 +2310,7 @@
 
 	r->out.result = _winreg_QueryMultipleValues(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2383,7 +2383,7 @@
 
 	r->out.result = _winreg_InitiateSystemShutdownEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2456,7 +2456,7 @@
 
 	r->out.result = _winreg_SaveKeyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2536,7 +2536,7 @@
 
 	r->out.result = _winreg_OpenHKPT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2616,7 +2616,7 @@
 
 	r->out.result = _winreg_OpenHKPN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2703,7 +2703,7 @@
 
 	r->out.result = _winreg_QueryMultipleValues2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2776,7 +2776,7 @@
 
 	r->out.result = _winreg_DeleteKeyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_wkssvc.c samba3/source3/librpc/gen_ndr/srv_wkssvc.c
--- samba3/source3/librpc/gen_ndr/srv_wkssvc.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_wkssvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _wkssvc_NetWkstaGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _wkssvc_NetWkstaSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -208,7 +208,7 @@
 
 	r->out.result = _wkssvc_NetWkstaEnumUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -288,7 +288,7 @@
 
 	r->out.result = _wkssvc_NetrWkstaUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -363,7 +363,7 @@
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrWkstaUserSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -445,7 +445,7 @@
 
 	r->out.result = _wkssvc_NetWkstaTransportEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -520,7 +520,7 @@
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrWkstaTransportAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -593,7 +593,7 @@
 
 	r->out.result = _wkssvc_NetrWkstaTransportDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -668,7 +668,7 @@
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrUseAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -748,7 +748,7 @@
 
 	r->out.result = _wkssvc_NetrUseGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -821,7 +821,7 @@
 
 	r->out.result = _wkssvc_NetrUseDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -903,7 +903,7 @@
 
 	r->out.result = _wkssvc_NetrUseEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@
 
 	r->out.result = _wkssvc_NetrMessageBufferSend(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1056,7 +1056,7 @@
 
 	r->out.result = _wkssvc_NetrWorkstationStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1129,7 +1129,7 @@
 
 	r->out.result = _wkssvc_NetrLogonDomainNameAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1202,7 +1202,7 @@
 
 	r->out.result = _wkssvc_NetrLogonDomainNameDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1275,7 +1275,7 @@
 
 	r->out.result = _wkssvc_NetrJoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1348,7 +1348,7 @@
 
 	r->out.result = _wkssvc_NetrUnjoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1421,7 +1421,7 @@
 
 	r->out.result = _wkssvc_NetrRenameMachineInDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1494,7 +1494,7 @@
 
 	r->out.result = _wkssvc_NetrValidateName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1575,7 +1575,7 @@
 
 	r->out.result = _wkssvc_NetrGetJoinInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1656,7 +1656,7 @@
 
 	r->out.result = _wkssvc_NetrGetJoinableOus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1729,7 +1729,7 @@
 
 	r->out.result = _wkssvc_NetrJoinDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1802,7 +1802,7 @@
 
 	r->out.result = _wkssvc_NetrUnjoinDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1875,7 +1875,7 @@
 
 	r->out.result = _wkssvc_NetrRenameMachineInDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1948,7 +1948,7 @@
 
 	r->out.result = _wkssvc_NetrValidateName2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2029,7 +2029,7 @@
 
 	r->out.result = _wkssvc_NetrGetJoinableOus2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2102,7 +2102,7 @@
 
 	r->out.result = _wkssvc_NetrAddAlternateComputerName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2175,7 +2175,7 @@
 
 	r->out.result = _wkssvc_NetrRemoveAlternateComputerName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2248,7 +2248,7 @@
 
 	r->out.result = _wkssvc_NetrSetPrimaryComputername(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2328,7 +2328,7 @@
 
 	r->out.result = _wkssvc_NetrEnumerateComputerNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_wmi.c samba3/source3/librpc/gen_ndr/srv_wmi.c
--- samba3/source3/librpc/gen_ndr/srv_wmi.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_wmi.c	2024-08-04 17:52:53.000000000 +0200
@@ -51,7 +51,7 @@
 
 	r->out.result = _Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -155,7 +155,7 @@
 
 	r->out.result = _OpenNamespace(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -235,7 +235,7 @@
 
 	r->out.result = _CancelAsyncCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -321,7 +321,7 @@
 
 	r->out.result = _QueryObjectSink(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -403,7 +403,7 @@
 
 	r->out.result = _GetObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -483,7 +483,7 @@
 
 	r->out.result = _GetObjectAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -564,7 +564,7 @@
 
 	r->out.result = _PutClass(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -644,7 +644,7 @@
 
 	r->out.result = _PutClassAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -725,7 +725,7 @@
 
 	r->out.result = _DeleteClass(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -805,7 +805,7 @@
 
 	r->out.result = _DeleteClassAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -891,7 +891,7 @@
 
 	r->out.result = _CreateClassEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -971,7 +971,7 @@
 
 	r->out.result = _CreateClassEnumAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1052,7 +1052,7 @@
 
 	r->out.result = _PutInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1132,7 +1132,7 @@
 
 	r->out.result = _PutInstanceAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1213,7 +1213,7 @@
 
 	r->out.result = _DeleteInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1293,7 +1293,7 @@
 
 	r->out.result = _DeleteInstanceAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1379,7 +1379,7 @@
 
 	r->out.result = _CreateInstanceEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1459,7 +1459,7 @@
 
 	r->out.result = _CreateInstanceEnumAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1545,7 +1545,7 @@
 
 	r->out.result = _ExecQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1625,7 +1625,7 @@
 
 	r->out.result = _ExecQueryAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1711,7 +1711,7 @@
 
 	r->out.result = _ExecNotificationQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1791,7 +1791,7 @@
 
 	r->out.result = _ExecNotificationQueryAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1873,7 +1873,7 @@
 
 	r->out.result = _ExecMethod(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1953,7 +1953,7 @@
 
 	r->out.result = _ExecMethodAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2077,7 +2077,7 @@
 
 	r->out.result = _Reset(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2169,7 +2169,7 @@
 
 	r->out.result = _IEnumWbemClassObject_Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2249,7 +2249,7 @@
 
 	r->out.result = _NextAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2335,7 +2335,7 @@
 
 	r->out.result = _IEnumWbemClassObject_Clone(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2415,7 +2415,7 @@
 
 	r->out.result = _Skip(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2527,7 +2527,7 @@
 
 	r->out.result = _Clone(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2607,7 +2607,7 @@
 
 	r->out.result = _GetNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2687,7 +2687,7 @@
 
 	r->out.result = _BeginEnumeration(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2767,7 +2767,7 @@
 
 	r->out.result = _Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2847,7 +2847,7 @@
 
 	r->out.result = _EndEnumeration(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2927,7 +2927,7 @@
 
 	r->out.result = _SetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3007,7 +3007,7 @@
 
 	r->out.result = _GetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3087,7 +3087,7 @@
 
 	r->out.result = _DeleteValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3167,7 +3167,7 @@
 
 	r->out.result = _DeleteAll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3283,7 +3283,7 @@
 
 	r->out.result = _EstablishPosition(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3369,7 +3369,7 @@
 
 	r->out.result = _RequestChallenge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3455,7 +3455,7 @@
 
 	r->out.result = _WBEMLogin(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3541,7 +3541,7 @@
 
 	r->out.result = _NTLMLogin(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3664,7 +3664,7 @@
 
 	r->out.result = _IWbemWCOSmartEnum_Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3772,7 +3772,7 @@
 
 	r->out.result = _Fetch(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3858,7 +3858,7 @@
 
 	r->out.result = _Test(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3967,7 +3967,7 @@
 
 	r->out.result = _GetResultObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4053,7 +4053,7 @@
 
 	r->out.result = _GetResultString(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4139,7 +4139,7 @@
 
 	r->out.result = _GetResultServices(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4225,7 +4225,7 @@
 
 	r->out.result = _GetCallStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4330,7 +4330,7 @@
 
 	r->out.result = _SetStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4410,7 +4410,7 @@
 
 	r->out.result = _Indicate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_wzcsvc.c samba3/source3/librpc/gen_ndr/srv_wzcsvc.c
--- samba3/source3/librpc/gen_ndr/srv_wzcsvc.c	2015-02-22 15:16:52.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_wzcsvc.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_wzcsvc_EnumInterfaces(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@
 
 	_wzcsvc_QueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@
 
 	_wzcsvc_SetInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@
 
 	_wzcsvc_RefreshInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@
 
 	_wzcsvc_QueryContext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@
 
 	_wzcsvc_SetContext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@
 
 	_wzcsvc_EapolUIResponse(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@
 
 	_wzcsvc_EapolGetCustomAuthData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@
 
 	_wzcsvc_EapolSetCustomAuthData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@
 
 	_wzcsvc_EapolGetInterfaceParams(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@
 
 	_wzcsvc_EapolSetInterfaceParams(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@
 
 	_wzcsvc_EapolReAuthenticateInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@
 
 	_wzcsvc_EapolQueryInterfaceState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@
 
 	_wzcsvc_OpenWZCDbLogSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@
 
 	_wzcsvc_CloseWZCDbLogSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1139,7 +1139,7 @@
 
 	_wzcsvc_EnumWZCDbLogRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1212,7 +1212,7 @@
 
 	_wzcsvc_FlushWZCdbLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1285,7 +1285,7 @@
 
 	_wzcsvc_GetWZCDbLogRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/srv_xattr.c samba3/source3/librpc/gen_ndr/srv_xattr.c
--- samba3/source3/librpc/gen_ndr/srv_xattr.c	2015-02-22 15:16:53.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/srv_xattr.c	2024-08-04 17:52:53.000000000 +0200
@@ -44,7 +44,7 @@
 
 	_xattr_parse_DOSATTRIB(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
diff -daurN samba3/source3/librpc/gen_ndr/wbint.h samba3/source3/librpc/gen_ndr/wbint.h
--- samba3/source3/librpc/gen_ndr/wbint.h	2015-02-22 15:16:56.000000000 +0100
+++ samba3/source3/librpc/gen_ndr/wbint.h	2024-09-12 23:44:50.000000000 +0200
@@ -29,9 +29,9 @@
 
 struct wbint_userinfo {
 	const char *acct_name;/* [unique,charset(UTF8)] */
-	const char *full_name;/* [charset(UTF8),unique] */
+	const char *full_name;/* [unique,charset(UTF8)] */
 	const char *homedir;/* [unique,charset(UTF8)] */
-	const char *shell;/* [charset(UTF8),unique] */
+	const char *shell;/* [unique,charset(UTF8)] */
 	uint64_t primary_gid;
 	struct dom_sid user_sid;
 	struct dom_sid group_sid;
@@ -83,8 +83,8 @@
 
 	struct {
 		enum lsa_SidType *type;/* [ref] */
-		const char **domain;/* [charset(UTF8),ref] */
-		const char **name;/* [charset(UTF8),ref] */
+		const char **domain;/* [ref,charset(UTF8)] */
+		const char **name;/* [ref,charset(UTF8)] */
 		NTSTATUS result;
 	} out;
 
@@ -107,7 +107,7 @@
 
 struct wbint_LookupName {
 	struct {
-		const char *domain;/* [charset(UTF8),ref] */
+		const char *domain;/* [ref,charset(UTF8)] */
 		const char *name;/* [ref,charset(UTF8)] */
 		uint32_t flags;
 	} in;
@@ -123,7 +123,7 @@
 
 struct wbint_Sid2Uid {
 	struct {
-		const char *dom_name;/* [charset(UTF8),unique] */
+		const char *dom_name;/* [unique,charset(UTF8)] */
 		struct dom_sid *sid;/* [ref] */
 	} in;
 
@@ -137,7 +137,7 @@
 
 struct wbint_Sid2Gid {
 	struct {
-		const char *dom_name;/* [charset(UTF8),unique] */
+		const char *dom_name;/* [unique,charset(UTF8)] */
 		struct dom_sid *sid;/* [ref] */
 	} in;
 
diff -daurN samba3/source3/librpc/ndr/util.c samba3/source3/librpc/ndr/util.c
--- samba3/source3/librpc/ndr/util.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/librpc/ndr/util.c	2024-08-04 17:52:53.000000000 +0200
@@ -28,3 +28,7 @@
 	char addr[INET6_ADDRSTRLEN];
 	ndr->print(ndr, "%-25s: %s", name, print_sockaddr(addr, sizeof(addr), ss));
 }
+
+_PUBLIC_ void ndr_print_disabled(struct ndr_print *ndr, const char *name, int flags, void *r)
+{
+}
diff -daurN samba3/source3/librpc/rpc/dcerpc.h samba3/source3/librpc/rpc/dcerpc.h
--- samba3/source3/librpc/rpc/dcerpc.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/librpc/rpc/dcerpc.h	2024-08-04 17:52:53.000000000 +0200
@@ -39,8 +39,10 @@
 struct pipe_auth_data {
 	enum dcerpc_AuthType auth_type;
 	enum dcerpc_AuthLevel auth_level;
+	bool verified_bitmask1;
 
 	void *auth_ctx;
+	uint32_t auth_context_id;
 
 	/* Only the client code uses these 3 for now */
 	char *domain;
@@ -70,10 +72,6 @@
 				 uint32_t auth_context_id,
 				 const DATA_BLOB *credentials,
 				 DATA_BLOB *blob);
-NTSTATUS dcerpc_pull_dcerpc_auth(TALLOC_CTX *mem_ctx,
-				 const DATA_BLOB *blob,
-				 struct dcerpc_auth *r,
-				 bool bigendian);
 NTSTATUS dcerpc_guess_sizes(struct pipe_auth_data *auth,
 			    size_t header_len, size_t data_left,
 			    size_t max_xmit_frag, size_t pad_alignment,
@@ -84,9 +82,8 @@
 NTSTATUS dcerpc_check_auth(struct pipe_auth_data *auth,
 			   struct ncacn_packet *pkt,
 			   DATA_BLOB *pkt_trailer,
-			   size_t header_size,
-			   DATA_BLOB *raw_pkt,
-			   size_t *pad_len);
+			   uint8_t header_size,
+			   DATA_BLOB *raw_pkt);
 
 /* The following definitions come from librpc/rpc/rpc_common.c  */
 
diff -daurN samba3/source3/librpc/rpc/dcerpc_helpers.c samba3/source3/librpc/rpc/dcerpc_helpers.c
--- samba3/source3/librpc/rpc/dcerpc_helpers.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/librpc/rpc/dcerpc_helpers.c	2024-08-04 17:52:53.000000000 +0200
@@ -210,47 +210,6 @@
 }
 
 /**
-* @brief Decodes a dcerpc_auth blob
-*
-* @param mem_ctx	The memory context on which to allocate the packet
-*			elements
-* @param blob		The blob of data to decode
-* @param r		An empty dcerpc_auth structure, must not be NULL
-*
-* @return a NTSTATUS error code
-*/
-NTSTATUS dcerpc_pull_dcerpc_auth(TALLOC_CTX *mem_ctx,
-				 const DATA_BLOB *blob,
-				 struct dcerpc_auth *r,
-				 bool bigendian)
-{
-	enum ndr_err_code ndr_err;
-	struct ndr_pull *ndr;
-
-	ndr = ndr_pull_init_blob(blob, mem_ctx);
-	if (!ndr) {
-		return NT_STATUS_NO_MEMORY;
-	}
-	if (bigendian) {
-		ndr->flags |= LIBNDR_FLAG_BIGENDIAN;
-	}
-
-	ndr_err = ndr_pull_dcerpc_auth(ndr, NDR_SCALARS|NDR_BUFFERS, r);
-
-	if (!NDR_ERR_CODE_IS_SUCCESS(ndr_err)) {
-		talloc_free(ndr);
-		return ndr_map_error2ntstatus(ndr_err);
-	}
-	talloc_free(ndr);
-
-	if (DEBUGLEVEL >= 10) {
-		NDR_PRINT_DEBUG(dcerpc_auth, r);
-	}
-
-	return NT_STATUS_OK;
-}
-
-/**
 * @brief Calculate how much data we can in a packet, including calculating
 *	 auth token and pad lengths.
 *
@@ -782,7 +741,7 @@
 					 auth->auth_type,
 					 auth->auth_level,
 					 pad_len,
-					 1 /* context id. */,
+					 auth->auth_context_id,
 					 &auth_blob,
 					 &auth_info);
 	if (!NT_STATUS_IS_OK(status)) {
@@ -844,19 +803,18 @@
 *
 * @param auth		The auth data for the connection
 * @param pkt		The actual ncacn_packet
-* @param pkt_trailer	The stub_and_verifier part of the packet
+* @param pkt_trailer [in][out]	The stub_and_verifier part of the packet,
+* 			the auth_trailer and padding will be removed.
 * @param header_size	The header size
 * @param raw_pkt	The whole raw packet data blob
-* @param pad_len	[out] The padding length used in the packet
 *
 * @return A NTSTATUS error code
 */
 NTSTATUS dcerpc_check_auth(struct pipe_auth_data *auth,
 			   struct ncacn_packet *pkt,
 			   DATA_BLOB *pkt_trailer,
-			   size_t header_size,
-			   DATA_BLOB *raw_pkt,
-			   size_t *pad_len)
+			   uint8_t header_size,
+			   DATA_BLOB *raw_pkt)
 {
 	struct schannel_state *schannel_auth;
 	struct auth_ntlmssp_state *ntlmssp_ctx;
@@ -868,6 +826,14 @@
 	DATA_BLOB full_pkt;
 	DATA_BLOB data;
 
+	/*
+	 * These check should be done in the caller.
+	 */
+	SMB_ASSERT(raw_pkt->length == pkt->frag_length);
+	SMB_ASSERT(header_size <= pkt->frag_length);
+	SMB_ASSERT(pkt_trailer->length < pkt->frag_length);
+	SMB_ASSERT((pkt_trailer->length + header_size) <= pkt->frag_length);
+
 	switch (auth->auth_level) {
 	case DCERPC_AUTH_LEVEL_PRIVACY:
 		DEBUG(10, ("Requested Privacy.\n"));
@@ -881,7 +847,6 @@
 		if (pkt->auth_length != 0) {
 			break;
 		}
-		*pad_len = 0;
 		return NT_STATUS_OK;
 
 	case DCERPC_AUTH_LEVEL_NONE:
@@ -890,7 +855,6 @@
 				  "authenticated connection!\n"));
 			return NT_STATUS_INVALID_PARAMETER;
 		}
-		*pad_len = 0;
 		return NT_STATUS_OK;
 
 	default:
@@ -899,16 +863,8 @@
 		return NT_STATUS_INVALID_PARAMETER;
 	}
 
-	/* Paranioa checks for auth_length. */
-	if (pkt->auth_length > pkt->frag_length) {
-		return NT_STATUS_INFO_LENGTH_MISMATCH;
-	}
-	if (((unsigned int)pkt->auth_length
-	     + DCERPC_AUTH_TRAILER_LENGTH < (unsigned int)pkt->auth_length) ||
-	    ((unsigned int)pkt->auth_length
-	     + DCERPC_AUTH_TRAILER_LENGTH < DCERPC_AUTH_TRAILER_LENGTH)) {
-		/* Integer wrap attempt. */
-		return NT_STATUS_INFO_LENGTH_MISMATCH;
+	if (pkt->auth_length == 0) {
+		return NT_STATUS_INVALID_PARAMETER;
 	}
 
 	status = dcerpc_pull_auth_trailer(pkt, pkt, pkt_trailer,
@@ -917,10 +873,23 @@
 		return status;
 	}
 
+	if (auth_info.auth_type != auth->auth_type) {
+		return NT_STATUS_INVALID_PARAMETER;
+	}
+
+	if (auth_info.auth_level != auth->auth_level) {
+		return NT_STATUS_INVALID_PARAMETER;
+	}
+
+	if (auth_info.auth_context_id != auth->auth_context_id) {
+		return NT_STATUS_INVALID_PARAMETER;
+	}
+
+	pkt_trailer->length -= auth_length;
 	data = data_blob_const(raw_pkt->data + header_size,
-				pkt_trailer->length - auth_length);
-	full_pkt = data_blob_const(raw_pkt->data,
-				raw_pkt->length - auth_info.credentials.length);
+			       pkt_trailer->length);
+	full_pkt = data_blob_const(raw_pkt->data, raw_pkt->length);
+	full_pkt.length -= auth_info.credentials.length;
 
 	switch (auth->auth_type) {
 	case DCERPC_AUTH_TYPE_NONE:
@@ -996,10 +965,13 @@
 	 * pkt_trailer actually has a copy of the raw data, and they
 	 * are still both used in later calls */
 	if (auth->auth_level == DCERPC_AUTH_LEVEL_PRIVACY) {
+		if (pkt_trailer->length != data.length) {
+			return NT_STATUS_INVALID_PARAMETER;
+		}
 		memcpy(pkt_trailer->data, data.data, data.length);
 	}
 
-	*pad_len = auth_info.auth_pad_length;
+	pkt_trailer->length -= auth_info.auth_pad_length;
 	data_blob_free(&auth_info.credentials);
 	return NT_STATUS_OK;
 }
diff -daurN samba3/source3/librpc/rpc/rpc_common.c samba3/source3/librpc/rpc/rpc_common.c
--- samba3/source3/librpc/rpc/rpc_common.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/librpc/rpc/rpc_common.c	2024-08-04 17:52:53.000000000 +0200
@@ -92,39 +92,56 @@
 
 static bool initialize_interfaces(void)
 {
+#ifdef LSA_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_lsarpc)) {
 		return false;
 	}
+#endif
+#ifdef ACTIVE_DIRECTORY
 	if (!smb_register_ndr_interface(&ndr_table_dssetup)) {
 		return false;
 	}
+#endif
+#ifdef SAMR_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_samr)) {
 		return false;
 	}
+#endif
+#ifdef NETLOGON_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_netlogon)) {
 		return false;
 	}
+#endif
 	if (!smb_register_ndr_interface(&ndr_table_srvsvc)) {
 		return false;
 	}
 	if (!smb_register_ndr_interface(&ndr_table_wkssvc)) {
 		return false;
 	}
+#ifdef WINREG_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_winreg)) {
 		return false;
 	}
+#endif
+#ifdef PRINTER_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_spoolss)) {
 		return false;
 	}
+#endif
+#ifdef DFS_SUPPORT
 	if (!smb_register_ndr_interface(&ndr_table_netdfs)) {
 		return false;
 	}
+#endif
+#ifdef DEVELOPER
 	if (!smb_register_ndr_interface(&ndr_table_rpcecho)) {
 		return false;
 	}
+#endif
 	if (!smb_register_ndr_interface(&ndr_table_initshutdown)) {
 		return false;
 	}
+#ifdef EXTRA_SERVICES
 	if (!smb_register_ndr_interface(&ndr_table_svcctl)) {
 		return false;
 	}
@@ -134,12 +151,15 @@
 	if (!smb_register_ndr_interface(&ndr_table_ntsvcs)) {
 		return false;
 	}
+#endif
 	if (!smb_register_ndr_interface(&ndr_table_epmapper)) {
 		return false;
 	}
+#ifdef ACTIVE_DIRECTORY
 	if (!smb_register_ndr_interface(&ndr_table_drsuapi)) {
 		return false;
 	}
+#endif
 	return true;
 }
 
diff -daurN samba3/source3/libsmb/cliconnect.c samba3/source3/libsmb/cliconnect.c
--- samba3/source3/libsmb/cliconnect.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/libsmb/cliconnect.c	2024-08-04 17:52:53.000000000 +0200
@@ -2077,6 +2077,17 @@
 		NTSTATUS status;
 
 		/* otherwise do a NT1 style session setup */
+		if (lp_client_ntlmv2_auth() && lp_client_use_spnego()) {
+			/*
+			 * Don't send an NTLMv2 response without NTLMSSP
+			 * if we want to use spnego support
+			 */
+			DEBUG(1, ("Server does not support EXTENDED_SECURITY "
+				  " but 'client use spnego = yes"
+				  " and 'client ntlmv2 auth = yes'\n"));
+			return NT_STATUS_ACCESS_DENIED;
+		}
+
 		status = cli_session_setup_nt1(cli, user, pass, passlen,
 					       ntpass, ntpasslen, workgroup);
 		if (!NT_STATUS_IS_OK(status)) {
diff -daurN samba3/source3/libsmb/clidfs.c samba3/source3/libsmb/clidfs.c
--- samba3/source3/libsmb/clidfs.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/libsmb/clidfs.c	2024-08-04 17:52:53.000000000 +0200
@@ -197,7 +202,9 @@
 		/* If a password was not supplied then
 		 * try again with a null username. */
 		if (password[0] || !username[0] ||
+			force_encrypt ||
 			get_cmdline_auth_info_use_kerberos(auth_info) ||
+			get_cmdline_auth_info_use_ccache(auth_info) ||
 			!NT_STATUS_IS_OK(cli_session_setup(c, "",
 				    		"", 0,
 						"", 0,
diff -daurN samba3/source3/libsmb/ntlmssp.c samba3/source3/libsmb/ntlmssp.c
--- samba3/source3/libsmb/ntlmssp.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/libsmb/ntlmssp.c	2024-08-04 17:52:53.000000000 +0200
@@ -162,6 +162,36 @@
 	return NT_STATUS_OK;
 }
 
+bool ntlmssp_have_feature(struct ntlmssp_state *ntlmssp_state,
+			  uint32_t feature)
+{
+	if (feature & NTLMSSP_FEATURE_SIGN) {
+		if (ntlmssp_state->session_key.length == 0) {
+			return false;
+		}
+		if (ntlmssp_state->neg_flags & NTLMSSP_NEGOTIATE_SIGN) {
+			return true;
+		}
+	}
+
+	if (feature & NTLMSSP_FEATURE_SEAL) {
+		if (ntlmssp_state->session_key.length == 0) {
+			return false;
+		}
+		if (ntlmssp_state->neg_flags & NTLMSSP_NEGOTIATE_SEAL) {
+			return true;
+		}
+	}
+
+	if (feature & NTLMSSP_FEATURE_SESSION_KEY) {
+		if (ntlmssp_state->session_key.length > 0) {
+			return true;
+		}
+	}
+
+	return false;
+}
+
 /**
  * Request features for the NTLMSSP negotiation
  *
@@ -176,17 +206,19 @@
 	 * also add  NTLMSSP_NEGOTIATE_SEAL here. JRA.
 	 */
 	if (in_list("NTLMSSP_FEATURE_SESSION_KEY", feature_list, True)) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SIGN;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SIGN;
 	}
 	if (in_list("NTLMSSP_FEATURE_SIGN", feature_list, True)) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SIGN;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SIGN;
 	}
 	if(in_list("NTLMSSP_FEATURE_SEAL", feature_list, True)) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SEAL;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SEAL;
 	}
 	if (in_list("NTLMSSP_FEATURE_CCACHE", feature_list, true)) {
 		ntlmssp_state->use_ccache = true;
 	}
+
+	ntlmssp_state->neg_flags |= ntlmssp_state->required_flags;
 }
 
 /**
@@ -199,17 +231,20 @@
 {
 	/* As per JRA's comment above */
 	if (feature & NTLMSSP_FEATURE_SESSION_KEY) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SIGN;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SIGN;
 	}
 	if (feature & NTLMSSP_FEATURE_SIGN) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SIGN;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SIGN;
 	}
 	if (feature & NTLMSSP_FEATURE_SEAL) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_SEAL;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SIGN;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_SEAL;
 	}
 	if (feature & NTLMSSP_FEATURE_CCACHE) {
 		ntlmssp_state->use_ccache = true;
 	}
+
+	ntlmssp_state->neg_flags |= ntlmssp_state->required_flags;
 }
 
 /**
@@ -387,7 +422,12 @@
 	}
 
 	if (ntlmssp_state->use_ntlmv2) {
-		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_NTLM2;
+		ntlmssp_state->required_flags |= NTLMSSP_NEGOTIATE_NTLM2;
+		ntlmssp_state->allow_lm_key = false;
+	}
+
+	if (ntlmssp_state->allow_lm_key) {
+		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_LM_KEY;
 	}
 
 	/* generate the ntlmssp negotiate packet */
@@ -422,6 +462,86 @@
 	return NT_STATUS_MORE_PROCESSING_REQUIRED;
 }
 
+static NTSTATUS ntlmssp3_handle_neg_flags(struct ntlmssp_state *ntlmssp_state,
+					  uint32_t flags)
+{
+	uint32_t missing_flags = ntlmssp_state->required_flags;
+
+	if (flags & NTLMSSP_NEGOTIATE_UNICODE) {
+		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_UNICODE;
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_OEM;
+		ntlmssp_state->unicode = true;
+	} else {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_UNICODE;
+		ntlmssp_state->neg_flags |= NTLMSSP_NEGOTIATE_OEM;
+		ntlmssp_state->unicode = false;
+	}
+
+	/*
+	 * NTLMSSP_NEGOTIATE_NTLM2 (NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY)
+	 * has priority over NTLMSSP_NEGOTIATE_LM_KEY
+	 */
+	if (!(flags & NTLMSSP_NEGOTIATE_NTLM2)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_NTLM2;
+	}
+
+	if (ntlmssp_state->neg_flags & NTLMSSP_NEGOTIATE_NTLM2) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_LM_KEY;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_LM_KEY)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_LM_KEY;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_ALWAYS_SIGN)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_ALWAYS_SIGN;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_128)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_128;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_56)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_56;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_KEY_EXCH)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_KEY_EXCH;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_SIGN)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_SIGN;
+	}
+
+	if (!(flags & NTLMSSP_NEGOTIATE_SEAL)) {
+		ntlmssp_state->neg_flags &= ~NTLMSSP_NEGOTIATE_SEAL;
+	}
+
+	if ((flags & NTLMSSP_REQUEST_TARGET)) {
+		ntlmssp_state->neg_flags |= NTLMSSP_REQUEST_TARGET;
+	}
+
+	missing_flags &= ~ntlmssp_state->neg_flags;
+	if (missing_flags != 0) {
+		NTSTATUS status = NT_STATUS_RPC_SEC_PKG_ERROR;
+		DEBUG(1, ("%s: Got challenge flags[0x%08x] "
+			  "- possible downgrade detected! "
+			  "missing_flags[0x%08x] - %s\n",
+			  __func__,
+			  (unsigned)flags,
+			  (unsigned)missing_flags,
+			  nt_errstr(status)));
+		debug_ntlmssp_flags(missing_flags);
+		DEBUGADD(4, ("neg_flags[0x%08x]\n",
+			     (unsigned)ntlmssp_state->neg_flags));
+		debug_ntlmssp_flags(ntlmssp_state->neg_flags);
+
+		return status;
+	}
+
+	return NT_STATUS_OK;
+}
+
 /**
  * Next state function for the Challenge Packet.  Generate an auth packet.
  *
@@ -448,6 +568,26 @@
 	DATA_BLOB encrypted_session_key = data_blob_null;
 	NTSTATUS nt_status = NT_STATUS_OK;
 
+	if (!msrpc_parse(ntlmssp_state, &reply, "CdBd",
+			 "NTLMSSP",
+			 &ntlmssp_command,
+			 &server_domain_blob,
+			 &chal_flags)) {
+		DEBUG(1, ("Failed to parse the NTLMSSP Challenge: (#1)\n"));
+		dump_data(2, reply.data, reply.length);
+
+		return NT_STATUS_INVALID_PARAMETER;
+	}
+	data_blob_free(&server_domain_blob);
+
+	DEBUG(3, ("Got challenge flags:\n"));
+	debug_ntlmssp_flags(chal_flags);
+
+	nt_status = ntlmssp3_handle_neg_flags(ntlmssp_state, chal_flags);
+	if (!NT_STATUS_IS_OK(nt_status)) {
+		return nt_status;
+	}
+
 	if (ntlmssp_state->use_ccache) {
 		struct wbcCredentialCacheParams params;
 		struct wbcCredentialCacheInfo *info = NULL;
@@ -498,17 +638,6 @@
 
 noccache:
 
-	if (!msrpc_parse(ntlmssp_state, &reply, "CdBd",
-			 "NTLMSSP",
-			 &ntlmssp_command,
-			 &server_domain_blob,
-			 &chal_flags)) {
-		DEBUG(1, ("Failed to parse the NTLMSSP Challenge: (#1)\n"));
-		dump_data(2, reply.data, reply.length);
-
-		return NT_STATUS_INVALID_PARAMETER;
-	}
-
 	if (DEBUGLEVEL >= 10) {
 		struct CHALLENGE_MESSAGE *challenge = talloc(
 			talloc_tos(), struct CHALLENGE_MESSAGE);
@@ -525,13 +654,6 @@
 		}
 	}
 
-	data_blob_free(&server_domain_blob);
-
-	DEBUG(3, ("Got challenge flags:\n"));
-	debug_ntlmssp_flags(chal_flags);
-
-	ntlmssp_handle_neg_flags(ntlmssp_state, chal_flags, lp_client_lanman_auth());
-
 	if (ntlmssp_state->unicode) {
 		if (chal_flags & NTLMSSP_NEGOTIATE_TARGET_INFO) {
 			chal_parse_string = "CdUdbddB";
@@ -769,6 +891,7 @@
 	ntlmssp_state->unicode = True;
 
 	ntlmssp_state->use_ntlmv2 = use_ntlmv2;
+	ntlmssp_state->allow_lm_key = lp_client_lanman_auth();
 
 	ntlmssp_state->expected_state = NTLMSSP_INITIAL;
 
@@ -780,6 +903,10 @@
 		NTLMSSP_NEGOTIATE_KEY_EXCH |
 		NTLMSSP_REQUEST_TARGET;
 
+	if (ntlmssp_state->use_ntlmv2) {
+		ntlmssp_state->allow_lm_key = false;
+	}
+
 	ntlmssp_state->client.netbios_name = talloc_strdup(ntlmssp_state, netbios_name);
 	if (!ntlmssp_state->client.netbios_name) {
 		talloc_free(ntlmssp_state);
diff -daurN samba3/source3/libsmb/trusts_util.c samba3/source3/libsmb/trusts_util.c
--- samba3/source3/libsmb/trusts_util.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/libsmb/trusts_util.c	2024-08-04 17:52:53.000000000 +0200
@@ -46,9 +46,11 @@
 	NTSTATUS nt_status;
 
 	switch (sec_channel_type) {
+#ifdef NETLOGON_SUPPORT
 	case SEC_CHAN_WKSTA:
 	case SEC_CHAN_DOMAIN:
 		break;
+#endif
 	default:
 		return NT_STATUS_NOT_SUPPORTED;
 	}
@@ -159,6 +161,11 @@
 	*num_domains = 0;
 	*sids = NULL;
 
+#ifndef NETLOGON_SUPPORT
+	return False;
+#endif
+
+
 	/* lookup a DC first */
 
 	if ( !get_dc_name(domain, NULL, dc_name, &dc_ss) ) {
@@ -243,6 +250,10 @@
 	struct cli_state *cli = NULL;
 	struct rpc_pipe_client *netlogon_pipe = NULL;
 
+#ifndef NETLOGON_SUPPORT
+	return NT_STATUS_UNSUCCESSFUL;
+#endif
+
 	DEBUG(5,("change_trust_account_password: Attempting to change trust account password in domain %s....\n",
 		domain));
 
diff -daurN samba3/source3/locale/net/de.po samba3/source3/locale/net/de.po
--- samba3/source3/locale/net/de.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/net/de.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,8852 +0,0 @@
-# net message translation (german).
-# Copyright (C) 2009, 2010 Kai Blin  <kai@samba.org>
-# Copyright (C) 2009, 2010 Andr Hentschel  <nerv@dawncrow.de>
-# This file is distributed under the same license as the samba package.
-#
-msgid ""
-msgstr ""
-"Project-Id-Version: @PACKAGE@\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-01-19 14:40+0100\n"
-"PO-Revision-Date: 2010-01-14 18:55+0100\n"
-"Last-Translator: Andr Hentschel <nerv@dawncrow.de>\n"
-"Language-Team: \n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../utils/net.c:103
-msgid "Enter machine password: "
-msgstr "Bitte Maschinenpasswort eingeben: "
-
-#: ../../utils/net.c:107
-msgid "Unable to write the machine account password in the secrets database"
-msgstr ""
-
-#: ../../utils/net.c:111
-msgid "Modified trust account password in secrets database\n"
-msgstr ""
-
-#: ../../utils/net.c:115
-msgid ""
-"Machine account password change requires the -f flag.\n"
-"Do NOT use this function unless you know what it does!\n"
-"This function will change the ADS Domain member machine account password in the secrets.tdb file!\n"
-msgstr ""
-
-#: ../../utils/net.c:132
-msgid "Failed to open secrets.tdb.\n"
-msgstr ""
-
-#: ../../utils/net.c:139 ../../utils/net.c:157 ../../utils/net_ads.c:1435 ../../utils/net_ads.c:1487 ../../utils/net_conf.c:1156 ../../utils/net_groupmap.c:195 ../../utils/net_groupmap.c:271 ../../utils/net_groupmap.c:355 ../../utils/net_groupmap.c:411
-#: ../../utils/net_groupmap.c:494 ../../utils/net_groupmap.c:521 ../../utils/net_help.c:36 ../../utils/net_rap.c:161 ../../utils/net_rap.c:302 ../../utils/net_rap.c:467 ../../utils/net_rap.c:752 ../../utils/net_rap.c:893 ../../utils/net_rap.c:1004
-#: ../../utils/net_rap.c:1195 ../../utils/net_rpc.c:2730 ../../utils/net_rpc.c:2845 ../../utils/net_rpc.c:4961 ../../utils/net_rpc.c:6953 ../../utils/net_rpc.c:7043 ../../utils/net_rpc.c:7148 ../../utils/net_util.c:586
-msgid "Usage:\n"
-msgstr "Verwendung:\n"
-
-#: ../../utils/net.c:141
-#, c-format
-msgid ""
-"    net setauthuser -U user[%%password] \n"
-"        Set the auth user account to userpassword. Prompt for password if not specified.\n"
-msgstr ""
-
-#: ../../utils/net.c:146 ../../utils/net.c:164
-msgid ""
-"    net setauthuser delete\n"
-"        Delete the auth user setting.\n"
-msgstr ""
-
-#: ../../utils/net.c:159
-#, c-format
-msgid ""
-"    net setauthuser -U user[%%password]\n"
-"        Set the auth user account to userpassword. Prompt for password if not specified.\n"
-msgstr ""
-
-#: ../../utils/net.c:169
-msgid "the auth user"
-msgstr ""
-
-#: ../../utils/net.c:171
-msgid "Failed to get the auth users password.\n"
-msgstr ""
-
-#: ../../utils/net.c:177
-msgid "error storing auth user name\n"
-msgstr ""
-
-#: ../../utils/net.c:183
-msgid "error storing auth user domain\n"
-msgstr ""
-
-#: ../../utils/net.c:189
-msgid "error storing auth user password\n"
-msgstr ""
-
-#: ../../utils/net.c:213
-msgid "No authorised user configured\n"
-msgstr ""
-
-#: ../../utils/net.c:255 ../../utils/net.c:336
-#, c-format
-msgid "Unable to open secrets.tdb.  Can't fetch domain SID for name: %s\n"
-msgstr ""
-
-#: ../../utils/net.c:268 ../../utils/net.c:359
-#, c-format
-msgid "SID for domain %s is: %s\n"
-msgstr "SID der Domne %s ist: %s\n"
-
-# c-format
-#: ../../utils/net.c:280 ../../utils/net.c:301 ../../utils/net.c:320 ../../utils/net.c:405 ../../utils/net_ads.c:134 ../../utils/net_ads.c:166 ../../utils/net_ads.c:382 ../../utils/net_ads.c:709 ../../utils/net_ads.c:862 ../../utils/net_ads.c:898
-#: ../../utils/net_ads.c:942 ../../utils/net_ads.c:1057 ../../utils/net_ads.c:1560 ../../utils/net_ads.c:1600 ../../utils/net_ads.c:1665 ../../utils/net_ads.c:1792 ../../utils/net_ads.c:1896 ../../utils/net_ads.c:1982 ../../utils/net_ads.c:2225
-#: ../../utils/net_ads.c:2246 ../../utils/net_ads.c:2274 ../../utils/net_ads.c:2293 ../../utils/net_ads.c:2362 ../../utils/net_ads.c:2388 ../../utils/net_ads.c:2445 ../../utils/net_ads_gpo.c:41 ../../utils/net_ads_gpo.c:230 ../../utils/net_ads_gpo.c:304
-#: ../../utils/net_ads_gpo.c:456 ../../utils/net_ads_gpo.c:498 ../../utils/net_ads_gpo.c:586 ../../utils/net_afs.c:38 ../../utils/net_afs.c:71 ../../utils/net_cache.c:159 ../../utils/net_cache.c:198 ../../utils/net_cache.c:228 ../../utils/net_cache.c:257
-#: ../../utils/net_cache.c:283 ../../utils/net_cache.c:306 ../../utils/net_cache.c:321 ../../utils/net_conf.c:42 ../../utils/net_conf.c:50 ../../utils/net_conf.c:63 ../../utils/net_conf.c:70 ../../utils/net_conf.c:78 ../../utils/net_conf.c:87
-#: ../../utils/net_conf.c:104 ../../utils/net_conf.c:113 ../../utils/net_conf.c:122 ../../utils/net_conf.c:131 ../../utils/net_conf.c:140 ../../utils/net_conf.c:149 ../../utils/net_conf.c:158 ../../utils/net_dom.c:27 ../../utils/net_dom.c:32
-#: ../../utils/net_dom.c:37 ../../utils/net_eventlog.c:47 ../../utils/net_eventlog.c:104 ../../utils/net_eventlog.c:200 ../../utils/net_groupmap.c:119 ../../utils/net_groupmap.c:557 ../../utils/net_groupmap.c:677 ../../utils/net_groupmap.c:715
-#: ../../utils/net_groupmap.c:738 ../../utils/net_groupmap.c:762 ../../utils/net_groupmap.c:822 ../../utils/net_idmap.c:65 ../../utils/net_idmap.c:97 ../../utils/net_idmap.c:244 ../../utils/net_idmap.c:344 ../../utils/net_lookup.c:327
-#: ../../utils/net_lookup.c:351 ../../utils/net_lookup.c:384 ../../utils/net_rap.c:507 ../../utils/net_rap.c:537 ../../utils/net_registry.c:134 ../../utils/net_registry.c:189 ../../utils/net_registry.c:246 ../../utils/net_registry.c:291
-#: ../../utils/net_registry.c:341 ../../utils/net_registry.c:398 ../../utils/net_registry.c:443 ../../utils/net_rpc.c:280 ../../utils/net_rpc.c:413 ../../utils/net_rpc.c:443 ../../utils/net_rpc.c:561 ../../utils/net_rpc.c:629 ../../utils/net_rpc.c:999
-#: ../../utils/net_rpc.c:1049 ../../utils/net_rpc.c:1131 ../../utils/net_rpc.c:1186 ../../utils/net_rpc.c:1933 ../../utils/net_rpc.c:2136 ../../utils/net_rpc.c:2221 ../../utils/net_rpc.c:3072 ../../utils/net_rpc.c:3258 ../../utils/net_rpc.c:3593
-#: ../../utils/net_rpc.c:3720 ../../utils/net_rpc.c:3755 ../../utils/net_rpc.c:4560 ../../utils/net_rpc.c:4686 ../../utils/net_rpc.c:4750 ../../utils/net_rpc.c:4768 ../../utils/net_rpc.c:5071 ../../utils/net_rpc.c:5220 ../../utils/net_rpc.c:5279
-#: ../../utils/net_rpc.c:5394 ../../utils/net_rpc.c:5436 ../../utils/net_rpc.c:5554 ../../utils/net_rpc.c:5638 ../../utils/net_rpc.c:5803 ../../utils/net_rpc.c:5937 ../../utils/net_rpc.c:6096 ../../utils/net_rpc.c:6471 ../../utils/net_rpc.c:6520
-#: ../../utils/net_rpc.c:6558 ../../utils/net_rpc.c:6614 ../../utils/net_rpc.c:6646 ../../utils/net_rpc.c:6678 ../../utils/net_rpc.c:6710 ../../utils/net_rpc.c:6742 ../../utils/net_rpc.c:6846 ../../utils/net_rpc.c:6873 ../../utils/net_rpc.c:6900
-#: ../../utils/net_rpc.c:6926 ../../utils/net_rpc.c:6980 ../../utils/net_rpc_audit.c:370 ../../utils/net_rpc_audit.c:388 ../../utils/net_rpc_audit.c:406 ../../utils/net_rpc_audit.c:424 ../../utils/net_rpc_audit.c:442 ../../utils/net_rpc_registry.c:475
-#: ../../utils/net_rpc_registry.c:530 ../../utils/net_rpc_registry.c:646 ../../utils/net_rpc_registry.c:674 ../../utils/net_rpc_registry.c:748 ../../utils/net_rpc_registry.c:799 ../../utils/net_rpc_registry.c:831 ../../utils/net_rpc_registry.c:905
-#: ../../utils/net_rpc_registry.c:1094 ../../utils/net_rpc_registry.c:1140 ../../utils/net_rpc_registry.c:1213 ../../utils/net_rpc_rights.c:417 ../../utils/net_rpc_rights.c:455 ../../utils/net_rpc_rights.c:526 ../../utils/net_rpc_rights.c:583
-#: ../../utils/net_rpc_rights.c:601 ../../utils/net_rpc_rights.c:623 ../../utils/net_rpc_samsync.c:258 ../../utils/net_rpc_samsync.c:341 ../../utils/net_rpc_samsync.c:485 ../../utils/net_rpc_service.c:218 ../../utils/net_rpc_service.c:327
-#: ../../utils/net_rpc_service.c:459 ../../utils/net_rpc_service.c:505 ../../utils/net_rpc_service.c:551 ../../utils/net_rpc_service.c:597 ../../utils/net_rpc_service.c:677 ../../utils/net_rpc_service.c:756 ../../utils/net_rpc_service.c:827
-#: ../../utils/net_rpc_service.c:845 ../../utils/net_rpc_service.c:863 ../../utils/net_rpc_service.c:881 ../../utils/net_rpc_service.c:899 ../../utils/net_rpc_service.c:917 ../../utils/net_rpc_service.c:935 ../../utils/net_rpc_service.c:953
-#: ../../utils/net_rpc_sh_acct.c:158 ../../utils/net_rpc_sh_acct.c:229 ../../utils/net_rpc_shell.c:217 ../../utils/net_sam.c:40 ../../utils/net_sam.c:146 ../../utils/net_sam.c:239 ../../utils/net_sam.c:303 ../../utils/net_sam.c:468
-#: ../../utils/net_sam.c:535 ../../utils/net_sam.c:583 ../../utils/net_sam.c:642 ../../utils/net_sam.c:699 ../../utils/net_sam.c:738 ../../utils/net_sam.c:866 ../../utils/net_sam.c:930 ../../utils/net_sam.c:967 ../../utils/net_sam.c:1000
-#: ../../utils/net_sam.c:1043 ../../utils/net_sam.c:1080 ../../utils/net_sam.c:1124 ../../utils/net_sam.c:1178 ../../utils/net_sam.c:1267 ../../utils/net_sam.c:1341 ../../utils/net_sam.c:1416 ../../utils/net_sam.c:1551 ../../utils/net_sam.c:1593
-#: ../../utils/net_status.c:69 ../../utils/net_status.c:221 ../../utils/net_time.c:139 ../../utils/net_time.c:165 ../../utils/net_time.c:227
-#, c-format
-msgid "Usage:"
-msgstr "Verwendung:"
-
-#: ../../utils/net.c:346
-msgid "Could not fetch local SID\n"
-msgstr "Lokale SID nicht abrufbar\n"
-
-#: ../../utils/net.c:350
-#, c-format
-msgid "SID for local machine %s is: %s\n"
-msgstr "SID des lokalen Rechners %s ist: %s\n"
-
-#: ../../utils/net.c:354
-msgid "Could not fetch domain SID\n"
-msgstr "SID der Domne nicht abrufbar\n"
-
-#: ../../utils/net.c:371
-#, c-format
-msgid "get_maxrid: Could not search %s\n"
-msgstr "get_maxrid: Konnte %s nicht suchen\n"
-
-#: ../../utils/net.c:410
-msgid "can't get current maximum rid\n"
-msgstr ""
-
-#: ../../utils/net.c:414
-#, c-format
-msgid "Currently used maximum rid: %d\n"
-msgstr ""
-
-#: ../../utils/net.c:425
-msgid "Run functions using RPC transport"
-msgstr "RPC Protokoll nutzen"
-
-#: ../../utils/net.c:426
-msgid "  Use 'net help rpc' to get more extensive information about 'net rpc' commands."
-msgstr ""
-
-#: ../../utils/net.c:433
-msgid "Run functions using RAP transport"
-msgstr "RAP Protokoll nutzen"
-
-#: ../../utils/net.c:434
-msgid "  Use 'net help rap' to get more extensive information about 'net rap' commands."
-msgstr ""
-
-#: ../../utils/net.c:441
-msgid "Run functions using ADS transport"
-msgstr "ADS Protokoll nutzen"
-
-#: ../../utils/net.c:442
-msgid "  Use 'net help ads' to get more extensive information about 'net ads' commands."
-msgstr ""
-
-#: ../../utils/net.c:451
-msgid "Functions on remote opened files"
-msgstr "Freigegebene Dateien verwalten"
-
-#: ../../utils/net.c:452
-msgid "  Use 'net help file' to get more information about 'net file' commands."
-msgstr ""
-
-#: ../../utils/net.c:459
-msgid "Functions on shares"
-msgstr "Freigaben verwalten"
-
-#: ../../utils/net.c:460
-msgid "  Use 'net help share' to get more information about 'net share' commands."
-msgstr ""
-
-#: ../../utils/net.c:467
-msgid "Manage sessions"
-msgstr "Sitzungen verwalten"
-
-#: ../../utils/net.c:468
-msgid "  Use 'net help session' to get more information about 'net session' commands."
-msgstr ""
-
-#: ../../utils/net.c:475 ../../utils/net_rap.c:1293
-msgid "List servers in workgroup"
-msgstr "Server der Arbeitsgruppe auflisten"
-
-#: ../../utils/net.c:476
-msgid "  Use 'net help server' to get more information about 'net server' commands."
-msgstr ""
-
-#: ../../utils/net.c:483
-msgid "List domains/workgroups on network"
-msgstr "Domnen/Arbeitsgruppen im Netzwerk auflisten"
-
-#: ../../utils/net.c:484
-msgid "  Use 'net help domain' to get more information about 'net domain' commands."
-msgstr ""
-
-#: ../../utils/net.c:491
-msgid "Modify printer queue"
-msgstr "Druckerwarteschlange ndern"
-
-#: ../../utils/net.c:492
-msgid "  Use 'net help printq' to get more information about 'net printq' commands."
-msgstr ""
-
-#: ../../utils/net.c:499
-msgid "Manage users"
-msgstr "Benutzer verwalten"
-
-#: ../../utils/net.c:500
-msgid "  Use 'net help user' to get more information about 'net user' commands."
-msgstr ""
-
-#: ../../utils/net.c:507
-msgid "Manage groups"
-msgstr "Gruppen verwalten"
-
-#: ../../utils/net.c:508
-msgid "  Use 'net help group' to get more information about 'net group' commands."
-msgstr ""
-
-#: ../../utils/net.c:515
-msgid "Manage group mappings"
-msgstr "Gruppenzuweisungen verwalten"
-
-#: ../../utils/net.c:516
-msgid "  Use 'net help groupmap' to get more information about 'net groupmap' commands."
-msgstr ""
-
-#: ../../utils/net.c:523
-msgid "Functions on the SAM database"
-msgstr "SAM Datenbank nutzen"
-
-#: ../../utils/net.c:524
-msgid "  Use 'net help sam' to get more information about 'net sam' commands."
-msgstr ""
-
-#: ../../utils/net.c:531
-msgid "Validate username and password"
-msgstr "Benutzername und Passwort prfen"
-
-#: ../../utils/net.c:532
-msgid "  Use 'net help validate' to get more information about 'net validate' commands."
-msgstr ""
-
-#: ../../utils/net.c:539
-msgid "Modify group memberships"
-msgstr "Gruppenzugehrigkeiten verwalten"
-
-#: ../../utils/net.c:540
-msgid "  Use 'net help groupmember' to get more information about 'net groupmember' commands."
-msgstr ""
-
-#: ../../utils/net.c:546
-msgid "Execute remote command on a remote OS/2 server"
-msgstr "Befehl auf einem entfernten OS/2 Server ausfhren"
-
-#: ../../utils/net.c:547
-msgid "  Use 'net help admin' to get more information about 'net admin' commands."
-msgstr ""
-
-#: ../../utils/net.c:553
-msgid "List/modify running services"
-msgstr "Zeige/ndere laufende Dienste"
-
-#: ../../utils/net.c:554
-msgid "  Use 'net help service' to get more information about 'net service' commands."
-msgstr ""
-
-#: ../../utils/net.c:561
-msgid "Change user password on target server"
-msgstr "Benutzerpasswort auf Zielserver ndern"
-
-#: ../../utils/net.c:562
-msgid "  Use 'net help password' to get more information about 'net password' commands."
-msgstr ""
-
-#: ../../utils/net.c:568
-msgid "Change the trust password"
-msgstr "Passwort von Vertrauenskonto ndern"
-
-#: ../../utils/net.c:569
-msgid "  Use 'net help changetrustpw' to get more information about 'net changetrustpw'."
-msgstr ""
-
-#: ../../utils/net.c:575
-msgid "Change the secret password"
-msgstr "Das geheime Passwort ndern"
-
-#: ../../utils/net.c:576
-msgid ""
-"  net [options] changesecretpw\n"
-"    Change the ADS domain member machine account password in secrets.tdb.\n"
-"    Do NOT use this function unless you know what it does.\n"
-"    Requires the -f flag to work."
-msgstr ""
-
-#: ../../utils/net.c:586
-msgid "Set the winbind auth user"
-msgstr "Winbind Authentfikationseinstellungen setzten"
-
-#: ../../utils/net.c:587
-#, c-format
-msgid ""
-"  net -U user[%%password] [-W domain] setauthuser\n"
-"    Set the auth user, password (and optionally domain\n"
-"    Will prompt for password if not given.\n"
-"  net setauthuser delete\n"
-"    Delete the existing auth user settings."
-msgstr ""
-
-#: ../../utils/net.c:597
-msgid "Get the winbind auth user settings"
-msgstr "Winbind Authentfikationseinstellungen lesen"
-
-#: ../../utils/net.c:598
-msgid ""
-"  net getauthuser\n"
-"    Get the current winbind auth user settings."
-msgstr ""
-
-#: ../../utils/net.c:604
-msgid "Show/set time"
-msgstr "Zeigt/Setzt die Systemzeit"
-
-#: ../../utils/net.c:605
-msgid "  Use 'net help time' to get more information about 'net time' commands."
-msgstr ""
-
-#: ../../utils/net.c:611
-msgid "Look up host names/IP addresses"
-msgstr "Hostname/IP-Adresse nachschlagen"
-
-#: ../../utils/net.c:612
-msgid "  Use 'net help lookup' to get more information about 'net lookup' commands."
-msgstr ""
-
-#: ../../utils/net.c:618
-msgid "Join a domain/AD"
-msgstr "Einer Domne/AD beitreten"
-
-#: ../../utils/net.c:619
-msgid "  Use 'net help join' to get more information about 'net join'."
-msgstr ""
-
-#: ../../utils/net.c:625
-msgid "Join/unjoin (remote) machines to/from a domain/AD"
-msgstr "Domne/AD betreten/verlassen"
-
-#: ../../utils/net.c:626
-msgid "  Use 'net help dom' to get more information about 'net dom' commands."
-msgstr ""
-
-#: ../../utils/net.c:632
-msgid "Operate on the cache tdb file"
-msgstr "Cache tdb Datei nutzen"
-
-#: ../../utils/net.c:633
-msgid "  Use 'net help cache' to get more information about 'net cache' commands."
-msgstr ""
-
-#: ../../utils/net.c:639
-msgid "Get the SID for the local domain"
-msgstr "SID der lokalen Domne anzeigen"
-
-#: ../../utils/net.c:640
-msgid "  net getlocalsid"
-msgstr ""
-
-#: ../../utils/net.c:645
-msgid "Set the SID for the local domain"
-msgstr "SID der lokalen Domne ndern"
-
-#: ../../utils/net.c:646
-msgid "  net setlocalsid S-1-5-21-x-y-z"
-msgstr ""
-
-#: ../../utils/net.c:651
-msgid "Set domain SID on member servers"
-msgstr "SID der Domne ndern (wenn zugehrig)"
-
-#: ../../utils/net.c:652
-msgid "  net setdomainsid S-1-5-21-x-y-z"
-msgstr ""
-
-#: ../../utils/net.c:657
-msgid "Get domain SID on member servers"
-msgstr "SID der Domne anzeigen (wenn zugehrig)"
-
-#: ../../utils/net.c:658
-msgid "  net getdomainsid"
-msgstr ""
-
-#: ../../utils/net.c:663
-msgid "Display the maximul RID currently used"
-msgstr "Die hchste verwendete RID anzeigen"
-
-#: ../../utils/net.c:664
-msgid "  net maxrid"
-msgstr ""
-
-#: ../../utils/net.c:669
-msgid "IDmap functions"
-msgstr "IDmap nutzen"
-
-#: ../../utils/net.c:670
-msgid "  Use 'net help idmap to get more information about 'net idmap' commands."
-msgstr ""
-
-#: ../../utils/net.c:676
-msgid "Display server status"
-msgstr "Zeigt den Server Status"
-
-#: ../../utils/net.c:677
-msgid "  Use 'net help status' to get more information about 'net status' commands."
-msgstr ""
-
-#: ../../utils/net.c:683
-msgid "Manage user-modifiable shares"
-msgstr "Benutzerfreigaben verwalten"
-
-#: ../../utils/net.c:684
-msgid "  Use 'net help usershare to get more information about 'net usershare' commands."
-msgstr ""
-
-#: ../../utils/net.c:690
-msgid "Display list of all users with SID"
-msgstr "Zeigt eine Liste aller SID-Benutzer"
-
-#: ../../utils/net.c:691
-msgid "  Use 'net help usersidlist' to get more information about 'net usersidlist'."
-msgstr ""
-
-#: ../../utils/net.c:697
-msgid "Manage Samba registry based configuration"
-msgstr "Konfiguration ndern"
-
-#: ../../utils/net.c:698
-msgid "  Use 'net help conf' to get more information about 'net conf' commands."
-msgstr ""
-
-#: ../../utils/net.c:704
-msgid "Manage the Samba registry"
-msgstr "Die Sambaregistrierung verwalten"
-
-#: ../../utils/net.c:705
-msgid "  Use 'net help registry' to get more information about 'net registry' commands."
-msgstr ""
-
-#: ../../utils/net.c:711
-msgid "Process Win32 *.evt eventlog files"
-msgstr "Arbeitet mit Win32 *.evt Eventlog Dateien"
-
-#: ../../utils/net.c:712
-msgid "  Use 'net help eventlog' to get more information about 'net eventlog' commands."
-msgstr ""
-
-#: ../../utils/net.c:720
-msgid "Manage AFS tokens"
-msgstr "AFS Tickets verwalten"
-
-#: ../../utils/net.c:721
-msgid "  Use 'net help afs' to get more information about 'net afs' commands."
-msgstr ""
-
-#: ../../utils/net.c:729
-msgid "Print usage information"
-msgstr "Zeigt die Hilfe an"
-
-#: ../../utils/net.c:730
-msgid "  Use 'net help help' to list usage information for 'net' commands."
-msgstr ""
-
-#: ../../utils/net.c:759
-msgid "Encrypt SMB transport (UNIX extended servers only)"
-msgstr "SMB bertragung verschlsseln (nur UNIX erweiterte Server)"
-
-#: ../../utils/net.c:827
-msgid ""
-"\n"
-"Invalid ip address specified\n"
-msgstr ""
-
-#: ../../utils/net.c:842
-#, c-format
-msgid ""
-"\n"
-"Invalid option %s: %s\n"
-msgstr ""
-"\n"
-"Ungltige Option %s: %s\n"
-
-#: ../../utils/net_ads.c:53 ../../utils/net_ads.c:399
-msgid "CLDAP query failed!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:57
-#, c-format
-msgid ""
-"Information for Domain Controller: %s\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:60
-msgid "Response Type: "
-msgstr ""
-
-#: ../../utils/net_ads.c:73
-#, c-format
-msgid "GUID: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:75
-#, c-format
-msgid ""
-"Flags:\n"
-"\tIs a PDC:                                   %s\n"
-"\tIs a GC of the forest:                      %s\n"
-"\tIs an LDAP server:                          %s\n"
-"\tSupports DS:                                %s\n"
-"\tIs running a KDC:                           %s\n"
-"\tIs running time services:                   %s\n"
-"\tIs the closest DC:                          %s\n"
-"\tIs writable:                                %s\n"
-"\tHas a hardware clock:                       %s\n"
-"\tIs a non-domain NC serviced by LDAP server: %s\n"
-"\tIs NT6 DC that has some secrets:            %s\n"
-"\tIs NT6 DC that has all secrets:             %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:88 ../../utils/net_ads.c:89 ../../utils/net_ads.c:90 ../../utils/net_ads.c:91 ../../utils/net_ads.c:92 ../../utils/net_ads.c:93 ../../utils/net_ads.c:94 ../../utils/net_ads.c:95 ../../utils/net_ads.c:96 ../../utils/net_ads.c:97
-#: ../../utils/net_ads.c:98 ../../utils/net_ads.c:99 ../../utils/net_rap.c:376 ../../utils/net_rpc_sh_acct.c:204 ../../utils/net_rpc_sh_acct.c:207
-msgid "yes"
-msgstr "Ja"
-
-#: ../../utils/net_ads.c:88 ../../utils/net_ads.c:89 ../../utils/net_ads.c:90 ../../utils/net_ads.c:91 ../../utils/net_ads.c:92 ../../utils/net_ads.c:93 ../../utils/net_ads.c:94 ../../utils/net_ads.c:95 ../../utils/net_ads.c:96 ../../utils/net_ads.c:97
-#: ../../utils/net_ads.c:98 ../../utils/net_ads.c:99 ../../utils/net_rap.c:376 ../../utils/net_rpc_sh_acct.c:204 ../../utils/net_rpc_sh_acct.c:207
-msgid "no"
-msgstr "Nein"
-
-#: ../../utils/net_ads.c:102
-#, c-format
-msgid "Forest:\t\t\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:103
-#, c-format
-msgid "Domain:\t\t\t%s\n"
-msgstr "Domne:\t\t\t%s\n"
-
-#: ../../utils/net_ads.c:104
-#, c-format
-msgid "Domain Controller:\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:106
-#, c-format
-msgid "Pre-Win2k Domain:\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:107
-#, c-format
-msgid "Pre-Win2k Hostname:\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:109
-#, c-format
-msgid "User name:\t%s\n"
-msgstr "Benutzername:\t%s\n"
-
-#: ../../utils/net_ads.c:111
-#, c-format
-msgid "Server Site Name :\t\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:112
-#, c-format
-msgid "Client Site Name :\t\t%s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:114
-#, c-format
-msgid "NT Version: %d\n"
-msgstr "NT Version: %d\n"
-
-#: ../../utils/net_ads.c:115
-#, c-format
-msgid "LMNT Token: %.2x\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:116
-#, c-format
-msgid "LM20 Token: %.2x\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:135
-msgid "Find the ADS DC using CLDAP lookup.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:140 ../../utils/net_ads.c:388
-msgid "Didn't find the cldap server!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:167
-msgid "Display information about an Active Directory server.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:173 ../../utils/net_ads.c:178
-msgid "Didn't find the ldap server!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:187
-msgid "Failed to get server's current time!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:192
-#, c-format
-msgid "LDAP server: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:193
-#, c-format
-msgid "LDAP server name: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:194
-#, c-format
-msgid "Realm: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:195
-#, c-format
-msgid "Bind Path: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:196
-#, c-format
-msgid "LDAP port: %d\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:197
-#, c-format
-msgid "Server time: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:200
-#, c-format
-msgid "KDC server: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:201
-#, c-format
-msgid "Server time offset: %d\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:383
-msgid "Print the workgroup name"
-msgstr ""
-
-#: ../../utils/net_ads.c:404
-#, c-format
-msgid "Workgroup: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:465
-#, c-format
-msgid "ads_user_add: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:470
-#, c-format
-msgid "ads_user_add: User %s already exists\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:484
-#, c-format
-msgid "Could not add user %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:491 ../../utils/net_ads.c:504
-#, c-format
-msgid "User %s added\n"
-msgstr ""
-
-#. password didn't set, delete account
-#: ../../utils/net_ads.c:510
-#, c-format
-msgid "Could not add user %s. Error setting password %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:558
-#, c-format
-msgid "ads_user_info: failed to escape user %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:576
-#, c-format
-msgid "ads_search: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:582
-msgid "ads_pull_uint32 failed\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:589
-#, c-format
-msgid "ads_domain_sid: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:649
-#, c-format
-msgid "User %s does not exist.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:659
-#, c-format
-msgid "User %s deleted\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:663
-#, c-format
-msgid "Error deleting user %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:676
-msgid "Add an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:677
-msgid ""
-"net ads user add\n"
-"    Add an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:684
-msgid "Display information about an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:685
-msgid ""
-"net ads user info\n"
-"    Display information about an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:692
-msgid "Delete an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:693
-msgid ""
-"net ads user delete\n"
-"    Delete an AD user"
-msgstr ""
-
-#: ../../utils/net_ads.c:710
-msgid "List AD users"
-msgstr "AD Benutzer auflisten"
-
-#: ../../utils/net_ads.c:720 ../../utils/net_rap.c:903 ../../utils/net_rpc.c:888
-msgid ""
-"\n"
-"User name             Comment\n"
-"-----------------------------\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:760
-#, c-format
-msgid "ads_group_add: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:765
-#, c-format
-msgid "ads_group_add: Group %s already exists\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:778
-#, c-format
-msgid "Group %s added\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:781
-#, c-format
-msgid "Could not add group %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:810
-#, c-format
-msgid "Group %s does not exist.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:820
-#, c-format
-msgid "Group %s deleted\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:824
-#, c-format
-msgid "Error deleting group %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:837
-msgid "Add an AD group"
-msgstr "AD Gruppe hinzufgen"
-
-#: ../../utils/net_ads.c:838
-msgid ""
-"net ads group add\n"
-"    Add an AD group"
-msgstr ""
-"net ads group add\n"
-"    AD Gruppe hinzufgen"
-
-#: ../../utils/net_ads.c:845
-msgid "Delete an AD group"
-msgstr "AD Gruppe entfernen"
-
-#: ../../utils/net_ads.c:846
-msgid ""
-"net ads group delete\n"
-"    Delete an AD group"
-msgstr ""
-"net ads group delete\n"
-"    AD Gruppe entfernen"
-
-#: ../../utils/net_ads.c:863
-msgid "List AD groups"
-msgstr "AD Gruppen auflisten"
-
-#: ../../utils/net_ads.c:873 ../../utils/net_rpc.c:2273
-msgid ""
-"\n"
-"Group name            Comment\n"
-"-----------------------------\n"
-msgstr ""
-"\n"
-"Gruppenname         Kommentar\n"
-"-----------------------------\n"
-
-#: ../../utils/net_ads.c:899 ../../utils/net_ads.c:2548
-msgid "Display machine account details"
-msgstr ""
-
-#: ../../utils/net_ads.c:909
-#, c-format
-msgid "ads_find_machine_acct: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:915
-#, c-format
-msgid "No machine account for '%s' found\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:943
-msgid "Leave an AD domain"
-msgstr ""
-
-#: ../../utils/net_ads.c:948
-msgid "No realm set, are we joined ?\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:953 ../../utils/net_ads.c:1281
-msgid "Could not initialise talloc context.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:963
-msgid "Could not initialise unjoin context.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:983
-#, c-format
-msgid "Failed to leave domain: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:990
-#, c-format
-msgid "Deleted account for '%s' in realm '%s'\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:997
-#, c-format
-msgid "Disabled account for '%s' in realm '%s'\n"
-msgstr ""
-
-#. Based on what we requseted, we shouldn't get here, but if
-#. we did, it means the secrets were removed, and therefore
-#. we have left the domain
-#: ../../utils/net_ads.c:1006
-#, c-format
-msgid "Machine '%s' Left domain '%s'\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1058
-msgid "Test if the existing join is ok"
-msgstr ""
-
-#: ../../utils/net_ads.c:1065
-#, c-format
-msgid "Join to domain is not valid: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1070
-#, c-format
-msgid "Join is OK\n"
-msgstr "Mitgliedschaft ist OK\n"
-
-#: ../../utils/net_ads.c:1081
-msgid "Host is not configured as a member server.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1086 ../../utils/net_rpc.c:462
-#, c-format
-msgid "Our netbios name can be at most 15 chars long, \"%s\" is %u chars long\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1093
-#, c-format
-msgid "realm must be set in in %s for ADS join to succeed.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1126
-#, c-format
-msgid "No DNS domain configured for %s. Unable to perform DNS Update.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1233
-msgid ""
-"net ads join [options]\n"
-"Valid options:\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1235
-msgid ""
-"   createupn[=UPN]    Set the userPrincipalName attribute during the join.\n"
-"                      The deault UPN is in the form host/netbiosname@REALM.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1237
-msgid ""
-"   createcomputer=OU  Precreate the computer account in a specific OU.\n"
-"                      The OU string read from top to bottom without RDNs and delimited by a '/'.\n"
-"                      E.g. \"createcomputer=Computers/Servers/Unix\"\n"
-"                      NB: A backslash '\\' is used as escape at multiple levels and may\n"
-"                          need to be doubled or even quadrupled.  It is not used as a separator.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1242
-msgid "   osName=string      Set the operatingSystem attribute during the join.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1243
-msgid ""
-"   osVer=string       Set the operatingSystemVersion attribute during the join.\n"
-"                      NB: osName and osVer must be specified together for either to take effect.\n"
-"                          Also, the operatingSystemService attribute is also set when along with\n"
-"                          the two other attributes.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1275
-msgid "Invalid configuration.  Exiting....\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1304
-msgid "Please supply a valid OU path.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1311
-msgid "Please supply a operating system name.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1318
-msgid "Please supply a valid operating system version.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1329
-msgid "Please supply a valid domain name\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1360
-#, c-format
-msgid ""
-"The workgroup in %s does not match the short\n"
-"domain name obtained from the server.\n"
-"Using the name [%s] from the server.\n"
-"You should set \"workgroup = %s\" in %s.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1368
-#, c-format
-msgid "Using short domain name -- %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1371
-#, c-format
-msgid "Joined '%s' to realm '%s'\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1374
-#, c-format
-msgid "Joined '%s' to domain '%s'\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1398 ../../utils/net_ads.c:1454
-msgid "DNS update failed!\n"
-msgstr ""
-
-#. issue an overall failure message at the end.
-#: ../../utils/net_ads.c:1412 ../../utils/net_dom.c:205
-#, c-format
-msgid "Failed to join domain: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1437
-msgid "Register hostname with DNS\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1442
-msgid "Could not initialise talloc context\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1460
-msgid "Successfully registered hostname with DNS\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1468
-msgid "DNS update support not enabled at compile time!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1488
-msgid "net ads dns gethostbyname <server> <name>\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1489
-msgid ""
-"  Look up hostname from the AD\n"
-"    server\tName server to use\n"
-"    name\tName to look up\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1497
-#, c-format
-msgid "do_gethostbyname returned %d\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1509
-msgid "Add host dns entry to AD"
-msgstr ""
-
-#: ../../utils/net_ads.c:1510
-msgid ""
-"net ads dns register\n"
-"    Add host dns entry to AD"
-msgstr ""
-
-#: ../../utils/net_ads.c:1517
-msgid "Look up host"
-msgstr ""
-
-#: ../../utils/net_ads.c:1518
-msgid ""
-"net ads dns gethostbyname\n"
-"    Look up host"
-msgstr ""
-
-#: ../../utils/net_ads.c:1533
-msgid ""
-"\n"
-"net ads printer search <printer>\n"
-"\tsearch for a printer in the directory\n"
-"\n"
-"net ads printer info <printer> <server>\n"
-"\tlookup info in directory for printer on server\n"
-"\t(note: printer defaults to \"*\", server defaults to local)\n"
-"\n"
-"net ads printer publish <printername>\n"
-"\tpublish printer in directory\n"
-"\t(note: printer name is required)\n"
-"\n"
-"net ads printer remove <printername>\n"
-"\tremove printer from directory\n"
-"\t(note: printer name is required)\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1561
-msgid "List printers in the AD"
-msgstr ""
-
-#: ../../utils/net_ads.c:1572
-#, c-format
-msgid "ads_find_printer: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1579
-msgid "No results found\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1601
-msgid ""
-"net ads printer info [printername [servername]]\n"
-"  Display printer info from AD\n"
-"    printername\tPrinter name or wildcard\n"
-"    servername\tName of the print server\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1627
-#, c-format
-msgid "Server '%s' not found: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1635 ../../utils/net_ads.c:1820
-#, c-format
-msgid "Printer '%s' not found\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1666
-msgid ""
-"net ads printer publish <printername> [servername]\n"
-"  Publish printer in AD\n"
-"    printername\tName of the printer\n"
-"    servername\tName of the print server\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1700
-#, c-format
-msgid "Unable to open a connnection to %s to obtain data for %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1713
-#, c-format
-msgid "Could not find machine account for server %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1729 ../../utils/net_ads.c:1738
-msgid "Internal error, out of memory!"
-msgstr ""
-
-#: ../../utils/net_ads.c:1749
-#, c-format
-msgid "Unable to open a connnection to the spoolss pipe on %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1793
-msgid ""
-"net ads printer remove <printername> [servername]\n"
-"  Remove a printer from the AD\n"
-"    printername\tName of the printer\n"
-"    servername\tName of the print server\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1813
-#, c-format
-msgid "ads_find_printer_on_server: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1832
-#, c-format
-msgid "ads_del_dn: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1848
-msgid "Search for a printer"
-msgstr "Drucker suchen"
-
-#: ../../utils/net_ads.c:1849
-msgid ""
-"net ads printer search\n"
-"    Search for a printer"
-msgstr ""
-
-#: ../../utils/net_ads.c:1856
-msgid "Display printer information"
-msgstr ""
-
-#: ../../utils/net_ads.c:1857
-msgid ""
-"net ads printer info\n"
-"    Display printer information"
-msgstr ""
-
-#: ../../utils/net_ads.c:1864
-msgid "Publish a printer"
-msgstr "Drucker freigeben"
-
-#: ../../utils/net_ads.c:1865
-msgid ""
-"net ads printer publish\n"
-"    Publish a printer"
-msgstr ""
-
-#: ../../utils/net_ads.c:1872
-msgid "Delete a printer"
-msgstr "Drucker lschen"
-
-#: ../../utils/net_ads.c:1873
-msgid ""
-"net ads printer remove\n"
-"    Delete a printer"
-msgstr ""
-
-#: ../../utils/net_ads.c:1897
-msgid ""
-"net ads password <username>\n"
-"  Change password for user\n"
-"    username\tName of user to change password for\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1904
-msgid "You must supply an administrator username/password\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1910
-msgid "ERROR: You must say which username to change password for\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1942
-msgid "Didn't find the kerberos server!\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1950 ../../utils/net_rpc.c:792
-#, c-format
-msgid "Enter new password for %s:"
-msgstr "Bitte neues Passwort fr %s eingeben: "
-
-#: ../../utils/net_ads.c:1960 ../../utils/net_ads.c:2011
-#, c-format
-msgid "Password change failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1965
-#, c-format
-msgid "Password change for %s completed.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:1983
-msgid "Change the machine account's trust password"
-msgstr "Passwort von Vertrauenskonto ndern"
-
-#: ../../utils/net_ads.c:2006
-#, c-format
-msgid "Changing password for principal: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2017
-#, c-format
-msgid "Password change for principal %s succeeded.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2020
-msgid "Attempting to update system keytab with new password.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2022
-msgid "Failed to update system keytab.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2038
-msgid ""
-"\n"
-"net ads search <expression> <attributes...>\n"
-"\n"
-"Perform a raw LDAP search on a ADS server and dump the results.\n"
-"The expression is a standard LDAP search expression, and the\n"
-"attributes are a list of LDAP fields to show in the results.\n"
-"\n"
-"Example: net ads search '(objectCategory=group)' sAMAccountName\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2075 ../../utils/net_ads.c:2136 ../../utils/net_ads.c:2200 ../../utils/net_ads_gpo.c:253
-#, c-format
-msgid "search failed: %s\n"
-msgstr "Suche fehlgeschlagen: %s\n"
-
-#: ../../utils/net_ads.c:2080 ../../utils/net_ads.c:2205 ../../utils/net_ads_gpo.c:259
-#, c-format
-msgid ""
-"Got %d replies\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2098
-msgid ""
-"\n"
-"net ads dn <dn> <attributes...>\n"
-"\n"
-"perform a raw LDAP search on a ADS server and dump the results\n"
-"The DN standard LDAP DN, and the attributes are a list of LDAP fields \n"
-"to show in the results\n"
-"\n"
-"Example: net ads dn 'CN=administrator,CN=Users,DC=my,DC=domain' sAMAccountName\n"
-"\n"
-"Note: the DN must be provided properly escaped. See RFC 4514 for details\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2158
-msgid ""
-"\n"
-"net ads sid <sid> <attributes...>\n"
-"\n"
-"perform a raw LDAP search on a ADS server and dump the results\n"
-"The SID is in string format, and the attributes are a list of LDAP fields \n"
-"to show in the results\n"
-"\n"
-"Example: net ads sid 'S-1-5-32' distinguishedName\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2193
-msgid "could not convert sid\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2226
-msgid "Delete the whole keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2247
-msgid ""
-"net ads keytab add <principal> [principal ...]\n"
-"  Add principals to local keytab\n"
-"    principal\tKerberos principal to add to keytab\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2254
-msgid "Processing principals to add...\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2275
-msgid "Create new default keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2294
-msgid ""
-"net ads keytab list [keytab]\n"
-"  List a local keytab\n"
-"    keytab\tKeytab to list\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2315
-msgid "Add a service principal"
-msgstr ""
-
-#: ../../utils/net_ads.c:2316
-msgid ""
-"net ads keytab add\n"
-"    Add a service principal"
-msgstr ""
-
-#: ../../utils/net_ads.c:2323
-msgid "Create a fresh keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2324
-msgid ""
-"net ads keytab create\n"
-"    Create a fresh keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2331
-msgid "Remove all keytab entries"
-msgstr ""
-
-#: ../../utils/net_ads.c:2332
-msgid ""
-"net ads keytab flush\n"
-"    Remove all keytab entries"
-msgstr ""
-
-#: ../../utils/net_ads.c:2339
-msgid "List a keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2340
-msgid ""
-"net ads keytab list\n"
-"    List a keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2347
-msgid ""
-"\n"
-"Warning: \"kerberos method\" must be set to a keytab method to use keytab functions.\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2363
-msgid "Renew TGT from existing credential cache"
-msgstr ""
-
-#: ../../utils/net_ads.c:2369
-#, c-format
-msgid "failed to renew kerberos ticket: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2389
-msgid "Dump the Kerberos PAC"
-msgstr ""
-
-#: ../../utils/net_ads.c:2417
-#, c-format
-msgid "failed to query kerberos PAC: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2426
-#, c-format
-msgid "The Pac: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2446
-msgid "Get Ticket Granting Ticket (TGT) for the user"
-msgstr ""
-
-#: ../../utils/net_ads.c:2468
-#, c-format
-msgid "failed to kinit password: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads.c:2482
-msgid "Retrieve Ticket Granting Ticket (TGT)"
-msgstr ""
-
-#: ../../utils/net_ads.c:2483
-msgid ""
-"net ads kerberos kinit\n"
-"    Receive Ticket Granting Ticket (TGT)"
-msgstr ""
-
-#: ../../utils/net_ads.c:2490
-msgid "Renew Ticket Granting Ticket from credential cache"
-msgstr ""
-
-#: ../../utils/net_ads.c:2491
-msgid ""
-"net ads kerberos renew\n"
-"    Renew Ticket Granting Ticket (TGT) from credential cache"
-msgstr ""
-
-#: ../../utils/net_ads.c:2499
-msgid "Dump Kerberos PAC"
-msgstr ""
-
-#: ../../utils/net_ads.c:2500
-msgid ""
-"net ads kerberos pac\n"
-"    Dump Kerberos PAC"
-msgstr ""
-
-#: ../../utils/net_ads.c:2516
-msgid "Display details on remote ADS server"
-msgstr ""
-
-#: ../../utils/net_ads.c:2517
-msgid ""
-"net ads info\n"
-"    Display details on remote ADS server"
-msgstr ""
-
-#: ../../utils/net_ads.c:2524
-msgid "Join the local machine to ADS realm"
-msgstr ""
-
-#: ../../utils/net_ads.c:2525
-msgid ""
-"net ads join\n"
-"    Join the local machine to ADS realm"
-msgstr ""
-
-#: ../../utils/net_ads.c:2532
-msgid "Validate machine account"
-msgstr ""
-
-#: ../../utils/net_ads.c:2533
-msgid ""
-"net ads testjoin\n"
-"    Validate machine account"
-msgstr ""
-
-#: ../../utils/net_ads.c:2540
-msgid "Remove the local machine from ADS"
-msgstr ""
-
-#: ../../utils/net_ads.c:2541
-msgid ""
-"net ads leave\n"
-"    Remove the local machine from ADS"
-msgstr ""
-
-#: ../../utils/net_ads.c:2549
-msgid ""
-"net ads status\n"
-"    Display machine account details"
-msgstr ""
-
-#: ../../utils/net_ads.c:2556 ../../utils/net_rpc.c:7220
-msgid "List/modify users"
-msgstr ""
-
-#: ../../utils/net_ads.c:2557
-msgid ""
-"net ads user\n"
-"    List/modify users"
-msgstr ""
-
-#: ../../utils/net_ads.c:2564 ../../utils/net_rpc.c:7237
-msgid "List/modify groups"
-msgstr ""
-
-#: ../../utils/net_ads.c:2565
-msgid ""
-"net ads group\n"
-"    List/modify groups"
-msgstr ""
-
-#: ../../utils/net_ads.c:2572
-msgid "Issue dynamic DNS update"
-msgstr ""
-
-#: ../../utils/net_ads.c:2573
-msgid ""
-"net ads dns\n"
-"    Issue dynamic DNS update"
-msgstr ""
-
-#: ../../utils/net_ads.c:2580
-msgid "Change user passwords"
-msgstr ""
-
-#: ../../utils/net_ads.c:2581
-msgid ""
-"net ads password\n"
-"    Change user passwords"
-msgstr ""
-
-#: ../../utils/net_ads.c:2588 ../../utils/net_rpc.c:7269
-msgid "Change trust account password"
-msgstr "Trust account Passwort ndern"
-
-#: ../../utils/net_ads.c:2589
-msgid ""
-"net ads changetrustpw\n"
-"    Change trust account password"
-msgstr ""
-
-#: ../../utils/net_ads.c:2596
-msgid "List/modify printer entries"
-msgstr ""
-
-#: ../../utils/net_ads.c:2597
-msgid ""
-"net ads printer\n"
-"    List/modify printer entries"
-msgstr ""
-
-#: ../../utils/net_ads.c:2604
-msgid "Issue LDAP search using filter"
-msgstr ""
-
-#: ../../utils/net_ads.c:2605
-msgid ""
-"net ads search\n"
-"    Issue LDAP search using filter"
-msgstr ""
-
-#: ../../utils/net_ads.c:2612
-msgid "Issue LDAP search by DN"
-msgstr ""
-
-#: ../../utils/net_ads.c:2613
-msgid ""
-"net ads dn\n"
-"    Issue LDAP search by DN"
-msgstr ""
-
-#: ../../utils/net_ads.c:2620
-msgid "Issue LDAP search by SID"
-msgstr ""
-
-#: ../../utils/net_ads.c:2621
-msgid ""
-"net ads sid\n"
-"    Issue LDAP search by SID"
-msgstr ""
-
-#: ../../utils/net_ads.c:2628
-msgid "Display workgroup name"
-msgstr ""
-
-#: ../../utils/net_ads.c:2629
-msgid ""
-"net ads workgroup\n"
-"    Display the workgroup name"
-msgstr ""
-
-#: ../../utils/net_ads.c:2636
-msgid "Perfom CLDAP query on DC"
-msgstr ""
-
-#: ../../utils/net_ads.c:2637
-msgid ""
-"net ads lookup\n"
-"    Find the ADS DC using CLDAP lookups"
-msgstr ""
-
-#: ../../utils/net_ads.c:2644
-msgid "Manage local keytab file"
-msgstr ""
-
-#: ../../utils/net_ads.c:2645
-msgid ""
-"net ads keytab\n"
-"    Manage local keytab file"
-msgstr ""
-
-#: ../../utils/net_ads.c:2652
-msgid "Manage group policy objects"
-msgstr ""
-
-#: ../../utils/net_ads.c:2653
-msgid ""
-"net ads gpo\n"
-"    Manage group policy objects"
-msgstr ""
-
-#: ../../utils/net_ads.c:2660
-msgid "Manage kerberos keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2661
-msgid ""
-"net ads kerberos\n"
-"    Manage kerberos keytab"
-msgstr ""
-
-#: ../../utils/net_ads.c:2674
-msgid "ADS support not compiled in\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:42
-msgid "net ads gpo refresh <username|machinename>"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:43
-msgid ""
-"  Lists all GPOs assigned to an account and downloads them\n"
-"    username\tUser to refresh GPOs for\n"
-"    machinename\tMachine to refresh GPOs for\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:57
-#, c-format
-msgid "failed to connect AD server: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:63
-#, c-format
-msgid "failed to find samaccount for %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:71
-#, c-format
-msgid ""
-"\n"
-"%s: '%s' has dn: '%s'\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:72 ../../utils/net_ads_gpo.c:332
-msgid "machine"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:72 ../../utils/net_ads_gpo.c:332
-msgid "user"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:75
-msgid "* fetching token "
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:83 ../../utils/net_ads_gpo.c:91 ../../utils/net_ads_gpo.c:103 ../../utils/net_ads_gpo.c:114 ../../utils/net_ads_gpo.c:159
-#, c-format
-msgid "failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:86 ../../utils/net_ads_gpo.c:95 ../../utils/net_ads_gpo.c:106 ../../utils/net_ads_gpo.c:119 ../../utils/net_ads_gpo.c:164
-msgid "finished\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:88
-msgid "* fetching GPO List "
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:97
-msgid "* Refreshing Group Policy Data "
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:108
-msgid "* storing GPO list to registry "
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:123
-msgid "* dumping GPO list\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:152
-msgid "* re-reading GPO list from registry "
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:168
-msgid "* dumping GPO list from registry\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:231
-msgid "List all GPOs on the DC"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:273
-#, c-format
-msgid "ads_parse_gpo failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:305
-msgid "net ads gpo list <username|machinename>"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:306
-msgid ""
-"  Lists all GPOs for machine/user\n"
-"    username\tUser to list GPOs for\n"
-"    machinename\tMachine to list GPOs for\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:331
-#, c-format
-msgid "%s: '%s' has dn: '%s'\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:457
-msgid "net ads gpo linkget <container>"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:458
-msgid ""
-"  Lists gPLink of a containter\n"
-"    container\tContainer to get link for\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:475
-#, c-format
-msgid "get link for %s failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:499
-msgid "net ads gpo linkadd <linkdn> <gpodn> [options]"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:500
-msgid ""
-"  Link a container to a GPO\n"
-"    linkdn\tContainer to link to a GPO\n"
-"    gpodn\tGPO to link container to\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:503
-msgid ""
-"note: DNs must be provided properly escaped.\n"
-"See RFC 4514 for details\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:524
-#, c-format
-msgid "link add failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:587
-msgid "net ads gpo getgpo <gpo>"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:588
-msgid ""
-"  List speciefied GPO\n"
-"    gpo\t\tGPO to list\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:610
-#, c-format
-msgid "get gpo for [%s] failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:641
-msgid "List specified GPO"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:642
-msgid ""
-"net ads gpo getgpo\n"
-"    List specified GPO"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:649
-msgid "Link a container to a GPO"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:650
-msgid ""
-"net ads gpo linkadd\n"
-"    Link a container to a GPO"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:667
-msgid "Lists gPLink of containter"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:668
-msgid ""
-"net ads gpo linkget\n"
-"    Lists gPLink of containter"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:675
-msgid "Lists all GPOs for machine/user"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:676
-msgid ""
-"net ads gpo list\n"
-"    Lists all GPOs for machine/user"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:683
-msgid "Lists all GPOs on a DC"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:684
-msgid ""
-"net ads gpo listall\n"
-"    Lists all GPOs on a DC"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:691
-msgid "Lists all GPOs assigned to an account and downloads them"
-msgstr ""
-
-#: ../../utils/net_ads_gpo.c:693
-msgid ""
-"net ads gpo refresh\n"
-"    Lists all GPOs assigned to an account and downloads them"
-msgstr ""
-
-#: ../../utils/net_afs.c:25
-msgid ""
-"  net afs key filename\n"
-"\tImports a OpenAFS KeyFile into our secrets.tdb\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:27
-msgid ""
-"  net afs impersonate <user> <cell>\n"
-"\tCreates a token for user@cell\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:43
-msgid "Could not open secrets.tdb\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:48
-#, c-format
-msgid "Could not open %s\n"
-msgstr "Konnte %s nicht ffnen\n"
-
-#: ../../utils/net_afs.c:53
-msgid "Could not read keyfile\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:58
-msgid "Could not write keyfile to secrets.tdb\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:78
-#, c-format
-msgid "Could not create token\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:83
-#, c-format
-msgid "Could not set token into kernel\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:87
-#, c-format
-msgid "Success: %s@%s\n"
-msgstr ""
-
-#: ../../utils/net_afs.c:98
-msgid "Import an OpenAFS keyfile"
-msgstr ""
-
-#: ../../utils/net_afs.c:99
-msgid ""
-"net afs key <filename>\n"
-"    Import kefile from <filename>."
-msgstr ""
-
-#: ../../utils/net_afs.c:106
-msgid "Get a user token"
-msgstr ""
-
-#: ../../utils/net_afs.c:107
-msgid ""
-"net afs impersonate <user> <cell>\n"
-"    Create token for user@cell"
-msgstr ""
-
-#: ../../utils/net_cache.c:74
-#, c-format
-msgid "Key: %s\t Timeout: %s\t Value: %s  %s\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:75
-msgid "(expired)"
-msgstr ""
-
-#: ../../utils/net_cache.c:84
-#, c-format
-msgid "Couldn't delete entry! key = %s\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:160
-msgid "net cache add <key string> <data string> <timeout>\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:172
-msgid "Invalid timeout argument.\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:177
-msgid "New cache entry stored successfully.\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:181
-msgid "Entry couldn't be added. Perhaps there's already such a key.\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:199
-msgid " net cache del <key string>\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:204
-msgid "Entry deleted.\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:208
-msgid "Couldn't delete specified entry\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:229
-msgid " net cache get <key>\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:239
-msgid "Failed to find entry\n"
-msgstr ""
-
-#: ../../utils/net_cache.c:258
-msgid " net cache search <pattern>\n"
-msgstr " net cache search <Muster>\n"
-
-#: ../../utils/net_cache.c:284
-msgid "List all cache entries."
-msgstr ""
-
-#: ../../utils/net_cache.c:307
-msgid "Delete all cache entries."
-msgstr ""
-
-#: ../../utils/net_cache.c:322 ../../utils/net_cache.c:400
-msgid "Move transient cache content to stable storage"
-msgstr ""
-
-#: ../../utils/net_cache.c:345
-msgid "Add new cache entry"
-msgstr ""
-
-#: ../../utils/net_cache.c:346
-msgid ""
-"net cache add <key string> <data string> <timeout>\n"
-"  Add new cache entry.\n"
-"    key string\tKey string to add cache data under.\n"
-"    data string\tData to store under given key.\n"
-"    timeout\tTimeout for cache data."
-msgstr ""
-
-#: ../../utils/net_cache.c:356
-msgid "Delete existing cache entry by key"
-msgstr ""
-
-#: ../../utils/net_cache.c:357
-msgid ""
-"net cache del <key string>\n"
-"  Delete existing cache entry by key.\n"
-"    key string\tKey string to delete."
-msgstr ""
-
-#: ../../utils/net_cache.c:365
-msgid "Get cache entry by key"
-msgstr ""
-
-#: ../../utils/net_cache.c:366
-msgid ""
-"net cache get <key string>\n"
-"  Get cache entry by key.\n"
-"    key string\tKey string to look up cache entry for."
-msgstr ""
-
-#: ../../utils/net_cache.c:375
-msgid "Search entry by pattern"
-msgstr ""
-
-#: ../../utils/net_cache.c:376
-msgid ""
-"net cache search <pattern>\n"
-"  Search entry by pattern.\n"
-"    pattern\tPattern to search for in cache."
-msgstr ""
-
-#: ../../utils/net_cache.c:384
-msgid "List all cache entries"
-msgstr ""
-
-#: ../../utils/net_cache.c:385
-msgid ""
-"net cache list\n"
-"  List all cache entries"
-msgstr ""
-
-#: ../../utils/net_cache.c:392
-msgid "Delete all cache entries"
-msgstr ""
-
-#: ../../utils/net_cache.c:393
-msgid ""
-"net cache flush\n"
-"  Delete all cache entries"
-msgstr ""
-
-#: ../../utils/net_cache.c:401
-msgid ""
-"net cache stabilize\n"
-"  Move transient cache content to stable storage"
-msgstr ""
-
-#: ../../utils/net_conf.c:51
-msgid ""
-" net conf import [--test|-T] <filename> [<servicename>]\n"
-"\t[--test|-T]    testmode - do not act, just print what would be done\n"
-"\t<servicename>  only import service <servicename>, ignore the rest\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:79
-msgid "net conf showshare <sharename>\n"
-msgstr "net conf showshare <sharename>\n"
-
-#: ../../utils/net_conf.c:88
-msgid ""
-" net conf addshare <sharename> <path> [writeable={y|N} [guest_ok={y|N} [<comment>]]\n"
-"\t<sharename>      the new share name.\n"
-"\t<path>           the path on the filesystem to export.\n"
-"\twriteable={y|N}  set \"writeable to \"yes\" or \"no\" (default) on this share.\n"
-"\tguest_ok={y|N}   set \"guest ok\" to \"yes\" or \"no\" (default)   on this share.\n"
-"\t<comment>        optional comment for the new share.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:105
-msgid "net conf delshare <sharename>\n"
-msgstr "net conf showshare <sharename>\n"
-
-#: ../../utils/net_conf.c:114
-msgid " net conf setparm <section> <param> <value>\n"
-msgstr " net conf setparm <section> <param> <value>\n"
-
-#: ../../utils/net_conf.c:123
-msgid " net conf getparm <section> <param>\n"
-msgstr " net conf setparm <section> <param> <value>\n"
-
-#: ../../utils/net_conf.c:132
-msgid " net conf delparm <section> <param>\n"
-msgstr " net conf setparm <section> <param> <value>\n"
-
-#: ../../utils/net_conf.c:141
-msgid " net conf getincludes <section>\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:150
-msgid " net conf setincludes <section> [<filename>]*\n"
-msgstr " net conf setparm <section> <param> <value>\n"
-
-#: ../../utils/net_conf.c:159
-msgid " net conf delincludes <section>\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:271
-#, c-format
-msgid "Error getting config: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:325 ../../utils/net_conf.c:338 ../../utils/net_conf.c:634 ../../utils/net_conf.c:762 ../../utils/net_conf.c:800 ../../utils/net_conf.c:806 ../../utils/net_conf.c:880 ../../utils/net_conf.c:886 ../../utils/net_conf.c:936
-#: ../../utils/net_conf.c:990 ../../utils/net_conf.c:1030 ../../utils/net_conf.c:1070
-msgid "error: out of memory!\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:344
-#, c-format
-msgid "error loading file '%s': %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:350
-msgid ""
-"\n"
-"TEST MODE - would import the following configuration:\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:366 ../../utils/net_conf.c:402 ../../utils/net_conf.c:427 ../../utils/net_conf.c:813
-#, c-format
-msgid "error starting transaction: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:420 ../../utils/net_conf.c:436 ../../utils/net_conf.c:837
-#, c-format
-msgid "error committing transaction: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:447 ../../utils/net_conf.c:848
-#, c-format
-msgid "error cancelling transaction: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:504
-#, c-format
-msgid "Error deleting configuration: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:541
-#, c-format
-msgid "error getting share parameters: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:650
-#, c-format
-msgid "ERROR: share name %s contains invalid characters (any of %s)\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:658
-msgid "ERROR: 'global' is not a valid share name.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:663
-#, c-format
-msgid "ERROR: share %s already exists.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:672
-#, c-format
-msgid "Error: path '%s' is not an absolute path.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:679
-#, c-format
-msgid ""
-"ERROR: cannot stat path '%s' to ensure this is a directory.\n"
-"Error was '%s'.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:688
-#, c-format
-msgid "ERROR: path '%s' is not a directory.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:699
-#, c-format
-msgid "Error creating share %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:710 ../../utils/net_conf.c:719 ../../utils/net_conf.c:727 ../../utils/net_conf.c:735
-#, c-format
-msgid "Error setting parameter %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:768
-#, c-format
-msgid "Error deleting share %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:821
-#, c-format
-msgid "Error creating share '%s': %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:830
-#, c-format
-msgid "Error setting value '%s': %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:894 ../../utils/net_conf.c:950
-#, c-format
-msgid "Error: given service '%s' does not exist.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:899 ../../utils/net_conf.c:955
-#, c-format
-msgid "Error: given parameter '%s' is not set.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:903
-#, c-format
-msgid "Error getting value '%s': %s.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:959
-#, c-format
-msgid "Error deleting value '%s': %s.\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:997
-#, c-format
-msgid "error getting includes: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:1043
-#, c-format
-msgid "error setting includes: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:1076
-#, c-format
-msgid "error deleting includes: %s\n"
-msgstr ""
-
-#: ../../utils/net_conf.c:1180
-msgid "Dump the complete configuration in smb.conf like format."
-msgstr ""
-
-#: ../../utils/net_conf.c:1182
-msgid ""
-"net conf list\n"
-"    Dump the complete configuration in smb.conf like format."
-msgstr ""
-
-#: ../../utils/net_conf.c:1191
-msgid "Import configuration from file in smb.conf format."
-msgstr ""
-
-#: ../../utils/net_conf.c:1193
-msgid ""
-"net conf import\n"
-"    Import configuration from file in smb.conf format."
-msgstr ""
-
-#: ../../utils/net_conf.c:1201
-msgid "List the share names."
-msgstr ""
-
-#: ../../utils/net_conf.c:1202
-msgid ""
-"net conf listshares\n"
-"    List the share names."
-msgstr ""
-
-#: ../../utils/net_conf.c:1209
-msgid "Delete the complete configuration."
-msgstr ""
-
-#: ../../utils/net_conf.c:1210
-msgid ""
-"net conf drop\n"
-"    Delete the complete configuration."
-msgstr ""
-
-#: ../../utils/net_conf.c:1217
-msgid "Show the definition of a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1218
-msgid ""
-"net conf showshare\n"
-"    Show the definition of a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1225
-msgid "Create a new share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1226
-msgid ""
-"net conf addshare\n"
-"    Create a new share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1233
-msgid "Delete a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1234
-msgid ""
-"net conf delshare\n"
-"    Delete a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1241
-msgid "Store a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1242
-msgid ""
-"net conf setparm\n"
-"    Store a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1249
-msgid "Retrieve the value of a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1250
-msgid ""
-"net conf getparm\n"
-"    Retrieve the value of a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1257
-msgid "Delete a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1258
-msgid ""
-"net conf delparm\n"
-"    Delete a parameter."
-msgstr ""
-
-#: ../../utils/net_conf.c:1265
-msgid "Show the includes of a share definition."
-msgstr ""
-
-#: ../../utils/net_conf.c:1266
-msgid ""
-"net conf getincludes\n"
-"    Show the includes of a share definition."
-msgstr ""
-
-#: ../../utils/net_conf.c:1273
-msgid "Set includes for a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1274
-msgid ""
-"net conf setincludes\n"
-"    Set includes for a share."
-msgstr ""
-
-#: ../../utils/net_conf.c:1281
-msgid "Delete includes from a share definition."
-msgstr ""
-
-#: ../../utils/net_conf.c:1282
-msgid ""
-"net conf setincludes\n"
-"    Delete includes from a share definition."
-msgstr ""
-
-#: ../../utils/net_dom.c:28
-msgid ""
-"net dom join <domain=DOMAIN> <ou=OU> <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Join a remote machine\n"
-msgstr ""
-
-#: ../../utils/net_dom.c:33
-msgid ""
-"net dom unjoin <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Unjoin a remote machine\n"
-msgstr ""
-
-#: ../../utils/net_dom.c:38
-msgid ""
-"net dom renamecomputer <newname=NEWNAME> <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Rename joined computer\n"
-msgstr ""
-
-#: ../../utils/net_dom.c:98
-#, c-format
-msgid "Failed to unjoin domain: %s\n"
-msgstr ""
-
-#: ../../utils/net_dom.c:104 ../../utils/net_dom.c:211
-msgid "Shutting down due to a domain membership change"
-msgstr ""
-
-#: ../../utils/net_dom.c:297
-#, c-format
-msgid "Failed to rename machine: "
-msgstr ""
-
-#: ../../utils/net_dom.c:299
-#, c-format
-msgid "Computer is not joined to a Domain\n"
-msgstr ""
-
-#: ../../utils/net_dom.c:308
-msgid "Shutting down due to a computer rename"
-msgstr ""
-
-#: ../../utils/net_dom.c:345
-msgid "Join a remote machine"
-msgstr ""
-
-#: ../../utils/net_dom.c:346
-msgid ""
-"net dom join <domain=DOMAIN> <ou=OU> <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Join a remote machine"
-msgstr ""
-
-#: ../../utils/net_dom.c:354
-msgid "Unjoin a remote machine"
-msgstr ""
-
-#: ../../utils/net_dom.c:355
-msgid ""
-"net dom unjoin <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Unjoin a remote machine"
-msgstr ""
-
-#: ../../utils/net_dom.c:363
-msgid "Rename a computer that is joined to a domain"
-msgstr ""
-
-#: ../../utils/net_dom.c:364
-msgid ""
-"net dom renamecomputer <newname=NEWNAME> <account=ACCOUNT> <password=PASSWORD> <reboot>\n"
-"  Rename joined computer"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:53 ../../utils/net_eventlog.c:110
-#, c-format
-msgid "failed to load evt file: %s\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:60 ../../utils/net_eventlog.c:131
-#, c-format
-msgid "evt pull failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:118
-#, c-format
-msgid "evt header pull failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:124
-msgid "input file is wrapped, cannot proceed\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:140 ../../utils/net_eventlog.c:206
-#, c-format
-msgid "can't open the eventlog TDB (%s)\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:160
-#, c-format
-msgid "can't write to the eventlog: %s\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:166
-#, c-format
-msgid "wrote %d entries to tdb\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:217
-#, c-format
-msgid "failed to save evt file: %s\n"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:246
-msgid "Dump eventlog"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:247
-msgid ""
-"net eventlog dump\n"
-"    Dump win32 *.evt eventlog file"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:254
-msgid "Import eventlog"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:255
-msgid ""
-"net eventlog import\n"
-"    Import win32 *.evt eventlog file"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:262
-msgid "Export eventlog"
-msgstr ""
-
-#: ../../utils/net_eventlog.c:263
-msgid ""
-"net eventlog export\n"
-"    Export win32 *.evt eventlog file"
-msgstr ""
-
-#: ../../utils/net_file.c:27
-msgid ""
-"net [<method>] file [misc. options] [targets]\n"
-"\tlists all open files on file server\n"
-msgstr ""
-
-#: ../../utils/net_file.c:29
-msgid ""
-"net [<method>] file USER <username> [misc. options] [targets]\n"
-"\tlists all files opened by username on file server\n"
-msgstr ""
-
-#: ../../utils/net_file.c:32
-msgid ""
-"net [<method>] file CLOSE <id> [misc. options] [targets]\n"
-"\tcloses specified file on target server\n"
-msgstr ""
-
-#: ../../utils/net_file.c:34
-msgid ""
-"net [rap] file INFO <id> [misc. options] [targets]\n"
-"\tdisplays information about the specified open file\n"
-msgstr ""
-
-#: ../../utils/net_group.c:27
-msgid ""
-"net [<method>] group [misc. options] [targets]\n"
-"\tList user groups\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_group.c:29
-msgid ""
-"net rpc group LIST [global|local|builtin]* [misc. options]\n"
-"\tList specific user groups\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_group.c:31
-msgid ""
-"net [<method>] group DELETE <name> [misc. options] [targets]\n"
-"\tDelete specified group\n"
-msgstr ""
-
-#: ../../utils/net_group.c:34
-msgid ""
-"\n"
-"net [<method>] group ADD <name> [-C comment] [-c container] [misc. options] [targets]\n"
-"\tCreate specified group\n"
-msgstr ""
-
-#: ../../utils/net_group.c:37
-msgid ""
-"\n"
-"net rpc group MEMBERS <name>\n"
-"\tList Group Members\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_group.c:38
-msgid ""
-"\n"
-"net rpc group ADDMEM <group> <member>\n"
-"\tAdd Group Members\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_group.c:40
-msgid ""
-"\n"
-"net rpc group DELMEM <group> <member>\n"
-"\tDelete Group Members\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_group.c:44 ../../utils/net_user.c:41
-msgid "\t-C or --comment=<comment>\tdescriptive comment (for add only)\n"
-msgstr ""
-
-#: ../../utils/net_group.c:46 ../../utils/net_user.c:43
-msgid "\t-c or --container=<container>\tLDAP container, defaults to cn=Users (for add in ADS only)\n"
-msgstr ""
-
-#: ../../utils/net_group.c:48
-msgid "\t-L or --localgroup\t\tWhen adding groups, create a local group (alias)\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:38
-#, c-format
-msgid "NT Group %s doesn't exist in mapping DB\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:46
-#, c-format
-msgid "converting sid %s from a string failed!\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:65
-#, c-format
-msgid "\tSID       : %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:66
-#, c-format
-msgid "\tUnix gid  : %u\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:67
-#, c-format
-msgid "\tUnix group: %s\n"
-msgstr "\tUnix Gruppe: %s\n"
-
-#: ../../utils/net_groupmap.c:68
-#, c-format
-msgid "\tGroup type: %s\n"
-msgstr "\tGruppentyp: %s\n"
-
-#: ../../utils/net_groupmap.c:70
-#, c-format
-msgid "\tComment   : %s\n"
-msgstr "\tKommentar   : %s\n"
-
-#: ../../utils/net_groupmap.c:84
-msgid ""
-"net groupmap list [verbose] [ntgroup=NT group] [sid=SID]\n"
-"    verbose\tPrint verbose list\n"
-"    ntgroup\tNT group to list\n"
-"    sid\tSID of group to list"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:91
-msgid "Usage: "
-msgstr "Verwendung: "
-
-#: ../../utils/net_groupmap.c:106 ../../utils/net_groupmap.c:213 ../../utils/net_groupmap.c:220 ../../utils/net_groupmap.c:364 ../../utils/net_groupmap.c:371 ../../utils/net_groupmap.c:503
-msgid "must supply a name\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:113 ../../utils/net_groupmap.c:227 ../../utils/net_groupmap.c:510
-msgid "must supply a SID\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:118 ../../utils/net_groupmap.c:265 ../../utils/net_groupmap.c:405 ../../utils/net_groupmap.c:515
-#, c-format
-msgid "Bad option: %s\n"
-msgstr "Ungltige Option: %s\n"
-
-#: ../../utils/net_groupmap.c:139
-msgid "Failure to local group SID in the database\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:181
-msgid "net groupmap add {rid=<int>|sid=<string>} unixgroup=<string> [type=<domain|local|builtin>] [ntgroup=<string>] [comment=<string>]"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:205
-#, c-format
-msgid "RID must be greater than %d\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:235 ../../utils/net_groupmap.c:379
-msgid "must supply a comment string\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:259
-#, c-format
-msgid "unknown group type %s\n"
-msgstr "Unbekannter Gruppentyp %s\n"
-
-#: ../../utils/net_groupmap.c:276
-#, c-format
-msgid "Can't lookup UNIX group %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:282
-#, c-format
-msgid "Unix group %s already mapped to SID %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:289
-msgid "No rid or sid specified, choosing a RID\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:292
-msgid "Could not get new RID\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:297
-#, c-format
-msgid "Got RID %d\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:327
-#, c-format
-msgid "adding entry for group %s failed!\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:331
-#, c-format
-msgid "Successfully added group %s to the mapping db as a %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:348
-msgid "net groupmap modify {ntgroup=<string>|sid=<SID>} [comment=<string>] [unixgroup=<string>] [type=<domain|local>]"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:387
-msgid "must supply a group name\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:433
-msgid "Failed to find local group SID in the database\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:442
-msgid "Can't map to an unknown group type.\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:448
-msgid "You can only change between domain and local groups.\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:465
-#, c-format
-msgid "Unable to lookup UNIX group %s.  Make sure the group exists.\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:475
-msgid "Could not update group database\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:479
-#, c-format
-msgid "Updated mapping entry for %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:490
-msgid "net groupmap delete {ntgroup=<string>|sid=<SID>}"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:531
-#, c-format
-msgid "Unable to resolve group %s to a SID\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:538
-#, c-format
-msgid "Failed to remove group %s from the mapping db!\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:543
-#, c-format
-msgid "Sucessfully removed %s from the mapping db\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:558
-msgid " net groupmap set \"NT Group\" [\"unix group\"] [-C \"comment\"] [-L] [-D]\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:564
-msgid "Can only specify -L or -D, not both\n"
-msgstr "Entweder -L oder -D angeben, aber nicht beides\n"
-
-#: ../../utils/net_groupmap.c:574
-#, c-format
-msgid "Could not find unix group %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:595
-#, c-format
-msgid "Could not find group mapping for %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:606
-msgid "Could not allocate new RID\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:622
-#, c-format
-msgid "Could not add mapping entry for %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:633
-#, c-format
-msgid "Can't change type of the BUILTIN group %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:660
-#, c-format
-msgid "Could not update group mapping for %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:678
-msgid "Delete all group mappings"
-msgstr "Alle Gruppenzuweisungen lschen"
-
-#: ../../utils/net_groupmap.c:684
-msgid "Could not list group mappings\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:691
-#, c-format
-msgid "Group %s is not mapped\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:694
-#, c-format
-msgid "Deleting mapping for NT Group %s, sid %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:716
-msgid "net groupmap addmem alias-sid member-sid\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:721
-#, c-format
-msgid "Could not add sid %s to alias %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:739
-msgid "net groupmap delmem alias-sid member-sid\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:744
-#, c-format
-msgid "Could not delete sid %s from alias %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:763
-msgid "net groupmap listmem alias-sid\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:772
-#, c-format
-msgid "Could not list members for sid %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:799
-#, c-format
-msgid "Could not list memberships for sid %s\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:823
-msgid "net groupmap memberof sid\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:829 ../../utils/net_idmap.c:349
-msgid "talloc_init failed\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:836
-msgid "Could not get domain sid\n"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:859
-msgid "Create a new group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:860
-msgid ""
-"net groupmap add\n"
-"    Create a new group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:867
-msgid "Update a group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:868
-msgid ""
-"net groupmap modify\n"
-"    Modify an existing group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:875
-msgid "Remove a group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:876
-msgid ""
-"net groupmap delete\n"
-"    Remove a group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:883
-msgid "Set group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:884
-msgid ""
-"net groupmap set\n"
-"    Set a group mapping"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:891
-msgid "Remove foreign group mapping entries"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:892
-msgid ""
-"net groupmap cleanup\n"
-"    Remove foreign group mapping entries"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:899
-msgid "Add a foreign alias member"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:900
-msgid ""
-"net groupmap addmem\n"
-"    Add a foreign alias member"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:907
-msgid "Delete foreign alias member"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:908
-msgid ""
-"net groupmap delmem\n"
-"    Delete foreign alias member"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:915
-msgid "List foreign group members"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:916
-msgid ""
-"net groupmap listmem\n"
-"    List foreign alias members"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:923
-msgid "List foreign group memberships"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:924
-msgid ""
-"net groupmap memberships\n"
-"    List foreign group memberships"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:931
-msgid "List current group map"
-msgstr ""
-
-#: ../../utils/net_groupmap.c:932
-msgid ""
-"net groupmap list\n"
-"    List current group map"
-msgstr ""
-
-#: ../../utils/net_help.c:39
-#, c-format
-msgid "net %s usage:\n"
-msgstr ""
-
-#: ../../utils/net_help_common.c:25 ../../utils/net_join.c:28
-msgid "Valid methods: (auto-detected if not specified)\n"
-msgstr ""
-
-#: ../../utils/net_help_common.c:26 ../../utils/net_join.c:29
-msgid "\tads\t\t\t\tActive Directory (LDAP/Kerberos)\n"
-msgstr ""
-
-#: ../../utils/net_help_common.c:27 ../../utils/net_join.c:30
-msgid "\trpc\t\t\t\tDCE-RPC\n"
-msgstr ""
-
-#: ../../utils/net_help_common.c:28
-msgid "\trap\t\t\t\tRAP (older systems)\n"
-msgstr ""
-
-#: ../../utils/net_help_common.c:35
-msgid "Valid targets: choose one (none defaults to localhost)\n"
-msgstr "Mgliche Zielangaben: (ohne Angabe wird localhost angenommen)\n"
-
-#: ../../utils/net_help_common.c:36
-msgid "\t-S or --server=<server>\t\tserver name\n"
-msgstr "\t-S oder --server=<server>\t\tServer Name\n"
-
-#: ../../utils/net_help_common.c:37
-msgid "\t-I or --ipaddress=<ipaddr>\taddress of target server\n"
-msgstr "\t-I oder --ipaddress=<ipaddr>\tAdresse des Zielservers\n"
-
-#: ../../utils/net_help_common.c:38
-msgid "\t-w or --workgroup=<wg>\t\ttarget workgroup or domain\n"
-msgstr "\t-w oder --workgroup=<wg>\t\tZielarbeitsgruppe oder -domne\n"
-
-#: ../../utils/net_help_common.c:41
-msgid "Valid miscellaneous options are:\n"
-msgstr "Diverse Optionen:\n"
-
-#. misc options
-#: ../../utils/net_help_common.c:42
-msgid "\t-p or --port=<port>\t\tconnection port on target\n"
-msgstr "\t-p oder --port=<port>\t\tPortnummer\n"
-
-#: ../../utils/net_help_common.c:43
-msgid "\t-W or --myworkgroup=<wg>\tclient workgroup\n"
-msgstr "\t-W oder --myworkgroup=<wg>\tzu nutzende Arbeitsgruppe\n"
-
-#: ../../utils/net_help_common.c:44
-msgid "\t-d or --debuglevel=<level>\tdebug level (0-10)\n"
-msgstr "\t-d oder --debuglevel=<level>\tDebug Level (0-10)\n"
-
-#: ../../utils/net_help_common.c:45
-msgid "\t-n or --myname=<name>\t\tclient name\n"
-msgstr "\t-n oder --myname=<name>\t\tzu nutzender Name\n"
-
-#: ../../utils/net_help_common.c:46
-msgid "\t-U or --user=<name>\t\tuser name\n"
-msgstr "\t-U oder --user=<name>\t\tBenutzername\n"
-
-#: ../../utils/net_help_common.c:47
-msgid "\t-s or --configfile=<path>\tpathname of smb.conf file\n"
-msgstr "\t-s oder --configfile=<path>\tPfad zur smb.conf Datei\n"
-
-#: ../../utils/net_help_common.c:48
-msgid "\t-l or --long\t\t\tDisplay full information\n"
-msgstr "\t-l oder --long\t\t\tAlle Informationen anzeigen\n"
-
-#: ../../utils/net_help_common.c:49
-msgid "\t-V or --version\t\t\tPrint samba version information\n"
-msgstr "\t-V oder --version\t\t\tSamba Versionsinformationen ausgeben\n"
-
-#: ../../utils/net_help_common.c:50
-msgid "\t-P or --machine-pass\t\tAuthenticate as machine account\n"
-msgstr "\t-P oder --machine-pass\t\tMit Rechnerkonto authentifizieren\n"
-
-#: ../../utils/net_help_common.c:52
-msgid "\t-e or --encrypt\t\t\tEncrypt SMB transport (UNIX extended servers only)\n"
-msgstr "\t-e oder --encrypt\t\t\tSMB bertragung verschlsseln  (nur UNIX erweiterte Server)\n"
-
-#: ../../utils/net_help_common.c:54
-msgid "\t-k or --kerberos\t\tUse kerberos (active directory) authentication\n"
-msgstr "\t-k oder --kerberos\t\tKerberos Authentifizierung benutzen (Active Directory)\n"
-
-#: ../../utils/net_idmap.c:26
-msgid "Out of memory!\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:40
-#, c-format
-msgid "USER HWM %d\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:45
-#, c-format
-msgid "GROUP HWM %d\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:66
-msgid ""
-"net idmap dump <inputfile>\n"
-"  Dump current ID mapping.\n"
-"    inputfile\tTDB file to read mappings from.\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:75
-#, c-format
-msgid "Could not open idmap: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:98
-msgid ""
-"net idmap restore [inputfile]\n"
-"  Restore ID mappings from file\n"
-"    inputfile\tFile to load ID mappings from. If not given, load data from stdin.\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:107
-msgid "To use net idmap Winbindd must be running.\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:145
-#, c-format
-msgid "Could not set USER HWM: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:154
-#, c-format
-msgid "Could not set GROUP HWM: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:159
-#, c-format
-msgid "ignoring invalid line [%s]\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:166
-#, c-format
-msgid "ignoring invalid sid [%s]: %s\n"
-msgstr "ignoriere ungltige sid [%s]: %s\n"
-
-#: ../../utils/net_idmap.c:178
-#, c-format
-msgid "Could not set mapping of %s %lu to sid %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:199 ../../utils/net_idmap.c:205 ../../utils/net_idmap.c:422 ../../utils/net_idmap.c:430
-msgid "Not implemented yet"
-msgstr "Noch nicht implementiert"
-
-#: ../../utils/net_idmap.c:245
-msgid ""
-"net idmap secret {<DOMAIN>|alloc} <secret>\n"
-"  Set the secret for the specified domain (or alloc module)\n"
-"    DOMAIN\tDomain to set secret for.\n"
-"    alloc\tSet secret for the alloc module\n"
-"    secret\tNew secret to set.\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:275
-msgid "The only currently supported backend is LDAP\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:285
-#, c-format
-msgid "Missing ldap_user_dn option for domain %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:296
-msgid "Missing ldap_user_dn option for alloc backend\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:306
-msgid "Failed to store secret\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:311
-msgid "Secret stored\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:317
-msgid ""
-"net idmap dump <inputfile>\n"
-"    Dump current id mapping\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:320
-msgid ""
-"net idmap restore\n"
-"    Restore entries from stdin\n"
-msgstr ""
-
-#. Deliberately *not* document net idmap delete
-#: ../../utils/net_idmap.c:325
-msgid ""
-"net idmap secret <DOMAIN>|alloc <secret>\n"
-"    Set the secret for the specified DOMAIN (or the alloc module)\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:355
-#, c-format
-msgid "db_open failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:360 ../../utils/net_idmap.c:365
-#, c-format
-msgid "%s is not a valid sid\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:371
-msgid "talloc_strdup failed\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:377
-msgid "could not fetch db record\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:385
-#, c-format
-msgid "could not store record: %s\n"
-msgstr ""
-
-#: ../../utils/net_idmap.c:406
-msgid "Dump the current ID mappings"
-msgstr ""
-
-#: ../../utils/net_idmap.c:407
-msgid ""
-"net idmap dump\n"
-"  Dump the current ID mappings"
-msgstr ""
-
-#: ../../utils/net_idmap.c:414
-msgid "Restore entries from stdin"
-msgstr ""
-
-#: ../../utils/net_idmap.c:415
-msgid ""
-"net idmap restore\n"
-"  Restore entries from stdin"
-msgstr ""
-
-#: ../../utils/net_idmap.c:423
-msgid ""
-"net idmap setmap\n"
-"  Not implemented yet"
-msgstr ""
-
-#: ../../utils/net_idmap.c:431
-msgid ""
-"net idmap delete\n"
-"  Not implemented yet"
-msgstr ""
-
-#: ../../utils/net_idmap.c:438
-msgid "Set secret for specified domain"
-msgstr ""
-
-#: ../../utils/net_idmap.c:439
-msgid ""
-"net idmap secret {<DOMAIN>|alloc} <secret>\n"
-"  Set secret for specified domain or alloc module"
-msgstr ""
-
-#: ../../utils/net_idmap.c:446
-msgid "Set acl map"
-msgstr ""
-
-#: ../../utils/net_idmap.c:447
-msgid ""
-"net idmap aclmapset\n"
-"  Set acl map"
-msgstr ""
-
-#: ../../utils/net_join.c:26
-msgid ""
-"\n"
-"net [<method>] join [misc. options]\n"
-"\tjoins this server to a domain\n"
-msgstr ""
-
-#: ../../utils/net_join.c:47
-msgid "ADS join did not work, falling back to RPC...\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:25
-msgid ""
-"  net lookup [host] HOSTNAME[#<type>]\n"
-"\tgives IP for a hostname\n"
-"\n"
-"  net lookup ldap [domain]\n"
-"\tgives IP of domain's ldap server\n"
-"\n"
-"  net lookup kdc [realm]\n"
-"\tgives IP of realm's kerberos KDC\n"
-"\n"
-"  net lookup pdc [domain|realm]\n"
-"\tgives IP of realm's kerberos KDC\n"
-"\n"
-"  net lookup dc [domain]\n"
-"\tgives IP of domains Domain Controllers\n"
-"\n"
-"  net lookup master [domain|wg]\n"
-"\tgive IP of master browser\n"
-"\n"
-"  net lookup name [name]\n"
-"\tLookup name's sid and type\n"
-"\n"
-"  net lookup sid [sid]\n"
-"\tGive sid's name and type\n"
-"\n"
-"  net lookup dsgetdcname [name] [flags] [sitename]\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:113 ../../utils/net_registry.c:261 ../../utils/net_registry.c:268 ../../utils/net_rpc.c:82 ../../utils/net_rpc.c:93 ../../utils/net_rpc.c:1589 ../../utils/net_rpc.c:4051 ../../utils/net_util.c:53
-msgid "failed"
-msgstr ""
-
-#: ../../utils/net_lookup.c:328
-msgid " net lookup name <name>\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:334 ../../utils/net_lookup.c:363
-#, c-format
-msgid "Could not lookup name %s\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:352
-msgid " net lookup sid <sid>\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:357
-#, c-format
-msgid "Could not convert %s to SID\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:385
-msgid " net lookup dsgetdcname <name> <flags> <sitename>\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:411
-#, c-format
-msgid "failed with: %s\n"
-msgstr ""
-
-#: ../../utils/net_lookup.c:444
-msgid ""
-"\n"
-"Usage: \n"
-msgstr ""
-
-#: ../../utils/net_rap.c:39
-msgid ""
-"\n"
-"Not implemented\n"
-msgstr ""
-"\n"
-"Nicht implementiert\n"
-
-#: ../../utils/net_rap.c:61
-#, c-format
-msgid ""
-"File ID          %d\n"
-"User name        %s\n"
-"Locks            0x%-4.2x\n"
-"Path             %s\n"
-"Permissions      0x%x\n"
-msgstr ""
-
-#. list open files
-#: ../../utils/net_rap.c:114
-msgid ""
-"\n"
-"Enumerating open files on remote server:\n"
-"\n"
-"\n"
-"FileId  Opened by            Perms  Locks  Path \n"
-"------  ---------            -----  -----  ---- \n"
-msgstr ""
-
-#: ../../utils/net_rap.c:120 ../../utils/net_rap.c:180
-msgid ""
-"\n"
-"Operation not supported by server!\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:133
-msgid "Close specified file on server"
-msgstr ""
-
-#: ../../utils/net_rap.c:134
-msgid ""
-"net rap file close\n"
-"    Close specified file on server"
-msgstr ""
-
-#: ../../utils/net_rap.c:141
-msgid "List all files opened by username"
-msgstr ""
-
-#: ../../utils/net_rap.c:142
-msgid ""
-"net rap file user\n"
-"    List all files opened by username"
-msgstr ""
-
-#: ../../utils/net_rap.c:149
-msgid "Display info about an opened file"
-msgstr ""
-
-#: ../../utils/net_rap.c:150
-msgid ""
-"net rap file info\n"
-"    Display info about an opened file"
-msgstr ""
-
-#: ../../utils/net_rap.c:162
-msgid ""
-"net rap file\n"
-"    List all open files on rempte server\n"
-msgstr ""
-
-#. list open files
-#: ../../utils/net_rap.c:174
-msgid ""
-"\n"
-"Enumerating open files on remote server:\n"
-"\n"
-"\n"
-"FileId  Opened by            Perms  Locks  Path\n"
-"------  ---------            -----  -----  ----\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:243
-msgid "Server path not specified\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:273 ../../utils/net_rap.c:281
-msgid "Delete a share from server"
-msgstr ""
-
-#: ../../utils/net_rap.c:274
-msgid ""
-"net rap share delete\n"
-"    Delete a share from server"
-msgstr ""
-
-#: ../../utils/net_rap.c:282
-msgid ""
-"net rap share close\n"
-"    Delete a share from server\n"
-"    Alias for net rap share delete"
-msgstr ""
-
-#: ../../utils/net_rap.c:290
-msgid "Add a share to server"
-msgstr ""
-
-#: ../../utils/net_rap.c:291
-msgid ""
-"net rap share add\n"
-"    Add a share to server"
-msgstr ""
-
-#: ../../utils/net_rap.c:303
-msgid ""
-"net rap share\n"
-"    List all shares on remote server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:314 ../../utils/net_rpc.c:3092
-msgid ""
-"\n"
-"Enumerating shared resources (exports) on remote server:\n"
-"\n"
-"\n"
-"Share name   Type     Description\n"
-"----------   ----     -----------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:331
-msgid ""
-"\n"
-"net rap session [misc. options] [targets]\n"
-"\tenumerates all active SMB/CIFS sessions on target server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:334
-msgid ""
-"\n"
-"net rap session DELETE <client_name> [misc. options] [targets] \n"
-"\tor\n"
-"net rap session CLOSE <client_name> [misc. options] [targets]\n"
-"\tDeletes (closes) a session from specified client to server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:339
-msgid ""
-"\n"
-"net rap session INFO <client_name>\n"
-"\tEnumerates all open files in specified session\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:369
-#, c-format
-msgid ""
-"User name       %-20.20s\n"
-"Computer        %-20.20s\n"
-"Guest logon     %-20.20s\n"
-"Client Type     %-40.40s\n"
-"Sess time       %2.2d:%2.2d:%2.2d\n"
-"Idle time       %2.2d:%2.2d:%2.2d\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:408
-msgid ""
-"Share name     Type     # Opens\n"
-"------------------------------------------------------------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:438
-msgid "Display information about session"
-msgstr ""
-
-#: ../../utils/net_rap.c:439
-msgid ""
-"net rap session info\n"
-"    Display information about session"
-msgstr ""
-
-#: ../../utils/net_rap.c:446 ../../utils/net_rap.c:455
-msgid "Close specified session"
-msgstr ""
-
-#: ../../utils/net_rap.c:447
-msgid ""
-"net rap session delete\n"
-"    Close specified session\n"
-"    Alias for net rap session close"
-msgstr ""
-
-#: ../../utils/net_rap.c:456
-msgid ""
-"net rap session close\n"
-"    Close specified session"
-msgstr ""
-
-#: ../../utils/net_rap.c:468
-msgid ""
-"net rap session\n"
-"    List all open sessions on remote server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:478
-msgid ""
-"Computer             User name            Client Type        Opens Idle time\n"
-"------------------------------------------------------------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:508
-msgid ""
-"net rap server name\n"
-"    Get the name of the server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:517
-msgid "cli_get_server_name failed\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:522
-#, c-format
-msgid "Server name = %s\n"
-msgstr "Servername = %s\n"
-
-#: ../../utils/net_rap.c:538
-msgid ""
-"net rap server domain\n"
-"    Enumerate servers in this domain/workgroup\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:546
-msgid ""
-"\n"
-"Enumerating servers in this domain or workgroup: \n"
-"\n"
-"\tServer name          Server description\n"
-"\t-------------        ----------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:563
-msgid "Get the name of the server"
-msgstr ""
-
-#: ../../utils/net_rap.c:564
-msgid ""
-"net rap server name\n"
-"    Get the name of the server"
-msgstr ""
-
-#: ../../utils/net_rap.c:571
-msgid "Get the servers in this domain/workgroup"
-msgstr ""
-
-#: ../../utils/net_rap.c:572
-msgid ""
-"net rap server domain\n"
-"    Get the servers in this domain/workgroup"
-msgstr ""
-
-#: ../../utils/net_rap.c:586
-msgid ""
-"net rap domain [misc. options] [target]\n"
-"\tlists the domains or workgroups visible on the current network\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:604
-msgid ""
-"\n"
-"Enumerating domains:\n"
-"\n"
-"\tDomain name          Server name of Browse Master\n"
-"\t-------------        ----------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:617
-msgid ""
-"net rap printq [misc. options] [targets]\n"
-"\tor\n"
-"net rap printq info [<queue_name>] [misc. options] [targets]\n"
-"\tlists the specified queue and jobs on the target server.\n"
-"\tIf the queue name is not specified, all queues are listed.\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:623
-msgid ""
-"net rap printq delete [<queue name>] [misc. options] [targets]\n"
-"\tdeletes the specified job number on the target server, or the\n"
-"\tprinter queue if no job number is specified\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:637
-#, c-format
-msgid "%-17.17s Queue %5d jobs                      "
-msgstr ""
-
-#: ../../utils/net_rap.c:642
-msgid "*Printer Active*\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:645
-msgid "*Printer Paused*\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:648
-msgid "*Printer error*\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:651
-msgid "*Delete Pending*\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:654 ../../utils/net_rap.c:680
-msgid "**UNKNOWN STATUS**\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:668
-msgid "Waiting\n"
-msgstr "Wartend\n"
-
-#: ../../utils/net_rap.c:671
-msgid "Held in queue\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:674
-msgid "Spooling\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:677
-msgid "Printing\n"
-msgstr "Druckend\n"
-
-#: ../../utils/net_rap.c:685
-#, c-format
-msgid ""
-"Print queues at \\\\%s\n"
-"\n"
-"Name                         Job #      Size            Status\n"
-"\n"
-"-------------------------------------------------------------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:733
-msgid "Display info about print queues and jobs"
-msgstr ""
-
-#: ../../utils/net_rap.c:734
-msgid ""
-"net rap printq info [queue]\n"
-"    Display info about print jobs in queue.\n"
-"    If queue is not specified, all queues are listed"
-msgstr ""
-
-#: ../../utils/net_rap.c:743
-msgid "Delete print job(s)"
-msgstr ""
-
-#: ../../utils/net_rap.c:744
-msgid ""
-"net rap printq delete\n"
-"    Delete print job(s)"
-msgstr ""
-
-#: ../../utils/net_rap.c:753
-msgid ""
-"net rap printq\n"
-"    List the print queue\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:866 ../../utils/net_rpc.c:945
-msgid "Add specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:867
-msgid ""
-"net rap user add\n"
-"    Add specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:874
-msgid "List domain groups of specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:875
-msgid ""
-"net rap user info\n"
-"    List domain groups of specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:883 ../../utils/net_rpc.c:961
-msgid "Remove specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:884
-msgid ""
-"net rap user delete\n"
-"    Remove specified user"
-msgstr ""
-
-#: ../../utils/net_rap.c:894
-msgid ""
-"net rap user\n"
-"    List all users\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:917
-#, c-format
-msgid "Net user returned: %d\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:985
-msgid "Add specified group"
-msgstr ""
-
-#: ../../utils/net_rap.c:986
-msgid ""
-"net rap group add\n"
-"    Add specified group"
-msgstr ""
-
-#: ../../utils/net_rap.c:993 ../../utils/net_rpc.c:2786
-msgid "Delete specified group"
-msgstr ""
-
-#: ../../utils/net_rap.c:994
-msgid ""
-"net rap group delete\n"
-"    Delete specified group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1005
-msgid ""
-"net rap group\n"
-"    List all groups\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1014
-msgid ""
-"Group name            Comment\n"
-"-----------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1031
-msgid ""
-"net rap groupmember LIST <group> [misc. options] [targets]\n"
-"\t Enumerate users in a group\n"
-"\n"
-"net rap groupmember DELETE <group> <user> [misc. options] [targets]\n"
-"\t Delete specified user from specified group\n"
-"\n"
-"net rap groupmember ADD <group> <user> [misc. options] [targets]\n"
-"\t Add specified user to specified group\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1098
-msgid "Add specified user to group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1099
-msgid ""
-"net rap groupmember add\n"
-"    Add specified user to group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1106
-msgid "List users in group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1107
-msgid ""
-"net rap groupmember list\n"
-"    List users in group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1114
-msgid "Remove user from group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1115
-msgid ""
-"net rap groupmember delete\n"
-"    Remove user from group"
-msgstr ""
-
-#: ../../utils/net_rap.c:1126
-msgid ""
-"net rap validate <username> [password]\n"
-"\tValidate user and password to check whether they can access target server or domain\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1141
-msgid ""
-"net rap service [misc. options] [targets] \n"
-"\tlists all running service daemons on target server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1143
-msgid ""
-"\n"
-"net rap service START <name> [service startup arguments] [misc. options] [targets]\n"
-"\tStart named service on remote server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1146
-msgid ""
-"\n"
-"net rap service STOP <name> [misc. options] [targets]\n"
-"\n"
-"\tStop named service on remote server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1176
-msgid "Start service on remote server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1177
-msgid ""
-"net rap service start\n"
-"    Start service on remote server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1184
-msgid "Stop named serve on remote server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1185
-msgid ""
-"net rap service stop\n"
-"    Stop named serve on remote server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1196
-msgid ""
-"net rap service\n"
-"    List services on remote server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1206
-msgid ""
-"Service name          Comment\n"
-"-----------------------------\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1221
-msgid ""
-"net rap password <user> <oldpwo> <newpw> [misc. options] [target]\n"
-"\tchanges the password for the specified user at target\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1248
-msgid ""
-"net rap admin <remote command> [cmd args [env]] [misc. options] [targets]\n"
-"\texecutes a remote command on an os/2 target server\n"
-msgstr ""
-
-#: ../../utils/net_rap.c:1269 ../../utils/net_rpc.c:7253
-msgid "List open files"
-msgstr ""
-
-#: ../../utils/net_rap.c:1270
-msgid ""
-"net rap file\n"
-"    List open files"
-msgstr ""
-
-#: ../../utils/net_rap.c:1277
-msgid "List shares exported by server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1278
-msgid ""
-"net rap share\n"
-"    List shares exported by server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1285
-msgid "List open sessions"
-msgstr ""
-
-#: ../../utils/net_rap.c:1286
-msgid ""
-"net rap session\n"
-"    List open sessions"
-msgstr ""
-
-#: ../../utils/net_rap.c:1294
-msgid ""
-"net rap server\n"
-"    List servers in domain/workgroup"
-msgstr ""
-
-#: ../../utils/net_rap.c:1301
-msgid "List domains in network"
-msgstr ""
-
-#: ../../utils/net_rap.c:1302
-msgid ""
-"net rap domain\n"
-"    List domains in network"
-msgstr ""
-
-#: ../../utils/net_rap.c:1309
-msgid "List printer queues on server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1310
-msgid ""
-"net rap printq\n"
-"    List printer queues on server"
-msgstr ""
-
-#: ../../utils/net_rap.c:1317
-msgid "List users"
-msgstr ""
-
-#: ../../utils/net_rap.c:1318
-msgid ""
-"net rap user\n"
-"    List users"
-msgstr ""
-
-#: ../../utils/net_rap.c:1325
-msgid "List user groups"
-msgstr ""
-
-#: ../../utils/net_rap.c:1326
-msgid ""
-"net rap group\n"
-"    List user groups"
-msgstr ""
-
-#: ../../utils/net_rap.c:1333
-msgid "Check username/password"
-msgstr ""
-
-#: ../../utils/net_rap.c:1334
-msgid ""
-"net rap validate\n"
-"    Check username/password"
-msgstr ""
-
-#: ../../utils/net_rap.c:1341
-msgid "List/modify group memberships"
-msgstr ""
-
-#: ../../utils/net_rap.c:1342
-msgid ""
-"net rap groupmember\n"
-"    List/modify group memberships"
-msgstr ""
-
-#: ../../utils/net_rap.c:1349
-msgid "Execute commands on remote OS/2"
-msgstr ""
-
-#: ../../utils/net_rap.c:1350
-msgid ""
-"net rap admin\n"
-"    Execute commands on remote OS/2"
-msgstr ""
-
-#: ../../utils/net_rap.c:1357
-msgid "Start/stop remote service"
-msgstr ""
-
-#: ../../utils/net_rap.c:1358
-msgid ""
-"net rap service\n"
-"    Start/stop remote service"
-msgstr ""
-
-#: ../../utils/net_rap.c:1365 ../../utils/net_rpc.c:969
-msgid "Change user password"
-msgstr ""
-
-#: ../../utils/net_rap.c:1366
-msgid ""
-"net rap password\n"
-"    Change user password"
-msgstr ""
-
-#: ../../utils/net_registry.c:94 ../../utils/net_registry.c:204
-#, c-format
-msgid "open_hive failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:101
-#, c-format
-msgid "reg_openkey failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:135
-msgid "net registry enumerate <path>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:137 ../../utils/net_registry.c:192 ../../utils/net_registry.c:249 ../../utils/net_registry.c:446 ../../utils/net_rpc_registry.c:834 ../../utils/net_rpc_registry.c:1216
-msgid "Example:"
-msgstr ""
-
-#: ../../utils/net_registry.c:138
-msgid "net registry enumerate 'HKLM\\Software\\Samba'\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:144 ../../utils/net_registry.c:298 ../../utils/net_registry.c:370 ../../utils/net_registry.c:405 ../../utils/net_registry.c:457
-#, c-format
-msgid "open_key failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:190
-msgid "net registry createkey <path>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:193
-msgid "net registry createkey 'HKLM\\Software\\Samba\\smbconf.127.0.0.1'\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:198 ../../utils/net_registry.c:255
-msgid "error: zero length key name given\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:212
-#, c-format
-msgid "reg_createkey failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:218 ../../utils/net_rpc_registry.c:727
-msgid "createkey did nothing -- huh?\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:221 ../../utils/net_rpc_registry.c:730
-#, c-format
-msgid "createkey created %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:224 ../../utils/net_rpc_registry.c:733
-#, c-format
-msgid "createkey opened existing %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:247
-msgid "net registry deletekey <path>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:250
-msgid "net registry deletekey 'HKLM\\Software\\Samba\\smbconf.127.0.0.1'\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:292 ../../utils/net_rpc_registry.c:647 ../../utils/net_rpc_registry.c:675
-msgid "net rpc registry getvalue <key> <valuename>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:304
-#, c-format
-msgid "reg_queryvalue failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:342 ../../utils/net_rpc_registry.c:476
-msgid "net rpc registry setvalue <key> <valuename> <type> [<val>]+\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:348 ../../utils/net_rpc_registry.c:436
-#, c-format
-msgid "Too many args for type %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:364 ../../utils/net_rpc_registry.c:450
-#, c-format
-msgid "type \"%s\" not implemented\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:376
-#, c-format
-msgid "reg_setvalue failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:399 ../../utils/net_rpc_registry.c:531
-msgid "net rpc registry deletevalue <key> <valuename>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:411
-#, c-format
-msgid "reg_deletekey failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:444
-msgid "net registry getsd <path>\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:447
-msgid "net registry getsd 'HKLM\\Software\\Samba'\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:463
-#, c-format
-msgid "reg_getkeysecurity failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_registry.c:486 ../../utils/net_rpc_registry.c:1287
-msgid "Enumerate registry keys and values"
-msgstr ""
-
-#: ../../utils/net_registry.c:487
-msgid ""
-"net registry enumerate\n"
-"    Enumerate registry keys and values"
-msgstr ""
-
-#: ../../utils/net_registry.c:494 ../../utils/net_rpc_registry.c:1295
-msgid "Create a new registry key"
-msgstr ""
-
-#: ../../utils/net_registry.c:495
-msgid ""
-"net registry createkey\n"
-"    Create a new registry key"
-msgstr ""
-
-#: ../../utils/net_registry.c:502 ../../utils/net_rpc_registry.c:1303
-msgid "Delete a registry key"
-msgstr ""
-
-#: ../../utils/net_registry.c:503
-msgid ""
-"net registry deletekey\n"
-"    Delete a registry key"
-msgstr ""
-
-#: ../../utils/net_registry.c:510 ../../utils/net_rpc_registry.c:1311 ../../utils/net_rpc_registry.c:1319
-msgid "Print a registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:511
-msgid ""
-"net registry getvalue\n"
-"    Print a registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:518
-msgid "Print a registry value (raw format)"
-msgstr ""
-
-#: ../../utils/net_registry.c:519
-msgid ""
-"net registry getvalueraw\n"
-"    Print a registry value (raw format)"
-msgstr ""
-
-#: ../../utils/net_registry.c:526 ../../utils/net_rpc_registry.c:1327
-msgid "Set a new registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:527
-msgid ""
-"net registry setvalue\n"
-"    Set a new registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:534 ../../utils/net_rpc_registry.c:1335
-msgid "Delete a registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:535
-msgid ""
-"net registry deletevalue\n"
-"    Delete a registry value"
-msgstr ""
-
-#: ../../utils/net_registry.c:542 ../../utils/net_rpc_registry.c:1367
-msgid "Get security descriptor"
-msgstr ""
-
-#: ../../utils/net_registry.c:543
-msgid ""
-"net registry getsd\n"
-"    Get security descriptor"
-msgstr ""
-
-#: ../../utils/net_registry_util.c:28
-#, c-format
-msgid "Keyname   = %s\n"
-msgstr ""
-
-#: ../../utils/net_registry_util.c:29
-#, c-format
-msgid "Modtime   = %s\n"
-msgstr ""
-
-#: ../../utils/net_registry_util.c:32
-msgid "None"
-msgstr "Kein"
-
-#: ../../utils/net_registry_util.c:39
-#, c-format
-msgid "Type       = %s\n"
-msgstr "Typ        = %s\n"
-
-#: ../../utils/net_registry_util.c:45 ../../utils/net_registry_util.c:76 ../../utils/net_registry_util.c:82
-msgid "Value      = "
-msgstr "Wert      = "
-
-#: ../../utils/net_registry_util.c:52
-msgid "Value      = \""
-msgstr "Wert      = \""
-
-#: ../../utils/net_registry_util.c:64
-#, c-format
-msgid "Value[%3.3d] = \""
-msgstr ""
-
-#: ../../utils/net_registry_util.c:78
-#, c-format
-msgid "%d bytes\n"
-msgstr "%d Bytes\n"
-
-#: ../../utils/net_registry_util.c:84
-msgid "<unprintable>\n"
-msgstr "<nicht druckbar>\n"
-
-#: ../../utils/net_registry_util.c:92
-#, c-format
-msgid "Valuename  = %s\n"
-msgstr "Wertname  = %s\n"
-
-#: ../../utils/net_rpc.c:73 ../../utils/net_util.c:45
-msgid "Could not initialise lsa pipe\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:256
-#, c-format
-msgid "Failed to change machine account password: %s\n"
-msgstr "Konnte Passwort fr Vertrauenskonto nicht ndern: %s\n"
-
-#: ../../utils/net_rpc.c:281
-msgid "Change the machine trust password"
-msgstr "Passwort von Vertrauenskonto ndern"
-
-#: ../../utils/net_rpc.c:364 ../../utils/net_rpc_join.c:477
-#, c-format
-msgid "Joined domain %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:414
-msgid "Join a domain the old way"
-msgstr "Einer Domne auf altem Weg beitreten"
-
-#: ../../utils/net_rpc.c:421
-msgid "Failed to join domain\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:444
-#, c-format
-msgid ""
-"net rpc join -U <username>[%%password] <type>\n"
-"  Join a domain\n"
-"    username\tName of the admin user    password\tPassword of the admin user, will prompt if not specified\n"
-"    type\tCan be one of the following:\n"
-"\t\tMEMBER\tJoin as member server (default)\n"
-"\t\tBDC\tJoin as BDC\n"
-"\t\tPDC\tJoin as PDC\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:457
-msgid "cannot join as standalone machine\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:512
-#, c-format
-msgid "Could not connect to SAM: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:524
-#, c-format
-msgid "Could not open domain: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:534
-#, c-format
-msgid "Domain Name: %s\n"
-msgstr "Domnenname: %s\n"
-
-#: ../../utils/net_rpc.c:536
-#, c-format
-msgid "Domain SID: %s\n"
-msgstr "Domnen SID: %s\n"
-
-#: ../../utils/net_rpc.c:537
-#, c-format
-msgid "Sequence number: %llu\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:539
-#, c-format
-msgid "Num users: %u\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:540
-#, c-format
-msgid "Num domain groups: %u\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:541
-#, c-format
-msgid "Num local groups: %u\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:562
-msgid "Display information about the domain"
-msgstr ""
-
-#: ../../utils/net_rpc.c:599
-#, c-format
-msgid "Storing SID %s for Domain %s in secrets.tdb\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:630
-msgid "Fetch domain SID into local secrets.tdb"
-msgstr "SID der Domne nach secrets.tdb bertragen"
-
-#: ../../utils/net_rpc.c:685
-#, c-format
-msgid "Failed to add user '%s' with error: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:690
-#, c-format
-msgid "Added user '%s'.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:723
-#, c-format
-msgid "Failed to rename user from %s to %s - %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:727
-#, c-format
-msgid "Renamed user from %s to %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:755
-#, c-format
-msgid "Failed to delete user '%s' with: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:760
-#, c-format
-msgid "Deleted user '%s'.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:806
-#, c-format
-msgid "Failed to set password for '%s' with error: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:849
-#, c-format
-msgid "Failed to get groups for '%s' with error: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:946
-msgid ""
-"net rpc user add\n"
-"    Add specified user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:953
-msgid "List domain groups of user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:954
-msgid ""
-"net rpc user info\n"
-"    List domain groups of user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:962
-msgid ""
-"net rpc user delete\n"
-"    Remove specified user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:970
-msgid ""
-"net rpc user password\n"
-"    Change user password"
-msgstr ""
-
-#: ../../utils/net_rpc.c:977
-msgid "Rename specified user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:978
-msgid ""
-"net rpc user rename\n"
-"    Rename specified user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1000
-msgid "List all users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1061
-#, c-format
-msgid "Could not lookup %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1067 ../../utils/net_sam.c:53 ../../utils/net_sam.c:159 ../../utils/net_sam.c:251
-#, c-format
-msgid "%s is a %s, not a user\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1074
-#, c-format
-msgid "%s is not in our domain\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1144
-#, c-format
-msgid "user rid: %d, group rid: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1208
-#, c-format
-msgid "%s's %s: [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1230
-#, c-format
-msgid "Set %s's %s from [%s] to [%s]\n"
-msgstr ""
-
-#. TRANSATORS: The yes|no here are program keywords. Please do
-#. not translate.
-#: ../../utils/net_rpc.c:1276
-#, c-format
-msgid "Usage: %s <username> [yes|no]\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1301
-#, c-format
-msgid "%s's %s flag: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1317
-#, c-format
-msgid "Set %s's %s flag from [%s] to [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1343
-msgid "Show/Set a user's full name"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1346
-msgid "Show/Set a user's home directory"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1349
-msgid "Show/Set a user's home drive"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1352
-msgid "Show/Set a user's logon script"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1355
-msgid "Show/Set a user's profile path"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1358
-msgid "Show/Set a user's description"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1361
-msgid "Show/Set whether a user is disabled"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1364
-msgid "Show/Set whether a user locked out"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1367
-msgid "Show/Set whether a user does not need a password"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1370
-msgid "Show/Set whether a user's password does not expire"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1385
-msgid "List available users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1388
-msgid "List the domain groups a user is member of"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1391
-msgid "Show info about a user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1394
-msgid "Show/Modify a user's fields"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1465
-msgid "Request samr_Connect2 failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1476
-msgid "Request open_domain failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1489
-#, c-format
-msgid "Lookup of '%s' failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1502
-msgid "Request open_group failed"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1514
-#, c-format
-msgid "Unable to query group members of %s"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1521
-#, c-format
-msgid "Domain Group %s (rid: %d) has %d members\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1536
-#, c-format
-msgid "Unable to open group member %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1548
-#, c-format
-msgid "Unable to lookup userinfo for group member %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1556
-#, c-format
-msgid "Group is primary group of %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1567
-msgid "Unable to delete group because some of it's members have it as primary group\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1578
-#, c-format
-msgid "Remove group member %d..."
-msgstr ""
-
-#: ../../utils/net_rpc.c:1586 ../../utils/net_rpc_registry.c:1104 ../../utils/net_rpc_registry.c:1124 ../../utils/net_rpc_registry.c:1150 ../../utils/net_rpc_registry.c:1157 ../../utils/net_rpc_registry.c:1177 ../../utils/net_rpc_registry.c:1183
-msgid "ok\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1607
-msgid "Request open_alias failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1615
-#, c-format
-msgid "%s is of type %s. This command is only for deleting local or global groups\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1624
-#, c-format
-msgid "Deleted %s '%s'\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1627
-#, c-format
-msgid "Deleting of %s failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1664
-#, c-format
-msgid "Failed to add group '%s' with error: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1669
-#, c-format
-msgid "Added group '%s'.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1697
-#, c-format
-msgid "Failed to add alias '%s' with error: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1702
-#, c-format
-msgid "Added alias '%s'.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1822 ../../utils/net_rpc.c:1872 ../../utils/net_rpc.c:2030 ../../utils/net_rpc.c:2077
-#, c-format
-msgid "Could not lookup up group member %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1934
-msgid ""
-"net rpc group addmem <group> <member>\n"
-"  Add a member to a group\n"
-"    group\tGroup to add member to\n"
-"    member\tMember to add to group\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1943 ../../utils/net_rpc.c:2146
-#, c-format
-msgid "Could not lookup group name %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1953 ../../utils/net_rpc.c:1964
-#, c-format
-msgid "Could not add %s to %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:1970
-#, c-format
-msgid "Can only add members to global or local groups which %s is not\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2137
-msgid ""
-"net rpc group delmem <group> <member>\n"
-"  Delete a member from a group\n"
-"    group\tGroup to delete member from\n"
-"    member\tMember to delete from group\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2156 ../../utils/net_rpc.c:2167
-#, c-format
-msgid "Could not del %s from %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2173
-#, c-format
-msgid "Can only delete members from global or local groups which %s is not\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2222
-msgid ""
-"net rpc group list [global] [local] [builtin]\n"
-"  List groups on RPC server\n"
-"    global\tList global groups\n"
-"    local\tList local groups\n"
-"    builtin\tList builtin groups\n"
-"    If none of global, local or builtin is specified, all three options are considered set\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2542
-msgid "Couldn't list alias members\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2556
-#, c-format
-msgid "Couldn't open LSA pipe. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2565
-msgid "Couldn't open LSA policy handle\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2572
-msgid "Out of memory\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2587
-msgid "Couldn't lookup SIDs\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2598 ../../utils/net_rpc.c:2599
-msgid "*unknown*"
-msgstr "*unbekannt*"
-
-#: ../../utils/net_rpc.c:2673 ../../utils/net_rpc.c:2686 ../../utils/net_rpc.c:2693
-#, c-format
-msgid "Couldn't find group %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2744
-#, c-format
-msgid "Renaming group %s failed with: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2778
-msgid "Create specified group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2779
-msgid ""
-"net rpc group add\n"
-"    Create specified group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2787
-msgid ""
-"net rpc group delete\n"
-"    Delete specified group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2794
-msgid "Add member to group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2795
-msgid ""
-"net rpc group addmem\n"
-"    Add member to group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2802
-msgid "Remove member from group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2803
-msgid ""
-"net rpc group delmem\n"
-"    Remove member from group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2810
-msgid "List groups"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2811
-msgid ""
-"net rpc group list\n"
-"    List groups"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2818 ../../utils/net_sam.c:2085
-msgid "List group members"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2819
-msgid ""
-"net rpc group members\n"
-"    List group members"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2826
-msgid "Rename group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2827
-msgid ""
-"net rpc group rename\n"
-"    Rename group"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2846
-msgid ""
-"net rpc group\n"
-"    Alias for net rpc group list global local builtin\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:2918
-#, c-format
-msgid "NetShareAdd failed with: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3073
-msgid "List shares on remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3108
-#, c-format
-msgid "skipping   [%s]: not a file share.\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3114
-#, c-format
-msgid "cli_tdis returned %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3126
-#, c-format
-msgid "share [%s] is not a diskshare (type: %x)\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3138
-#, c-format
-msgid "excluding  [%s]\n"
-msgstr ""
-
-#. finally add the share on the dst server
-#: ../../utils/net_rpc.c:3205
-#, c-format
-msgid "migrating: [%s], path: %s, comment: %s, without share-ACLs\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3219
-#, c-format
-msgid "           [%s] does already exist\n"
-msgstr "           [%s] existiert bereits\n"
-
-#: ../../utils/net_rpc.c:3225
-#, c-format
-msgid "cannot add share: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3259
-msgid "Migrate shares to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3264 ../../utils/net_rpc.c:3599 ../../utils/net_rpc.c:3726 ../../utils/net_rpc.c:3761 ../../utils/net_rpc.c:6564 ../../utils/net_rpc.c:6620 ../../utils/net_rpc.c:6652 ../../utils/net_rpc.c:6684 ../../utils/net_rpc.c:6716
-#: ../../utils/net_rpc.c:6749
-#, c-format
-msgid "no server to migrate\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3324 ../../utils/net_rpc.c:3436 ../../utils/net_rpc.c:3519
-#, c-format
-msgid "Unsupported mode %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3329
-#, c-format
-msgid "could not handle dir %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3339
-#, c-format
-msgid "could not handle files\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3366
-#, c-format
-msgid "Unsupported file mode %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3372
-#, c-format
-msgid "could not handle file %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3395
-#, c-format
-msgid "cli_resolve_path %s failed with error: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3402
-#, c-format
-msgid "listing %s failed with error: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3441
-#, c-format
-msgid "Could handle directory attributes for top level directory of share %s. Error %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3508
-#, c-format
-msgid "skipping   [%s]: builtin/hidden share\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3523
-#, c-format
-msgid "    [%s] files and directories %s ACLs, %s DOS Attributes %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3526 ../../utils/net_rpc.c:3527
-msgid "including"
-msgstr "inklusive"
-
-#: ../../utils/net_rpc.c:3526 ../../utils/net_rpc.c:3527 ../../utils/net_rpc_printer.c:370 ../../utils/net_rpc_printer.c:371
-msgid "without"
-msgstr "ohne"
-
-#: ../../utils/net_rpc.c:3528 ../../utils/net_rpc_printer.c:372
-msgid "(preserving timestamps)"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3557
-#, c-format
-msgid "Could not handle the top level directory permissions for the share: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3565
-#, c-format
-msgid "could not handle files for share: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3594
-msgid "Migrate files to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3667
-#, c-format
-msgid "migrating: [%s], path: %s, comment: %s, including share-ACLs\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3686
-#, c-format
-msgid "cannot set share-acl: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3721
-msgid "Migrate share-acls to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3756
-msgid "Migrates shares including all share settings"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3798 ../../utils/net_rpc.c:3822
-msgid "Migrate shares from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3799
-msgid ""
-"net rpc share migrate all\n"
-"    Migrate shares from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3806
-msgid "Migrate files from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3807
-msgid ""
-"net rpc share migrate files\n"
-"    Migrate files from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3814
-msgid "Migrate share-ACLs from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3815
-msgid ""
-"net rpc share migrate security\n"
-"    Migrate share-ACLs from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:3823
-msgid ""
-"net rpc share migrate shares\n"
-"    Migrate shares from remote to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4238
-msgid "winbind use default domain = yes set, please specify a workgroup\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4247
-#, c-format
-msgid "winbind could not list users: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4561
-msgid "List allowed users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4609
-msgid ""
-"net usersidlist\n"
-"\tprints out a list of all users the running winbind knows\n"
-"\tabout, together with all their SIDs. This is used as\n"
-"\tinput to the 'net rpc share allowedusers' command.\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4634
-msgid "Add share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4635
-msgid ""
-"net rpc share add\n"
-"    Add share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4642
-msgid "Remove share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4643
-msgid ""
-"net rpc share delete\n"
-"    Remove share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4650
-msgid "Modify allowed users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4651
-msgid ""
-"net rpc share allowedusers\n"
-"    Modify allowed users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4658
-msgid "Migrate share to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4659
-msgid ""
-"net rpc share migrate\n"
-"    Migrate share to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4666
-msgid "List shares"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4667
-msgid ""
-"net rpc share list\n"
-"    List shares"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4687
-msgid ""
-"net rpc share\n"
-"    List shares\n"
-"    Alias for net rpc share list\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4721
-#, c-format
-msgid "Usage: %s <share> <path> [comment]\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4782
-#, c-format
-msgid "Name:     %s\n"
-msgstr "Name:     %s\n"
-
-#: ../../utils/net_rpc.c:4783
-#, c-format
-msgid "Comment:  %s\n"
-msgstr "Kommentar:  %s\n"
-
-#: ../../utils/net_rpc.c:4784
-#, c-format
-msgid "Path:     %s\n"
-msgstr "Pfad:     %s\n"
-
-#: ../../utils/net_rpc.c:4785
-#, c-format
-msgid "Password: %s\n"
-msgstr "Passwort: %s\n"
-
-#: ../../utils/net_rpc.c:4797
-msgid "List available shares"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4800
-msgid "Add a share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4803
-msgid "Delete a share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4806
-msgid "Get information about a share"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4898
-msgid ""
-"\n"
-"Enumerating open files on remote server:\n"
-"\n"
-"\n"
-"FileId  Opened by            Perms  Locks  Path\n"
-"------  ---------            -----  -----  ---- \n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4924
-msgid "Close opened file"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4925
-msgid ""
-"net rpc file close\n"
-"    Close opened file"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4932
-msgid "List files opened by user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4933
-msgid ""
-"net rpc file user\n"
-"    List files opened by user"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4941
-msgid "Display information about opened file"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4942
-msgid ""
-"net rpc file info\n"
-"    Display information about opened file"
-msgstr ""
-
-#: ../../utils/net_rpc.c:4962
-msgid ""
-"net rpc file\n"
-"    List opened files\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5005 ../../utils/net_rpc.c:5044
-msgid ""
-"\n"
-"Shutdown successfully aborted\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5072
-msgid "Abort a scheduled shutdown"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5116 ../../utils/net_rpc.c:5169
-msgid "This machine will be shutdown shortly"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5135 ../../utils/net_rpc.c:5190
-msgid ""
-"\n"
-"Shutdown of remote machine succeeded\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5221
-msgid "Shut down a remote RPC server"
-msgstr "Einen entfernten RPC server herunterfahren"
-
-#: ../../utils/net_rpc.c:5280
-msgid " net rpc trustdom add <domain_name> <trust password>\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5342
-#, c-format
-msgid "net rpc trustdom add: create user %s failed %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5395
-msgid "net rpc trustdom add <domain_name> <trust password>\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5437
-msgid " net rpc trustdom del <domain_name>\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5480
-#, c-format
-msgid "net rpc trustdom del: LookupNames on user %s failed %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5493
-#, c-format
-msgid "net rpc trustdom del: OpenUser on user %s failed %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5510
-#, c-format
-msgid "net rpc trustdom del: RemoveMemberFromForeignDomain on user %s failed %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5522
-#, c-format
-msgid "net rpc trustdom del: DeleteUser on user %s failed %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5529
-#, c-format
-msgid "Could not set trust account password: %s\n"
-msgstr "Konnte Passwort fr Vertrauenskonto nicht stetzen: %s\n"
-
-#: ../../utils/net_rpc.c:5555
-msgid "net rpc trustdom del <domain>\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5639
-msgid "net rpc trustdom establish <domain_name>\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5781
-#, c-format
-msgid "Trust to domain %s established\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5804
-msgid ""
-"net rpc trustdom revoke <domain_name>\n"
-"  Revoke trust relationship\n"
-"    domain_name\tName of domain to revoke trust\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:5938
-msgid "Vampire trust relationship from remote server"
-msgstr ""
-
-#.
-#. * Keep calling LsaEnumTrustdom over opened pipe until
-#. * the end of enumeration is reached
-#.
-#: ../../utils/net_rpc.c:6012
-msgid ""
-"Vampire trusted domains:\n"
-"\n"
-msgstr ""
-
-#.
-#. * in case of no trusted domains say something rather
-#. * than just display blank line
-#.
-#: ../../utils/net_rpc.c:6047 ../../utils/net_rpc.c:6203
-msgid "none\n"
-msgstr "kein\n"
-
-#: ../../utils/net_rpc.c:6097
-msgid "List incoming and outgoing trust relationships"
-msgstr ""
-
-#.
-#. * Keep calling LsaEnumTrustdom over opened pipe until
-#. * the end of enumeration is reached
-#.
-#: ../../utils/net_rpc.c:6171
-msgid ""
-"Trusted domains list:\n"
-"\n"
-msgstr ""
-
-#.
-#. * Listing trusting domains (stored in passdb backend, if local)
-#.
-#: ../../utils/net_rpc.c:6222
-msgid ""
-"\n"
-"Trusting domains list:\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6323
-msgid "strange - couldn't get domain's sid\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6328
-#, c-format
-msgid "domain controller is not responding: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6331
-msgid "couldn't get domain's sid\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6375
-msgid "Add trusting domain's account"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6376
-msgid ""
-"net rpc trustdom add\n"
-"    Add trusting domain's account"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6383
-msgid "Remove trusting domain's account"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6384
-msgid ""
-"net rpc trustdom del\n"
-"    Remove trusting domain's account"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6391
-msgid "Establish outgoing trust relationship"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6392
-msgid ""
-"net rpc trustdom establish\n"
-"    Establish outgoing trust relationship"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6399
-msgid "Revoke outgoing trust relationship"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6400
-msgid ""
-"net rpc trustdom revoke\n"
-"    Revoke outgoing trust relationship"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6407
-msgid "List in- and outgoing domain trusts"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6408
-msgid ""
-"net rpc trustdom list\n"
-"    List in- and outgoing domain trusts"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6415
-msgid "Vampire trusts from remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6416
-msgid ""
-"net rpc trustdom vampire\n"
-"    Vampire trusts from remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6472
-msgid "Dump remote SAM database"
-msgstr "Entfernte SAM Datenbank ausgeben"
-
-#: ../../utils/net_rpc.c:6489
-msgid "Dump remote SAM database to ldif"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6490
-msgid ""
-"net rpc vampire ldif\n"
-"    Dump remote SAM database to LDIF file or stdout"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6498
-msgid "Dump remote SAM database to Kerberos Keytab"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6499
-msgid ""
-"net rpc vampire keytab\n"
-"    Dump remote SAM database to Kerberos keytab file"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6507 ../../utils/net_rpc_samsync.c:259
-msgid "Dump remote SAM database to passdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6508
-msgid ""
-"net rpc vampire passdb\n"
-"    Dump remote SAM database to passdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6521
-msgid "Vampire remote SAM database"
-msgstr "Entfernte SAM Datenbank bernehmen"
-
-#: ../../utils/net_rpc.c:6559
-msgid "Migrate everything from a print server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6615
-msgid "Migrate print-drivers from a print-server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6647
-msgid "Migrate print-forms from a print-server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6679
-msgid "Migrate printers from a print-server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6711
-msgid "Migrate printer-ACLs from a print-server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6743
-msgid "Migrate printer-settings from a print-server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6779
-msgid "Migrate all from remote to local print server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6780
-msgid ""
-"net rpc printer migrate all\n"
-"    Migrate all from remote to local print server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6787
-msgid "Migrate drivers to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6788
-msgid ""
-"net rpc printer migrate drivers\n"
-"    Migrate drivers to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6795
-msgid "Migrate froms to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6796
-msgid ""
-"net rpc printer migrate forms\n"
-"    Migrate froms to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6803
-msgid "Migrate printers to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6804
-msgid ""
-"net rpc printer migrate printers\n"
-"    Migrate printers to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6811
-msgid "Mirgate printer ACLs to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6812
-msgid ""
-"net rpc printer migrate security\n"
-"    Mirgate printer ACLs to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6819
-msgid "Migrate printer settings to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6820
-msgid ""
-"net rpc printer migrate settings\n"
-"    Migrate printer settings to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6847
-msgid "List printers on a remote RPC server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6874
-msgid "List printer-drivers on a remote RPC server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:6901
-msgid "Publish printer in ADS via MSRPC"
-msgstr "Drucker in AD ber MSRPC freigeben"
-
-#: ../../utils/net_rpc.c:6927
-msgid "Update printer in ADS via MSRPC"
-msgstr "Drucker in AD ber MSRPC aktualisieren"
-
-#: ../../utils/net_rpc.c:6954
-msgid "UnPublish printer in ADS via MSRPC"
-msgstr "Freigabe eines Druckers in AD ber MSRPC entfernen"
-
-#: ../../utils/net_rpc.c:6981
-msgid "List published printers via MSRPC"
-msgstr "Freigegebene Drucker in AD ber MSRPC auflisten"
-
-#: ../../utils/net_rpc.c:7010 ../../utils/net_rpc.c:7139
-msgid "Publish printer in AD"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7011
-msgid ""
-"net rpc printer publish publish\n"
-"    Publish printer in AD"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7018
-msgid "Update printer in AD"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7019
-msgid ""
-"net rpc printer publish update\n"
-"    Update printer in AD"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7026
-msgid "Unpublish printer"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7027
-msgid ""
-"net rpc printer publish unpublish\n"
-"    Unpublish printer"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7034
-msgid "List published printers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7035
-msgid ""
-"net rpc printer publish list\n"
-"    List published printers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7044
-msgid ""
-"net rpc printer publish\n"
-"    List published printers\n"
-"    Alias of net rpc printer publish list\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7071
-msgid ""
-"net rpc printer LIST [printer] [misc. options] [targets]\n"
-"\tlists all printers on print-server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7073
-msgid ""
-"net rpc printer DRIVER [printer] [misc. options] [targets]\n"
-"\tlists all printer-drivers on print-server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7075
-msgid ""
-"net rpc printer PUBLISH action [printer] [misc. options] [targets]\n"
-"\tpublishes printer settings in Active Directory\n"
-"\taction can be one of PUBLISH, UPDATE, UNPUBLISH or LIST\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7078
-msgid ""
-"net rpc printer MIGRATE PRINTERS [printer] [misc. options] [targets]\n"
-"\tmigrates printers from remote to local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7080
-msgid ""
-"net rpc printer MIGRATE SETTINGS [printer] [misc. options] [targets]\n"
-"\tmigrates printer-settings from remote to local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7082
-msgid ""
-"net rpc printer MIGRATE DRIVERS [printer] [misc. options] [targets]\n"
-"\tmigrates printer-drivers from remote to local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7084
-msgid ""
-"net rpc printer MIGRATE FORMS [printer] [misc. options] [targets]\n"
-"\tmigrates printer-forms from remote to local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7086
-msgid ""
-"net rpc printer MIGRATE SECURITY [printer] [misc. options] [targets]\n"
-"\tmigrates printer-ACLs from remote to local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7088
-msgid ""
-"net rpc printer MIGRATE ALL [printer] [misc. options] [targets]\n"
-"\tmigrates drivers, forms, queues, settings and acls from\n"
-"\tremote to local print-server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7094
-msgid ""
-"\t-v or --verbose\t\t\tgive verbose output\n"
-"\t      --destination\t\tmigration target server (default: localhost)\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7115
-msgid "List all printers on print server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7116
-msgid ""
-"net rpc printer list\n"
-"    List all printers on print server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7123
-msgid "Migrate printer to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7124
-msgid ""
-"net rpc printer migrate\n"
-"    Migrate printer to local server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7131
-msgid "List printer drivers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7132
-msgid ""
-"net rpc printer driver\n"
-"    List printer drivers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7140
-msgid ""
-"net rpc printer publish\n"
-"    Publish printer in AD"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7149
-msgid ""
-"net rpc printer\n"
-"    List printers\n"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7180
-msgid "Modify global audit settings"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7181
-msgid ""
-"net rpc audit\n"
-"    Modify global audit settings"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7188
-msgid "Show basic info about a domain"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7189
-msgid ""
-"net rpc info\n"
-"    Show basic info about a domain"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7196
-msgid "Join a domain"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7197
-msgid ""
-"net rpc join\n"
-"    Join a domain"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7204
-msgid "Join a domain created in server manager"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7205
-msgid ""
-"net rpc oldjoin\n"
-"    Join a domain created in server manager"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7212
-msgid "Test that a join is valid"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7213
-msgid ""
-"net rpc testjoin\n"
-"    Test that a join is valid"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7221
-msgid ""
-"net rpc user\n"
-"    List/modify users"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7228
-msgid "Change a user password"
-msgstr "Benutzerpasswort ndern"
-
-#: ../../utils/net_rpc.c:7229
-msgid ""
-"net rpc password\n"
-"    Change a user password\n"
-"    Alias for net rpc user password"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7238
-msgid ""
-"net rpc group\n"
-"    List/modify groups"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7245
-msgid "List/modify shares"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7246
-msgid ""
-"net rpc share\n"
-"    List/modify shares"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7254
-msgid ""
-"net rpc file\n"
-"    List open files"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7261
-msgid "List/modify printers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7262
-msgid ""
-"net rpc printer\n"
-"    List/modify printers"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7270
-msgid ""
-"net rpc changetrustpw\n"
-"    Change trust account password"
-msgstr ""
-"net rpc changetrustpw\n"
-"    trust account Passwort ndern"
-
-#: ../../utils/net_rpc.c:7277
-msgid "Modify domain trusts"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7278
-msgid ""
-"net rpc trustdom\n"
-"    Modify domain trusts"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7285
-msgid "Abort a remote shutdown"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7286
-msgid ""
-"net rpc abortshutdown\n"
-"    Abort a remote shutdown"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7293
-msgid "Shutdown a remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7294
-msgid ""
-"net rpc shutdown\n"
-"    Shutdown a remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7301
-msgid "Dump SAM data of remote NT PDC"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7302
-msgid ""
-"net rpc samdump\n"
-"    Dump SAM data of remote NT PDC"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7309
-msgid "Sync a remote NT PDC's data into local passdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7310
-msgid ""
-"net rpc vampire\n"
-"    Sync a remote NT PDC's data into local passdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7317
-msgid "Fetch the domain sid into local secrets.tdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7318
-msgid ""
-"net rpc getsid\n"
-"    Fetch the domain sid into local secrets.tdb"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7325
-msgid "Manage privileges assigned to SID"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7326
-msgid ""
-"net rpc rights\n"
-"    Manage privileges assigned to SID"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7333
-msgid "Start/stop/query remote services"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7334
-msgid ""
-"net rpc service\n"
-"    Start/stop/query remote services"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7341
-msgid "Manage registry hives"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7342
-msgid ""
-"net rpc registry\n"
-"    Manage registry hives"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7349
-msgid "Open interactive shell on remote server"
-msgstr ""
-
-#: ../../utils/net_rpc.c:7350
-msgid ""
-"net rpc shell\n"
-"    Open interactive shell on remote server"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:28
-msgid "net rpc audit list                       View configured Auditing policies\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:29
-msgid "net rpc audit enable                     Enable Auditing\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:30
-msgid "net rpc audit disable                    Disable Auditing\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:31
-msgid "net rpc audit get <category>             View configured Auditing policy setting\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:32
-msgid ""
-"net rpc audit set <category> <policy>    Set Auditing policies\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:33
-msgid "\tcategory can be one of: SYSTEM, LOGON, OBJECT, PRIVILEGE, PROCESS, POLICY, SAM, DIRECTORY or ACCOUNT\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:34
-msgid ""
-"\tpolicy can be one of: SUCCESS, FAILURE, ALL or NONE\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:45 ../../utils/net_util.c:613
-msgid "Unknown"
-msgstr "Unbekannt"
-
-#: ../../utils/net_rpc_audit.c:48
-msgid "Invalid"
-msgstr "Ungltig"
-
-#: ../../utils/net_rpc_audit.c:51
-#, c-format
-msgid "\t%-30s%s\n"
-msgstr "\t%-30s%s\n"
-
-#: ../../utils/net_rpc_audit.c:73 ../../utils/net_rpc_audit.c:140
-msgid "insufficient arguments\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:79 ../../utils/net_rpc_audit.c:146
-#, c-format
-msgid "invalid auditing category: %s\n"
-msgstr "Ungltige Audit-Kategorie: %s\n"
-
-#: ../../utils/net_rpc_audit.c:115
-#, c-format
-msgid "failed to get auditing policy: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:161
-#, c-format
-msgid "invalid auditing policy: %s\n"
-msgstr "Ungltige Audit-Regel: %s\n"
-
-#: ../../utils/net_rpc_audit.c:205
-#, c-format
-msgid "failed to set audit policy: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:254
-#, c-format
-msgid "%s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:255
-msgid "failed to enable audit policy"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:256
-msgid "failed to disable audit policy"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:328
-#, c-format
-msgid "Auditing:\t\t"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:331
-#, c-format
-msgid "Enabled"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:334
-#, c-format
-msgid "Disabled"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:337
-#, c-format
-msgid "unknown (%d)"
-msgstr "unbekannt (%d)"
-
-#: ../../utils/net_rpc_audit.c:343
-#, c-format
-msgid "Auditing categories:\t%d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:344
-#, c-format
-msgid "Auditing settings:\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:354
-#, c-format
-msgid "failed to list auditing policies: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:371
-msgid "View configured audit setting"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:389
-msgid "Set audit policies"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:407 ../../utils/net_rpc_audit.c:477
-msgid "Enable auditing"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:425 ../../utils/net_rpc_audit.c:485
-msgid "Disable auditing"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:443
-msgid "List auditing settings"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:461
-msgid "View configured auditing settings"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:462
-msgid ""
-"net rpc audit get\n"
-"    View configured auditing settings"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:469
-msgid "Set auditing policies"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:470
-msgid ""
-"net rpc audit set\n"
-"    Set auditing policies"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:478
-msgid ""
-"net rpc audit enable\n"
-"    Enable auditing"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:486
-msgid ""
-"net rpc audit disable\n"
-"    Disable auditing"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:493
-msgid "List configured auditing settings"
-msgstr ""
-
-#: ../../utils/net_rpc_audit.c:494
-msgid ""
-"net rpc audit list\n"
-"    List configured auditing settings"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:297
-msgid "Creation of workstation account failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:304
-msgid "User specified does not have administrator privileges\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:410 ../../utils/net_rpc_join.c:438
-#, c-format
-msgid ""
-"Please make sure that no computer account\n"
-"named like this machine (%s) exists in the domain\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:475
-#, c-format
-msgid "Unable to join domain %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:499
-msgid ""
-"Usage\n"
-"net rpc testjoin\n"
-"    Test if a join is OK\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:508
-#, c-format
-msgid "Join to domain '%s' is not valid: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_join.c:513
-#, c-format
-msgid "Join to '%s' is OK\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:55
-#, c-format
-msgid "Printer Driver Info 3:\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:56
-#, c-format
-msgid "\tVersion: [%x]\n"
-msgstr "\tVersion: [%x]\n"
-
-#: ../../utils/net_rpc_printer.c:57
-#, c-format
-msgid "\tDriver Name: [%s]\n"
-msgstr "\tTreibername: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:58
-#, c-format
-msgid "\tArchitecture: [%s]\n"
-msgstr "\tArchitektur: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:59
-#, c-format
-msgid "\tDriver Path: [%s]\n"
-msgstr "\tTreiberpfad: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:60
-#, c-format
-msgid "\tDatafile: [%s]\n"
-msgstr "\tDatendatei: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:61
-#, c-format
-msgid ""
-"\tConfigfile: [%s]\n"
-"\n"
-msgstr ""
-"\tKonfigurationsdatei: [%s]\n"
-"\n"
-
-#: ../../utils/net_rpc_printer.c:62
-#, c-format
-msgid ""
-"\tHelpfile: [%s]\n"
-"\n"
-msgstr ""
-"\tHilfedatei: [%s]\n"
-"\n"
-
-#: ../../utils/net_rpc_printer.c:65
-#, c-format
-msgid "\tDependentfiles: [%s]\n"
-msgstr "\tAbhngigkeiten: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:70
-#, c-format
-msgid "\tMonitorname: [%s]\n"
-msgstr "\tMonitorname: [%s]\n"
-
-#: ../../utils/net_rpc_printer.c:71
-#, c-format
-msgid ""
-"\tDefaultdatatype: [%s]\n"
-"\n"
-msgstr ""
-"\tStandard Datentyp: [%s]\n"
-"\n"
-
-#: ../../utils/net_rpc_printer.c:81
-#, c-format
-msgid "\t[%s:%s]: REG_DWORD: 0x%08x\n"
-msgstr "\t[%s:%s]: REG_DWORD: 0x%08x\n"
-
-#: ../../utils/net_rpc_printer.c:91
-#, c-format
-msgid "\t[%s:%s]: REG_SZ: %s\n"
-msgstr "\t[%s:%s]: REG_SZ: %s\n"
-
-#: ../../utils/net_rpc_printer.c:96
-#, c-format
-msgid "\t[%s:%s]: REG_BINARY: unknown length value not displayed\n"
-msgstr "\t[%s:%s]: REG_BINARY: unbekannte Lnge, Daten werden nicht angezeigt\n"
-
-#: ../../utils/net_rpc_printer.c:120
-#, c-format
-msgid "\t%s: unknown type %d\n"
-msgstr "\t%s: unbekannter Typ %d\n"
-
-#: ../../utils/net_rpc_printer.c:254
-#, c-format
-msgid "could not close %s on originating server: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:262
-#, c-format
-msgid "could not close %s on destination server: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:355
-#, c-format
-msgid "malloc fail for size %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:366
-#, c-format
-msgid "copying [\\\\%s\\%s%s] => [\\\\%s\\%s%s] %s ACLs and %s DOS Attributes %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:370 ../../utils/net_rpc_printer.c:371
-msgid "with"
-msgstr "mit"
-
-#: ../../utils/net_rpc_printer.c:390
-#, c-format
-msgid "Error writing file: %s\n"
-msgstr "Datei konnte nicht gespeichert werden: %s\n"
-
-#: ../../utils/net_rpc_printer.c:414
-#, c-format
-msgid "cannot check for directory %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:424
-#, c-format
-msgid "could not close file on originating server: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:432
-#, c-format
-msgid "could not close file on destination server: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:565
-#, c-format
-msgid "cannot check %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:606
-#, c-format
-msgid "copying driver: [%s], for architecture: [%s], version: [%d]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:675
-#, c-format
-msgid "cannot enum printers: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:708
-#, c-format
-msgid "no access to printer [%s] on [%s] for user [%s] granted\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:715
-#, c-format
-msgid "cannot open printer %s on server %s: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:741
-#, c-format
-msgid "cannot get printer-info: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:822 ../../utils/net_rpc_printer.c:1326
-#, c-format
-msgid "cannot set printer-info: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:850
-#, c-format
-msgid "unable to set printerdata: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:871
-#, c-format
-msgid "enumprinterkey failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:897
-#, c-format
-msgid "enumprinterdataex failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:934
-#, c-format
-msgid "could not set printerdataex: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:959
-#, c-format
-msgid "could not enum forms: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:983
-#, c-format
-msgid "cannot enum drivers: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1016
-#, c-format
-msgid "cannot get driver: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1046
-#, c-format
-msgid "unsupported info level: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1057
-#, c-format
-msgid "You are not allowed to add drivers\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1061
-#, c-format
-msgid "cannot add driver: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1161
-#, c-format
-msgid "printer %d: %s, shared as: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1201
-#, c-format
-msgid "listing printer-drivers\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1216
-#, c-format
-msgid "no drivers found on server for architecture: [%s].\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1222
-#, c-format
-msgid "got %d printer-drivers for architecture: [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1295
-msgid "published"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1298
-msgid "updated"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1301
-msgid "unpublished"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1304
-msgid "unknown action"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1305
-#, c-format
-msgid "unkown action: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1331
-#, c-format
-msgid "successfully %s printer %s in Active Directory\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1443
-#, c-format
-msgid "printer [%s] is published"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1446
-#, c-format
-msgid ", guid: %s"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1450
-#, c-format
-msgid "printer [%s] is unpublished\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1454
-#, c-format
-msgid "printer [%s] is currently updating\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1458
-#, c-format
-msgid "unkown state: %d\n"
-msgstr "unbekannter Status: %d\n"
-
-#: ../../utils/net_rpc_printer.c:1528 ../../utils/net_rpc_printer.c:1675 ../../utils/net_rpc_printer.c:1858 ../../utils/net_rpc_printer.c:2047 ../../utils/net_rpc_printer.c:2214
-#, c-format
-msgid "no printers found on server.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1549
-#, c-format
-msgid "migrating printer ACLs for:     [%s] / [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1695
-#, c-format
-msgid "migrating printer forms for:    [%s] / [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1731
-#, c-format
-msgid "\tmigrating form # %d [%s] of type [%d]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1747
-#, c-format
-msgid "\tAddForm form %d: [%s] refused.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:1880
-#, c-format
-msgid "migrating printer driver for:   [%s] / [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2067
-#, c-format
-msgid "migrating printer queue for:    [%s] / [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2079
-#, c-format
-msgid "could not get printer, creating printer.\n"
-msgstr ""
-
-#. copy each src printer to a dst printer 1:1,
-#. maybe some values have to be changed though
-#: ../../utils/net_rpc_printer.c:2103
-#, c-format
-msgid "creating printer: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2114
-#, c-format
-msgid "printer [%s] successfully added.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2117
-#, c-format
-msgid "printer [%s] already exists.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2120
-#, c-format
-msgid "could not create printer [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2248
-#, c-format
-msgid "migrating printer settings for: [%s] / [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_printer.c:2401
-#, c-format
-msgid "got no key-data\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:430 ../../utils/net_rpc_registry.c:504 ../../utils/net_rpc_registry.c:566 ../../utils/net_rpc_registry.c:841 ../../utils/net_rpc_registry.c:913 ../../utils/net_rpc_registry.c:1224
-#, c-format
-msgid "registry_openkey failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:459
-#, c-format
-msgid "registry_setvalue failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:515
-#, c-format
-msgid "registry_deletevalue failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:587 ../../utils/net_rpc_registry.c:604
-#, c-format
-msgid "registry_queryvalue failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:719
-#, c-format
-msgid "createkey returned %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:749
-msgid "net rpc registry createkey <key>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:788
-#, c-format
-msgid "deletekey returned %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:800
-msgid "net rpc registry deletekey <key>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:832
-msgid "net rpc registry enumerate <path>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:849
-#, c-format
-msgid "enumerating keys failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:861
-#, c-format
-msgid "enumerating values failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:906
-msgid "net rpc registry backup <path> <file> \n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:921
-#, c-format
-msgid "Unable to save [%s] to %s:%s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:986
-msgid "unknown"
-msgstr "unbekannt"
-
-#: ../../utils/net_rpc_registry.c:1095
-msgid "net rpc registry dump <file> \n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1099 ../../utils/net_rpc_registry.c:1145 ../../utils/net_rpc_registry.c:1152
-#, c-format
-msgid "Opening %s...."
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1101 ../../utils/net_rpc_registry.c:1147
-#, c-format
-msgid "Failed to open %s for reading\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1109 ../../utils/net_rpc_registry.c:1162
-msgid "Could not get rootkey\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1122
-msgid "Closing registry..."
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1141
-msgid "net rpc registry copy <srcfile> <newfile>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1154
-#, c-format
-msgid "Failed to open %s for writing\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1165
-#, c-format
-msgid "RootKey: [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1173 ../../utils/net_rpc_registry.c:1179
-#, c-format
-msgid "Closing %s..."
-msgstr "Schliee %s..."
-
-#: ../../utils/net_rpc_registry.c:1214
-msgid "net rpc registry getsd <path> <secinfo>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1245
-#, c-format
-msgid "getting sd failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1288
-msgid ""
-"net rpc registry enumerate\n"
-"    Enumerate registry keys and values"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1296
-msgid ""
-"net rpc registry createkey\n"
-"    Create a new registry key"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1304
-msgid ""
-"net rpc registry deletekey\n"
-"    Delete a registry key"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1312
-msgid ""
-"net rpc registry getvalue\n"
-"    Print a registry value"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1320
-msgid ""
-"net rpc registry getvalueraw\n"
-"    Print a registry value (raw version)"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1328
-msgid ""
-"net rpc registry setvalue\n"
-"    Set a new registry value"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1336
-msgid ""
-"net rpc registry deletevalue\n"
-"    Delete a registry value"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1343
-msgid "Save a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1344
-msgid ""
-"net rpc registry save\n"
-"    Save a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1351
-msgid "Dump a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1352
-msgid ""
-"net rpc registry dump\n"
-"    Dump a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1359
-msgid "Copy a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1360
-msgid ""
-"net rpc registry copy\n"
-"    Copy a registry file"
-msgstr ""
-
-#: ../../utils/net_rpc_registry.c:1368
-msgid ""
-"net rpc registry getsd\n"
-"    Get security descriptior"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:203
-msgid "No privileges assigned\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:368
-#, c-format
-msgid "No such privilege exists: %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:371
-#, c-format
-msgid "Error resolving privilege display name [%s].\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:380
-#, c-format
-msgid "Error enumerating accounts for privilege %s [%s].\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:456
-msgid " net rpc rights grant <name|SID> <rights...>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:493
-msgid "Successfully granted rights.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:497
-#, c-format
-msgid "Failed to grant privileges for %s (%s)\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:527
-msgid " net rpc rights revoke <name|SID> <rights...>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:562
-msgid "Successfully revoked rights.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:566
-#, c-format
-msgid "Failed to revoke privileges for %s (%s)\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:584
-msgid ""
-"net rpc rights list [{accounts|privileges} [name|SID]]\n"
-"    View available/assigned privileges\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:602
-msgid ""
-"net rpc rights grant <name|SID> <right>\n"
-"    Assign privilege[s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:604
-msgid ""
-"For example:\n"
-"    net rpc rights grant 'VALE\\biddle' SePrintOperatorPrivilege SeDiskOperatorPrivilege\n"
-"    would grant the printer admin and disk manager rights to the user 'VALE\\biddle'\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:624
-msgid ""
-"net rpc rights revoke <name|SID> <right>\n"
-"    Revoke privilege[s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:626
-msgid ""
-"For example:\n"
-"    net rpc rights revoke 'VALE\\biddle' SePrintOperatorPrivilege SeDiskOperatorPrivilege\n"
-"    would revoke the printer admin and disk manager rights from the user 'VALE\\biddle'\n"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:648
-msgid "View available/assigned privileges"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:649
-msgid ""
-"net rpc rights list\n"
-"    View available/assigned privileges"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:656 ../../utils/net_rpc_rights.c:715
-msgid "Assign privilege[s]"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:657
-msgid ""
-"net rpc rights grant\n"
-"    Assign privilege[s]"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:664 ../../utils/net_rpc_rights.c:718
-msgid "Revoke privilege[s]"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:665
-msgid ""
-"net rpc rights revoke\n"
-"    Revoke privilege[s]"
-msgstr ""
-
-#: ../../utils/net_rpc_rights.c:712
-msgid "View available or assigned privileges"
-msgstr ""
-
-#: ../../utils/net_rpc_samsync.c:159
-msgid ""
-"net rpc vampire ([ldif [<ldif-filename>] | [keytab] [<keytab-filename]) [options]\n"
-"\t to pull accounts from a remote PDC where we are a BDC\n"
-"\t\t no args puts accounts in local passdb from smb.conf\n"
-"\t\t ldif - put accounts in ldif format (file defaults to /tmp/tmp.ldif)\n"
-"\t\t keytab - put account passwords in krb5 keytab (defaults to system keytab)\n"
-msgstr ""
-
-#: ../../utils/net_rpc_samsync.c:187
-#, c-format
-msgid ""
-"Cannot import users from %s at this time, as the current domain:\n"
-"\t%s: %s\n"
-"conflicts with the remote domain\n"
-"\t%s: %s\n"
-"Perhaps you need to set: \n"
-"\n"
-"\tsecurity=user\n"
-"\tworkgroup=%s\n"
-"\n"
-" in your smb.conf?\n"
-msgstr ""
-
-#: ../../utils/net_rpc_samsync.c:342
-msgid "Dump remote SAM database to LDIF file or stdout"
-msgstr "Entfernte SAM Datenbank in LDIF-Datei oder Standardausgabe ausgeben"
-
-#: ../../utils/net_rpc_samsync.c:486
-msgid ""
-"net rpc vampire keytab <keytabfile>\n"
-"    Dump remote SAM database to Kerberos keytab file\n"
-msgstr ""
-
-#: ../../utils/net_rpc_samsync.c:503
-#, c-format
-msgid "DC is not running Active Directory\n"
-msgstr ""
-
-#: ../../utils/net_rpc_samsync.c:513
-#, c-format
-msgid "Fallback to NT4 vampire on Mixed-Mode AD Domain\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:29
-msgid "stopped"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:30
-msgid "start pending"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:31
-msgid "stop pending"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:32
-msgid "running"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:33
-msgid "resume pending"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:34
-msgid "pause pending"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:35
-msgid "paused"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:47
-#, c-format
-msgid "Unknown State [%d]"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:82 ../../utils/net_rpc_service.c:162 ../../utils/net_rpc_service.c:355 ../../utils/net_rpc_service.c:625 ../../utils/net_rpc_service.c:705
-#, c-format
-msgid "Failed to open service.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:176
-#, c-format
-msgid "Control service request failed.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:185 ../../utils/net_rpc_service.c:373
-#, c-format
-msgid "%s service is %s.\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:230 ../../utils/net_rpc_service.c:340
-#, c-format
-msgid "Failed to open Service Control Manager. [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:249
-#, c-format
-msgid "Failed to enumerate services.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:261
-msgid "No services returned\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:368 ../../utils/net_rpc_service.c:639
-#, c-format
-msgid "Query status request failed.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:395
-#, c-format
-msgid "Query config request failed.  [%s]\n"
-msgstr ""
-
-#. print out the configuration information for the service
-#: ../../utils/net_rpc_service.c:402
-msgid "Configuration details:\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:403
-#, c-format
-msgid "\tControls Accepted    = 0x%x\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:405
-#, c-format
-msgid "\tService Type         = 0x%x\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:406
-#, c-format
-msgid "\tStart Type           = 0x%x\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:407
-#, c-format
-msgid "\tError Control        = 0x%x\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:408
-#, c-format
-msgid "\tTag ID               = 0x%x\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:411
-#, c-format
-msgid "\tExecutable Path      = %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:416
-#, c-format
-msgid "\tLoad Order Group     = %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:421
-#, c-format
-msgid "\tDependencies         = %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:426
-#, c-format
-msgid "\tStart Name           = %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:430
-#, c-format
-msgid "\tDisplay Name         = %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:474 ../../utils/net_rpc_service.c:520 ../../utils/net_rpc_service.c:566 ../../utils/net_rpc_service.c:610 ../../utils/net_rpc_service.c:690 ../../utils/net_rpc_service.c:769
-#, c-format
-msgid "Failed to open Service Control Manager.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:647
-#, c-format
-msgid "Successfully started service: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:650
-#, c-format
-msgid "Failed to start service: %s [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:717
-#, c-format
-msgid "Delete service request failed.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:722
-#, c-format
-msgid "Successfully deleted Service: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:800
-#, c-format
-msgid "Create service request failed.  [%s]\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:805
-#, c-format
-msgid "Successfully created Service: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:828 ../../utils/net_rpc_service.c:972
-msgid "View configured Win32 services"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:846
-msgid "Start a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:864
-msgid "Stop a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:882
-msgid "Resume a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:900
-msgid "Pause a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:918
-msgid "Show the current status of a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:936
-msgid "Delete a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:954
-msgid "Create a Win32 service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:973
-msgid ""
-"net rpc service list\n"
-"    View configured Win32 services"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:980
-msgid "Start a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:981
-msgid ""
-"net rpc service start\n"
-"    Start a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:988
-msgid "Stop a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:989
-msgid ""
-"net rpc service stop\n"
-"    Stop a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:996
-msgid "Pause a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:997
-msgid ""
-"net rpc service pause\n"
-"    Pause a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1004
-msgid "Resume a paused service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1005
-msgid ""
-"net rpc service resume\n"
-"    Resume a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1012
-msgid "View current status of a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1013
-msgid ""
-"net rpc service status\n"
-"    View current status of a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1020
-msgid "Delete a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1021
-msgid ""
-"net rpc service delete\n"
-"    Deletes a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1028
-msgid "Create a service"
-msgstr ""
-
-#: ../../utils/net_rpc_service.c:1029
-msgid ""
-"net rpc service create\n"
-"    Creates a service"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:79
-#, c-format
-msgid "query_domain_info level 1 failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:90
-#, c-format
-msgid "query_domain_info level 3 failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:101
-#, c-format
-msgid "query_domain_info level 12 failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:134
-#, c-format
-msgid "Got unexpected info level %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:162
-#, c-format
-msgid "Minimum password length: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:163
-#, c-format
-msgid "Password history length: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:166
-msgid "Minimum password age: "
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:169 ../../utils/net_rpc_sh_acct.c:177 ../../utils/net_rpc_sh_acct.c:189 ../../utils/net_rpc_sh_acct.c:197
-#, c-format
-msgid "%d seconds\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:171 ../../utils/net_rpc_sh_acct.c:179 ../../utils/net_rpc_sh_acct.c:191 ../../utils/net_rpc_sh_acct.c:199
-msgid "not set\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:174
-msgid "Maximum password age: "
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:182
-#, c-format
-msgid "Bad logon attempts: %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:186
-msgid "Account lockout duration: "
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:194
-msgid "Bad password count reset after: "
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:203
-#, c-format
-msgid "Disconnect users when logon hours expire: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:206
-#, c-format
-msgid "User must logon to change password: %s\n"
-msgstr "Benutzer muss sich anmelden um Passwort zu ndern: %s\n"
-
-#: ../../utils/net_rpc_sh_acct.c:234
-#, c-format
-msgid "Setting bad password count to %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:259 ../../utils/net_rpc_sh_acct.c:289 ../../utils/net_rpc_sh_acct.c:319 ../../utils/net_rpc_sh_acct.c:349 ../../utils/net_rpc_sh_acct.c:379 ../../utils/net_rpc_sh_acct.c:409
-#, c-format
-msgid "Usage: %s <count>\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:264
-#, c-format
-msgid "Setting lockout duration to %d seconds\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:294
-#, c-format
-msgid "Setting bad password reset duration to %d seconds\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:324
-#, c-format
-msgid "Setting minimum password age to %d seconds\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:354
-#, c-format
-msgid "Setting maximum password age to %d seconds\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:384
-#, c-format
-msgid "Setting minimum password length to %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:414
-#, c-format
-msgid "Setting password history length to %d\n"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:435
-msgid "Show current account policy settings"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:437
-msgid "Set bad password count before lockout"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:439
-msgid "Set account lockout duration"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:442
-msgid "Set bad password count reset duration"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:444
-msgid "Set minimum password age"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:446
-msgid "Set maximum password age"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:448
-msgid "Set minimum password length"
-msgstr ""
-
-#: ../../utils/net_rpc_sh_acct.c:450
-msgid "Set the password history length"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:77
-msgid "talloc_new failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:84
-#, c-format
-msgid "Could not open pipe: %s\n"
-msgstr ""
-
-#. None found
-#: ../../utils/net_rpc_shell.c:146
-#, c-format
-msgid "%s: unknown cmd\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:152 ../../utils/net_rpc_shell.c:232 ../../utils/net_sam.c:1605 ../../utils/net_sam.c:1867
-msgid "talloc failed\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:184
-#, c-format
-msgid "%s failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:194
-msgid "Print information about the domain connected to"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:197
-msgid "List/Grant/Revoke user rights"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:200
-msgid "List/Add/Remove etc shares"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:203
-msgid "List/Add/Remove user info"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:206
-msgid "Show/Change account policy settings"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:238
-#, c-format
-msgid "Could not open connection: %s\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:253
-#, c-format
-msgid "Talking to domain %s (%s)\n"
-msgstr ""
-
-#: ../../utils/net_rpc_shell.c:280
-#, c-format
-msgid "cmdline invalid: %s\n"
-msgstr "Kommandozeile ungltig: %s\n"
-
-#: ../../utils/net_sam.c:41
-#, c-format
-msgid "net sam set %s <user> <value>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:48 ../../utils/net_sam.c:154 ../../utils/net_sam.c:246 ../../utils/net_sam.c:310 ../../utils/net_sam.c:706 ../../utils/net_sam.c:745 ../../utils/net_sam.c:1558
-#, c-format
-msgid "Could not find name %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:59 ../../utils/net_sam.c:69 ../../utils/net_sam.c:165 ../../utils/net_sam.c:257
-msgid "Internal error\n"
-msgstr "interner Fehler\n"
-
-#: ../../utils/net_sam.c:64 ../../utils/net_sam.c:170 ../../utils/net_sam.c:262
-#, c-format
-msgid "Loading user %s failed\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:75 ../../utils/net_sam.c:186 ../../utils/net_sam.c:274
-#, c-format
-msgid "Updating sam account %s failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:82
-#, c-format
-msgid "Updated %s for %s\\%s to %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:147
-#, c-format
-msgid "net sam set %s <user> [yes|no]\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:193
-#, c-format
-msgid "Updated flag %s for %s\\%s to %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:240
-msgid "net sam set pwdmustchangenow <user> [yes|no]\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:281
-#, c-format
-msgid "Updated 'user must change password at next logon' for %s\\%s to %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:304
-msgid "net sam set comment <name> <comment>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:321
-#, c-format
-msgid "%s is a %s, not a group\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:327
-#, c-format
-msgid "Could not load group %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:336
-#, c-format
-msgid "Updating group mapping entry failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:354
-msgid "Change a user's home directory"
-msgstr ""
-
-#: ../../utils/net_sam.c:355
-msgid ""
-"net sam set homedir\n"
-"    Change a user's home directory"
-msgstr ""
-
-#: ../../utils/net_sam.c:362
-msgid "Change a user's profile path"
-msgstr ""
-
-#: ../../utils/net_sam.c:363
-msgid ""
-"net sam set profilepath\n"
-"    Change a user's profile path"
-msgstr ""
-
-#: ../../utils/net_sam.c:370
-msgid "Change a users or groups description"
-msgstr ""
-
-#: ../../utils/net_sam.c:371
-msgid ""
-"net sam set comment\n"
-"    Change a users or groups description"
-msgstr ""
-
-#: ../../utils/net_sam.c:378
-msgid "Change a user's full name"
-msgstr ""
-
-#: ../../utils/net_sam.c:379
-msgid ""
-"net sam set fullname\n"
-"    Change a user's full name"
-msgstr ""
-
-#: ../../utils/net_sam.c:386
-msgid "Change a user's logon script"
-msgstr ""
-
-#: ../../utils/net_sam.c:387
-msgid ""
-"net sam set logonscript\n"
-"    Change a user's logon script"
-msgstr ""
-
-#: ../../utils/net_sam.c:394
-msgid "Change a user's home drive"
-msgstr ""
-
-#: ../../utils/net_sam.c:395
-msgid ""
-"net sam set homedrive\n"
-"    Change a user's home drive"
-msgstr ""
-
-#: ../../utils/net_sam.c:402
-msgid "Change a user's allowed workstations"
-msgstr ""
-
-#: ../../utils/net_sam.c:403
-msgid ""
-"net sam set workstations\n"
-"    Change a user's allowed workstations"
-msgstr ""
-
-#: ../../utils/net_sam.c:410
-msgid "Disable/Enable a user"
-msgstr ""
-
-#: ../../utils/net_sam.c:411
-msgid ""
-"net sam set disable\n"
-"    Disable/Enable a user"
-msgstr ""
-
-#: ../../utils/net_sam.c:418
-msgid "Disable/Enable the password not required flag"
-msgstr ""
-
-#: ../../utils/net_sam.c:419
-msgid ""
-"net sam set pwnotreq\n"
-"    Disable/Enable the password not required flag"
-msgstr ""
-
-#: ../../utils/net_sam.c:426
-msgid "Disable/Enable a user's lockout flag"
-msgstr ""
-
-#: ../../utils/net_sam.c:427
-msgid ""
-"net sam set autolock\n"
-"    Disable/Enable a user's lockout flag"
-msgstr ""
-
-#: ../../utils/net_sam.c:434
-msgid "Disable/Enable whether a user's pw does not expire"
-msgstr ""
-
-#: ../../utils/net_sam.c:436
-msgid ""
-"net sam set pwnoexp\n"
-"    Disable/Enable whether a user's pw does not expire"
-msgstr ""
-
-#: ../../utils/net_sam.c:444
-msgid "Force users password must change at next logon"
-msgstr ""
-
-#: ../../utils/net_sam.c:445
-msgid ""
-"net sam set pwdmustchangenow\n"
-"    Force users password must change at next logon"
-msgstr ""
-
-#: ../../utils/net_sam.c:469
-msgid "net sam policy set \"<account policy>\" <value>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:484
-#, c-format
-msgid "Unable to set policy \"%s\"! Invalid value \"%s\".\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:496
-#, c-format
-msgid ""
-"No account policy \"%s\"!\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:497 ../../utils/net_sam.c:550 ../../utils/net_sam.c:590
-msgid "Valid account policies are:\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:508 ../../utils/net_sam.c:561
-#, c-format
-msgid "Valid account policy, but unable to fetch value!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:511
-#, c-format
-msgid "Account policy \"%s\" value was: %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:516
-msgid "Valid account policy, but unable to set value!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:520
-#, c-format
-msgid "Account policy \"%s\" value is now: %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:536
-msgid "net sam policy show \"<account policy>\"\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:548
-msgid "No account policy by that name!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:566
-#, c-format
-msgid "Account policy \"%s\" description: %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:568
-#, c-format
-msgid "Account policy \"%s\" value is: %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:584 ../../utils/net_sam.c:607
-msgid "List account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:608
-msgid ""
-"net sam policy list\n"
-"    List account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:615
-msgid "Show account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:616
-msgid ""
-"net sam policy show\n"
-"    Show account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:623
-msgid "Change account policies"
-msgstr "Konto-Regeln ndern"
-
-#: ../../utils/net_sam.c:624
-msgid ""
-"net sam policy set\n"
-"    Change account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:643
-msgid "net sam rights list [privilege name]\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:665
-#, c-format
-msgid "Could not list rights: %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:700
-msgid "net sam rights grant <name> <rights> ...\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:712 ../../utils/net_sam.c:752
-#, c-format
-msgid "%s unknown\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:717
-msgid "Could not grant privilege\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:721
-#, c-format
-msgid "Granted %s to %s\\%s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:739
-msgid "net sam rights revoke <name> <rights>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:757
-msgid "Could not revoke privilege\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:761
-#, c-format
-msgid "Revoked %s from %s\\%s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:774
-msgid "List possible user rights"
-msgstr ""
-
-#: ../../utils/net_sam.c:775
-msgid ""
-"net sam rights list\n"
-"    List possible user rights"
-msgstr ""
-
-#: ../../utils/net_sam.c:782
-msgid "Grant right(s)"
-msgstr ""
-
-#: ../../utils/net_sam.c:783
-msgid ""
-"net sam rights grant\n"
-"    Grant right(s)"
-msgstr ""
-
-#: ../../utils/net_sam.c:790
-msgid "Revoke right(s)"
-msgstr ""
-
-#: ../../utils/net_sam.c:791
-msgid ""
-"net sam rights revoke\n"
-"    Revoke right(s)"
-msgstr ""
-
-#: ../../utils/net_sam.c:867
-msgid "net sam mapunixgroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:873 ../../utils/net_sam.c:1185 ../../utils/net_sam.c:1274 ../../utils/net_sam.c:1348
-#, c-format
-msgid "Could not find group %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:880
-#, c-format
-msgid "Mapping group %s failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:885
-#, c-format
-msgid "Mapped unix group %s to SID %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:931
-msgid "net sam unmapunixgroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:937
-#, c-format
-msgid "Could not find mapping for group %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:945
-#, c-format
-msgid "Unmapping group %s failed with %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:950
-#, c-format
-msgid "Unmapped unix group %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:968
-msgid "net sam createdomaingroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:975 ../../utils/net_sam.c:1057 ../../utils/net_sam.c:1155
-#, c-format
-msgid "Creating %s failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:980
-#, c-format
-msgid "Created domain group %s with RID %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1001 ../../utils/net_sam.c:1081
-msgid "net sam deletelocalgroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1007 ../../utils/net_sam.c:1087
-#, c-format
-msgid "Could not find %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1012
-#, c-format
-msgid "%s is a %s, not a domain group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1022
-#, c-format
-msgid "Deleting domain group %s failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1027
-#, c-format
-msgid "Deleted domain group %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1044
-msgid "net sam createlocalgroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1049
-msgid "winbind seems not to run. createlocalgroup only works when winbind runs.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1062
-#, c-format
-msgid "Created local group %s with RID %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1092
-#, c-format
-msgid "%s is a %s, not a local group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1100
-#, c-format
-msgid "Deleting local group %s failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1105
-#, c-format
-msgid "Deleted local group %s.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1125
-msgid "net sam createbuiltingroup <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1130
-msgid "winbind seems not to run. createbuiltingroup only works when winbind runs.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1143
-#, c-format
-msgid "%s is not a BUILTIN group\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1148
-#, c-format
-msgid "Failed to get RID for %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1160
-#, c-format
-msgid "Created BUILTIN group %s with RID %d\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1179
-msgid "net sam addmem <group> <member>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1197 ../../utils/net_sam.c:1281
-#, c-format
-msgid "Could not find member %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1205
-#, c-format
-msgid "Could not resolve SID %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1214
-#, c-format
-msgid ""
-"%s is a local group, only users and domain groups can be added.\n"
-"%s is a %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1223
-#, c-format
-msgid "Adding local group member failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1235
-#, c-format
-msgid "Adding domain group member failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1240
-#, c-format
-msgid "Can only add members to local groups so far, %s is a %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1246
-#, c-format
-msgid "Added %s\\%s to %s\\%s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1268
-msgid "net sam delmem <group> <member>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1292
-#, c-format
-msgid "Deleting local group member failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1304
-#, c-format
-msgid "Deleting domain group member failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1309
-#, c-format
-msgid "Can only delete members from local groups so far, %s is a %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1316
-#, c-format
-msgid "Deleted %s\\%s from %s\\%s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1319
-#, c-format
-msgid "Deleted %s from %s\\%s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1342
-msgid "net sam listmem <group>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1357 ../../utils/net_sam.c:1367
-#, c-format
-msgid "Listing group members failed with %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1385
-#, c-format
-msgid ""
-"Can only list local group members so far.\n"
-"%s is a %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1390
-#, c-format
-msgid "%s\\%s has %u members\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1417
-#, c-format
-msgid "net sam list %s [verbose]\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1422
-msgid "Could not start search\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1497
-msgid "List SAM users"
-msgstr ""
-
-#: ../../utils/net_sam.c:1498
-msgid ""
-"net sam list users\n"
-"    List SAM users"
-msgstr ""
-
-#: ../../utils/net_sam.c:1505
-msgid "List SAM groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1506
-msgid ""
-"net sam list groups\n"
-"    List SAM groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1513
-msgid "List SAM local groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1514
-msgid ""
-"net sam list localgroups\n"
-"    List SAM local groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1521
-msgid "List builtin groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1522
-msgid ""
-"net sam list builtin\n"
-"    List builtin groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1529
-msgid "List domain member workstations"
-msgstr ""
-
-#: ../../utils/net_sam.c:1530
-msgid ""
-"net sam list workstations\n"
-"    List domain member workstations"
-msgstr ""
-
-#: ../../utils/net_sam.c:1552
-msgid "net sam show <name>\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1562
-#, c-format
-msgid "%s\\%s is a %s with SID %s\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1594
-msgid "Init an LDAP tree with default users/groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:1600 ../../utils/net_sam.c:1729 ../../utils/net_sam.c:1761 ../../utils/net_sam.c:1805 ../../utils/net_sam.c:1843 ../../utils/net_sam.c:1881 ../../utils/net_sam.c:1892 ../../utils/net_sam.c:1961
-msgid "Out of Memory!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1620
-msgid "Provisioning works only with ldapsam backend\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1627
-msgid "Provisioning works only if ldapsam:trusted and ldapsam:editposix are enabled.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1633
-msgid "winbind seems not to run. Provisioning LDAP only works when winbind runs.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1639
-msgid "Unable to connect to the LDAP server.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1643
-msgid "Checking for Domain Users group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1656
-msgid "Adding the Domain Users group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1660
-msgid "Unable to allocate a new gid to create Domain Users group!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1690
-msgid "Failed to add Domain Users group to ldap directory\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1695 ../../utils/net_sam.c:1752 ../../utils/net_sam.c:1836 ../../utils/net_sam.c:1925 ../../utils/net_sam.c:1939 ../../utils/net_sam.c:1986
-msgid "found!\n"
-msgstr "gefunden!\n"
-
-#: ../../utils/net_sam.c:1700
-msgid "Checking for Domain Admins group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1713
-msgid "Adding the Domain Admins group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1717
-msgid "Unable to allocate a new gid to create Domain Admins group!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1747
-msgid "Failed to add Domain Admins group to ldap directory\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1757
-msgid "Check for Administrator account.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1777
-msgid "Adding the Administrator user.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1781
-msgid "Can't create Administrator user, Domain Admins group not available!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1787
-msgid "Unable to allocate a new uid to create the Administrator user!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1832
-msgid "Failed to add Administrator user to ldap directory\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1839
-msgid "Checking for Guest user.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1855
-msgid "Adding the Guest user.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1862
-msgid "Can't create Guest user, Domain Users group not available!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1873
-msgid "Unable to allocate a new uid to create the Guest user!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1921
-msgid "Failed to add Guest user to ldap directory\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1928
-msgid "Checking Guest's group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1933
-msgid ""
-"Failed to find just created Guest account!\n"
-"   Is nss properly configured?!\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1952
-msgid "Adding the Domain Guests group.\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:1982
-msgid "Failed to add Domain Guests group to ldap directory\n"
-msgstr ""
-
-#: ../../utils/net_sam.c:2011
-msgid "Create a new BUILTIN group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2012
-msgid ""
-"net sam createbuiltingroup\n"
-"    Create a new BUILTIN group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2019
-msgid "Create a new local group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2020
-msgid ""
-"net sam createlocalgroup\n"
-"    Create a new local group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2027
-msgid "Create a new group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2028
-msgid ""
-"net sam createdomaingroup\n"
-"    Create a new group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2035
-msgid "Delete an existing local group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2036
-msgid ""
-"net sam deletelocalgroup\n"
-"    Delete an existing local group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2043
-msgid "Delete a domain group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2044
-msgid ""
-"net sam deletedomaingroup\n"
-"    Delete a group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2051
-msgid "Map a unix group to a domain group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2052
-msgid ""
-"net sam mapunixgroup\n"
-"    Map a unix group to a domain group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2059
-msgid "Remove a group mapping of an unix group to a domain group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2061
-msgid ""
-"net sam unmapunixgroup\n"
-"    Remove a group mapping of an unix group to a domain group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2069
-msgid "Add a member to a group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2070
-msgid ""
-"net sam addmem\n"
-"    Add a member to a group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2077
-msgid "Delete a member from a group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2078
-msgid ""
-"net sam delmem\n"
-"    Delete a member from a group"
-msgstr ""
-
-#: ../../utils/net_sam.c:2086
-msgid ""
-"net sam listmem\n"
-"    List group members"
-msgstr ""
-
-#: ../../utils/net_sam.c:2093
-msgid "List users, groups and local groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:2094
-msgid ""
-"net sam list\n"
-"    List users, groups and local groups"
-msgstr ""
-
-#: ../../utils/net_sam.c:2101
-msgid "Show details of a SAM entry"
-msgstr ""
-
-#: ../../utils/net_sam.c:2102
-msgid ""
-"net sam show\n"
-"    Show details of a SAM entry"
-msgstr ""
-
-#: ../../utils/net_sam.c:2109
-msgid "Set details of a SAM account"
-msgstr ""
-
-#: ../../utils/net_sam.c:2110
-msgid ""
-"net sam set\n"
-"    Set details of a SAM account"
-msgstr ""
-
-#: ../../utils/net_sam.c:2117
-msgid "Set account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:2118
-msgid ""
-"net sam policy\n"
-"    Set account policies"
-msgstr ""
-
-#: ../../utils/net_sam.c:2125
-msgid "Manipulate user privileges"
-msgstr ""
-
-#: ../../utils/net_sam.c:2126
-msgid ""
-"net sam rights\n"
-"    Manipulate user privileges"
-msgstr ""
-
-#: ../../utils/net_sam.c:2134
-msgid "Provision a clean user database"
-msgstr ""
-
-#: ../../utils/net_sam.c:2135
-msgid ""
-"net sam privison\n"
-"    Provision a clear user database"
-msgstr ""
-
-#: ../../utils/net_sam.c:2143
-msgid "You are not root, most things won't work\n"
-msgstr ""
-
-#: ../../utils/net_share.c:27
-msgid ""
-"\n"
-"net [<method>] share [misc. options] [targets] \n"
-"\tenumerates all exported resources (network shares) on target server\n"
-"\n"
-"net [<method>] share ADD <name=serverpath> [misc. options] [targets]\n"
-"\tadds a share from a server (makes the export active)\n"
-"\n"
-"net [<method>] share DELETE <sharename> [misc. options] [targets]\n"
-"\tdeletes a share from a server (makes the export inactive)\n"
-"\n"
-"net [<method>] share ALLOWEDUSERS [<filename>] [misc. options] [targets]\n"
-"\tshows a list of all shares together with all users allowed to\n"
-"\taccess them. This needs the output of 'net usersidlist' on\n"
-"\tstdin or in <filename>.\n"
-"\n"
-"net [<method>] share MIGRATE FILES <sharename> [misc. options] [targets]\n"
-"\tMigrates files from remote to local server\n"
-"\n"
-"net [<method>] share MIGRATE SHARES <sharename> [misc. options] [targets]\n"
-"\tMigrates shares from remote to local server\n"
-"\n"
-"net [<method>] share MIGRATE SECURITY <sharename> [misc. options] [targets]\n"
-"\tMigrates share-ACLs from remote to local server\n"
-"\n"
-"net [<method>] share MIGRATE ALL <sharename> [misc. options] [targets]\n"
-"\tMigrates shares (including directories, files) from remote\n"
-"\tto local server\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_share.c:52
-msgid ""
-"\t-C or --comment=<comment>\tdescriptive comment (for add only)\n"
-"\t-M or --maxusers=<num>\t\tmax users allowed for share\n"
-"\t      --acls\t\t\tcopies ACLs as well\n"
-"\t      --attrs\t\t\tcopies DOS Attributes as well\n"
-"\t      --timestamps\t\tpreserve timestamps while copying files\n"
-"\t      --destination\t\tmigration target server (default: localhost)\n"
-"\t-e or --exclude\t\t\tlist of shares to be excluded from mirroring\n"
-"\t-v or --verbose\t\t\tgive verbose output\n"
-msgstr ""
-
-#: ../../utils/net_status.c:24
-msgid "  net status sessions [parseable] Show list of open sessions\n"
-msgstr ""
-
-#: ../../utils/net_status.c:26
-msgid "  net status shares [parseable]   Show list of open shares\n"
-msgstr ""
-
-#: ../../utils/net_status.c:70
-msgid ""
-"Display open user sessions.\n"
-"    If parseable is specified, output is machine-readable."
-msgstr ""
-
-#: ../../utils/net_status.c:85
-msgid ""
-"PID     Username      Group         Machine                        \n"
-"-------------------------------------------------------------------\n"
-msgstr ""
-
-#: ../../utils/net_status.c:94 ../../utils/net_status.c:200
-#, c-format
-msgid "%s not initialised\n"
-msgstr ""
-
-#: ../../utils/net_status.c:222
-msgid ""
-"Display open user shares.\n"
-"    If parseable is specified, output is machine-readable."
-msgstr ""
-
-#: ../../utils/net_status.c:230
-msgid ""
-"\n"
-"Service      pid     machine       Connected at\n"
-"-------------------------------------------------------\n"
-msgstr ""
-
-#: ../../utils/net_status.c:254
-msgid "Show list of open sessions"
-msgstr ""
-
-#: ../../utils/net_status.c:255
-msgid ""
-"net status sessions [parseable]\n"
-"    If parseable is specified, output is presented in a machine-parseable fashion."
-msgstr ""
-
-#: ../../utils/net_status.c:263
-msgid "Show list of open shares"
-msgstr ""
-
-#: ../../utils/net_status.c:264
-msgid ""
-"net status shares [parseable]\n"
-"    If parseable is specified, output is presented in a machine-parseable fashion."
-msgstr ""
-
-#: ../../utils/net_time.c:39
-#, c-format
-msgid "Can't contact server %s. Error %s\n"
-msgstr ""
-
-#: ../../utils/net_time.c:52
-#, c-format
-msgid "Session request failed\n"
-msgstr ""
-
-#: ../../utils/net_time.c:57
-#, c-format
-msgid "Protocol negotiation failed: %s\n"
-msgstr ""
-
-#: ../../utils/net_time.c:97
-msgid ""
-"net time\n"
-"\tdisplays time on a server\n"
-"\n"
-"net time system\n"
-"\tdisplays time on a server in a format ready for /bin/date\n"
-"\n"
-"net time set\n"
-"\truns /bin/date with the time from the server\n"
-"\n"
-"net time zone\n"
-"\tdisplays the timezone in hours from GMT on the remote computer\n"
-"\n"
-"\n"
-msgstr ""
-"net time\n"
-"\tZeigt die Zeit eines Servers an\n"
-"\n"
-"net time system\n"
-"\tZeigt die Zeit eines Servers im /bin/date Format an\n"
-"\n"
-"net time set\n"
-"\tFhrt /bin/date mit der Serverzeit aus\n"
-"\n"
-"net time zone\n"
-"\tZeigt die Zeitzone in Stunden zur GMT auf dem entfernten Computer\n"
-"\n"
-
-#: ../../utils/net_time.c:123
-#, c-format
-msgid "%s failed.  Error was (%s)\n"
-msgstr ""
-
-#: ../../utils/net_time.c:140
-msgid "Output remote time server time in a format ready for /bin/date"
-msgstr ""
-
-#: ../../utils/net_time.c:166
-msgid "Display the remote time server's offset to UTC"
-msgstr ""
-
-#: ../../utils/net_time.c:196
-msgid "Display time ready for /bin/date"
-msgstr ""
-
-#: ../../utils/net_time.c:197
-msgid ""
-"net time system\n"
-"    Display time ready for /bin/date"
-msgstr ""
-
-#: ../../utils/net_time.c:204
-msgid "Set the system time from time server"
-msgstr ""
-
-#: ../../utils/net_time.c:205
-msgid ""
-"net time set\n"
-"    Set the system time from time server"
-msgstr ""
-
-#: ../../utils/net_time.c:212
-msgid "Display timezone offset from UTC"
-msgstr ""
-
-#: ../../utils/net_time.c:213
-msgid ""
-"net time zone\n"
-"    Display timezone offset from UTC"
-msgstr ""
-
-#: ../../utils/net_time.c:228
-msgid "Display the remote time server's time"
-msgstr ""
-
-#: ../../utils/net_time.c:235
-msgid "Could not locate a time server.  Try specifying a target host.\n"
-msgstr ""
-
-#: ../../utils/net_user.c:27
-msgid ""
-"\n"
-"net [<method>] user [misc. options] [targets]\n"
-"\tList users\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_user.c:29
-msgid ""
-"net [<method>] user DELETE <name> [misc. options] [targets]\n"
-"\tDelete specified user\n"
-msgstr ""
-
-#: ../../utils/net_user.c:31
-msgid ""
-"\n"
-"net [<method>] user INFO <name> [misc. options] [targets]\n"
-"\tList the domain groups of the specified user\n"
-msgstr ""
-
-#: ../../utils/net_user.c:33
-msgid ""
-"\n"
-"net [<method>] user ADD <name> [password] [-c container] [-F user flags] [misc. options] [targets]\n"
-"\tAdd specified user\n"
-msgstr ""
-
-#: ../../utils/net_user.c:36
-msgid ""
-"\n"
-"net [<method>] user RENAME <oldusername> <newusername> [targets]\n"
-"\tRename specified user\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:29
-msgid "Malformed usershare file"
-msgstr ""
-
-#: ../../utils/net_usershare.c:30
-msgid "Bad version number"
-msgstr ""
-
-#: ../../utils/net_usershare.c:31
-msgid "Malformed path entry"
-msgstr ""
-
-#: ../../utils/net_usershare.c:32
-msgid "Malformed comment entryfile"
-msgstr ""
-
-#: ../../utils/net_usershare.c:33
-msgid "Malformed acl definition"
-msgstr ""
-
-#: ../../utils/net_usershare.c:34
-msgid "Acl parse error"
-msgstr ""
-
-#: ../../utils/net_usershare.c:35
-msgid "Path not absolute"
-msgstr ""
-
-#: ../../utils/net_usershare.c:36
-msgid "Path is denied"
-msgstr ""
-
-#: ../../utils/net_usershare.c:37
-msgid "Path not allowed"
-msgstr ""
-
-#: ../../utils/net_usershare.c:38
-msgid "Path is not a directory"
-msgstr ""
-
-#: ../../utils/net_usershare.c:39
-msgid "System error"
-msgstr "System Fehler"
-
-#: ../../utils/net_usershare.c:55
-#, c-format
-msgid "Usershare error code (0x%x)"
-msgstr ""
-
-#: ../../utils/net_usershare.c:67
-#, c-format
-msgid ""
-"net usershare add [-l|--long] <sharename> <path> [<comment>] [<acl>] [<guest_ok=[y|n]>]\n"
-"\tAdds the specified share name for this user.\n"
-"\t<sharename> is the new share name.\n"
-"\t<path> is the path on the filesystem to export.\n"
-"\t<comment> is the optional comment for the new share.\n"
-"\t<acl> is an optional share acl in the format \"DOMAIN%cname:X,DOMAIN%cname:X,....\"\n"
-"\t<guest_ok=y> if present sets \"guest ok = yes\" on this usershare.\n"
-"\t\t\"X\" represents a permission and can be any one of the characters f, r or d\n"
-"\t\twhere \"f\" means full control, \"r\" means read-only, \"d\" means deny access.\n"
-"\t\tname may be a domain user or group. For local users use the local server name instead of \"DOMAIN\"\n"
-"\t\tThe default acl is \"Everyone:r\" which allows everyone read-only access.\n"
-"\tAdd -l or --long to print the info on the newly added share.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:87
-msgid ""
-"net usershare delete <sharename>\n"
-"\tdeletes the specified share name for this user.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:95
-msgid ""
-"net usershare info [-l|--long] [wildcard sharename]\n"
-"\tPrints out the path, comment and acl elements of shares that match the wildcard.\n"
-"\tBy default only gives info on shares owned by the current user\n"
-"\tAdd -l or --long to apply this to all shares\n"
-"\tOmit the sharename or use a wildcard of '*' to see all shares\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:106
-msgid ""
-"net usershare list [-l|--long] [wildcard sharename]\n"
-"\tLists the names of all shares that match the wildcard.\n"
-"\tBy default only lists shares owned by the current user\n"
-"\tAdd -l or --long to apply this to all shares\n"
-"\tOmit the sharename or use a wildcard of '*' to see all shares\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:116
-msgid ""
-"net usershare add <sharename> <path> [<comment>] [<acl>] [<guest_ok=[y|n]>] to add or change a user defined share.\n"
-"net usershare delete <sharename> to delete a user defined share.\n"
-"net usershare info [-l|--long] [wildcard sharename] to print info about a user defined share.\n"
-"net usershare list [-l|--long] [wildcard sharename] to list user defined shares.\n"
-"net usershare help\n"
-"\n"
-"Type \"net usershare help <option>\" to get more information on that option\n"
-"\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:158
-msgid "strlower_talloc failed\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:163
-#, c-format
-msgid "net usershare delete: share name %s contains invalid characters (any of %s)\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:180
-#, c-format
-msgid "net usershare delete: unable to remove usershare %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:218
-#, c-format
-msgid "get_share_list: cannot open usershare directory %s. Error %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:238
-#, c-format
-msgid "get_share_list: ignoring bad share name %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:253
-#, c-format
-msgid "get_share_list: can't lstat file %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:261
-#, c-format
-msgid "get_share_list: file %s is not a regular file. Ignoring.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:362
-#, c-format
-msgid "info_fn: unable to open %s. %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:370
-#, c-format
-msgid "info_fn: can't fstat file %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:378
-#, c-format
-msgid "info_fn: file %s is not a regular file. Ignoring.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:402
-#, c-format
-msgid "info_fn: file %s is not a well formed usershare file.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:405
-#, c-format
-msgid "info_fn: Error was %s.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:555
-#, c-format
-msgid "count_num_usershares: cannot open usershare directory %s. Error %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:575
-#, c-format
-msgid "count_num_usershares: ignoring bad share name %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:590
-#, c-format
-msgid "count_num_usershares: can't lstat file %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:598
-#, c-format
-msgid "count_num_usershares: file %s is not a regular file. Ignoring.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:694
-#, c-format
-msgid "net usershare add: maximum number of allowed usershares (%d) reached\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:702
-#, c-format
-msgid "net usershare add: share name %s contains invalid characters (any of %s)\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:712
-#, c-format
-msgid "net usershare add: share name %s is already a valid system user name\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:744
-#, c-format
-msgid "net usershare add: path %s is not an absolute path.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:754
-#, c-format
-msgid "net usershare add: cannot stat path %s to ensure this is a directory. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:763
-#, c-format
-msgid "net usershare add: path %s is not a directory.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:773
-#, c-format
-msgid ""
-"net usershare add: cannot share path %s as we are restricted to only sharing directories we own.\n"
-"\tAsk the administrator to add the line \"usershare owner only = false\" \n"
-"\tto the [global] section of the smb.conf to allow this.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:806
-#, c-format
-msgid "net usershare add: malformed acl %s (missing ':').\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:822
-#, c-format
-msgid "net usershare add: malformed acl %s (access control must be 'r', 'f', or 'd')\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:832
-#, c-format
-msgid "net usershare add: malformed terminating character for acl %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:841
-msgid "talloc_strndup failed\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:850
-#, c-format
-msgid "net usershare add: cannot convert name \"%s\" to a SID. %s."
-msgstr ""
-
-#: ../../utils/net_usershare.c:855
-msgid " Maybe smbd is not running.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:876
-msgid "net usershare add: guest_ok=y requested but the \"usershare allow guests\" parameter is not enabled by this server.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:888
-#, c-format
-msgid "net usershare add: cannot create tmp file %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:897
-#, c-format
-msgid "net usershare add: cannot lstat tmp file %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:906
-#, c-format
-msgid "net usershare add: cannot fstat tmp file %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:914
-#, c-format
-msgid "net usershare add: tmp file %s is not a regular file ?\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:923
-#, c-format
-msgid "net usershare add: failed to fchmod tmp file %s to 0644n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:939
-#, c-format
-msgid "net usershare add: failed to write %u bytes to file %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:951
-#, c-format
-msgid "net usershare add: failed to add share %s. Error was %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1046
-msgid "Add/modify user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1047
-msgid ""
-"net usershare add\n"
-"    Add/modify user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1054
-msgid "Delete user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1055
-msgid ""
-"net usershare delete\n"
-"    Delete user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1062
-msgid "Display information about a user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1063
-msgid ""
-"net usershare info\n"
-"    Display information about a user defined share"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1070
-msgid "List user defined shares"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1071
-msgid ""
-"net usershare list\n"
-"    List user defined shares"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1079
-msgid "net usershare: usershares are currently disabled\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1088
-#, c-format
-msgid "net usershare: cannot open usershare directory %s. Error %s\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1093
-msgid "You do not have permission to create a usershare. Ask your administrator to grant you permissions to create a share.\n"
-msgstr ""
-
-#: ../../utils/net_usershare.c:1098
-msgid "Please ask your system administrator to enable user sharing.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:118
-#, c-format
-msgid "Could not connect to server %s\n"
-msgstr "Verbindung mit Server %s gescheitert\n"
-
-#: ../../utils/net_util.c:126
-msgid "The username or password was not correct.\n"
-msgstr "Benutzername oder Passwort nicht korrekt.\n"
-
-#: ../../utils/net_util.c:131
-msgid "The account was locked out.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:135
-msgid "The account was disabled.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:146
-msgid "Encryption required and server that doesn't support UNIX extensions - failing connect\n"
-msgstr ""
-
-#: ../../utils/net_util.c:150
-msgid "Encryption required and can't get UNIX CIFS extensions version from server.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:154
-#, c-format
-msgid "Encryption required and share %s doesn't support encryption.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:158
-#, c-format
-msgid "Encryption required and setup failed with error %s.\n"
-msgstr ""
-
-#: ../../utils/net_util.c:345 ../../utils/net_util.c:367
-msgid "ERROR: Unable to open secrets database\n"
-msgstr ""
-
-#: ../../utils/net_util.c:501
-#, c-format
-msgid "Unable to find a suitable server for domain %s\n"
-msgstr ""
-
-#: ../../utils/net_util.c:526
-#, c-format
-msgid "Connection failed: %s\n"
-msgstr "Verbindung fehlgeschlagen: %s\n"
-
-#: ../../utils/net_util.c:560
-#, c-format
-msgid "Enter %s's password:"
-msgstr "Bitte Passwort fr %s eingeben: "
-
-#: ../../utils/net_util.c:583
-#, c-format
-msgid "Invalid command: %s %s\n"
-msgstr "Ungltiges Kommando: %s %s\n"
-
-#: ../../utils/net_util.c:609
-msgid "Disk"
-msgstr "Festplatte"
-
-#: ../../utils/net_util.c:610
-msgid "Print"
-msgstr "Drucker"
-
-#: ../../utils/net_util.c:611
-msgid "Dev"
-msgstr "Gert"
-
-#: ../../utils/net_util.c:612
-msgid "IPC"
-msgstr "IPC"
-
-#~ msgid "Usage\n"
-#~ msgstr "Verwendung\n"
-
-#~ msgid "usage: net setlocalsid S-1-5-21-x-y-z\n"
-#~ msgstr "Aufruf: net setlocalsid S-1-5-21-x-y-z\n"
-
-#~ msgid "usage: net setdomainsid S-1-5-21-x-y-z\n"
-#~ msgstr "Aufruf: net setdomainsid S-1-5-21-x-y-z\n"
-
-#~ msgid "usage: net getdomainsid\n"
-#~ msgstr "Aufruf: net getdomainsid\n"
-
-#~ msgid "usage: net maxrid\n"
-#~ msgstr "Aufruf: net maxrid\n"
-
-#~ msgid "usage: 'net afs key <keyfile> cell'\n"
-#~ msgstr "Aufruf: 'net afs key <keyfile> cell'\n"
-
-#~ msgid "Usage: net afs impersonate <user> <cell>\n"
-#~ msgstr "Aufruf: net afs impersonate <user> <cell>\n"
-
-#~ msgid "USAGE: net conf list\n"
-#~ msgstr "Aufruf: net conf list\n"
-
-#~ msgid "USAGE: net conf listshares\n"
-#~ msgstr "Aufruf: net conf listshares\n"
-
-#~ msgid "USAGE: net conf drop\n"
-#~ msgstr "Aufruf: net conf drop\n"
-
-#~ msgid "Not Implemented yet\n"
-#~ msgstr "Noch nicht implementiert\n"
diff -daurN samba3/source3/locale/pam_winbind/ar.po samba3/source3/locale/pam_winbind/ar.po
--- samba3/source3/locale/pam_winbind/ar.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/ar.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-06 08:04\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "      "
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "       "
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "   "
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "       "
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "       "
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "     "
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "        "
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "       "
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "  .    "
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "  .    "
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "  .    "
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "   "
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "      \n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "       %d %s\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "    .           ."
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "              .     "
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "   %d     "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "       %d  "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "                    "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "    .            ."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "      "
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr " : "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "   "
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "  NT () "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "   NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "    NT : "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr " "
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr " : "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "     "
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "       "
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "      "
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/cs.po samba3/source3/locale/pam_winbind/cs.po
--- samba3/source3/locale/pam_winbind/cs.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/cs.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 14:25\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "spch"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "dn primrn domnov kontrolr nen dostupn."
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Nenalezeny dn domnov kontrolry"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "dn pihlaovac servery"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Heslo je pli krtk"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Heslo tohoto uivatele nelze zmnit, protoe je pli nov"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Heslo je ji v historii hesel"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Vae heslo vyprelo"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Je poteba zmnit Vae heslo"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Nemte prva pro pihlen z tto stanice."
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Nyn nemte povolen k pihlen."
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Platnost vaeho tu vyprela. Kontaktujte svho sprvce systmu."
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "V et je zablokovn. Kontaktujte svho sprvce systmu"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "V et byl uzamen. Prosm kontaktujte svho sprvce systmu."
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Neplatn et vztahu dvryhodnosti"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Pstup zamtnut"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Je poteba zmnit Vae heslo"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Vae heslo vypr dnes.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Vae heslo vypr %d %s\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "Dn"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "Den"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Vjimen pidlen login. Zmte sv heslo, jakmile budete znovu online"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Domnov kontrolr je nedostupn, msto toho pouity pihlaovac daje. Sov zdroje jsou mon nedostupn"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Vae heslo:"
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "mus mt nejmn %d znak;"
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "nelze zopakovat dn z vaich %d hesel;"
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "mus obsahovat velk psmena, slice nebo speciln znaky;nesm obsahovat nzev vaeho tu nebo cel jmno;"
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Prosm napite jin heslo. Napite heslo, kter bude splovat poadavky uveden v obou textovch rmecch."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Heslo nespluje poadavky na sloitost."
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Heslo:"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Mnm heslo pro"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "NT heslo (aktuln):"
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Zadejte nov NT heslo:"
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Zopakujte nov NT heslo: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Pstup zamtnut"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Je poteba zmnit Vae heslo"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Heslo je pli krtk"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Heslo je pli krtk"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Heslo je pli krtk"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Heslo:"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Vae heslo:"
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Heslo je pli krtk"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Neplatn et vztahu dvryhodnosti"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Vae heslo vyprelo"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Nenalezeny dn domnov kontrolry"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "dn pihlaovac servery"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "dn primrn domnov kontrolr nen dostupn."
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Neplatn et vztahu dvryhodnosti"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "dn pihlaovac servery"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/da.po samba3/source3/locale/pam_winbind/da.po
--- samba3/source3/locale/pam_winbind/da.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/da.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,560 +0,0 @@
-# Martin Schlander <mschlander@opensuse.org>, 2008.
-msgid ""
-msgstr ""
-"Project-Id-Version: @PACKAGE@\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2008-11-23 15:44+0100\n"
-"Last-Translator: Martin Schlander <mschlander@opensuse.org>\n"
-"Language-Team: Danish <opensuse-translation@opensuse.org>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"X-Generator: Lokalize 0.2\n"
-"Plural-Forms: nplurals=2; plural=(n != 1);\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Gennemfrt"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Ingen primr domne-controller tilgngelig"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Ingen domne-controllere fundet"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Ingen log p-servere"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "For kort adgangskode"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Denne brugers adgangskode er for ny til at ndre"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Adgangskoden er allerede i adgangskode-historikken"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Din adgangskode er udlbet"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Du skal ndre din adgangskode nu"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Du har ikke tilladelse til at logge p fra denne arbejdsstation"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Du har ikke tilladelse til at logge p, p nuvrende tidspunkt"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Din konto er udlbet. Kontakt din systemadministrator"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Din konto er deaktiveret. Kontakt din systemadministrator"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Din konto er blevet lst. Kontakt din systemadministrator"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Ugyldig tillidskonto"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Adgang ngtet"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Du skal ndre din adgangskode nu"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Din adgangskode udlber i dag.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Din adgangskode udlber om %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dage"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dag"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Nde-login. ndr venligst din adgangskode, s snart du er online igen"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Domne-controller kan ikke ns, bruger cachede akkreditiver i stedet. Netvrksressourcer kan vre utilgngelige"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-"Kunne ikke etablere din Kerberos-billet-cache pga. tidsforskelle\n"
-"med domne-controlleren. Verificr venligst systemtiden.\n"
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Din adgangskode"
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "skal have mindst %d tegn;"
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "kan ikke gentage nogen af dine forrige %d adgangskoder;"
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "skal indeholde store bogstaver, tal eller skilletegn og m ikke indholde dit kontonavn eller fulde navn;"
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Indtast venligst en anden adgangskode. Indtast en adgangskode, som opfylder disse krav, i begge tekstfelter."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Adgangskoden opfylder ikke kravene til kompleksitet"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr "Brugernavn: "
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Adgangskode: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "ndrer adgangskode for"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(nuvrende) NT-adgangskode: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Indtast ny NT-adgangskode: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Indtast ny NT-adgangskode igen: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr "Beklager, adgangskoderne stemmer ikke overens"
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Adgang ngtet"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Du skal ndre din adgangskode nu"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "For kort adgangskode"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "For kort adgangskode"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "For kort adgangskode"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Adgangskode: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Din adgangskode"
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "For kort adgangskode"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Ugyldig tillidskonto"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Din adgangskode er udlbet"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Ingen domne-controllere fundet"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Ingen log p-servere"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Ingen primr domne-controller tilgngelig"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Ugyldig tillidskonto"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Ingen log p-servere"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/de.po samba3/source3/locale/pam_winbind/de.po
--- samba3/source3/locale/pam_winbind/de.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/de.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,563 +0,0 @@
-# pam_winbind message translations (german)
-# Copyright (C) 2008 Guenther Deschner <gd@samba.org>
-# This file is distributed under the same license as the pam_winbind package.
-#
-#, fuzzy
-msgid ""
-msgstr ""
-"Project-Id-Version: @PACKAGE@\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2008-11-13 14:29+0100\n"
-"Last-Translator: Guenther Deschner <gd@samba.org>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"Plural-Forms: nplurals=2; plural=(n != 1);\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Erfolgreich"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Kein primrer Domnen-Controller verfgbar"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Keine Domnen-Controller gefunden"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Keine Anmeldeserver verfgbar"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Passwort ist zu kurz"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Das Passwort des Benutzers kann noch nicht erneut gendert werden"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Das neue Passwort ist bereits in der Passwort-Historie enthalten"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Ihr Passwort ist abgelaufen"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Sie mssen Ihr Passwort jetzt ndern"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Sie knnen sich nicht von diesem Arbeitsplatz aus anmelden"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Sie knnen sich zum jetzigen Zeitpunkt nicht anmelden"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Ihr Benutzerkonto ist abgelaufen. Bitte kontaktieren Sie ihren System-Administrator"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Ihr Benutzerkonto ist deaktiviert. Bitte kontaktieren Sie ihren System-Administrator"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Ihr Benutzerkonto wurde gesperrt. Bitte kontaktieren Sie ihren System-Administrator"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Ungltiges Maschinen-Konto"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Zugriff verweigert"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Sie mssen Ihr Passwort jetzt ndern"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Ihr Passwort luft heute ab.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Ihr Passwort wird in %d %s ungltig.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "Tagen"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "Tag"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Kulanzanmeldung. Bitte ndern sie ihr Passwort sobald sie wieder online sind"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Domnen-Controller unerreichbar. Anmeldung erfolgte mit gespeicherten Anmeldedaten. Netzwerk-Ressourcen knnen momentan nicht verfgbar sein"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-"Anforderung eines Kerberos-Tickets wegen Zeitunterschied zum \n"
-"Domnen-Controller fehlgeschlagen. Bitte berprfen Sie die Systemzeit.\n"
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Ihr Passwort "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "muss mindestens %d Zeichen lang sein; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "kann keines der %d vorherigen Passwrter enthalten; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "muss Grobuchstaben, Ziffern oder Punktzeichen enthalten; kann nicht den Benutzer- oder vollen Namen enthalten; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Bitte whlen Sie ein anderes Passwort. Geben Sie ein geeignetes Passwort in beide Textfelder ein."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr "Anlegen des Verzeichnisses: %s fehlgeschlagen: %s"
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Passwort gengt nicht den Komplexittsanforderungen"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr "Benuzername: "
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Passwort: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-#, fuzzy
-msgid "Changing password for"
-msgstr "ndere Passwort fr"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(aktuelles) NT Passwort: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Neues NT Passwort eingeben: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Neues NT Passwort wiederholen: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr "Passwrter stimmen leider nicht berein"
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Zugriff verweigert"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Sie mssen Ihr Passwort jetzt ndern"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Passwort ist zu kurz"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Passwort ist zu kurz"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Passwort ist zu kurz"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Passwort: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Ihr Passwort "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Passwort ist zu kurz"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Ungltiges Maschinen-Konto"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Ihr Passwort ist abgelaufen"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Keine Domnen-Controller gefunden"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Keine Anmeldeserver verfgbar"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Kein primrer Domnen-Controller verfgbar"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Ungltiges Maschinen-Konto"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Keine Anmeldeserver verfgbar"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/es.po samba3/source3/locale/pam_winbind/es.po
--- samba3/source3/locale/pam_winbind/es.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/es.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-04 14:32\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Correcto"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "No hay un controlador de dominio principal disponible"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "No se han encontrado controladores de dominio"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "No hay servidores de inicio de sesin"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "La contrasea es demasiado corta"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "La contrasea de este usuario es demasiado reciente como para cambiarla"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "La contrasea ya se encuentra en el historial de contraseas"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Su contrasea ha caducado"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Debe cambiar su contrasea ahora"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "No dispone de la autorizacin necesaria para iniciar sesin desde esta estacin de trabajo"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "No dispone de la autorizacin necesaria para iniciar sesin en este momento"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Su cuenta ha caducado. Pngase en contacto con el administrador del sistema."
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Su cuenta est inhabilitada. Pngase en contacto con el administrador del sistema."
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Su cuenta ha sido bloqueada. Pngase en contacto con el administrador del sistema."
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Cuenta de confianza no vlida"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Acceso denegado"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Debe cambiar su contrasea ahora"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "La contrasea caduca hoy.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "La contrasea caducar en %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "das"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "da"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Inicio de sesin en periodo de gracia. Cambie su contrasea tan pronto como vuelva a estar en lnea."
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "No se encuentra el controlador de dominio, por lo que se utilizarn las credenciales del cach en su lugar. Es posible que los recursos de red no estn disponibles."
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Su contrasea "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "debe tener al menos %d caracteres; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "no puede repetir ninguna de sus %d contraseas anteriores; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "debe contener letras en mayscula, nmeros o signos de puntuacin y no puede contener su nombre de cuenta ni su nombre completo; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Introduzca una contrasea diferente. Escriba una contrasea que cumpla estos requisitos en ambos campos de texto."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "La contrasea no cumple con los requisitos de complejidad solicitados"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Contrasea:"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Cambiando la contrasea para"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "Contrasea de NT (actual): "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Introduzca la nueva contrasea de NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Vuelva a introducir la nueva contrasea de NT: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Acceso denegado"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Debe cambiar su contrasea ahora"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "La contrasea es demasiado corta"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "La contrasea es demasiado corta"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "La contrasea es demasiado corta"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Contrasea:"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Su contrasea "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "La contrasea es demasiado corta"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Cuenta de confianza no vlida"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Su contrasea ha caducado"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "No se han encontrado controladores de dominio"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "No hay servidores de inicio de sesin"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "No hay un controlador de dominio principal disponible"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Cuenta de confianza no vlida"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "No hay servidores de inicio de sesin"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/fi.po samba3/source3/locale/pam_winbind/fi.po
--- samba3/source3/locale/pam_winbind/fi.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/fi.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,563 +0,0 @@
-# translation of pam_winbind.fi.po to suomi
-# Jyri Palokangas <jmp@opensuse.org>, 2008.
-# Jyri Palokangas <jyri.palokangas@opensuse.org>, 2008.
-# Mikko Piippo <mikko.piippo@opensuse.fi>, 2008.
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind.fi\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2008-11-23 17:53+0200\n"
-"Last-Translator: Jyri Palokangas <jyri.palokangas@opensuse.org>\n"
-"Language-Team: suomi <fi@li.org>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"X-Generator: KBabel 1.11.4\n"
-"Plural-Forms: nplurals=2; plural=n != 1;\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Onnistui"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Ensisijaista toimialueen ohjainta ei kytettviss"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Toimialueen ohjaimia ei lytynyt"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Ei kirjautumispalvelimia"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Liian lyhyt salasana"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Tmn kyttjn salasana on liian uusi muutettavaksi"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Salasana lytyy jo salasana historiasta"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Salasanasi on vanhentunut"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Salasana tytyy vaihtaa nyt"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Sinulla ei ole oikeutta kirjautua tlt tyasemalta"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Sinulla ei ole oikeutta kirjautua thn aikaan."
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Tilisi on vanhentunut. Ota yhteytt jrjestelmn yllpitjn"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Tilisi ei ole kytss. Ota yhteytt jrjestelmn yllpitjn"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Tilisi on lukittu. Ota yhteytt jrjestelmn yllpitjn"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Virheellinen luottotili"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Psy estetty"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Salasana tytyy vaihtaa nyt"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Salasanasi vanhenee tnn.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Salasanasi vanhenee %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "piv"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "piv"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Ok. Mutta vain tmn kerran. Muuta salasana heti kun mahdollista."
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Toimialueen ohjaimeen ei saatu yhteytt. Kytetn vlimuistin tietoja. Verkkopalveluita ei kenties voida kytt."
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-"Kerberos lippuvlimuistin todentaminen eponnistui johtuen aika eroavaisuuksista\n"
-"toimialueohjaimen kanssa.  Tarkista jjestelmn aika asetukset.\n"
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Salasanasi "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "tytyy olla vhintn %d merkki; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "ei voi toistaa mitn edellisist %d salasanasta; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "tytyy sislt suuraakkosia, numeroita tai vlimerkkej eik se saa sislt kyttjn tilin nime tai koko nime; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Anna erilainen salasana. Anna molempiin laatikoihin tarpeeksi monimutkainen salasana."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Salasana ei ole tarpeeksi monimutkainen."
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr "Kyttjnimi: "
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Salasana: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Vaihdetaan salasana kyttjlle"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(nykyinen) NT-salasana: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Anna uusi NT-salasana: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Anna uusi NT-salasana uudestaan: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr "Salasanat eivt tsm"
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Psy estetty"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Salasana tytyy vaihtaa nyt"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Liian lyhyt salasana"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Liian lyhyt salasana"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Liian lyhyt salasana"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Salasana: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Salasanasi "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Liian lyhyt salasana"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Virheellinen luottotili"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Salasanasi on vanhentunut"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Toimialueen ohjaimia ei lytynyt"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Ei kirjautumispalvelimia"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Ensisijaista toimialueen ohjainta ei kytettviss"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Virheellinen luottotili"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Ei kirjautumispalvelimia"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/fr.po samba3/source3/locale/pam_winbind/fr.po
--- samba3/source3/locale/pam_winbind/fr.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/fr.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,546 +0,0 @@
-# This file is distributed under the same license as the pam_winbind package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-# Copyright (C) 2010 Christian Perrier <bubulle@debian.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2010-01-15 19:18+0100\n"
-"Last-Translator: Christian Perrier <bubulle@debian.org>\n"
-"Language-Team: French <debian-l10n-french@lists.debian.org>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"X-Generator: Lokalize 1.0\n"
-"Plural-Forms: nplurals=2; plural=(n > 1);\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Succs"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Aucun contrleur de domaine principal disponible"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Aucun contrleur de domaine trouv"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Aucun serveur d'authentification"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Mot de passe trop court"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Le mot de passe de cet utilisateur est trop rcent pour tre modifi."
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Ce mot de passe est dans l'historique des mots de passe utiliss."
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Votre mot de passe a expir."
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Vous devez changer votre mot de passe maintenant."
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Vous n'avez pas l'autorisation de vous connecter depuis cet ordinateur."
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Vous n'avez pas l'autorisation de vous connecter  cette heure."
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Votre compte a expir. Contactez votre administrateur systme."
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Votre compte a t dsactiv. Contactez votre administrateur systme."
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Votre compte a t verrouill. Contactez votre administrateur systme."
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Compte d'approbation non valable"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Accs refus"
-
-#: ../../../nsswitch/pam_winbind.c:818
-msgid "Do you want to change your password now?"
-msgstr "Voulez-vous changer votre mot de passe maintenant ?"
-
-#: ../../../nsswitch/pam_winbind.c:902
-msgid "Your password expires today.\n"
-msgstr "Votre mot de passe expire aujourd'hui.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Votre mot de passe expirera dans %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "jours"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "jour"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr "Impossible de convertir le groupe %s en sid, veuillez contacter votre administrateur pour voir si le groupe %s est valide."
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Dlai de grce. Veuillez changer votre mot de passe  votre prochaine connexion."
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Le contrleur de domaine est injoignable. Les donns d'identification en cache seront utilises. Certaines ressources rseaux seront indisponibles."
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-"Impossible d'tablir votre cache Kerberos Ticket en raison d'une diffrence\n"
-"de temps avec le contrleur de domaine.  Veuillez vrifier l'heure systme.\n"
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Votre mot de passe "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "doit contenir au moins %d caractres; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "ne peut tre identique  un de vos %d prcdents mots de passe ; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "doit contenir des majuscules, des chiffres ou des signes de ponctuation et ne doit pas contenir votre nom ou votre identifiant; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Veuillez choisir un autre mot de passe qui satisfasse les diffrents critres."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr "La cration du rpertoire %s a chou : %s"
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Le mot de passe n'est pas suffisamment complexe."
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr "Nom d'utilisateur : "
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Mot de passe : "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Changement du mot de passe pour"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "Mot de passe NT actuel : "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Nouveau mot de passe NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Confirmation du nouveau mot de passe NT: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr "Dsol, les mots de passe ne correspondent pas."
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr "Erreur indtermine"
-
-#: ../../libsmb/nterr.c:560
-msgid "Access denied"
-msgstr "Accs refus"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr "Compte bloqu"
-
-#: ../../libsmb/nterr.c:562
-msgid "Must change password"
-msgstr "Doit changer son mot de passe"
-
-#: ../../libsmb/nterr.c:563
-msgid "Password is too short"
-msgstr "Mot de passe trop court"
-
-#: ../../libsmb/nterr.c:564
-msgid "Password is too recent"
-msgstr "Mot de passe trop rcent"
-
-#: ../../libsmb/nterr.c:565
-msgid "Password history conflict"
-msgstr "Mot de passe en conflit avec l'historique"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr "Nom de compte incorrectement form"
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr "L'utilisateur existe"
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr "Pas de tel utilisateur"
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr "Le groupe existe"
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr "Pas de tel groupe"
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr "Pas membre de ce groupe"
-
-#: ../../libsmb/nterr.c:573
-msgid "Wrong Password"
-msgstr "Mot de passe incorrect"
-
-#: ../../libsmb/nterr.c:574
-msgid "Ill formed password"
-msgstr "Mot de passe mal form"
-
-#: ../../libsmb/nterr.c:575
-msgid "Password restriction"
-msgstr "Restriction relative au mot de passe"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr "Echec de connexion"
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr "Restriction de compte"
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr "Heures de connexion non valides"
-
-#: ../../libsmb/nterr.c:579
-msgid "Invalid workstation"
-msgstr "Ordinateur non valide"
-
-#: ../../libsmb/nterr.c:580
-msgid "Password expired"
-msgstr "Mot de passe expir"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr "Compte dsactiv"
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr "Erreur d'allocation mmoire"
-
-#: ../../libsmb/nterr.c:583
-msgid "No domain controllers located"
-msgstr "Aucun contrleur de domaine trouv"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr "Relais nomm indisponible"
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr "Pas implment"
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr "Classe d'information non valide"
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr "Longueur d'information incohrente"
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr "Violation d'accs"
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr "Rfrence non valide"
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr "Paramtre non valide"
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr "Pas de mmoire"
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr "Tampon trop petit"
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr "Rvisions incompatibles"
-
-#: ../../libsmb/nterr.c:594
-msgid "No such logon session"
-msgstr "Pas de telle session de connexion"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr "Pas de tel privilge"
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr "Procdure non trouve"
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr "Serveur dsactiv"
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr "Etat du relais non valide"
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr "Relais nomm occup"
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr "Fonction illgale"
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr "Relais nomm dconnect"
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr "Le relais nomm va fermer"
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr "Le serveur distant n'coute pas"
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr "Nom en double sur le rseau"
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr "La file d'impression est pleine"
-
-#: ../../libsmb/nterr.c:606
-msgid "No print spool space available"
-msgstr "Aucun espace d'impression disponible"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr "Le nom de rseau ne peut tre trouv"
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr "La connexion a t refuse"
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr "Trop de noms"
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr "Trop de sessions"
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr "Etat du serveur non valide"
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr "Etat du domaine non valide"
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr "Rle du domaine non valide"
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr "Pas de tel domaine"
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr "Le domain existe"
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr "Limite de domaine dpasse"
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr "Mauvais tat de la session de connexion"
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr "Collision de la session de connexion"
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr "Type de connexion non valide"
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr "Annul"
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr "Nom d'ordinateur non valide"
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr "Conflit de serveurs d'authentification"
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr "Diffrence de temps au niveau du contrleur de domaine"
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr "Relais bris"
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr "Base de registre corrompue"
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr "Trop de secrets"
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr "Trop de SIDs"
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr "Chiffrement crois Lanmanager ncessaire"
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr "Journal plein"
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr "Pas de secret LSA approuv"
-
-#: ../../libsmb/nterr.c:631
-msgid "No trusted SAM account"
-msgstr "Pas de compte SAM approuv"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr "Erreur de domaine approuv"
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr "Erreur de relation d'approbation"
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr "Erreur d'approbation"
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr "Service Netlogon non dmarr"
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr "Compte expir"
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr "Conflit d'identifiants rseau"
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr "Limite de sessions distantes"
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr "Impossible de se connecter avec un compte de confiance inter-domaine"
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr "Impossible de se connecter avec un compte de confiance ordinateur"
-
-#: ../../libsmb/nterr.c:641
-msgid "No logon server trust account"
-msgstr "Impossible de se connecter avec un compte de confiance serveur"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr "Approbation du domaine incohrente"
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr "Pas de cl de session utilisateur disponible"
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr "Session utilisateur supprime"
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr "Ressources serveur insuffisantes"
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr "Informations de connexion insuffisantes"
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr "Quota de licenses dpass"
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr "Plus de fichiers"
diff -daurN samba3/source3/locale/pam_winbind/hu.po samba3/source3/locale/pam_winbind/hu.po
--- samba3/source3/locale/pam_winbind/hu.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/hu.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,559 +0,0 @@
-# translation of pam_winbind.hu.po to
-# Kalman Kemenczy <kkemenczy@novell.com>, 2008.
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind.hu\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2008-10-26 10:27+0100\n"
-"Last-Translator: Kalman Kemenczy <kkemenczy@novell.com>\n"
-"Language-Team:  <hu@li.org>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"X-Generator: KBabel 1.11.4\n"
-"Plural-Forms:  nplurals=2; plural=(n != 1);\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Sikeres"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Az elsdleges tartomnyvezrl nem rhet el"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Nem tallhat tartomnyvezrl"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Nincsenek Logon kiszolglk"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Tl rvid jelsz"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "A felhasznl jelszava j"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "A jelsz mr szerepel az elzmnyekben"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "A jelszava lejrt"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Meg kell most vltoztatnia a jelszavt"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Nem jogosult belpni errl a munkallomsrl"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Most nem jogosult most belpni"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "A felhasznli fikja lejrt. Lpjen kapcsolatba a rendszergazdval"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "A felhasznli fikja le van tiltva. Lpjen kapcsolatba a rendszergazdval"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "A felhasznli fikja zrolt. Lpjen kapcsolatba a rendszergazdval"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "rvnytelen Trust Account"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Hozzfrs megtagadva"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Meg kell most vltoztatnia a jelszavt"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "A jelszava ma jr le.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Jelszava le fog jrni %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "nap mlva"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "nap mlva"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Trelmi belps. Cserlje le a jelszavt a kvetkez alkalommal"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "A tartomny nem rhet el, a gyorstrozott hitelest adat kerl felhasznlsra. A hlzati erforrsok valsznleg nem rhatk el "
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "A jelszavnak"
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "legalbb %d karakterbl kell llnia; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "nem ismtldhet az elz %d jelsz; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "tartalmaznia kell betket, szmokat vagy rsjeleket s nem tartalmazhatja a felhasznli vagy a teljes nevt; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Adjon meg egy msik jelszt. rjon be mindkt szvegmezbe a feltteleknek megfelel jelszt."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "A jelsz nem felel meg a kvetelmnyeknek"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Jelsz: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Jelszmdosts"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(jelenlegi) NT jelsz: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "j NT jelsz: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "j NT jelsz ismt: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Hozzfrs megtagadva"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Meg kell most vltoztatnia a jelszavt"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Tl rvid jelsz"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Tl rvid jelsz"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Tl rvid jelsz"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Jelsz: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "A jelszavnak"
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Tl rvid jelsz"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "rvnytelen Trust Account"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "A jelszava lejrt"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Nem tallhat tartomnyvezrl"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Nincsenek Logon kiszolglk"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Az elsdleges tartomnyvezrl nem rhet el"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "rvnytelen Trust Account"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Nincsenek Logon kiszolglk"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/it.po samba3/source3/locale/pam_winbind/it.po
--- samba3/source3/locale/pam_winbind/it.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/it.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 10:11\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Successo"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Nessun controller di dominio primario disponibile"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Nessun controller di dominio trovato"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Nessun server d'autenticazione"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Password troppo breve"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "La password per questo utente  troppo recente per essere cambiata"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "La password  gi presente nella cronologia delle password"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "La password  scaduta"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr " necessario modificare la password ora"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Impossibile effettuare il login da questa workstation"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Impossibile effettuare il login in questo momento"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "L'account  scaduto. Contattare l'amministratore di sistema"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "L'account  disabilitato. Contattare l'amministratore di sistema"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "L'account  stato bloccato. Contattare l'amministratore di sistema"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Account attendibile non valido"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Accesso negato"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr " necessario modificare la password ora"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "La password scade oggi.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "La password scadr tra %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "giorni"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "giorno"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Login extra. Modificare la password poich a breve verr ristabilita la connessione"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Controller del dominio non raggiungibile; uso delle credenziali memorizzate al suo posto. Le risorse di rete potrebbero non essere disponibili"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "La tua password "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "deve essere composta almeno da %d caratteri; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "non puoi ripetere nessuna delle tue %d password precedenti; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "deve contenere lettere maiuscole, cifre e punteggiatura; e non pu contenere il nome del tuo account o il tuo nome completo; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Inserire una password diversa. Digita in entrambe le caselle una password che soddisfa i requisiti."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "La password non soddisfa i requisiti di complessit"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Password: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Modifica la password per"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "Password NT (corrente): "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Immetti la nuova password NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Reinserisci la nuova password NT: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Accesso negato"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr " necessario modificare la password ora"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Password troppo breve"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Password troppo breve"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Password troppo breve"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Password: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "La tua password "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Password troppo breve"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Account attendibile non valido"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "La password  scaduta"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Nessun controller di dominio trovato"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Nessun server d'autenticazione"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Nessun controller di dominio primario disponibile"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Account attendibile non valido"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Nessun server d'autenticazione"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/ja.po samba3/source3/locale/pam_winbind/ja.po
--- samba3/source3/locale/pam_winbind/ja.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/ja.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-04 15:11\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr " () "
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr " %d %s \n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr " %d ; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr " %d ; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr " () ;  () ; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr ""
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr ":"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr " NT : "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr " NT : "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr " NT : "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr ""
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr ""
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr ":"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr " "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr ""
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr ""
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/ko.po samba3/source3/locale/pam_winbind/ko.po
--- samba3/source3/locale/pam_winbind/ko.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/ko.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-04 15:02\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "      ."
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "  ."
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "  ."
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "  ."
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "          ."
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "    ."
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr " ."
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "   ."
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "    ."
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "   ."
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr " .   ."
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr " .   ."
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr " .   ."
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "  ."
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr " ."
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "   ."
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "  .\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr " %d %s  .\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr " .      . "
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "       .     . "
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr " %d  ."
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "  %d     ."
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr ",      ,       ."
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "  .        . "
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "    ."
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr ":"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "() NT :"
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr " NT  :"
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr " NT  :"
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr " ."
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "   ."
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr ":"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr " ."
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "      ."
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "  ."
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/nb.po samba3/source3/locale/pam_winbind/nb.po
--- samba3/source3/locale/pam_winbind/nb.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/nb.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,565 +0,0 @@
-# translation of pam_winbind.po to norsk bokml
-# @TITLE@
-# This file is distributed under the same license as @PACKAGE@ package. FIRST
-#
-# Olav Pettershagen <olav.pet@gmail.com>, 2008.
-# Olav P. <olav.pet@gmail.com>, 2008.
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2008-11-22 22:33+0100\n"
-"Last-Translator: Olav P. <olav.pet@gmail.com>\n"
-"Language-Team: Norwegian Bokml <>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-"X-Generator: Lokalize 0.2\n"
-"Plural-Forms: nplurals=2; plural=(n != 1);\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Vellykket"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Ingen primr domenekontroller tilgjengelig"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Ingen domenekontrollere funnet"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Ingen innloggingsservere"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Passordet er for kort"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Passordet for denne brukeren er for nytt til  endre"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Passordet finnes allerede i passordloggen"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Passordet er utlpt"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Du m endre passordet n"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Du er ikke autorisert for  logge inn fra denne arbeidsstasjonen"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Du er ikke autorisert for  logge inn p dette tidspunktet"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Din konto er utlpt. Kontakt systemadministratoren"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Din konto er deaktivert. Kontakt systemadministratoren"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Din konto er lst. Kontakt systemadministratoren"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Ugyldig plitelig konto"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Tilgang avvist"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Du m endre passordet n"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Passordet utlper i dag.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Passordet vil utlpe om %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dager"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dag"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Midlertidig innlogging. Du m endre passordet straks du er tilkoblet igjen"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Domenekontrolleren er utilgjengelig, bruker mellomlagrede rettigheter i stedet. Nettverksressurser Kan vre utilgjengelige"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-"Kunne ikke opprette mellomlager for  Kerberos-billetter p grunn av tidsdifferanse\n"
-"i forhold til domenekontroller. Kontroller systemtiden.\n"
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Passordet "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "m inneholde minst %d tegn; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "kan ikke vre likt noen av dine %d tidligere passord; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "m inneholde store bokstaver, tall eller skilletegn; og kan ikke inneholde ditt kontonavn eller fulle navn; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Angi et annet passord. Skriv inn et passord som oppfyller kriteriene i begge tekstboksene."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Passordet er for enkelt"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr "Brukernavn: "
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Passord: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Endrer passord for"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(gjeldende) NT-passord: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Angi nytt NT-passord: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Bekreft det nye NT-passordet: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr "Beklager, passordene samsvarer ikke"
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Tilgang avvist"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Du m endre passordet n"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Passordet er for kort"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Passordet er for kort"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Passordet er for kort"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Passord: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Passordet "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Passordet er for kort"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Ugyldig plitelig konto"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Passordet er utlpt"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Ingen domenekontrollere funnet"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Ingen innloggingsservere"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Ingen primr domenekontroller tilgjengelig"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Ugyldig plitelig konto"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Ingen innloggingsservere"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/nl.po samba3/source3/locale/pam_winbind/nl.po
--- samba3/source3/locale/pam_winbind/nl.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/nl.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 08:00\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Succes"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Geen primaire domeincontroller beschikbaar"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Geen domeincontroller gevonden"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Geen aanmeldservers"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Wachtwoord te kort"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Het wachtwoord van deze gebruiker is te recent om te wijzigen"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Wachtwoord zit al in de wachtwoordgeschiedenis"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Uw wachtwoord is verlopen"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "U moet uw wachtwoord nu wijzigen"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "U mag u vanaf dit werkstation niet aanmelden"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "U mag u op dit tijdstip niet aanmelden"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Uw account is verlopen. Neem contact op met uw systeembeheerder"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Uw account is uitgeschakeld. Neem contact op met de systeembeheerder"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Uw account is vergrendeld. Meen contact op met uw systeembeheerder"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Ongeldige vertrouwde account"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Toegang geweigerd"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "U moet uw wachtwoord nu wijzigen"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Uw wachtwoord verloopt vandaag.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Uw wachtwoord verloopt over %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dagen"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dag"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Dispensatie-aanmelding. Wijzig uw wachtwoord zodra u weer online bent"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Domeincontroller is onbereikbaar. Uw gegevens uit de cache worden gebruikt. Netwerkrecources kunnen onbereikbaar zijn"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Uw wachtwoord "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "moet uit minstens %d tekens bestaan; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "mag niet hetzelfde zijn als een van uw voorgaande %d wachtwoorden; "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "moet hoofdletters, cijfers of bijzondere tekens bevatten; en mag niet uw accountnaam of volledige naam bevatten; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Geef een ander wachtwoord op. Typ een wachtwoord dat voldoet aan de vereisten in beide tekstblokken."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Wachtwoord voldoet niet aan de complexiteitseisen"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Wachtwoord:"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Wachtwoord wijzigen voor"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(huidig) NT-wachtwoord: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Geef nieuw NT-wachtwoord: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Nieuw NT-wachtwoord herhalen: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Toegang geweigerd"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "U moet uw wachtwoord nu wijzigen"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Wachtwoord te kort"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Wachtwoord te kort"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Wachtwoord te kort"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Wachtwoord:"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Uw wachtwoord "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Wachtwoord te kort"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Ongeldige vertrouwde account"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Uw wachtwoord is verlopen"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Geen domeincontroller gevonden"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Geen aanmeldservers"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Geen primaire domeincontroller beschikbaar"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Ongeldige vertrouwde account"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Geen aanmeldservers"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/pl.po samba3/source3/locale/pam_winbind/pl.po
--- samba3/source3/locale/pam_winbind/pl.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/pl.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-13 18:27\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Sukces"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Brak podstawowego kontolera domeny"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Nie odnaleziono kontrolerw domen"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Brak serwerw logowania"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Zbyt krtkie haso"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Haso tego uytkownika jest zbyt nowe, aby je zmieni"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Haso znajduje si ju w historii hase."
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Haso uytkownika wygaso"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Zmiana hasa jest wymagana w tej chwili"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Brak zezwolenia na logowanie si z tej stacji roboczej"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Brak zezwolenia na logowanie si w tej chwili"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "To konto wygaso. Prosz skontaktowa si z administratorem systemu."
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "To konto zostao wyczone. Prosz skontaktowa si z administratorem systemu."
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "To konto zostao zablokowane. Prosz skontaktowa si z administratorem systemu."
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Nieprawidowe zaufane konto"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "Brak dostpu"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Zmiana hasa jest wymagana w tej chwili"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Haso uytkownika wygasa dzisiaj.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Haso uytkownika wyganie za %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dni"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dzie"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Logowanie dodatkowe. Prosz zmieni swoje haso przy nastpnym wejciu w tryb online."
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Kontroler domeny jest nieosigalny, zamiast tego uywane s zapisane wczeniej dane. Zasoby sieciowe mog by niedostpne."
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Haso uytkownika "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "musi mie co najmniej %d znakw; "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "nie mona powtarza adnego z poprzednich %d hase, "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "musi zawiera litery, cyfry lub znaki interpunkcyjne i nie moe zawiera nazwy konta lub nazwiska; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Prosz wprowadzi inne haso. Prosz wpisa w oba pola tekstowe haso, ktre spenia te wymagania."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Haso nie spenia wymaga zoonoci"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Haso: "
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Zmiana hasa dla"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(aktualne) haso NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Prosze poda nowe haso NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Powtrzenie nowego hasa NT: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "Brak dostpu"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Zmiana hasa jest wymagana w tej chwili"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Zbyt krtkie haso"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Zbyt krtkie haso"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Zbyt krtkie haso"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Haso: "
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Haso uytkownika "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Zbyt krtkie haso"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Nieprawidowe zaufane konto"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Haso uytkownika wygaso"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Nie odnaleziono kontrolerw domen"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Brak serwerw logowania"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Brak podstawowego kontolera domeny"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Nieprawidowe zaufane konto"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Brak serwerw logowania"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/pt_BR.po samba3/source3/locale/pam_winbind/pt_BR.po
--- samba3/source3/locale/pam_winbind/pt_BR.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/pt_BR.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 09:28\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Sucesso"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Nenhum Controlador de Domnio primrio disponvel"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Nenhum controlador de domnio encontrado"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Nenhum servidor de logon"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Senha muito curta"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "A senha deste usurio  muito recente para ser alterada"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "A senha j est no histrico de senhas"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Sua senha expirou"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Voc precisa alterar sua senha agora"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Voc no tem autorizao para efetuar login a partir desta estao de trabalho"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Voc no tem autorizao para efetuar login agora"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Sua conta expirou. Entre em contato com o administrador do sistema"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Sua conta est desabilitada. Entre em contato com o administrador do sistema"
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Sua conta foi bloqueada. Entre em contato com o administrador do sistema"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Conta Confivel Invlida"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "O acesso foi negado"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Voc precisa alterar sua senha agora"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Sua senha expira hoje.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Sua senha expirar em %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dias"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dia"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Login extra. Altere sua senha assim que voc ficar online novamente"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Controlador de domnio inacessvel, usando no lugar dele credencias em cache. Os recursos de rede podem estar indisponveis"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Sua senha"
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "deve ter no mnimo %d caracteres;"
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "no  permitido repetir quaisquer das suas %d senhas anteriores;"
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "deve conter maisculas, nmeros ou pontuao e no pode conter o nome de sua conta nem seu nome completo;"
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Digite uma senha diferente. Digite uma senha que atenda a estes requisitos em ambas as caixas de texto."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "A senha no atende aos requisitos de complexidade"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Senha:"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "Alterando a senha para"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(atual) senha NT:"
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Digite a nova senha NT:"
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Redigite a nova senha NT:"
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "O acesso foi negado"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Voc precisa alterar sua senha agora"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Senha muito curta"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Senha muito curta"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Senha muito curta"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Senha:"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Sua senha"
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Senha muito curta"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Conta Confivel Invlida"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Sua senha expirou"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Nenhum controlador de domnio encontrado"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Nenhum servidor de logon"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Nenhum Controlador de Domnio primrio disponvel"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Conta Confivel Invlida"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Nenhum servidor de logon"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/ru.po samba3/source3/locale/pam_winbind/ru.po
--- samba3/source3/locale/pam_winbind/ru.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/ru.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 08:14\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "   "
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "  "
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "  "
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "    ,   "
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "    "
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "     "
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "       "
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "      "
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "     . ,    "
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "   .    "
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "   . ,    "
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "   "
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "     "
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "     .\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "      %d %s.\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr " . ,   ,       "
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "  ,     .     "
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "  "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "    %d ;"
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "       %d ;"
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "   ,    ;          ; "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr ",   .  ,   ,    ."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "    "
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr ":"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "  "
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "()  NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "   NT: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "   NT: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr " "
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "     "
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr ":"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "    "
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "   "
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "  "
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/sv.po samba3/source3/locale/pam_winbind/sv.po
--- samba3/source3/locale/pam_winbind/sv.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/sv.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 07:23\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr "Lyckades"
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr "Det finns ingen tillgnglig primr domnkontrollant"
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr "Inga domnkontrollanter hittades"
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr "Inga inloggningsservrar"
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr "Lsenordet r fr kort"
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr "Lsenordet fr den hr anvndaren r fr nytt fr att kunna ndras"
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr "Lsenordet finns redan i lsenordshistoriken"
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr "Ditt lsenord gller inte lngre"
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr "Du mste ndra ditt lsenord nu"
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr "Du kan inte logga in frn den hr arbetsstationen"
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr "Du kan inte logga in just nu"
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr "Ditt konto gller inte lngre. Kontakta systemadministratren"
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr "Ditt konto har inaktiverats. Kontakta systemadministratren."
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr "Ditt konto har lsts. Kontakta systemadministratren"
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr "Ogiltigt frtroendekonto"
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr "tkomst nekades"
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr "Du mste ndra ditt lsenord nu"
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "Ditt lsenord upphr att glla i dag.\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "Ditt lsenord slutar glla om %d %s/\n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr "dagar"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr "dag"
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr "Inloggningsrknaren har aktiverats. ndra ditt lsenord s fort du ansluter igen"
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr "Det gick inte att ansluta till domnkontrollanten. Cachelagrade inloggningsuppgifter anvnds i stllet. Ntverksresurserna kanske inte r tillgngliga"
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr "Ditt lsenord"
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr "mste vara minst %d tecken lngt, "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr "fr inte vara identiskt med ngot av dina %d senaste lsenord "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr "mste innehlla versaler, siffror eller skiljetecken och fr inte innehlla ditt kontonamn eller ditt fullstndiga namn,"
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr "Skriv ett annat lsenord. Skriv ett lsenord som uppfyller kraven i bda textrutorna."
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr "Lsenordet uppfyller inte kraven p komplexitet"
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr "Lsenord:"
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr "ndrar lsenord fr"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "(aktuellt) NT-lsenord:"
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr "Ange det nya NT-lsenordet: "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr "Skriv det nya NT-lsenordet igen: "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr "tkomst nekades"
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr "Du mste ndra ditt lsenord nu"
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr "Lsenordet r fr kort"
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr "Lsenordet r fr kort"
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr "Lsenordet r fr kort"
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr "Lsenord:"
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr "Ditt lsenord"
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr "Lsenordet r fr kort"
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr "Ogiltigt frtroendekonto"
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr "Ditt lsenord gller inte lngre"
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr "Inga domnkontrollanter hittades"
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr "Inga inloggningsservrar"
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr "Det finns ingen tillgnglig primr domnkontrollant"
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr "Ogiltigt frtroendekonto"
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr "Inga inloggningsservrar"
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/zh_CN.po samba3/source3/locale/pam_winbind/zh_CN.po
--- samba3/source3/locale/pam_winbind/zh_CN.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/zh_CN.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-05 09:53\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr " %d %s \n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr " %d  "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr " %d  "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr " "
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr ""
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr ""
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "NT  "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr " NT  "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr " NT  "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr ""
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr ""
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr " "
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr ""
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr ""
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/locale/pam_winbind/zh_TW.po samba3/source3/locale/pam_winbind/zh_TW.po
--- samba3/source3/locale/pam_winbind/zh_TW.po	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/locale/pam_winbind/zh_TW.po	1970-01-01 01:00:00.000000000 +0100
@@ -1,558 +0,0 @@
-# This file is distributed under the same license as the package.
-#
-# Copyright (C) 2009 Lars Mueller <lars@samba.org>
-msgid ""
-msgstr ""
-"Project-Id-Version: pam_winbind\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-03-06 01:55+0800\n"
-"PO-Revision-Date: 2009-02-04 15:44\n"
-"Last-Translator: Novell Language <language@novell.com>\n"
-"Language-Team: Novell Language <language@novell.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=UTF-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: ../../../nsswitch/pam_winbind.c:583 ../../libsmb/nterr.c:558
-msgid "Success"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:585
-msgid "No primary Domain Controler available"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:587
-msgid "No domain controllers found"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:589 ../../libsmb/nterr.c:566
-msgid "No logon servers"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:591
-msgid "Password too short"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:593
-msgid "The password of this user is too recent to change"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:595
-msgid "Password is already in password history"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:597
-msgid "Your password has expired"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:599
-msgid "You need to change your password now"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:601
-msgid "You are not allowed to logon from this workstation"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:603
-msgid "You are not allowed to logon at this time"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:605
-msgid "Your account has expired. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:608
-msgid "Your account is disabled. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:611
-msgid "Your account has been locked. Please contact your System administrator"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:614 ../../../nsswitch/pam_winbind.c:616 ../../../nsswitch/pam_winbind.c:618
-msgid "Invalid Trust Account"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:620
-msgid "Access is denied"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:818
-#, fuzzy
-msgid "Do you want to change your password now?"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:902
-#, fuzzy
-msgid "Your password expires today.\n"
-msgstr "\n"
-
-#: ../../../nsswitch/pam_winbind.c:932
-#, fuzzy, c-format
-msgid "Your password will expire in %d %s.\n"
-msgstr "  %d %s \n"
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "days"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:933
-msgid "day"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1169 ../../../nsswitch/pam_winbind.c:1193
-#, c-format
-msgid "Cannot convert group %s to sid, please contact your administrator to see if group %s is valid."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1387
-msgid "Grace login. Please change your password as soon you're online again"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1397
-msgid "Domain Controller unreachable, using cached credentials instead. Network resources may be unavailable"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1422
-msgid ""
-"Failed to establish your Kerberos Ticket cache due time differences\n"
-"with the domain controller.  Please verify the system time.\n"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1490
-msgid "Your password "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1497
-#, c-format
-msgid "must be at least %d characters; "
-msgstr " %d "
-
-#: ../../../nsswitch/pam_winbind.c:1506
-#, c-format
-msgid "cannot repeat any of your previous %d passwords; "
-msgstr " %d "
-
-#: ../../../nsswitch/pam_winbind.c:1516
-msgid "must contain capitals, numerals or punctuation; and cannot contain your account or full name; "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1526
-msgid "Please type a different password. Type a password which meets these requirements in both text boxes."
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:1553
-#, c-format
-msgid "Creating directory: %s failed: %s"
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2018
-msgid "Password does not meet complexity requirements"
-msgstr ""
-
-#.
-#. * First get the name of a user
-#.
-#: ../../../nsswitch/pam_winbind.c:2489 ../../../nsswitch/pam_winbind.c:3035
-msgid "Username: "
-msgstr ""
-
-#: ../../../nsswitch/pam_winbind.c:2665
-msgid "Password: "
-msgstr ""
-
-#. instruct user what is happening
-#: ../../../nsswitch/pam_winbind.c:3073
-msgid "Changing password for"
-msgstr " -"
-
-#: ../../../nsswitch/pam_winbind.c:3086
-msgid "(current) NT password: "
-msgstr "() NT "
-
-#: ../../../nsswitch/pam_winbind.c:3156
-msgid "Enter new NT password: "
-msgstr " NT "
-
-#: ../../../nsswitch/pam_winbind.c:3157
-msgid "Retype new NT password: "
-msgstr " NT "
-
-#.
-#. * here is the string to inform the user that the new passwords they
-#. * typed were not the same.
-#.
-#: ../../../nsswitch/pam_winbind.h:128
-msgid "Sorry, passwords do not match"
-msgstr ""
-
-#: ../../libsmb/nterr.c:559
-msgid "Undetermined error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:560
-#, fuzzy
-msgid "Access denied"
-msgstr ""
-
-#: ../../libsmb/nterr.c:561
-msgid "Account locked out"
-msgstr ""
-
-#: ../../libsmb/nterr.c:562
-#, fuzzy
-msgid "Must change password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:563
-#, fuzzy
-msgid "Password is too short"
-msgstr ""
-
-#: ../../libsmb/nterr.c:564
-#, fuzzy
-msgid "Password is too recent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:565
-#, fuzzy
-msgid "Password history conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:567
-msgid "Improperly formed account name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:568
-msgid "User exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:569
-msgid "No such user"
-msgstr ""
-
-#: ../../libsmb/nterr.c:570
-msgid "Group exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:571
-msgid "No such group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:572
-msgid "Member not in group"
-msgstr ""
-
-#: ../../libsmb/nterr.c:573
-#, fuzzy
-msgid "Wrong Password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:574
-#, fuzzy
-msgid "Ill formed password"
-msgstr ""
-
-#: ../../libsmb/nterr.c:575
-#, fuzzy
-msgid "Password restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:576
-msgid "Logon failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:577
-msgid "Account restriction"
-msgstr ""
-
-#: ../../libsmb/nterr.c:578
-msgid "Invalid logon hours"
-msgstr ""
-
-#: ../../libsmb/nterr.c:579
-#, fuzzy
-msgid "Invalid workstation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:580
-#, fuzzy
-msgid "Password expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:581
-msgid "Account disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:582
-msgid "Memory allocation error"
-msgstr ""
-
-#: ../../libsmb/nterr.c:583
-#, fuzzy
-msgid "No domain controllers located"
-msgstr ""
-
-#: ../../libsmb/nterr.c:584
-msgid "Named pipe not available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:585
-msgid "Not implemented"
-msgstr ""
-
-#: ../../libsmb/nterr.c:586
-msgid "Invalid information class"
-msgstr ""
-
-#: ../../libsmb/nterr.c:587
-msgid "Information length mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:588
-msgid "Access violation"
-msgstr ""
-
-#: ../../libsmb/nterr.c:589
-msgid "Invalid handle"
-msgstr ""
-
-#: ../../libsmb/nterr.c:590
-msgid "Invalid parameter"
-msgstr ""
-
-#: ../../libsmb/nterr.c:591
-msgid "No memory"
-msgstr ""
-
-#: ../../libsmb/nterr.c:592
-msgid "Buffer too small"
-msgstr ""
-
-#: ../../libsmb/nterr.c:593
-msgid "Revision mismatch"
-msgstr ""
-
-#: ../../libsmb/nterr.c:594
-#, fuzzy
-msgid "No such logon session"
-msgstr ""
-
-#: ../../libsmb/nterr.c:595
-msgid "No such privilege"
-msgstr ""
-
-#: ../../libsmb/nterr.c:596
-msgid "Procedure not found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:597
-msgid "Server disabled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:598
-msgid "Invalid pipe state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:599
-msgid "Named pipe busy"
-msgstr ""
-
-#: ../../libsmb/nterr.c:600
-msgid "Illegal function"
-msgstr ""
-
-#: ../../libsmb/nterr.c:601
-msgid "Named pipe disconnected"
-msgstr ""
-
-#: ../../libsmb/nterr.c:602
-msgid "Named pipe closing"
-msgstr ""
-
-#: ../../libsmb/nterr.c:603
-msgid "Remote host not listening"
-msgstr ""
-
-#: ../../libsmb/nterr.c:604
-msgid "Duplicate name on network"
-msgstr ""
-
-#: ../../libsmb/nterr.c:605
-msgid "Print queue is full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:606
-#, fuzzy
-msgid "No print spool space available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:607
-msgid "The network name cannot be found"
-msgstr ""
-
-#: ../../libsmb/nterr.c:608
-msgid "The connection was refused"
-msgstr ""
-
-#: ../../libsmb/nterr.c:609
-msgid "Too many names"
-msgstr ""
-
-#: ../../libsmb/nterr.c:610
-msgid "Too many sessions"
-msgstr ""
-
-#: ../../libsmb/nterr.c:611
-msgid "Invalid server state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:612
-msgid "Invalid domain state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:613
-msgid "Invalid domain role"
-msgstr ""
-
-#: ../../libsmb/nterr.c:614
-msgid "No such domain"
-msgstr ""
-
-#: ../../libsmb/nterr.c:615
-msgid "Domain exists"
-msgstr ""
-
-#: ../../libsmb/nterr.c:616
-msgid "Domain limit exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:617
-msgid "Bad logon session state"
-msgstr ""
-
-#: ../../libsmb/nterr.c:618
-msgid "Logon session collision"
-msgstr ""
-
-#: ../../libsmb/nterr.c:619
-msgid "Invalid logon type"
-msgstr ""
-
-#: ../../libsmb/nterr.c:620
-msgid "Cancelled"
-msgstr ""
-
-#: ../../libsmb/nterr.c:621
-msgid "Invalid computer name"
-msgstr ""
-
-#: ../../libsmb/nterr.c:622
-msgid "Logon server conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:623
-msgid "Time difference at domain controller"
-msgstr ""
-
-#: ../../libsmb/nterr.c:624
-msgid "Pipe broken"
-msgstr ""
-
-#: ../../libsmb/nterr.c:625
-msgid "Registry corrupt"
-msgstr ""
-
-#: ../../libsmb/nterr.c:626
-msgid "Too many secrets"
-msgstr ""
-
-#: ../../libsmb/nterr.c:627
-msgid "Too many SIDs"
-msgstr ""
-
-#: ../../libsmb/nterr.c:628
-msgid "Lanmanager cross encryption required"
-msgstr ""
-
-#: ../../libsmb/nterr.c:629
-msgid "Log file full"
-msgstr ""
-
-#: ../../libsmb/nterr.c:630
-msgid "No trusted LSA secret"
-msgstr ""
-
-#: ../../libsmb/nterr.c:631
-#, fuzzy
-msgid "No trusted SAM account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:632
-msgid "Trusted domain failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:633
-msgid "Trust relationship failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:634
-msgid "Trust failure"
-msgstr ""
-
-#: ../../libsmb/nterr.c:635
-msgid "Netlogon service not started"
-msgstr ""
-
-#: ../../libsmb/nterr.c:636
-msgid "Account expired"
-msgstr ""
-
-#: ../../libsmb/nterr.c:637
-msgid "Network credential conflict"
-msgstr ""
-
-#: ../../libsmb/nterr.c:638
-msgid "Remote session limit"
-msgstr ""
-
-#: ../../libsmb/nterr.c:639
-msgid "No logon interdomain trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:640
-msgid "No logon workstation trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:641
-#, fuzzy
-msgid "No logon server trust account"
-msgstr ""
-
-#: ../../libsmb/nterr.c:642
-msgid "Domain trust inconsistent"
-msgstr ""
-
-#: ../../libsmb/nterr.c:643
-msgid "No user session key available"
-msgstr ""
-
-#: ../../libsmb/nterr.c:644
-msgid "User session deleted"
-msgstr ""
-
-#: ../../libsmb/nterr.c:645
-msgid "Insufficient server resources"
-msgstr ""
-
-#: ../../libsmb/nterr.c:646
-msgid "Insufficient logon information"
-msgstr ""
-
-#: ../../libsmb/nterr.c:648
-msgid "License quota exceeded"
-msgstr ""
-
-#: ../../libsmb/nterr.c:649
-msgid "No more files"
-msgstr ""
diff -daurN samba3/source3/Makefile.in samba3/source3/Makefile.in
--- samba3/source3/Makefile.in	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/Makefile.in	2024-08-04 17:52:53.000000000 +0200
@@ -63,32 +63,32 @@
 TERMLDFLAGS=@TERMLDFLAGS@
 TERMLIBS=@TERMLIBS@
 PRINT_LIBS=@PRINT_LIBS@
-ZLIB_LIBS=@ZLIB_LIBS@
+ZLIB_LIBS=@ZLIB_LIBS@ -ldl
 AUTH_LIBS=@AUTH_LIBS@
 ACL_LIBS=@ACL_LIBS@
 PASSDB_LIBS=@PASSDB_LIBS@
 IDMAP_LIBS=@IDMAP_LIBS@
 KRB5LIBS=@KRB5_LIBS@
 LDAP_LIBS=@LDAP_LIBS@
-NSCD_LIBS=@NSCD_LIBS@
+NSCD_LIBS=@NSCD_LIBS@ -ldl
 UUID_LIBS=@UUID_LIBS@
 LIBWBCLIENT=@LIBWBCLIENT_STATIC@ @LIBWBCLIENT_SHARED@
-LIBWBCLIENT_LIBS=@LIBWBCLIENT_LIBS@
-PTHREAD_LDFLAGS=@PTHREAD_LDFLAGS@
+LIBWBCLIENT_LIBS=@LIBWBCLIENT_STATIC@
+PTHREAD_LDFLAGS=@PTHREAD_LDFLAGS@ -ldl
 PTHREAD_CFLAGS=@PTHREAD_CFLAGS@
 DNSSD_LIBS=@DNSSD_LIBS@
 AVAHI_LIBS=@AVAHI_LIBS@
 POPT_LIBS=@POPTLIBS@
 LIBTALLOC=@LIBTALLOC_STATIC@ @LIBTALLOC_SHARED@
-LIBTALLOC_LIBS=@LIBTALLOC_LIBS@
+LIBTALLOC_LIBS=@LIBTALLOC_STATIC@
 LIBTEVENT=@LIBTEVENT_STATIC@ @LIBTEVENT_SHARED@
 LIBTEVENT_LIBS=@LIBTEVENT_LIBS@
 LIBREPLACE_LIBS=@LIBREPLACE_LIBS@
 LIBTDB=@LIBTDB_STATIC@ @LIBTDB_SHARED@
-LIBTDB_LIBS=@LIBTDB_LIBS@
+LIBTDB_LIBS=@LIBTDB_STATIC@
 TDB_DEPS=@TDB_DEPS@
 LIBNETAPI=@LIBNETAPI_STATIC@ @LIBNETAPI_SHARED@
-LIBNETAPI_LIBS=@LIBNETAPI_LIBS@
+LIBNETAPI_LIBS=@LIBNETAPI_STATIC@
 LIBSMBCLIENT_LIBS=@LIBSMBCLIENT_LIBS@
 LIBSMBSHAREMODES_LIBS=@LIBSMBSHAREMODES_LIBS@
 
@@ -216,7 +216,7 @@
 
 # Note that all executable programs now provide for an optional executable suffix.
 
-SBIN_PROGS = bin/smbd@EXEEXT@ bin/nmbd@EXEEXT@ @SWAT_SBIN_TARGETS@ @EXTRA_SBIN_PROGS@
+SBIN_PROGS = bin/samba_multicall@EXEEXT@ bin/smbd@EXEEXT@ bin/nmbd@EXEEXT@ @SWAT_SBIN_TARGETS@ @EXTRA_SBIN_PROGS@
 
 BIN_PROGS1 = bin/smbclient@EXEEXT@ bin/net@EXEEXT@ bin/smbspool@EXEEXT@ \
 	bin/testparm@EXEEXT@ bin/smbstatus@EXEEXT@ bin/smbget@EXEEXT@ \
@@ -323,7 +323,8 @@
 	     ../librpc/ndr/uuid.o \
 	     librpc/ndr/util.o \
 	     librpc/gen_ndr/ndr_server_id.o \
-	     librpc/gen_ndr/ndr_dcerpc.o
+	     librpc/gen_ndr/ndr_dcerpc.o \
+	     ../librpc/ndr/ndr_dcerpc.o
 
 LIBNDR_GEN_OBJ0 = librpc/gen_ndr/ndr_samr.o \
 		  librpc/gen_ndr/ndr_lsa.o
@@ -454,7 +455,7 @@
 	  lib/username.o \
 	  ../libds/common/flag_mapping.o \
 	  lib/access.o lib/smbrun.o \
-	  lib/bitmap.o lib/dprintf.o $(UTIL_REG_OBJ) \
+	  ../lib/util/bitmap.o lib/dprintf.o $(UTIL_REG_OBJ) \
 	  lib/wins_srv.o \
 	  lib/util_str.o lib/clobber.o lib/util_sid.o \
 	  lib/util_unistr.o ../lib/util/charset/codepoints.o lib/util_file.o \
@@ -782,6 +783,7 @@
 PROFILE_OBJ = profile/profile.o
 PROFILES_OBJ = utils/profiles.o \
 	       $(LIBSMB_ERR_OBJ) \
+	       $(LIBNDR_NTLMSSP_OBJ) \
 	       $(PARAM_OBJ) \
                $(LIB_OBJ) $(LIB_DUMMY_OBJ) \
                $(POPT_LIB_OBJ) \
@@ -987,15 +989,17 @@
 	   $(POPT_LIB_OBJ) $(SMBLDAP_OBJ) $(LIBMSRPC_GEN_OBJ) $(LIBMSRPC_OBJ) \
            $(PASSCHANGE_OBJ) $(FNAME_UTIL_OBJ) \
 	   $(LIBCLI_SAMR_OBJ) \
-	   rpc_client/init_lsa.o
+	   $(LIBCLI_NETLOGON_OBJ) \
+	   rpc_client/init_lsa.o \
+	   rpc_client/init_netlogon.o
 
 STATUS_OBJ = utils/status.o utils/status_profile.o \
 	     $(LOCKING_OBJ) $(PARAM_OBJ) \
              $(PROFILE_OBJ) $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) \
-	     $(LIBSMB_ERR_OBJ) $(FNAME_UTIL_OBJ)
+	     $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) $(FNAME_UTIL_OBJ)
 
 SMBCONTROL_OBJ = utils/smbcontrol.o $(PARAM_OBJ) $(LIB_NONSMBD_OBJ) \
-	$(LIBSMB_ERR_OBJ) $(POPT_LIB_OBJ) $(PRINTBASE_OBJ)
+	$(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) $(POPT_LIB_OBJ) $(PRINTBASE_OBJ)
 
 SMBTREE_OBJ = utils/smbtree.o $(PARAM_OBJ) \
              $(PROFILE_OBJ) $(LIB_NONSMBD_OBJ) $(LIBSMB_OBJ) \
@@ -1003,15 +1007,17 @@
 	     $(PASSDB_OBJ) $(SMBLDAP_OBJ) $(GROUPDB_OBJ) \
 	     $(LIBMSRPC_GEN_OBJ) \
 	     $(LIBMSRPC_OBJ) \
-	     $(LIBCLI_SRVSVC_OBJ)
+	     $(LIBCLI_SRVSVC_OBJ) \
+	     $(LIBCLI_NETLOGON_OBJ) \
+	     rpc_client/init_netlogon.o
 
 TESTPARM_OBJ = utils/testparm.o \
                $(PARAM_OBJ) $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) \
-	       $(LIBSMB_ERR_OBJ)
+	       $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ)
 
 SMBTA_UTIL_OBJ = utils/smbta-util.o $(PARAM_OBJ) $(POPT_LIB_OBJ) \
 	$(LIB_NONSMBD_OBJ) \
-	$(LIBSMB_ERR_OBJ) $(FNAME_UTIL_OBJ)
+	$(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) $(FNAME_UTIL_OBJ)
 
 TEST_LP_LOAD_OBJ = param/test_lp_load.o \
 		   $(PARAM_OBJ) $(LIB_NONSMBD_OBJ) \
@@ -1019,13 +1025,15 @@
 
 PASSWD_UTIL_OBJ = utils/passwd_util.o
 
-SMBPASSWD_OBJ = utils/smbpasswd.o $(PASSWD_UTIL_OBJ) $(PASSCHANGE_OBJ) \
+SMBPASSWD_OBJ = utils/owrt_smbpasswd.o $(PASSWD_UTIL_OBJ) $(PASSCHANGE_OBJ) \
 		$(PARAM_OBJ) $(LIBSMB_OBJ) $(PASSDB_OBJ) \
 		$(GROUPDB_OBJ) $(LIB_NONSMBD_OBJ) $(KRBCLIENT_OBJ) \
 		$(POPT_LIB_OBJ) $(SMBLDAP_OBJ) \
 		$(LIBMSRPC_GEN_OBJ) $(LIBMSRPC_OBJ) \
 		$(LIBCLI_SAMR_OBJ) \
-		rpc_client/init_lsa.o
+		$(LIBCLI_NETLOGON_OBJ) \
+		rpc_client/init_lsa.o \
+		rpc_client/init_netlogon.o
 
 PDBEDIT_OBJ = utils/pdbedit.o $(PASSWD_UTIL_OBJ) $(PARAM_OBJ) $(PASSDB_OBJ) \
 		$(LIBSAMBA_OBJ) $(LIBTSOCKET_OBJ) \
@@ -1098,7 +1106,9 @@
 		    $(LIBMSRPC_OBJ) $(LIBMSRPC_GEN_OBJ) \
 		    $(PASSDB_OBJ) $(SMBLDAP_OBJ) $(GROUPDB_OBJ) \
 		    $(LIBCLI_SRVSVC_OBJ) \
-		    $(LIBCLI_LSA_OBJ)
+		    $(LIBCLI_LSA_OBJ) \
+		    $(LIBCLI_NETLOGON_OBJ) \
+		    rpc_client/init_netlogon.o
 
 LIBSMBCLIENT_OBJ = $(LIBSMBCLIENT_OBJ1)
 
@@ -1121,7 +1131,9 @@
              $(READLINE_OBJ) $(POPT_LIB_OBJ) \
              $(PASSDB_OBJ) $(SMBLDAP_OBJ) $(GROUPDB_OBJ) \
 	     $(DISPLAY_SEC_OBJ) \
-	     $(LIBCLI_SRVSVC_OBJ)
+	     $(LIBCLI_SRVSVC_OBJ) \
+	     $(LIBCLI_NETLOGON_OBJ) \
+	     rpc_client/init_netlogon.o
 
 LIBSMBCONF_OBJ = ../lib/smbconf/smbconf.o \
 		 ../lib/smbconf/smbconf_util.o \
@@ -1135,6 +1147,7 @@
 		  $(LIB_NONSMBD_OBJ) \
 		  $(PARAM_OBJ) \
 		  $(LIBSMB_ERR_OBJ) \
+		  $(LIBNDR_NTLMSSP_OBJ) \
 		  $(POPT_LIB_OBJ)
 
 PTHREADPOOLTEST_OBJ = lib/pthreadpool/pthreadpool.o \
@@ -1218,7 +1231,7 @@
 	  $(LIBNDR_GEN_OBJ0)
 
 NMBLOOKUP_OBJ = utils/nmblookup.o $(PARAM_OBJ) $(LIBNMB_OBJ) \
-               $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) $(LIBSMB_ERR_OBJ)
+               $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ)
 
 SMBTORTURE_OBJ1 = torture/torture.o torture/nbio.o torture/scanner.o torture/utable.o \
 		torture/denytest.o torture/mangle_test.o \
@@ -1233,13 +1246,16 @@
 	@LIBWBCLIENT_STATIC@ \
         torture/wbc_async.o \
         ../nsswitch/wb_reqtrans.o \
-	$(LIBMSRPC_OBJ) $(LIBMSRPC_GEN_OBJ) $(LIBCLI_ECHO_OBJ)
+	$(LIBMSRPC_OBJ) $(LIBMSRPC_GEN_OBJ) $(LIBCLI_ECHO_OBJ) \
+	$(LIBCLI_NETLOGON_OBJ) rpc_client/init_netlogon.o
+
 
 MASKTEST_OBJ = torture/masktest.o $(PARAM_OBJ) $(LIBSMB_OBJ) $(KRBCLIENT_OBJ) \
                  $(LIB_NONSMBD_OBJ) \
 		 $(LIBNDR_GEN_OBJ0)
 
 MSGTEST_OBJ = torture/msgtest.o $(PARAM_OBJ) $(LIBSMB_ERR_OBJ) \
+		 $(LIBNDR_NTLMSSP_OBJ) \
                  $(LIB_NONSMBD_OBJ) \
 		 $(LIBNDR_GEN_OBJ0)
 
@@ -1256,7 +1272,7 @@
 
 VFSTEST_OBJ = torture/cmd_vfs.o torture/vfstest.o $(SMBD_OBJ_BASE) $(READLINE_OBJ)
 
-SMBICONV_OBJ = $(PARAM_OBJ) torture/smbiconv.o $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) $(LIBSMB_ERR_OBJ)
+SMBICONV_OBJ = $(PARAM_OBJ) torture/smbiconv.o $(LIB_NONSMBD_OBJ) $(POPT_LIB_OBJ) $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ)
 
 LOG2PCAP_OBJ = utils/log2pcaphex.o
 
@@ -1268,29 +1284,33 @@
 		$(KRBCLIENT_OBJ) $(LIB_NONSMBD_OBJ) \
 		$(PASSDB_OBJ) $(GROUPDB_OBJ) $(LIBMSRPC_OBJ) $(LIBMSRPC_GEN_OBJ) \
 		$(POPT_LIB_OBJ) $(SMBLDAP_OBJ) \
-		$(LIBCLI_LSA_OBJ)
+		$(LIBCLI_LSA_OBJ) \
+		$(LIBCLI_NETLOGON_OBJ) \
+		rpc_client/init_netlogon.o
 
 SMBCQUOTAS_OBJ = utils/smbcquotas.o $(LIBSMB_OBJ) $(KRBCLIENT_OBJ) \
 		$(PARAM_OBJ) \
 		$(LIB_NONSMBD_OBJ) \
 		$(LIBMSRPC_OBJ) $(LIBMSRPC_GEN_OBJ) $(POPT_LIB_OBJ) \
 		$(PASSDB_OBJ) $(SMBLDAP_OBJ) $(GROUPDB_OBJ) \
-		$(LIBCLI_LSA_OBJ)
+		$(LIBCLI_LSA_OBJ) \
+		$(LIBCLI_NETLOGON_OBJ) \
+		rpc_client/init_netlogon.o
 
 EVTLOGADM_OBJ0	= utils/eventlogadm.o
 
 EVTLOGADM_OBJ	= $(EVTLOGADM_OBJ0) $(PARAM_OBJ) $(LIB_NONSMBD_OBJ) \
-		$(LIBSMB_ERR_OBJ) $(LIB_EVENTLOG_OBJ) \
+		$(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) $(LIB_EVENTLOG_OBJ) \
 		librpc/gen_ndr/ndr_eventlog.o \
 		librpc/gen_ndr/ndr_lsa.o
 
 SHARESEC_OBJ0 = utils/sharesec.o
 SHARESEC_OBJ  = $(SHARESEC_OBJ0) $(PARAM_OBJ) $(LIB_NONSMBD_OBJ) \
-		$(LIBSMB_ERR_OBJ) \
+		$(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) \
                 $(POPT_LIB_OBJ)
 
 TALLOCTORT_OBJ = @tallocdir@/testsuite.o @tallocdir@/testsuite_main.o \
-		$(PARAM_OBJ) $(LIB_NONSMBD_OBJ) $(LIBSMB_ERR_OBJ)
+		$(PARAM_OBJ) $(LIB_NONSMBD_OBJ) $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ)
 
 REPLACETORT_OBJ = @libreplacedir@/test/testsuite.o \
 		@libreplacedir@/test/getifaddrs.o \
@@ -1306,7 +1326,7 @@
 		 $(LIBNDR_GEN_OBJ0)
 
 WINBIND_WINS_NSS_OBJ = ../nsswitch/wins.o $(PARAM_OBJ) \
-	$(LIB_NONSMBD_OBJ) $(LIBSMB_ERR_OBJ) $(LIBNMB_OBJ)
+	$(LIB_NONSMBD_OBJ) $(LIBSMB_ERR_OBJ) $(LIBNDR_NTLMSSP_OBJ) $(LIBNMB_OBJ)
 
 PAM_SMBPASS_OBJ_0 = pam_smbpass/pam_smb_auth.o pam_smbpass/pam_smb_passwd.o \
 		pam_smbpass/pam_smb_acct.o pam_smbpass/support.o ../lib/util/asn1.o
@@ -1514,12 +1534,14 @@
 DBWRAP_TOOL_OBJ = utils/dbwrap_tool.o \
 		  $(PARAM_OBJ) \
 		  $(LIB_NONSMBD_OBJ) \
-		  $(LIBSMB_ERR_OBJ)
+		  $(LIBSMB_ERR_OBJ) \
+		  $(LIBNDR_NTLMSSP_OBJ)
 
 DBWRAP_TORTURE_OBJ = utils/dbwrap_torture.o \
 		     $(PARAM_OBJ) \
 		     $(LIB_NONSMBD_OBJ) \
 		     $(LIBSMB_ERR_OBJ) \
+		     $(LIBNDR_NTLMSSP_OBJ) \
 		     $(POPT_LIB_OBJ)
 
 SPLIT_TOKENS_OBJ = utils/split_tokens.o \
@@ -1777,6 +1799,42 @@
 	  dir=bin $(MAKEDIR); fi
 	@: >> $@ || : > $@ # what a fancy emoticon!
 
+smbd/server_multicall.o: smbd/server.c smbd/server.o
+	@echo Compiling $<.c
+	@$(COMPILE_CC_PATH) -Dmain=smbd_main && exit 0;\
+		echo "The following command failed:" 1>&2;\
+		echo "$(COMPILE_CC_PATH)" 1>&2;\
+		$(COMPILE_CC_PATH) >/dev/null 2>&1
+
+nmbd/nmbd_multicall.o: nmbd/nmbd.c nmbd/nmbd.o
+	@echo Compiling $<.c
+	@$(COMPILE_CC_PATH) -Dmain=nmbd_main && exit 0;\
+		echo "The following command failed:" 1>&2;\
+		echo "$(COMPILE_CC_PATH)" 1>&2;\
+		$(COMPILE_CC_PATH) >/dev/null 2>&1
+
+utils/smbpasswd_multicall.o: utils/owrt_smbpasswd.c utils/owrt_smbpasswd.o
+	@echo Compiling $<.c
+	@$(COMPILE_CC_PATH) -Dmain=smbpasswd_main && exit 0;\
+		echo "The following command failed:" 1>&2;\
+		echo "$(COMPILE_CC_PATH)" 1>&2;\
+		$(COMPILE_CC_PATH) >/dev/null 2>&1
+
+SMBD_MULTI_O = $(patsubst smbd/server.o,smbd/server_multicall.o,$(SMBD_OBJ))
+NMBD_MULTI_O = $(patsubst nmbd/nmbd.o,nmbd/nmbd_multicall.o,$(filter-out $(LIB_DUMMY_OBJ),$(NMBD_OBJ)))
+SMBPASSWD_MULTI_O = $(patsubst utils/owrt_smbpasswd.o,utils/smbpasswd_multicall.o,$(filter-out $(LIB_DUMMY_OBJ),$(SMBPASSWD_OBJ)))
+MULTI_O = multi.o
+
+MULTICALL_O = $(sort $(SMBD_MULTI_O) $(NMBD_MULTI_O) $(SMBPASSWD_MULTI_O) $(MULTI_O))
+
+bin/samba_multicall@EXEEXT@: $(BINARY_PREREQS) $(MULTICALL_O) $(LIBTALLOC) $(LIBTDB) $(LIBWBCLIENT) @BUILD_POPT@
+	@echo Linking $@
+	@$(CC) -o $@ $(MULTICALL_O) $(LDFLAGS) $(LDAP_LIBS) @SMBD_FAM_LIBS@ \
+		$(KRB5LIBS) $(DYNEXP) $(PRINT_LIBS) $(AUTH_LIBS) \
+		$(ACL_LIBS) $(PASSDB_LIBS) $(LIBS) $(DNSSD_LIBS) $(AVAHI_LIBS) \
+		$(POPT_LIBS) @SMBD_LIBS@ $(LIBTALLOC_LIBS) $(LIBTEVENT_LIBS) $(LIBTDB_LIBS) \
+		$(LIBWBCLIENT_LIBS) $(ZLIB_LIBS)
+
 bin/smbd@EXEEXT@: $(BINARY_PREREQS) $(SMBD_OBJ) $(LIBTALLOC) $(LIBTEVENT) $(LIBTDB) $(LIBWBCLIENT) @BUILD_POPT@
 	@echo Linking $@
 	@$(CC) -o $@ $(SMBD_OBJ) $(LDFLAGS) $(LDAP_LIBS) @SMBD_FAM_LIBS@ \
@@ -3462,7 +3520,7 @@
 	-rm -f smbd/build_options.c
 	-rm -f $(PRECOMPILED_HEADER)
 	-rm -f core */*~ *~ \
-		*/*.o */*/*.o */*/*/*.o */*/*/*/*.o \
+		*.o */*.o */*/*.o */*/*/*.o */*/*/*/*.o \
 		../testsuite/*/*.o \
 		../nsswitch/*.o ../nsswitch/*/*.o ../nsswitch/*/*/*.o ../nsswitch/*.@SHLIBEXT@ \
 		../client/*.o \
diff -daurN samba3/source3/Makefile-smbtorture4 samba3/source3/Makefile-smbtorture4
--- samba3/source3/Makefile-smbtorture4	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/Makefile-smbtorture4	2024-08-04 17:52:53.000000000 +0200
@@ -6,7 +6,7 @@
 samba4-configure:
 	@(cd .. && \
 		CFLAGS='' $(WAF) reconfigure || \
-		CFLAGS='' $(WAF) configure --enable-socket-wrapper --enable-nss-wrapper --enable-uid-wrapper --nonshared-binary=$(SAMBA4_BINARIES) --enable-auto-reconfigure )
+		CFLAGS='' $(WAF) configure --enable-socket-wrapper --enable-nss-wrapper --enable-uid-wrapper --nonshared-binary=$(SAMBA4_BINARIES) --enable-auto-reconfigure --bundled-libraries=ALL --disable-gnutls )
 
 .PHONY: samba4-configure
 
diff -daurN samba3/source3/modules/vfs_acl_common.c samba3/source3/modules/vfs_acl_common.c
--- samba3/source3/modules/vfs_acl_common.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/modules/vfs_acl_common.c	2024-08-04 17:52:53.000000000 +0200
@@ -23,6 +23,7 @@
 #include "system/filesys.h"
 #include "../libcli/security/security.h"
 #include "../librpc/gen_ndr/ndr_security.h"
+#include "../lib/util/bitmap.h"
 
 static NTSTATUS create_acl_blob(const struct security_descriptor *psd,
 			DATA_BLOB *pblob,
diff -daurN samba3/source3/modules/vfs_full_audit.c samba3/source3/modules/vfs_full_audit.c
--- samba3/source3/modules/vfs_full_audit.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/modules/vfs_full_audit.c	2024-08-04 17:52:53.000000000 +0200
@@ -64,6 +64,7 @@
 #include "../librpc/gen_ndr/ndr_netlogon.h"
 #include "auth.h"
 #include "ntioctl.h"
+#include "lib/util/bitmap.h"
 
 static int vfs_full_audit_debug_level = DBGC_VFS;
 
diff -daurN samba3/source3/multi.c samba3/source3/multi.c
--- samba3/source3/multi.c	1970-01-01 01:00:00.000000000 +0100
+++ samba3/source3/multi.c	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,35 @@
+#include <stdio.h>
+#include <string.h>
+
+extern int smbd_main(int argc, char **argv);
+extern int nmbd_main(int argc, char **argv);
+extern int smbpasswd_main(int argc, char **argv);
+
+static struct {
+	const char *name;
+	int (*func)(int argc, char **argv);
+} multicall[] = {
+	{ "smbd", smbd_main },
+	{ "nmbd", nmbd_main },
+	{ "smbpasswd", smbpasswd_main },
+};
+
+#define ARRAY_SIZE(a) (sizeof(a) / sizeof(a[0]))
+
+int main(int argc, char **argv)
+{
+	int i;
+
+	for (i = 0; i < ARRAY_SIZE(multicall); i++) {
+		if (strstr(argv[0], multicall[i].name))
+			return multicall[i].func(argc, argv);
+	}
+
+	fprintf(stderr, "Invalid multicall command, available commands:");
+	for (i = 0; i < ARRAY_SIZE(multicall); i++)
+		fprintf(stderr, " %s", multicall[i].name);
+
+	fprintf(stderr, "\n");
+
+	return 1;
+}
diff -daurN samba3/source3/nmbd/nmbd_processlogon.c samba3/source3/nmbd/nmbd_processlogon.c
--- samba3/source3/nmbd/nmbd_processlogon.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/nmbd/nmbd_processlogon.c	2024-08-04 17:52:53.000000000 +0200
@@ -320,6 +320,10 @@
 	NTSTATUS status;
 	const char *pdc_name;
 
+#ifndef NETLOGON_SUPPORT
+	return;
+#endif
+
 	in_addr_to_sockaddr_storage(&ss, p->ip);
 	pss = iface_ip((struct sockaddr *)&ss);
 	if (!pss) {
diff -daurN samba3/source3/param/loadparm.c samba3/source3/param/loadparm.c
--- samba3/source3/param/loadparm.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/param/loadparm.c	2024-08-04 17:52:53.000000000 +0200
@@ -64,6 +64,7 @@
 #include "smb_signing.h"
 #include "dbwrap.h"
 #include "smbldap.h"
+#include "../lib/util/bitmap.h"
 
 #ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
@@ -214,6 +215,7 @@
 	int  winbind_expand_groups;
 	bool bWinbindRefreshTickets;
 	bool bWinbindOfflineLogon;
+	bool bWinbindSealedPipes;
 	bool bWinbindNormalizeNames;
 	bool bWinbindRpcOnly;
 	bool bCreateKrb5Conf;
@@ -335,6 +337,7 @@
 	bool bAllowTrustedDomains;
 	bool bLanmanAuth;
 	bool bNTLMAuth;
+	bool bRawNTLMv2Auth;
 	bool bUseSpnego;
 	bool bClientLanManAuth;
 	bool bClientNTLMv2Auth;
@@ -352,6 +355,7 @@
 	bool bUseMmap;
 	bool bHostnameLookups;
 	bool bUnixExtensions;
+	bool bAllowDcerpcAuthLevelConnect;
 	bool bDisableNetbios;
 	char * szDedicatedKeytabFile;
 	int  iKerberosMethod;
@@ -364,6 +368,7 @@
 	int restrict_anonymous;
 	int name_cache_timeout;
 	int client_signing;
+	int client_ipc_signing;
 	int server_signing;
 	int client_ldap_sasl_wrapping;
 	int iUsershareMaxShares;
@@ -1382,6 +1387,15 @@
 		.flags		= FLAG_ADVANCED,
 	},
 	{
+		.label		= "raw NTLMv2 auth",
+		.type		= P_BOOL,
+		.p_class	= P_GLOBAL,
+		.ptr		= &Globals.bRawNTLMv2Auth,
+		.special	= NULL,
+		.enum_list	= NULL,
+		.flags		= FLAG_ADVANCED,
+	},
+	{
 		.label		= "client NTLMv2 auth",
 		.type		= P_BOOL,
 		.p_class	= P_GLOBAL,
@@ -2290,6 +2304,15 @@
 		.flags		= FLAG_ADVANCED,
 	},
 	{
+		.label		= "allow dcerpc auth level connect",
+		.type		= P_BOOL,
+		.p_class	= P_GLOBAL,
+		.ptr		= &Globals.bAllowDcerpcAuthLevelConnect,
+		.special	= NULL,
+		.enum_list	= NULL,
+		.flags		= FLAG_ADVANCED,
+	},
+	{
 		.label		= "use spnego",
 		.type		= P_BOOL,
 		.p_class	= P_GLOBAL,
@@ -2308,6 +2331,15 @@
 		.flags		= FLAG_ADVANCED,
 	},
 	{
+		.label		= "client ipc signing",
+		.type		= P_ENUM,
+		.p_class	= P_GLOBAL,
+		.ptr		= &Globals.client_ipc_signing,
+		.special	= NULL,
+		.enum_list	= enum_smb_signing_vals,
+		.flags		= FLAG_ADVANCED,
+	},
+	{
 		.label		= "server signing",
 		.type		= P_ENUM,
 		.p_class	= P_GLOBAL,
@@ -4754,6 +4786,15 @@
 		.flags		= FLAG_ADVANCED,
 	},
 	{
+		.label		= "winbind sealed pipes",
+		.type		= P_BOOL,
+		.p_class	= P_GLOBAL,
+		.ptr		= &Globals.bWinbindSealedPipes,
+		.special	= NULL,
+		.enum_list	= NULL,
+		.flags		= FLAG_ADVANCED,
+	},
+	{
 		.label		= "winbind normalize names",
 		.type		= P_BOOL,
 		.p_class	= P_GLOBAL,
@@ -5336,9 +5377,12 @@
 	Globals.bClientPlaintextAuth = False;	/* Do NOT use a plaintext password even if is requested by the server */
 	Globals.bLanmanAuth = False;	/* Do NOT use the LanMan hash, even if it is supplied */
 	Globals.bNTLMAuth = True;	/* Do use NTLMv1 if it is supplied by the client (otherwise NTLMv2) */
+	Globals.bRawNTLMv2Auth = false;	/* Allow NTLMv2 without NTLMSSP */
 	Globals.bClientNTLMv2Auth = True; /* Client should always use use NTLMv2, as we can't tell that the server supports it, but most modern servers do */
 	/* Note, that we will also use NTLM2 session security (which is different), if it is available */
 
+	Globals.bAllowDcerpcAuthLevelConnect = false; /* we don't allow this by default */
+
 	Globals.map_to_guest = 0;	/* By Default, "Never" */
 	Globals.oplock_break_wait_time = 0;	/* By Default, 0 msecs. */
 	Globals.enhanced_browsing = true;
@@ -5380,6 +5424,8 @@
 	Globals.ldap_debug_level = 0;
 	Globals.ldap_debug_threshold = 10;
 
+	Globals.client_ldap_sasl_wrapping = ADS_AUTH_SASL_SIGN;
+
 	/* This is what we tell the afs client. in reality we set the token 
 	 * to never expire, though, when this runs out the afs client will 
 	 * forget the token. Set to 0 to get NEVERDATE.*/
@@ -5444,6 +5490,7 @@
 	Globals.szWinbindNssInfo = str_list_make_v3(NULL, "template", NULL);
 	Globals.bWinbindRefreshTickets = False;
 	Globals.bWinbindOfflineLogon = False;
+	Globals.bWinbindSealedPipes = True;
 
 	Globals.iIdmapCacheTime = 86400 * 7; /* a week by default */
 	Globals.iIdmapNegativeCacheTime = 120; /* 2 minutes by default */
@@ -5456,6 +5503,7 @@
 	Globals.bClientUseSpnego = True;
 
 	Globals.client_signing = Auto;
+	Globals.client_ipc_signing = Required;
 	Globals.server_signing = False;
 
 	Globals.bDeferSharingViolations = True;
@@ -5709,6 +5757,7 @@
 
 FN_GLOBAL_STRING(lp_check_password_script, &Globals.szCheckPasswordScript)
 
+FN_GLOBAL_BOOL(lp_allow_dcerpc_auth_level_connect, &Globals.bAllowDcerpcAuthLevelConnect)
 FN_GLOBAL_STRING(lp_wins_hook, &Globals.szWINSHook)
 FN_GLOBAL_CONST_STRING(lp_template_homedir, &Globals.szTemplateHomedir)
 FN_GLOBAL_CONST_STRING(lp_template_shell, &Globals.szTemplateShell)
@@ -5722,6 +5771,7 @@
 FN_GLOBAL_INTEGER(lp_winbind_expand_groups, &Globals.winbind_expand_groups)
 FN_GLOBAL_BOOL(lp_winbind_refresh_tickets, &Globals.bWinbindRefreshTickets)
 FN_GLOBAL_BOOL(lp_winbind_offline_logon, &Globals.bWinbindOfflineLogon)
+FN_GLOBAL_BOOL(lp_winbind_sealed_pipes, &Globals.bWinbindSealedPipes)
 FN_GLOBAL_BOOL(lp_winbind_normalize_names, &Globals.bWinbindNormalizeNames)
 FN_GLOBAL_BOOL(lp_winbind_rpc_only, &Globals.bWinbindRpcOnly)
 FN_GLOBAL_BOOL(lp_create_krb5_conf, &Globals.bCreateKrb5Conf)
@@ -5818,6 +5868,7 @@
 FN_GLOBAL_INTEGER(lp_restrict_anonymous, &Globals.restrict_anonymous)
 FN_GLOBAL_BOOL(lp_lanman_auth, &Globals.bLanmanAuth)
 FN_GLOBAL_BOOL(lp_ntlm_auth, &Globals.bNTLMAuth)
+FN_GLOBAL_BOOL(lp_raw_ntlmv2_auth, &Globals.bRawNTLMv2Auth)
 FN_GLOBAL_BOOL(lp_client_plaintext_auth, &Globals.bClientPlaintextAuth)
 FN_GLOBAL_BOOL(lp_client_lanman_auth, &Globals.bClientLanManAuth)
 FN_GLOBAL_BOOL(lp_client_ntlmv2_auth, &Globals.bClientNTLMv2Auth)
@@ -6056,6 +6107,7 @@
 FN_GLOBAL_INTEGER(lp_algorithmic_rid_base, &Globals.AlgorithmicRidBase)
 FN_GLOBAL_INTEGER(lp_name_cache_timeout, &Globals.name_cache_timeout)
 FN_GLOBAL_INTEGER(lp_client_signing, &Globals.client_signing)
+FN_GLOBAL_INTEGER(lp_client_ipc_signing, &Globals.client_ipc_signing)
 FN_GLOBAL_INTEGER(lp_server_signing, &Globals.server_signing)
 FN_GLOBAL_INTEGER(lp_client_ldap_sasl_wrapping, &Globals.client_ldap_sasl_wrapping)
 
@@ -9685,6 +9737,20 @@
 		lp_do_parameter(GLOBAL_SECTION_SNUM, "wins server", "127.0.0.1");
 	}
 
+	if (!lp_is_in_client()) {
+		switch (lp_client_ipc_signing()) {
+		case Required:
+			lp_set_cmdline("client signing", "mandatory");
+			break;
+		case Auto:
+			lp_set_cmdline("client signing", "auto");
+			break;
+		case False:
+			lp_set_cmdline("client signing", "disabled");
+			break;
+		}
+	}
+
 	init_iconv();
 
 	bAllowIncludeRegistry = true;
diff -daurN samba3/source3/passdb/pdb_get_set.c samba3/source3/passdb/pdb_get_set.c
--- samba3/source3/passdb/pdb_get_set.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/passdb/pdb_get_set.c	2024-08-04 17:52:53.000000000 +0200
@@ -25,6 +25,7 @@
 #include "passdb.h"
 #include "../libcli/auth/libcli_auth.h"
 #include "../libcli/security/security.h"
+#include "../lib/util/bitmap.h"
 
 #undef DBGC_CLASS
 #define DBGC_CLASS DBGC_PASSDB
diff -daurN samba3/source3/printing/spoolssd.c samba3/source3/printing/spoolssd.c
--- samba3/source3/printing/spoolssd.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/printing/spoolssd.c	2024-08-04 17:52:53.000000000 +0200
@@ -165,6 +165,10 @@
 	NTSTATUS status;
 	int ret;
 
+#ifndef PRINTER_SUPPORT
+	return;
+#endif
+
 	DEBUG(1, ("Forking SPOOLSS Daemon\n"));
 
 	pid = sys_fork();
diff -daurN samba3/source3/remove-librpc-print-calls.sh samba3/source3/remove-librpc-print-calls.sh
--- samba3/source3/remove-librpc-print-calls.sh	1970-01-01 01:00:00.000000000 +0100
+++ samba3/source3/remove-librpc-print-calls.sh	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,22 @@
+#!/usr/bin/env bash
+set -e
+for file in ${1:-librpc/gen_ndr/ndr_*.c}; do
+	quilt add "$file" || true
+	awk '
+$0 ~ /^static const struct ndr_interface_call .* = {$/ {
+	replace = 1
+}
+
+$0 ~ /^}$/ {
+	replace = 0;
+}
+
+replace == 1 {
+	gsub(/.ndr_print_function_t. .*,/, "(ndr_print_function_t) ndr_print_disabled,", $0)
+}
+{
+	print $0
+}
+	' < "$file" > "$file.new"
+	mv "$file.new" "$file"
+done
diff -daurN samba3/source3/rpc_client/cli_pipe.c samba3/source3/rpc_client/cli_pipe.c
--- samba3/source3/rpc_client/cli_pipe.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_client/cli_pipe.c	2024-08-04 17:52:53.000000000 +0200
@@ -28,6 +28,7 @@
 #include "../libcli/auth/ntlmssp.h"
 #include "ntlmssp_wrap.h"
 #include "librpc/gen_ndr/ndr_dcerpc.h"
+#include "librpc/gen_ndr/ndr_netlogon_c.h"
 #include "librpc/rpc/dcerpc.h"
 #include "librpc/crypto/gse.h"
 #include "librpc/crypto/spnego.h"
@@ -399,12 +400,13 @@
 						struct ncacn_packet *pkt,
 						DATA_BLOB *pdu,
 						uint8_t expected_pkt_type,
+						uint32_t call_id,
 						DATA_BLOB *rdata,
 						DATA_BLOB *reply_pdu)
 {
-	struct dcerpc_response *r;
+	const struct dcerpc_response *r = NULL;
+	DATA_BLOB tmp_stub = data_blob_null;
 	NTSTATUS ret = NT_STATUS_OK;
-	size_t pad_len = 0;
 
 	/*
 	 * Point the return values at the real data including the RPC
@@ -412,50 +414,123 @@
 	 */
 	*rdata = *pdu;
 
+	if ((pkt->ptype == DCERPC_PKT_BIND_ACK) &&
+	    !(pkt->pfc_flags & DCERPC_PFC_FLAG_LAST)) {
+		/*
+		 * TODO: do we still need this hack which was introduced
+		 * in commit a42afcdcc7ab9aa9ed193ae36d3dbb10843447f0.
+		 *
+		 * I don't even know what AS/U might be...
+		 */
+		DEBUG(5, (__location__ ": bug in server (AS/U?), setting "
+			  "fragment first/last ON.\n"));
+		pkt->pfc_flags |= DCERPC_PFC_FLAG_FIRST | DCERPC_PFC_FLAG_LAST;
+	}
+
 	/* Ensure we have the correct type. */
 	switch (pkt->ptype) {
-	case DCERPC_PKT_ALTER_RESP:
+	case DCERPC_PKT_BIND_NAK:
+		DEBUG(1, (__location__ ": Bind NACK received from %s!\n",
+			  rpccli_pipe_txt(talloc_tos(), cli)));
+
+		ret = dcerpc_verify_ncacn_packet_header(pkt,
+						DCERPC_PKT_BIND_NAK,
+						0, /* max_auth_info */
+						DCERPC_PFC_FLAG_FIRST |
+						DCERPC_PFC_FLAG_LAST,
+						0); /* optional flags */
+		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
+			return ret;
+		}
+
+		/* Use this for now... */
+		return NT_STATUS_NETWORK_ACCESS_DENIED;
+
 	case DCERPC_PKT_BIND_ACK:
+		ret = dcerpc_verify_ncacn_packet_header(pkt,
+					expected_pkt_type,
+					pkt->u.bind_ack.auth_info.length,
+					DCERPC_PFC_FLAG_FIRST |
+					DCERPC_PFC_FLAG_LAST,
+					DCERPC_PFC_FLAG_CONC_MPX |
+					DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN);
+		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
+			return ret;
+		}
 
-		/* Client code never receives this kind of packets */
 		break;
 
+	case DCERPC_PKT_ALTER_RESP:
+		ret = dcerpc_verify_ncacn_packet_header(pkt,
+					expected_pkt_type,
+					pkt->u.alter_resp.auth_info.length,
+					DCERPC_PFC_FLAG_FIRST |
+					DCERPC_PFC_FLAG_LAST,
+					DCERPC_PFC_FLAG_CONC_MPX |
+					DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN);
+		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
+			return ret;
+		}
+
+		break;
 
 	case DCERPC_PKT_RESPONSE:
 
 		r = &pkt->u.response;
 
+		ret = dcerpc_verify_ncacn_packet_header(pkt,
+						expected_pkt_type,
+						r->stub_and_verifier.length,
+						0, /* required_flags */
+						DCERPC_PFC_FLAG_FIRST |
+						DCERPC_PFC_FLAG_LAST);
+		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
+			return ret;
+		}
+
+		tmp_stub.data = r->stub_and_verifier.data;
+		tmp_stub.length = r->stub_and_verifier.length;
+
 		/* Here's where we deal with incoming sign/seal. */
 		ret = dcerpc_check_auth(cli->auth, pkt,
-					&r->stub_and_verifier,
+					&tmp_stub,
 					DCERPC_RESPONSE_LENGTH,
-					pdu, &pad_len);
+					pdu);
 		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
 			return ret;
 		}
 
-		if (pkt->frag_length < DCERPC_RESPONSE_LENGTH + pad_len) {
-			return NT_STATUS_BUFFER_TOO_SMALL;
-		}
-
 		/* Point the return values at the NDR data. */
-		rdata->data = r->stub_and_verifier.data;
-
-		if (pkt->auth_length) {
-			/* We've already done integer wrap tests in
-			 * dcerpc_check_auth(). */
-			rdata->length = r->stub_and_verifier.length
-					 - pad_len
-					 - DCERPC_AUTH_TRAILER_LENGTH
-					 - pkt->auth_length;
-		} else {
-			rdata->length = r->stub_and_verifier.length;
-		}
+		*rdata = tmp_stub;
 
-		DEBUG(10, ("Got pdu len %lu, data_len %lu, ss_len %u\n",
+		DEBUG(10, ("Got pdu len %lu, data_len %lu\n",
 			   (long unsigned int)pdu->length,
-			   (long unsigned int)rdata->length,
-			   (unsigned int)pad_len));
+			   (long unsigned int)rdata->length));
 
 		/*
 		 * If this is the first reply, and the allocation hint is
@@ -476,14 +551,23 @@
 
 		break;
 
-	case DCERPC_PKT_BIND_NAK:
-		DEBUG(1, (__location__ ": Bind NACK received from %s!\n",
-			  rpccli_pipe_txt(talloc_tos(), cli)));
-		/* Use this for now... */
-		return NT_STATUS_NETWORK_ACCESS_DENIED;
-
 	case DCERPC_PKT_FAULT:
 
+		ret = dcerpc_verify_ncacn_packet_header(pkt,
+						DCERPC_PKT_FAULT,
+						0, /* max_auth_info */
+						DCERPC_PFC_FLAG_FIRST |
+						DCERPC_PFC_FLAG_LAST,
+						DCERPC_PFC_FLAG_DID_NOT_EXECUTE);
+		if (!NT_STATUS_IS_OK(ret)) {
+			DEBUG(1, (__location__ ": Connection to %s got an unexpected "
+				  "RPC packet type - %u, expected %u: %s\n",
+				  rpccli_pipe_txt(talloc_tos(), cli),
+				  pkt->ptype, expected_pkt_type,
+				  nt_errstr(ret)));
+			return ret;
+		}
+
 		DEBUG(1, (__location__ ": RPC fault code %s received "
 			  "from %s!\n",
 			  dcerpc_errstr(talloc_tos(),
@@ -497,26 +581,16 @@
 			  "from %s!\n",
 			  (unsigned int)pkt->ptype,
 			  rpccli_pipe_txt(talloc_tos(), cli)));
-		return NT_STATUS_INVALID_INFO_CLASS;
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
 	}
 
-	if (pkt->ptype != expected_pkt_type) {
+
+	if (pkt->call_id != call_id) {
 		DEBUG(3, (__location__ ": Connection to %s got an unexpected "
-			  "RPC packet type - %u, not %u\n",
+			  "RPC call_id - %u, not %u\n",
 			  rpccli_pipe_txt(talloc_tos(), cli),
-			  pkt->ptype, expected_pkt_type));
-		return NT_STATUS_INVALID_INFO_CLASS;
-	}
-
-	/* Do this just before return - we don't want to modify any rpc header
-	   data before now as we may have needed to do cryptographic actions on
-	   it before. */
-
-	if ((pkt->ptype == DCERPC_PKT_BIND_ACK) &&
-	    !(pkt->pfc_flags & DCERPC_PFC_FLAG_LAST)) {
-		DEBUG(5, (__location__ ": bug in server (AS/U?), setting "
-			  "fragment first/last ON.\n"));
-		pkt->pfc_flags |= DCERPC_PFC_FLAG_FIRST | DCERPC_PFC_FLAG_LAST;
+			  pkt->call_id, call_id));
+		return NT_STATUS_RPC_PROTOCOL_ERROR;
 	}
 
 	return NT_STATUS_OK;
@@ -873,6 +947,12 @@
 
 	state->pkt = talloc(state, struct ncacn_packet);
 	if (!state->pkt) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
 		tevent_req_nterror(req, NT_STATUS_NO_MEMORY);
 		return;
 	}
@@ -882,22 +962,21 @@
 					  state->pkt,
 					  !state->endianess);
 	if (!NT_STATUS_IS_OK(status)) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
 		tevent_req_nterror(req, status);
 		return;
 	}
 
-	if (state->incoming_frag.length != state->pkt->frag_length) {
-		DEBUG(5, ("Incorrect pdu length %u, expected %u\n",
-			  (unsigned int)state->incoming_frag.length,
-			  (unsigned int)state->pkt->frag_length));
-		tevent_req_nterror(req,  NT_STATUS_INVALID_PARAMETER);
-		return;
-	}
-
 	status = cli_pipe_validate_current_pdu(state,
 						state->cli, state->pkt,
 						&state->incoming_frag,
 						state->expected_pkt_type,
+						state->call_id,
 						&rdata,
 						&state->reply_pdu);
 
@@ -906,6 +985,28 @@
 		  (unsigned)state->reply_pdu_offset,
 		  nt_errstr(status)));
 
+	if (state->pkt->ptype != DCERPC_PKT_FAULT && !NT_STATUS_IS_OK(status)) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+	} else if (NT_STATUS_EQUAL(status, NT_STATUS_RPC_PROTOCOL_ERROR)) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+	} else if (NT_STATUS_EQUAL(status, NT_STATUS_RPC_SEC_PKG_ERROR)) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+	}
 	if (!NT_STATUS_IS_OK(status)) {
 		tevent_req_nterror(req, status);
 		return;
@@ -930,7 +1031,24 @@
 			 "%s\n",
 			 state->endianess?"little":"big",
 			 state->pkt->drep[0]?"little":"big"));
-		tevent_req_nterror(req, NT_STATUS_INVALID_PARAMETER);
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+		tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
+		return;
+	}
+
+	if (state->reply_pdu_offset + rdata.length > MAX_RPC_DATA_SIZE) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+		tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
 		return;
 	}
 
@@ -938,6 +1056,12 @@
 	if (state->reply_pdu.length < state->reply_pdu_offset + rdata.length) {
 		if (!data_blob_realloc(NULL, &state->reply_pdu,
 				state->reply_pdu_offset + rdata.length)) {
+			/*
+			 * TODO: do a real async disconnect ...
+			 *
+			 * For now do it sync...
+			 */
+			TALLOC_FREE(state->cli->transport);
 			tevent_req_nterror(req, NT_STATUS_NO_MEMORY);
 			return;
 		}
@@ -967,6 +1091,14 @@
 	subreq = get_complete_frag_send(state, state->ev, state->cli,
 					state->call_id,
 					&state->incoming_frag);
+	if (subreq == NULL) {
+		/*
+		 * TODO: do a real async disconnect ...
+		 *
+		 * For now do it sync...
+		 */
+		TALLOC_FREE(state->cli->transport);
+	}
 	if (tevent_req_nomem(subreq, req)) {
 		return;
 	}
@@ -1236,7 +1368,7 @@
 						auth->auth_type,
 						auth->auth_level,
 						0, /* auth_pad_length */
-						1, /* auth_context_id */
+						auth->auth_context_id,
 						&auth_token,
 						&auth_info);
 		if (!NT_STATUS_IS_OK(ret)) {
@@ -1269,12 +1401,17 @@
 	uint32_t call_id;
 	DATA_BLOB *req_data;
 	uint32_t req_data_sent;
+	DATA_BLOB req_trailer;
+	uint32_t req_trailer_sent;
+	bool verify_bitmask1;
+	bool verify_pcontext;
 	DATA_BLOB rpc_out;
 	DATA_BLOB reply_pdu;
 };
 
 static void rpc_api_pipe_req_write_done(struct tevent_req *subreq);
 static void rpc_api_pipe_req_done(struct tevent_req *subreq);
+static NTSTATUS prepare_verification_trailer(struct rpc_api_pipe_req_state *state);
 static NTSTATUS prepare_next_frag(struct rpc_api_pipe_req_state *state,
 				  bool *is_last_frag);
 
@@ -1310,6 +1447,11 @@
 		goto post_status;
 	}
 
+	status = prepare_verification_trailer(state);
+	if (!NT_STATUS_IS_OK(status)) {
+		goto post_status;
+	}
+
 	status = prepare_next_frag(state, &is_last_frag);
 	if (!NT_STATUS_IS_OK(status)) {
 		goto post_status;
@@ -1344,25 +1486,161 @@
 	return NULL;
 }
 
+static NTSTATUS prepare_verification_trailer(struct rpc_api_pipe_req_state *state)
+{
+	struct pipe_auth_data *a = state->cli->auth;
+	struct dcerpc_sec_verification_trailer *t;
+	struct dcerpc_sec_vt *c = NULL;
+	struct ndr_push *ndr = NULL;
+	enum ndr_err_code ndr_err;
+	size_t align = 0;
+	size_t pad = 0;
+
+	if (a == NULL) {
+		return NT_STATUS_OK;
+	}
+
+	if (a->auth_level < DCERPC_AUTH_LEVEL_INTEGRITY) {
+		return NT_STATUS_OK;
+	}
+
+	t = talloc_zero(state, struct dcerpc_sec_verification_trailer);
+	if (t == NULL) {
+		return NT_STATUS_NO_MEMORY;
+	}
+
+	if (!a->verified_bitmask1) {
+		t->commands = talloc_realloc(t, t->commands,
+					     struct dcerpc_sec_vt,
+					     t->count.count + 1);
+		if (t->commands == NULL) {
+			return NT_STATUS_NO_MEMORY;
+		}
+		c = &t->commands[t->count.count++];
+		ZERO_STRUCTP(c);
+
+		c->command = DCERPC_SEC_VT_COMMAND_BITMASK1;
+		state->verify_bitmask1 = true;
+	}
+
+	if (!state->cli->verified_pcontext) {
+		t->commands = talloc_realloc(t, t->commands,
+					     struct dcerpc_sec_vt,
+					     t->count.count + 1);
+		if (t->commands == NULL) {
+			return NT_STATUS_NO_MEMORY;
+		}
+		c = &t->commands[t->count.count++];
+		ZERO_STRUCTP(c);
+
+		c->command = DCERPC_SEC_VT_COMMAND_PCONTEXT;
+		c->u.pcontext.abstract_syntax = state->cli->abstract_syntax;
+		c->u.pcontext.transfer_syntax = state->cli->transfer_syntax;
+
+		state->verify_pcontext = true;
+	}
+
+	if (true) { /* We do not support header signing */
+		t->commands = talloc_realloc(t, t->commands,
+					     struct dcerpc_sec_vt,
+					     t->count.count + 1);
+		if (t->commands == NULL) {
+			return NT_STATUS_NO_MEMORY;
+		}
+		c = &t->commands[t->count.count++];
+		ZERO_STRUCTP(c);
+
+		c->command = DCERPC_SEC_VT_COMMAND_HEADER2;
+		c->u.header2.ptype = DCERPC_PKT_REQUEST;
+		c->u.header2.drep[0] = DCERPC_DREP_LE;
+		c->u.header2.drep[1] = 0;
+		c->u.header2.drep[2] = 0;
+		c->u.header2.drep[3] = 0;
+		c->u.header2.call_id = state->call_id;
+		c->u.header2.context_id = 0;
+		c->u.header2.opnum = state->op_num;
+	}
+
+	if (t->count.count == 0) {
+		TALLOC_FREE(t);
+		return NT_STATUS_OK;
+	}
+
+	c = &t->commands[t->count.count - 1];
+	c->command |= DCERPC_SEC_VT_COMMAND_END;
+
+	if (DEBUGLEVEL >= 10) {
+		NDR_PRINT_DEBUG(dcerpc_sec_verification_trailer, t);
+	}
+
+	ndr = ndr_push_init_ctx(state);
+	if (ndr == NULL) {
+		return NT_STATUS_NO_MEMORY;
+	}
+
+	ndr_err = ndr_push_dcerpc_sec_verification_trailer(ndr,
+						NDR_SCALARS | NDR_BUFFERS,
+						t);
+	if (!NDR_ERR_CODE_IS_SUCCESS(ndr_err)) {
+		return ndr_map_error2ntstatus(ndr_err);
+	}
+	state->req_trailer = ndr_push_blob(ndr);
+
+	align = state->req_data->length & 0x3;
+	if (align > 0) {
+		pad = 4 - align;
+	}
+	if (pad > 0) {
+		bool ok;
+		uint8_t *p;
+		const uint8_t zeros[4] = { 0, };
+
+		ok = data_blob_append(ndr, &state->req_trailer, zeros, pad);
+		if (!ok) {
+			return NT_STATUS_NO_MEMORY;
+		}
+
+		/* move the padding to the start */
+		p = state->req_trailer.data;
+		memmove(p + pad, p, state->req_trailer.length - pad);
+		memset(p, 0, pad);
+	}
+
+	return NT_STATUS_OK;
+}
+
 static NTSTATUS prepare_next_frag(struct rpc_api_pipe_req_state *state,
 				  bool *is_last_frag)
 {
-	size_t data_sent_thistime;
 	size_t auth_len;
 	size_t frag_len;
 	uint8_t flags = 0;
 	size_t pad_len;
 	size_t data_left;
+	size_t data_thistime;
+	size_t trailer_left;
+	size_t trailer_thistime = 0;
+	size_t total_left;
+	size_t total_thistime;
 	NTSTATUS status;
+	bool ok;
 	union dcerpc_payload u;
 
 	data_left = state->req_data->length - state->req_data_sent;
+	trailer_left = state->req_trailer.length - state->req_trailer_sent;
+	total_left = data_left + trailer_left;
+	if ((total_left < data_left) || (total_left < trailer_left)) {
+		/*
+		 * overflow
+		 */
+		return NT_STATUS_INVALID_PARAMETER_MIX;
+	}
 
 	status = dcerpc_guess_sizes(state->cli->auth,
-				    DCERPC_REQUEST_LENGTH, data_left,
+				    DCERPC_REQUEST_LENGTH, total_left,
 				    state->cli->max_xmit_frag,
 				    CLIENT_NDR_PADDING_SIZE,
-				    &data_sent_thistime,
+				    &total_thistime,
 				    &frag_len, &auth_len, &pad_len);
 	if (!NT_STATUS_IS_OK(status)) {
 		return status;
@@ -1372,15 +1650,20 @@
 		flags = DCERPC_PFC_FLAG_FIRST;
 	}
 
-	if (data_sent_thistime == data_left) {
+	if (total_thistime == total_left) {
 		flags |= DCERPC_PFC_FLAG_LAST;
 	}
 
+	data_thistime = MIN(total_thistime, data_left);
+	if (data_thistime < total_thistime) {
+		trailer_thistime = total_thistime - data_thistime;
+	}
+
 	data_blob_free(&state->rpc_out);
 
 	ZERO_STRUCT(u.request);
 
-	u.request.alloc_hint	= state->req_data->length;
+	u.request.alloc_hint	= total_left;
 	u.request.context_id	= 0;
 	u.request.opnum		= state->op_num;
 
@@ -1400,11 +1683,26 @@
 	 * at this stage */
 	dcerpc_set_frag_length(&state->rpc_out, frag_len);
 
-	/* Copy in the data. */
-	if (!data_blob_append(NULL, &state->rpc_out,
+	if (data_thistime > 0) {
+		/* Copy in the data. */
+		ok = data_blob_append(NULL, &state->rpc_out,
 				state->req_data->data + state->req_data_sent,
-				data_sent_thistime)) {
-		return NT_STATUS_NO_MEMORY;
+				data_thistime);
+		if (!ok) {
+			return NT_STATUS_NO_MEMORY;
+		}
+		state->req_data_sent += data_thistime;
+	}
+
+	if (trailer_thistime > 0) {
+		/* Copy in the verification trailer. */
+		ok = data_blob_append(NULL, &state->rpc_out,
+				state->req_trailer.data + state->req_trailer_sent,
+				trailer_thistime);
+		if (!ok) {
+			return NT_STATUS_NO_MEMORY;
+		}
+		state->req_trailer_sent += trailer_thistime;
 	}
 
 	switch (state->cli->auth->auth_level) {
@@ -1424,7 +1722,6 @@
 		return NT_STATUS_INVALID_PARAMETER;
 	}
 
-	state->req_data_sent += data_sent_thistime;
 	*is_last_frag = ((flags & DCERPC_PFC_FLAG_LAST) != 0);
 
 	return status;
@@ -1488,6 +1785,20 @@
 		tevent_req_nterror(req, status);
 		return;
 	}
+
+	if (state->cli->auth == NULL) {
+		tevent_req_done(req);
+		return;
+	}
+
+	if (state->verify_bitmask1) {
+		state->cli->auth->verified_bitmask1 = true;
+	}
+
+	if (state->verify_pcontext) {
+		state->cli->verified_pcontext = true;
+	}
+
 	tevent_req_done(req);
 }
 
@@ -1559,9 +1870,8 @@
 
 static NTSTATUS create_rpc_bind_auth3(TALLOC_CTX *mem_ctx,
 				struct rpc_pipe_client *cli,
-				uint32 rpc_call_id,
-				enum dcerpc_AuthType auth_type,
-				enum dcerpc_AuthLevel auth_level,
+				struct pipe_auth_data *auth,
+				uint32_t rpc_call_id,
 				DATA_BLOB *pauth_blob,
 				DATA_BLOB *rpc_out)
 {
@@ -1571,10 +1881,10 @@
 	u.auth3._pad = 0;
 
 	status = dcerpc_push_dcerpc_auth(mem_ctx,
-					 auth_type,
-					 auth_level,
+					 auth->auth_type,
+					 auth->auth_level,
 					 0, /* auth_pad_length */
-					 1, /* auth_context_id */
+					 auth->auth_context_id,
 					 pauth_blob,
 					 &u.auth3.auth_info);
 	if (!NT_STATUS_IS_OK(status)) {
@@ -1604,9 +1914,8 @@
  ********************************************************************/
 
 static NTSTATUS create_rpc_alter_context(TALLOC_CTX *mem_ctx,
-					enum dcerpc_AuthType auth_type,
-					enum dcerpc_AuthLevel auth_level,
-					uint32 rpc_call_id,
+					struct pipe_auth_data *auth,
+					uint32_t rpc_call_id,
 					const struct ndr_syntax_id *abstract,
 					const struct ndr_syntax_id *transfer,
 					const DATA_BLOB *pauth_blob, /* spnego auth blob already created. */
@@ -1616,10 +1925,10 @@
 	NTSTATUS status;
 
 	status = dcerpc_push_dcerpc_auth(mem_ctx,
-					 auth_type,
-					 auth_level,
+					 auth->auth_type,
+					 auth->auth_level,
 					 0, /* auth_pad_length */
-					 1, /* auth_context_id */
+					 auth->auth_context_id,
 					 pauth_blob,
 					 &auth_info);
 	if (!NT_STATUS_IS_OK(status)) {
@@ -1647,9 +1956,15 @@
 	DATA_BLOB rpc_out;
 	bool auth3;
 	uint32_t rpc_call_id;
+	struct netr_Authenticator auth;
+	struct netr_Authenticator return_auth;
+	struct netlogon_creds_CredentialState *creds;
+	union netr_Capabilities capabilities;
+	struct netr_LogonGetCapabilities r;
 };
 
 static void rpc_pipe_bind_step_one_done(struct tevent_req *subreq);
+static void rpc_pipe_bind_step_two_trigger(struct tevent_req *req);
 static NTSTATUS rpc_bind_next_send(struct tevent_req *req,
 				   struct rpc_pipe_bind_state *state,
 				   DATA_BLOB *credentials);
@@ -1753,35 +2068,53 @@
 
 	case DCERPC_AUTH_TYPE_NONE:
 	case DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM:
-	case DCERPC_AUTH_TYPE_SCHANNEL:
 		/* Bind complete. */
 		tevent_req_done(req);
 		return;
 
-	case DCERPC_AUTH_TYPE_NTLMSSP:
-	case DCERPC_AUTH_TYPE_SPNEGO:
-	case DCERPC_AUTH_TYPE_KRB5:
-		/* Paranoid lenght checks */
-		if (pkt->frag_length < DCERPC_AUTH_TRAILER_LENGTH
-						+ pkt->auth_length) {
-			tevent_req_nterror(req,
-					NT_STATUS_INFO_LENGTH_MISMATCH);
+	case DCERPC_AUTH_TYPE_SCHANNEL:
+		rpc_pipe_bind_step_two_trigger(req);
+		return;
+
+	default:
+		if (pkt->auth_length == 0) {
+			tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
 			return;
 		}
 		/* get auth credentials */
-		status = dcerpc_pull_dcerpc_auth(talloc_tos(),
-						 &pkt->u.bind_ack.auth_info,
-						 &auth, false);
+		status = dcerpc_pull_auth_trailer(pkt, talloc_tos(),
+						  &pkt->u.bind_ack.auth_info,
+						  &auth, NULL, true);
 		if (!NT_STATUS_IS_OK(status)) {
 			DEBUG(0, ("Failed to pull dcerpc auth: %s.\n",
 				  nt_errstr(status)));
 			tevent_req_nterror(req, status);
 			return;
 		}
-		break;
 
-	default:
-		goto err_out;
+		if (auth.auth_type != pauth->auth_type) {
+			DEBUG(0, (__location__ " Auth type %u mismatch expected %u.\n",
+				  auth.auth_type, pauth->auth_type));
+			tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
+			return;
+		}
+
+		if (auth.auth_level != pauth->auth_level) {
+			DEBUG(0, (__location__ " Auth level %u mismatch expected %u.\n",
+				  auth.auth_level, pauth->auth_level));
+			tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
+			return;
+		}
+
+		if (auth.auth_context_id != pauth->auth_context_id) {
+			DEBUG(0, (__location__ " Auth context id %u mismatch expected %u.\n",
+				  (unsigned)auth.auth_context_id,
+				  (unsigned)pauth->auth_context_id));
+			tevent_req_nterror(req, NT_STATUS_RPC_PROTOCOL_ERROR);
+			return;
+		}
+
+		break;
 	}
 
 	/*
@@ -1869,6 +2202,158 @@
 	tevent_req_nterror(req, NT_STATUS_INTERNAL_ERROR);
 }
 
+static void rpc_pipe_bind_step_two_done(struct tevent_req *subreq);
+
+static void rpc_pipe_bind_step_two_trigger(struct tevent_req *req)
+{
+	struct rpc_pipe_bind_state *state =
+		tevent_req_data(req,
+				struct rpc_pipe_bind_state);
+	struct dcerpc_binding_handle *b = state->cli->binding_handle;
+	struct schannel_state *schannel_auth =
+		talloc_get_type_abort(state->cli->auth->auth_ctx,
+				      struct schannel_state);
+	struct tevent_req *subreq;
+
+#ifndef NETLOGON_SUPPORT
+	tevent_req_nterror(req, NT_STATUS_UNSUCCESSFUL);
+	return;
+#endif
+
+	if (schannel_auth == NULL ||
+	    !ndr_syntax_id_equal(&state->cli->abstract_syntax,
+				 &ndr_table_netlogon.syntax_id)) {
+		tevent_req_done(req);
+		return;
+	}
+
+	ZERO_STRUCT(state->return_auth);
+
+	state->creds = netlogon_creds_copy(state, schannel_auth->creds);
+	if (state->creds == NULL) {
+		tevent_req_nterror(req, NT_STATUS_NO_MEMORY);
+		return;
+	}
+
+	netlogon_creds_client_authenticator(state->creds, &state->auth);
+
+	state->r.in.server_name = state->cli->srv_name_slash;
+	state->r.in.computer_name = state->creds->computer_name;
+	state->r.in.credential = &state->auth;
+	state->r.in.query_level = 1;
+	state->r.in.return_authenticator = &state->return_auth;
+
+	state->r.out.capabilities = &state->capabilities;
+	state->r.out.return_authenticator = &state->return_auth;
+
+	subreq = dcerpc_netr_LogonGetCapabilities_r_send(talloc_tos(),
+							 state->ev,
+							 b,
+							 &state->r);
+	if (subreq == NULL) {
+		tevent_req_nterror(req, NT_STATUS_NO_MEMORY);
+		return;
+	}
+
+	tevent_req_set_callback(subreq, rpc_pipe_bind_step_two_done, req);
+	return;
+}
+
+static void rpc_pipe_bind_step_two_done(struct tevent_req *subreq)
+{
+	struct tevent_req *req =
+		tevent_req_callback_data(subreq,
+					 struct tevent_req);
+	struct rpc_pipe_bind_state *state =
+		tevent_req_data(req,
+				struct rpc_pipe_bind_state);
+	struct schannel_state *schannel_auth =
+		talloc_get_type_abort(state->cli->auth->auth_ctx,
+				      struct schannel_state);
+	NTSTATUS status;
+
+	status = dcerpc_netr_LogonGetCapabilities_r_recv(subreq, talloc_tos());
+	TALLOC_FREE(subreq);
+	if (NT_STATUS_EQUAL(status, NT_STATUS_RPC_PROCNUM_OUT_OF_RANGE)) {
+		if (state->cli->dc->negotiate_flags &
+		    NETLOGON_NEG_SUPPORTS_AES) {
+			DEBUG(5, ("AES is not supported and the error was %s\n",
+				  nt_errstr(status)));
+			tevent_req_nterror(req,
+					   NT_STATUS_INVALID_NETWORK_RESPONSE);
+			return;
+		}
+
+		/* This is probably NT */
+		DEBUG(5, ("We are checking against an NT - %s\n",
+			  nt_errstr(status)));
+		tevent_req_done(req);
+		return;
+	} else if (!NT_STATUS_IS_OK(status)) {
+		DEBUG(0, ("dcerpc_netr_LogonGetCapabilities_r_recv failed with %s\n",
+			  nt_errstr(status)));
+		tevent_req_nterror(req, status);
+		return;
+	}
+
+	if (NT_STATUS_EQUAL(state->r.out.result, NT_STATUS_NOT_IMPLEMENTED)) {
+		if (state->creds->negotiate_flags & NETLOGON_NEG_SUPPORTS_AES) {
+			/* This means AES isn't supported. */
+			DEBUG(5, ("AES is not supported and the error was %s\n",
+				  nt_errstr(state->r.out.result)));
+			tevent_req_nterror(req,
+					   NT_STATUS_INVALID_NETWORK_RESPONSE);
+			return;
+		}
+
+		/* This is probably an old Samba version */
+		DEBUG(5, ("We are checking against an old Samba version - %s\n",
+			  nt_errstr(state->r.out.result)));
+		tevent_req_done(req);
+		return;
+	}
+
+	/* We need to check the credential state here, cause win2k3 and earlier
+	 * returns NT_STATUS_NOT_IMPLEMENTED */
+	if (!netlogon_creds_client_check(state->creds,
+					 &state->r.out.return_authenticator->cred)) {
+		/*
+		 * Server replied with bad credential. Fail.
+		 */
+		DEBUG(0,("rpc_pipe_bind_step_two_done: server %s "
+			 "replied with bad credential\n",
+			 state->cli->desthost));
+		tevent_req_nterror(req, NT_STATUS_UNSUCCESSFUL);
+		return;
+	}
+
+	TALLOC_FREE(schannel_auth->creds);
+	schannel_auth->creds = talloc_steal(state->cli, state->creds);
+
+	if (!NT_STATUS_IS_OK(state->r.out.result)) {
+		DEBUG(0, ("dcerpc_netr_LogonGetCapabilities_r_recv failed with %s\n",
+			  nt_errstr(state->r.out.result)));
+		tevent_req_nterror(req, state->r.out.result);
+		return;
+	}
+
+	if (state->creds->negotiate_flags !=
+	    state->r.out.capabilities->server_capabilities) {
+		DEBUG(0, ("The client capabilities don't match the server "
+			  "capabilities: local[0x%08X] remote[0x%08X]\n",
+			  state->creds->negotiate_flags,
+			  state->capabilities.server_capabilities));
+		tevent_req_nterror(req,
+				   NT_STATUS_INVALID_NETWORK_RESPONSE);
+		return;
+	}
+
+	/* TODO: Add downgrade dectection. */
+
+	tevent_req_done(req);
+	return;
+}
+
 static NTSTATUS rpc_bind_next_send(struct tevent_req *req,
 				   struct rpc_pipe_bind_state *state,
 				   DATA_BLOB *auth_token)
@@ -1880,9 +2365,7 @@
 	/* Now prepare the alter context pdu. */
 	data_blob_free(&state->rpc_out);
 
-	status = create_rpc_alter_context(state,
-					  auth->auth_type,
-					  auth->auth_level,
+	status = create_rpc_alter_context(state, auth,
 					  state->rpc_call_id,
 					  &state->cli->abstract_syntax,
 					  &state->cli->transfer_syntax,
@@ -1915,10 +2398,8 @@
 	/* Now prepare the auth3 context pdu. */
 	data_blob_free(&state->rpc_out);
 
-	status = create_rpc_bind_auth3(state, state->cli,
+	status = create_rpc_bind_auth3(state, state->cli, auth,
 					state->rpc_call_id,
-					auth->auth_type,
-					auth->auth_level,
 					auth_token,
 					&state->rpc_out);
 	if (!NT_STATUS_IS_OK(status)) {
@@ -2152,8 +2633,9 @@
 	/*
 	 * TODO: do a real async disconnect ...
 	 *
-	 * For now the caller needs to free rpc_cli
+	 * For now we do it sync...
 	 */
+	TALLOC_FREE(hs->rpc_cli->transport);
 	hs->rpc_cli = NULL;
 
 	tevent_req_done(req);
@@ -2290,6 +2772,7 @@
 
 	result->auth_type = DCERPC_AUTH_TYPE_NCALRPC_AS_SYSTEM;
 	result->auth_level = DCERPC_AUTH_LEVEL_CONNECT;
+	result->auth_context_id = 1;
 
 	result->user_name = talloc_strdup(result, "");
 	result->domain = talloc_strdup(result, "");
@@ -2314,6 +2797,7 @@
 
 	result->auth_type = DCERPC_AUTH_TYPE_NONE;
 	result->auth_level = DCERPC_AUTH_LEVEL_NONE;
+	result->auth_context_id = 0;
 
 	result->user_name = talloc_strdup(result, "");
 	result->domain = talloc_strdup(result, "");
@@ -2351,6 +2835,7 @@
 
 	result->auth_type = auth_type;
 	result->auth_level = auth_level;
+	result->auth_context_id = 1;
 
 	result->user_name = talloc_strdup(result, username);
 	result->domain = talloc_strdup(result, domain);
@@ -2422,6 +2907,7 @@
 
 	result->auth_type = DCERPC_AUTH_TYPE_SCHANNEL;
 	result->auth_level = auth_level;
+	result->auth_context_id = 1;
 
 	result->user_name = talloc_strdup(result, "");
 	result->domain = talloc_strdup(result, domain);
@@ -2904,12 +3390,14 @@
 	status = rpc_pipe_bind(result, auth);
 	if (!NT_STATUS_IS_OK(status)) {
 		int lvl = 0;
+#ifdef ACTIVE_DIRECTORY
 		if (ndr_syntax_id_equal(interface,
 					&ndr_table_dssetup.syntax_id)) {
 			/* non AD domains just don't have this pipe, avoid
 			 * level 0 statement in that case - gd */
 			lvl = 3;
 		}
+#endif
 		DEBUG(lvl, ("cli_rpc_pipe_open_noauth: rpc_pipe_bind for pipe "
 			    "%s failed with error %s\n",
 			    get_pipe_name_from_syntax(talloc_tos(), interface),
@@ -3086,6 +3574,7 @@
 	}
 	auth->auth_type = DCERPC_AUTH_TYPE_KRB5;
 	auth->auth_level = auth_level;
+	auth->auth_context_id = 1;
 
 	if (!username) {
 		username = "";
@@ -3156,6 +3645,7 @@
 	}
 	auth->auth_type = DCERPC_AUTH_TYPE_SPNEGO;
 	auth->auth_level = auth_level;
+	auth->auth_context_id = 1;
 
 	if (!username) {
 		username = "";
@@ -3230,6 +3720,7 @@
 	}
 	auth->auth_type = DCERPC_AUTH_TYPE_SPNEGO;
 	auth->auth_level = auth_level;
+	auth->auth_context_id = 1;
 
 	if (!username) {
 		username = "";
diff -daurN samba3/source3/rpc_client/rpc_client.h samba3/source3/rpc_client/rpc_client.h
--- samba3/source3/rpc_client/rpc_client.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_client/rpc_client.h	2024-08-04 17:52:53.000000000 +0200
@@ -39,6 +39,7 @@
 
 	struct ndr_syntax_id abstract_syntax;
 	struct ndr_syntax_id transfer_syntax;
+	bool verified_pcontext;
 
 	char *desthost;
 	char *srv_name_slash;
diff -daurN samba3/source3/rpcclient/rpcclient.c samba3/source3/rpcclient/rpcclient.c
--- samba3/source3/rpcclient/rpcclient.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpcclient/rpcclient.c	2024-08-04 17:52:53.000000000 +0200
@@ -623,20 +623,34 @@
 	rpcclient_commands,
 	lsarpc_commands,
 	ds_commands,
+#ifdef SAMR_SUPPORT
 	samr_commands,
+#endif
+#ifdef PRINTER_SUPPORT
 	spoolss_commands,
+#endif
+#ifdef NETLOGON_SUPPORT
 	netlogon_commands,
+#endif
 	srvsvc_commands,
+#ifdef DFS_SUPPORT
 	dfs_commands,
+#endif
+#ifdef DEVELOPER
 	echo_commands,
+#endif
 	epmapper_commands,
 	shutdown_commands,
  	test_commands,
 	wkssvc_commands,
+#ifdef EXTRA_SERVICES
 	ntsvcs_commands,
 	drsuapi_commands,
 	eventlog_commands,
+#endif
+#ifdef WINREG_SUPPORT
 	winreg_commands,
+#endif
 	NULL
 };
 
@@ -1031,6 +1045,10 @@
 		binding->transport = NCACN_NP;
 	}
 
+	if (binding->flags & DCERPC_CONNECT) {
+		pipe_default_auth_level = DCERPC_AUTH_LEVEL_CONNECT;
+		pipe_default_auth_type = DCERPC_AUTH_TYPE_NTLMSSP;
+	}
 	if (binding->flags & DCERPC_SIGN) {
 		pipe_default_auth_level = DCERPC_AUTH_LEVEL_INTEGRITY;
 		pipe_default_auth_type = DCERPC_AUTH_TYPE_NTLMSSP;
@@ -1044,12 +1062,6 @@
 		pipe_default_auth_spnego_type = PIPE_AUTH_TYPE_SPNEGO_NTLMSSP;
 	}
 	if (binding->flags & DCERPC_AUTH_NTLM) {
-		/* If neither Integrity or Privacy are requested then
-		 * Use just Connect level */
-		if (pipe_default_auth_level == DCERPC_AUTH_LEVEL_NONE) {
-			pipe_default_auth_level = DCERPC_AUTH_LEVEL_CONNECT;
-		}
-
 		if (pipe_default_auth_type == DCERPC_AUTH_TYPE_SPNEGO) {
 			pipe_default_auth_spnego_type = PIPE_AUTH_TYPE_SPNEGO_NTLMSSP;
 		} else {
@@ -1057,18 +1069,18 @@
 		}
 	}
 	if (binding->flags & DCERPC_AUTH_KRB5) {
-		/* If neither Integrity or Privacy are requested then
-		 * Use just Connect level */
-		if (pipe_default_auth_level == DCERPC_AUTH_LEVEL_NONE) {
-			pipe_default_auth_level = DCERPC_AUTH_LEVEL_CONNECT;
-		}
-
 		if (pipe_default_auth_type == DCERPC_AUTH_TYPE_SPNEGO) {
 			pipe_default_auth_spnego_type = PIPE_AUTH_TYPE_SPNEGO_KRB5;
 		} else {
 			pipe_default_auth_type = DCERPC_AUTH_TYPE_KRB5;
 		}
 	}
+	if (pipe_default_auth_type != DCERPC_AUTH_TYPE_NONE) {
+		/* If nothing is requested then default to integrity */
+		if (pipe_default_auth_level == DCERPC_AUTH_LEVEL_NONE) {
+			pipe_default_auth_level = DCERPC_AUTH_LEVEL_INTEGRITY;
+		}
+	}
 
 	if (get_cmdline_auth_info_use_kerberos(rpcclient_auth_info)) {
 		flags |= CLI_FULL_CONNECTION_USE_KERBEROS |
diff -daurN samba3/source3/rpc_server/dfs/srv_dfs_nt.c samba3/source3/rpc_server/dfs/srv_dfs_nt.c
--- samba3/source3/rpc_server/dfs/srv_dfs_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/dfs/srv_dfs_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -411,125 +411,125 @@
 WERROR _dfs_SetInfo(struct pipes_struct *p, struct dfs_SetInfo *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_Rename(struct pipes_struct *p, struct dfs_Rename *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_Move(struct pipes_struct *p, struct dfs_Move *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_ManagerGetConfigInfo(struct pipes_struct *p, struct dfs_ManagerGetConfigInfo *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_ManagerSendSiteInfo(struct pipes_struct *p, struct dfs_ManagerSendSiteInfo *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_AddFtRoot(struct pipes_struct *p, struct dfs_AddFtRoot *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_RemoveFtRoot(struct pipes_struct *p, struct dfs_RemoveFtRoot *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_AddStdRoot(struct pipes_struct *p, struct dfs_AddStdRoot *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_RemoveStdRoot(struct pipes_struct *p, struct dfs_RemoveStdRoot *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_ManagerInitialize(struct pipes_struct *p, struct dfs_ManagerInitialize *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_AddStdRootForced(struct pipes_struct *p, struct dfs_AddStdRootForced *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_GetDcAddress(struct pipes_struct *p, struct dfs_GetDcAddress *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_SetDcAddress(struct pipes_struct *p, struct dfs_SetDcAddress *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_FlushFtTable(struct pipes_struct *p, struct dfs_FlushFtTable *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_Add2(struct pipes_struct *p, struct dfs_Add2 *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_Remove2(struct pipes_struct *p, struct dfs_Remove2 *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_EnumEx(struct pipes_struct *p, struct dfs_EnumEx *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _dfs_SetInfo2(struct pipes_struct *p, struct dfs_SetInfo2 *r)
 {
 	/* FIXME: Implement your code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/dssetup/srv_dssetup_nt.c samba3/source3/rpc_server/dssetup/srv_dssetup_nt.c
--- samba3/source3/rpc_server/dssetup/srv_dssetup_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/dssetup/srv_dssetup_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -130,7 +130,7 @@
 WERROR _dssetup_DsRoleDnsNameToFlatName(struct pipes_struct *p,
 					struct dssetup_DsRoleDnsNameToFlatName *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -140,7 +140,7 @@
 WERROR _dssetup_DsRoleDcAsDc(struct pipes_struct *p,
 			     struct dssetup_DsRoleDcAsDc *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -150,7 +150,7 @@
 WERROR _dssetup_DsRoleDcAsReplica(struct pipes_struct *p,
 				  struct dssetup_DsRoleDcAsReplica *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -160,7 +160,7 @@
 WERROR _dssetup_DsRoleDemoteDc(struct pipes_struct *p,
 			       struct dssetup_DsRoleDemoteDc *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -170,7 +170,7 @@
 WERROR _dssetup_DsRoleGetDcOperationProgress(struct pipes_struct *p,
 					     struct dssetup_DsRoleGetDcOperationProgress *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -180,7 +180,7 @@
 WERROR _dssetup_DsRoleGetDcOperationResults(struct pipes_struct *p,
 					    struct dssetup_DsRoleGetDcOperationResults *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -190,7 +190,7 @@
 WERROR _dssetup_DsRoleCancel(struct pipes_struct *p,
 			     struct dssetup_DsRoleCancel *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -200,7 +200,7 @@
 WERROR _dssetup_DsRoleServerSaveStateForUpgrade(struct pipes_struct *p,
 						struct dssetup_DsRoleServerSaveStateForUpgrade *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -210,7 +210,7 @@
 WERROR _dssetup_DsRoleUpgradeDownlevelServer(struct pipes_struct *p,
 					     struct dssetup_DsRoleUpgradeDownlevelServer *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -220,6 +220,6 @@
 WERROR _dssetup_DsRoleAbortDownlevelServerUpgrade(struct pipes_struct *p,
 						  struct dssetup_DsRoleAbortDownlevelServerUpgrade *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/echo/srv_echo_nt.c samba3/source3/rpc_server/echo/srv_echo_nt.c
--- samba3/source3/rpc_server/echo/srv_echo_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/echo/srv_echo_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -87,13 +87,13 @@
 
 void _echo_TestCall(struct pipes_struct *p, struct echo_TestCall *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return;
 }
 
 NTSTATUS _echo_TestCall2(struct pipes_struct *p, struct echo_TestCall2 *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_OK;
 }
 
@@ -105,18 +105,18 @@
 
 void _echo_TestEnum(struct pipes_struct *p, struct echo_TestEnum *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return;
 }
 
 void _echo_TestSurrounding(struct pipes_struct *p, struct echo_TestSurrounding *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return;
 }
 
 uint16 _echo_TestDoublePointer(struct pipes_struct *p, struct echo_TestDoublePointer *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return 0;
 }
diff -daurN samba3/source3/rpc_server/epmapper/srv_epmapper.c samba3/source3/rpc_server/epmapper/srv_epmapper.c
--- samba3/source3/rpc_server/epmapper/srv_epmapper.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/epmapper/srv_epmapper.c	2024-08-04 17:52:53.000000000 +0200
@@ -297,6 +297,7 @@
 	/* If this is not a priviledged users, return */
 	if (p->transport != NCALRPC ||
 	    !is_priviledged_pipe(p->session_info)) {
+		p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 		return EPMAPPER_STATUS_CANT_PERFORM_OP;
 	}
 
@@ -433,6 +434,7 @@
 	/* If this is not a priviledged users, return */
 	if (p->transport != NCALRPC ||
 	    !is_priviledged_pipe(p->session_info)) {
+		p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 		return EPMAPPER_STATUS_CANT_PERFORM_OP;
 	}
 
@@ -1096,7 +1098,7 @@
 error_status_t _epm_InqObject(struct pipes_struct *p,
 		      struct epm_InqObject *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return EPMAPPER_STATUS_CANT_PERFORM_OP;
 }
 
@@ -1110,7 +1112,7 @@
 error_status_t _epm_MgmtDelete(struct pipes_struct *p,
 		       struct epm_MgmtDelete *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return EPMAPPER_STATUS_CANT_PERFORM_OP;
 }
 
@@ -1121,7 +1123,7 @@
 error_status_t _epm_MapAuth(struct pipes_struct *p,
 		    struct epm_MapAuth *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return EPMAPPER_STATUS_CANT_PERFORM_OP;
 }
 
diff -daurN samba3/source3/rpc_server/eventlog/srv_eventlog_nt.c samba3/source3/rpc_server/eventlog/srv_eventlog_nt.c
--- samba3/source3/rpc_server/eventlog/srv_eventlog_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/eventlog/srv_eventlog_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -695,7 +695,7 @@
 
 NTSTATUS _eventlog_BackupEventLogW(struct pipes_struct *p, struct eventlog_BackupEventLogW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -838,104 +838,104 @@
 NTSTATUS _eventlog_DeregisterEventSource(struct pipes_struct *p,
 					 struct eventlog_DeregisterEventSource *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_ChangeNotify(struct pipes_struct *p,
 				struct eventlog_ChangeNotify *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_RegisterEventSourceW(struct pipes_struct *p,
 					struct eventlog_RegisterEventSourceW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_OpenBackupEventLogW(struct pipes_struct *p,
 				       struct eventlog_OpenBackupEventLogW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_ClearEventLogA(struct pipes_struct *p,
 				  struct eventlog_ClearEventLogA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_BackupEventLogA(struct pipes_struct *p,
 				   struct eventlog_BackupEventLogA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_OpenEventLogA(struct pipes_struct *p,
 				 struct eventlog_OpenEventLogA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_RegisterEventSourceA(struct pipes_struct *p,
 					struct eventlog_RegisterEventSourceA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_OpenBackupEventLogA(struct pipes_struct *p,
 				       struct eventlog_OpenBackupEventLogA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_ReadEventLogA(struct pipes_struct *p,
 				 struct eventlog_ReadEventLogA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_ReportEventA(struct pipes_struct *p,
 				struct eventlog_ReportEventA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_RegisterClusterSvc(struct pipes_struct *p,
 				      struct eventlog_RegisterClusterSvc *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_DeregisterClusterSvc(struct pipes_struct *p,
 					struct eventlog_DeregisterClusterSvc *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_WriteClusterEvents(struct pipes_struct *p,
 				      struct eventlog_WriteClusterEvents *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _eventlog_ReportEventAndSourceW(struct pipes_struct *p,
 					 struct eventlog_ReportEventAndSourceW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
diff -daurN samba3/source3/rpc_server/lsa/srv_lsa_nt.c samba3/source3/rpc_server/lsa/srv_lsa_nt.c
--- samba3/source3/rpc_server/lsa/srv_lsa_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/lsa/srv_lsa_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -817,7 +817,7 @@
 	struct lsa_QueryInfoPolicy r;
 
 	if ((pdb_capabilities() & PDB_CAP_ADS) == 0) {
-		p->rng_fault_state = True;
+		p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 		return NT_STATUS_NOT_IMPLEMENTED;
 	}
 
@@ -3210,88 +3210,88 @@
 
 NTSTATUS _lsa_SetSecObj(struct pipes_struct *p, struct lsa_SetSecObj *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_ChangePassword(struct pipes_struct *p,
 			     struct lsa_ChangePassword *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetInfoPolicy(struct pipes_struct *p, struct lsa_SetInfoPolicy *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_ClearAuditLog(struct pipes_struct *p, struct lsa_ClearAuditLog *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_GetQuotasForAccount(struct pipes_struct *p,
 				  struct lsa_GetQuotasForAccount *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetQuotasForAccount(struct pipes_struct *p,
 				  struct lsa_SetQuotasForAccount *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetInformationTrustedDomain(struct pipes_struct *p,
 					  struct lsa_SetInformationTrustedDomain *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_QuerySecret(struct pipes_struct *p, struct lsa_QuerySecret *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetTrustedDomainInfo(struct pipes_struct *p,
 				   struct lsa_SetTrustedDomainInfo *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_StorePrivateData(struct pipes_struct *p,
 			       struct lsa_StorePrivateData *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_RetrievePrivateData(struct pipes_struct *p,
 				  struct lsa_RetrievePrivateData *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetInfoPolicy2(struct pipes_struct *p,
 			     struct lsa_SetInfoPolicy2 *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetTrustedDomainInfoByName(struct pipes_struct *p,
 					 struct lsa_SetTrustedDomainInfoByName *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -3310,7 +3310,7 @@
 	 * _lsa_EnumTrustedDomains() afterwards - gd */
 
 	if (!(pdb_capabilities() & PDB_CAP_TRUSTED_DOMAINS_EX)) {
-		p->rng_fault_state = True;
+		p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 		return NT_STATUS_NOT_IMPLEMENTED;
 	}
 
@@ -3379,107 +3379,107 @@
 NTSTATUS _lsa_QueryDomainInformationPolicy(struct pipes_struct *p,
 					   struct lsa_QueryDomainInformationPolicy *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_SetDomainInformationPolicy(struct pipes_struct *p,
 					 struct lsa_SetDomainInformationPolicy *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_TestCall(struct pipes_struct *p, struct lsa_TestCall *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRWRITE(struct pipes_struct *p, struct lsa_CREDRWRITE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRREAD(struct pipes_struct *p, struct lsa_CREDRREAD *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRENUMERATE(struct pipes_struct *p, struct lsa_CREDRENUMERATE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRWRITEDOMAINCREDENTIALS(struct pipes_struct *p,
 					  struct lsa_CREDRWRITEDOMAINCREDENTIALS *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRREADDOMAINCREDENTIALS(struct pipes_struct *p,
 					 struct lsa_CREDRREADDOMAINCREDENTIALS *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRDELETE(struct pipes_struct *p, struct lsa_CREDRDELETE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRGETTARGETINFO(struct pipes_struct *p,
 				 struct lsa_CREDRGETTARGETINFO *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRPROFILELOADED(struct pipes_struct *p,
 				 struct lsa_CREDRPROFILELOADED *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_CREDRGETSESSIONTYPES(struct pipes_struct *p,
 				   struct lsa_CREDRGETSESSIONTYPES *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARREGISTERAUDITEVENT(struct pipes_struct *p,
 				     struct lsa_LSARREGISTERAUDITEVENT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARGENAUDITEVENT(struct pipes_struct *p,
 				struct lsa_LSARGENAUDITEVENT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARUNREGISTERAUDITEVENT(struct pipes_struct *p,
 				       struct lsa_LSARUNREGISTERAUDITEVENT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_lsaRQueryForestTrustInformation(struct pipes_struct *p,
 					      struct lsa_lsaRQueryForestTrustInformation *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -3992,34 +3992,34 @@
 NTSTATUS _lsa_CREDRRENAME(struct pipes_struct *p,
 			  struct lsa_CREDRRENAME *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSAROPENPOLICYSCE(struct pipes_struct *p,
 				struct lsa_LSAROPENPOLICYSCE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARADTREGISTERSECURITYEVENTSOURCE(struct pipes_struct *p,
 						 struct lsa_LSARADTREGISTERSECURITYEVENTSOURCE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE(struct pipes_struct *p,
 						   struct lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
 NTSTATUS _lsa_LSARADTREPORTSECURITYEVENT(struct pipes_struct *p,
 					 struct lsa_LSARADTREPORTSECURITYEVENT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
diff -daurN samba3/source3/rpc_server/netlogon/srv_netlog_nt.c samba3/source3/rpc_server/netlogon/srv_netlog_nt.c
--- samba3/source3/rpc_server/netlogon/srv_netlog_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/netlogon/srv_netlog_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -1508,6 +1508,7 @@
 	case NetlogonNetworkTransitiveInformation:
 	{
 		const char *wksname = nt_workstation;
+		const char *workgroup = lp_workgroup();
 
 		status = make_auth_context_fixed(talloc_tos(), &auth_context,
 						 logon->network->challenge);
@@ -1532,6 +1533,14 @@
 						     logon->network->nt.length)) {
 			status = NT_STATUS_NO_MEMORY;
 		}
+
+		if (NT_STATUS_IS_OK(status)) {
+			status = NTLMv2_RESPONSE_verify_netlogon_creds(
+						user_info->client.account_name,
+						user_info->client.domain_name,
+						user_info->password.response.nt,
+						creds, workgroup);
+		}
 		break;
 	}
 	case NetlogonInteractiveInformation:
@@ -1636,6 +1645,14 @@
 						r->out.validation->sam3);
 		break;
 	case 6:
+		/* Only allow this if the pipe is protected. */
+		if (p->auth.auth_level < DCERPC_AUTH_LEVEL_PRIVACY) {
+			DEBUG(0,("netr_Validation6: client %s not using privacy for netlogon\n",
+				get_remote_machine_name()));
+			status = NT_STATUS_INVALID_PARAMETER;
+			break;
+		}
+
 		status = serverinfo_to_SamInfo6(server_info, pipe_session_key, 16,
 						r->out.validation->sam6);
 		break;
@@ -1787,7 +1804,7 @@
 WERROR _netr_LogonUasLogon(struct pipes_struct *p,
 			   struct netr_LogonUasLogon *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1797,7 +1814,7 @@
 WERROR _netr_LogonUasLogoff(struct pipes_struct *p,
 			    struct netr_LogonUasLogoff *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1807,7 +1824,7 @@
 NTSTATUS _netr_DatabaseDeltas(struct pipes_struct *p,
 			      struct netr_DatabaseDeltas *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1817,7 +1834,7 @@
 NTSTATUS _netr_DatabaseSync(struct pipes_struct *p,
 			    struct netr_DatabaseSync *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1827,7 +1844,7 @@
 NTSTATUS _netr_AccountDeltas(struct pipes_struct *p,
 			     struct netr_AccountDeltas *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1837,7 +1854,7 @@
 NTSTATUS _netr_AccountSync(struct pipes_struct *p,
 			   struct netr_AccountSync *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1978,7 +1995,7 @@
 NTSTATUS _netr_DatabaseSync2(struct pipes_struct *p,
 			     struct netr_DatabaseSync2 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1988,7 +2005,7 @@
 NTSTATUS _netr_DatabaseRedo(struct pipes_struct *p,
 			    struct netr_DatabaseRedo *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -1998,7 +2015,7 @@
 WERROR _netr_DsRGetDCName(struct pipes_struct *p,
 			  struct netr_DsRGetDCName *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2017,7 +2034,7 @@
 WERROR _netr_NETRLOGONSETSERVICEBITS(struct pipes_struct *p,
 				     struct netr_NETRLOGONSETSERVICEBITS *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2027,7 +2044,7 @@
 WERROR _netr_LogonGetTrustRid(struct pipes_struct *p,
 			      struct netr_LogonGetTrustRid *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2037,7 +2054,7 @@
 WERROR _netr_NETRLOGONCOMPUTESERVERDIGEST(struct pipes_struct *p,
 					  struct netr_NETRLOGONCOMPUTESERVERDIGEST *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2047,7 +2064,7 @@
 WERROR _netr_NETRLOGONCOMPUTECLIENTDIGEST(struct pipes_struct *p,
 					  struct netr_NETRLOGONCOMPUTECLIENTDIGEST *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2057,7 +2074,7 @@
 WERROR _netr_DsRGetDCNameEx(struct pipes_struct *p,
 			    struct netr_DsRGetDCNameEx *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2067,7 +2084,7 @@
 WERROR _netr_DsRGetSiteName(struct pipes_struct *p,
 			    struct netr_DsRGetSiteName *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2077,7 +2094,7 @@
 NTSTATUS _netr_LogonGetDomainInfo(struct pipes_struct *p,
 				  struct netr_LogonGetDomainInfo *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2087,7 +2104,7 @@
 WERROR _netr_ServerPasswordGet(struct pipes_struct *p,
 			       struct netr_ServerPasswordGet *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2097,7 +2114,7 @@
 WERROR _netr_NETRLOGONSENDTOSAM(struct pipes_struct *p,
 				struct netr_NETRLOGONSENDTOSAM *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2107,7 +2124,7 @@
 WERROR _netr_DsRAddressToSitenamesW(struct pipes_struct *p,
 				    struct netr_DsRAddressToSitenamesW *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2117,7 +2134,7 @@
 WERROR _netr_DsRGetDCNameEx2(struct pipes_struct *p,
 			     struct netr_DsRGetDCNameEx2 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2127,7 +2144,7 @@
 WERROR _netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN(struct pipes_struct *p,
 						 struct netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2137,7 +2154,7 @@
 WERROR _netr_NetrEnumerateTrustedDomainsEx(struct pipes_struct *p,
 					   struct netr_NetrEnumerateTrustedDomainsEx *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2147,7 +2164,7 @@
 WERROR _netr_DsRAddressToSitenamesExW(struct pipes_struct *p,
 				      struct netr_DsRAddressToSitenamesExW *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2157,7 +2174,7 @@
 WERROR _netr_DsrGetDcSiteCoverageW(struct pipes_struct *p,
 				   struct netr_DsrGetDcSiteCoverageW *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2167,7 +2184,7 @@
 WERROR _netr_DsrEnumerateDomainTrusts(struct pipes_struct *p,
 				      struct netr_DsrEnumerateDomainTrusts *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2177,7 +2194,7 @@
 WERROR _netr_DsrDeregisterDNSHostRecords(struct pipes_struct *p,
 					 struct netr_DsrDeregisterDNSHostRecords *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2187,7 +2204,7 @@
 NTSTATUS _netr_ServerTrustPasswordsGet(struct pipes_struct *p,
 				       struct netr_ServerTrustPasswordsGet *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2197,7 +2214,7 @@
 WERROR _netr_DsRGetForestTrustInformation(struct pipes_struct *p,
 					  struct netr_DsRGetForestTrustInformation *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -2271,11 +2288,13 @@
 
 	/* TODO: check server name */
 
-	status = schannel_check_creds_state(p->mem_ctx, lp_private_dir(),
-					    r->in.computer_name,
-					    r->in.credential,
-					    r->out.return_authenticator,
-					    &creds);
+	become_root();
+	status = netr_creds_server_step_check(p, p->mem_ctx,
+					      r->in.computer_name,
+					      r->in.credential,
+					      r->out.return_authenticator,
+					      &creds);
+	unbecome_root();
 	if (!NT_STATUS_IS_OK(status)) {
 		return status;
 	}
@@ -2371,11 +2390,13 @@
 
 	/* TODO: check server name */
 
-	status = schannel_check_creds_state(p->mem_ctx, lp_private_dir(),
-					    r->in.computer_name,
-					    r->in.credential,
-					    r->out.return_authenticator,
-					    &creds);
+	become_root();
+	status = netr_creds_server_step_check(p, p->mem_ctx,
+					      r->in.computer_name,
+					      r->in.credential,
+					      r->out.return_authenticator,
+					      &creds);
+	unbecome_root();
 	if (!NT_STATUS_IS_OK(status)) {
 		return status;
 	}
@@ -2476,7 +2497,7 @@
 NTSTATUS _netr_Unused47(struct pipes_struct *p,
 			struct netr_Unused47 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2486,6 +2507,6 @@
 NTSTATUS _netr_DsrUpdateReadOnlyServerDnsRecords(struct pipes_struct *p,
 						 struct netr_DsrUpdateReadOnlyServerDnsRecords *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
diff -daurN samba3/source3/rpc_server/ntsvcs/srv_ntsvcs_nt.c samba3/source3/rpc_server/ntsvcs/srv_ntsvcs_nt.c
--- samba3/source3/rpc_server/ntsvcs/srv_ntsvcs_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/ntsvcs/srv_ntsvcs_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -227,7 +227,7 @@
 WERROR _PNP_Disconnect(struct pipes_struct *p,
 		       struct PNP_Disconnect *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -237,7 +237,7 @@
 WERROR _PNP_Connect(struct pipes_struct *p,
 		    struct PNP_Connect *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -247,7 +247,7 @@
 WERROR _PNP_GetGlobalState(struct pipes_struct *p,
 			   struct PNP_GetGlobalState *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -257,7 +257,7 @@
 WERROR _PNP_InitDetection(struct pipes_struct *p,
 			  struct PNP_InitDetection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -267,7 +267,7 @@
 WERROR _PNP_ReportLogOn(struct pipes_struct *p,
 			struct PNP_ReportLogOn *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -277,7 +277,7 @@
 WERROR _PNP_GetRootDeviceInstance(struct pipes_struct *p,
 				  struct PNP_GetRootDeviceInstance *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -287,7 +287,7 @@
 WERROR _PNP_GetRelatedDeviceInstance(struct pipes_struct *p,
 				     struct PNP_GetRelatedDeviceInstance *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -297,7 +297,7 @@
 WERROR _PNP_EnumerateSubKeys(struct pipes_struct *p,
 			     struct PNP_EnumerateSubKeys *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -307,7 +307,7 @@
 WERROR _PNP_GetDepth(struct pipes_struct *p,
 		     struct PNP_GetDepth *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -317,7 +317,7 @@
 WERROR _PNP_SetDeviceRegProp(struct pipes_struct *p,
 			     struct PNP_SetDeviceRegProp *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -327,7 +327,7 @@
 WERROR _PNP_GetClassInstance(struct pipes_struct *p,
 			     struct PNP_GetClassInstance *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -337,7 +337,7 @@
 WERROR _PNP_CreateKey(struct pipes_struct *p,
 		      struct PNP_CreateKey *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -347,7 +347,7 @@
 WERROR _PNP_DeleteRegistryKey(struct pipes_struct *p,
 			      struct PNP_DeleteRegistryKey *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -357,7 +357,7 @@
 WERROR _PNP_GetClassCount(struct pipes_struct *p,
 			  struct PNP_GetClassCount *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -367,7 +367,7 @@
 WERROR _PNP_GetClassName(struct pipes_struct *p,
 			 struct PNP_GetClassName *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -377,7 +377,7 @@
 WERROR _PNP_DeleteClassKey(struct pipes_struct *p,
 			   struct PNP_DeleteClassKey *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -387,7 +387,7 @@
 WERROR _PNP_GetInterfaceDeviceAlias(struct pipes_struct *p,
 				    struct PNP_GetInterfaceDeviceAlias *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -397,7 +397,7 @@
 WERROR _PNP_GetInterfaceDeviceList(struct pipes_struct *p,
 				   struct PNP_GetInterfaceDeviceList *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -407,7 +407,7 @@
 WERROR _PNP_GetInterfaceDeviceListSize(struct pipes_struct *p,
 				       struct PNP_GetInterfaceDeviceListSize *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -417,7 +417,7 @@
 WERROR _PNP_RegisterDeviceClassAssociation(struct pipes_struct *p,
 					   struct PNP_RegisterDeviceClassAssociation *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -427,7 +427,7 @@
 WERROR _PNP_UnregisterDeviceClassAssociation(struct pipes_struct *p,
 					     struct PNP_UnregisterDeviceClassAssociation *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -437,7 +437,7 @@
 WERROR _PNP_GetClassRegProp(struct pipes_struct *p,
 			    struct PNP_GetClassRegProp *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -447,7 +447,7 @@
 WERROR _PNP_SetClassRegProp(struct pipes_struct *p,
 			    struct PNP_SetClassRegProp *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -457,7 +457,7 @@
 WERROR _PNP_CreateDevInst(struct pipes_struct *p,
 			  struct PNP_CreateDevInst *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -467,7 +467,7 @@
 WERROR _PNP_DeviceInstanceAction(struct pipes_struct *p,
 				 struct PNP_DeviceInstanceAction *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -477,7 +477,7 @@
 WERROR _PNP_GetDeviceStatus(struct pipes_struct *p,
 			    struct PNP_GetDeviceStatus *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -487,7 +487,7 @@
 WERROR _PNP_SetDeviceProblem(struct pipes_struct *p,
 			     struct PNP_SetDeviceProblem *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -497,7 +497,7 @@
 WERROR _PNP_DisableDevInst(struct pipes_struct *p,
 			   struct PNP_DisableDevInst *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -507,7 +507,7 @@
 WERROR _PNP_UninstallDevInst(struct pipes_struct *p,
 			     struct PNP_UninstallDevInst *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -517,7 +517,7 @@
 WERROR _PNP_AddID(struct pipes_struct *p,
 		  struct PNP_AddID *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -527,7 +527,7 @@
 WERROR _PNP_RegisterDriver(struct pipes_struct *p,
 			   struct PNP_RegisterDriver *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -537,7 +537,7 @@
 WERROR _PNP_QueryRemove(struct pipes_struct *p,
 			struct PNP_QueryRemove *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -547,7 +547,7 @@
 WERROR _PNP_RequestDeviceEject(struct pipes_struct *p,
 			       struct PNP_RequestDeviceEject *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -557,7 +557,7 @@
 WERROR _PNP_IsDockStationPresent(struct pipes_struct *p,
 				 struct PNP_IsDockStationPresent *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -567,7 +567,7 @@
 WERROR _PNP_RequestEjectPC(struct pipes_struct *p,
 			   struct PNP_RequestEjectPC *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -577,7 +577,7 @@
 WERROR _PNP_AddEmptyLogConf(struct pipes_struct *p,
 			    struct PNP_AddEmptyLogConf *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -587,7 +587,7 @@
 WERROR _PNP_FreeLogConf(struct pipes_struct *p,
 			struct PNP_FreeLogConf *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -597,7 +597,7 @@
 WERROR _PNP_GetFirstLogConf(struct pipes_struct *p,
 			    struct PNP_GetFirstLogConf *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -607,7 +607,7 @@
 WERROR _PNP_GetNextLogConf(struct pipes_struct *p,
 			   struct PNP_GetNextLogConf *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -617,7 +617,7 @@
 WERROR _PNP_GetLogConfPriority(struct pipes_struct *p,
 			       struct PNP_GetLogConfPriority *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -627,7 +627,7 @@
 WERROR _PNP_AddResDes(struct pipes_struct *p,
 		      struct PNP_AddResDes *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -637,7 +637,7 @@
 WERROR _PNP_FreeResDes(struct pipes_struct *p,
 		       struct PNP_FreeResDes *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -647,7 +647,7 @@
 WERROR _PNP_GetNextResDes(struct pipes_struct *p,
 			  struct PNP_GetNextResDes *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -657,7 +657,7 @@
 WERROR _PNP_GetResDesData(struct pipes_struct *p,
 			  struct PNP_GetResDesData *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -667,7 +667,7 @@
 WERROR _PNP_GetResDesDataSize(struct pipes_struct *p,
 			      struct PNP_GetResDesDataSize *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -677,7 +677,7 @@
 WERROR _PNP_ModifyResDes(struct pipes_struct *p,
 			 struct PNP_ModifyResDes *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -687,7 +687,7 @@
 WERROR _PNP_DetectResourceLimit(struct pipes_struct *p,
 				struct PNP_DetectResourceLimit *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -697,7 +697,7 @@
 WERROR _PNP_QueryResConfList(struct pipes_struct *p,
 			     struct PNP_QueryResConfList *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -707,7 +707,7 @@
 WERROR _PNP_SetHwProf(struct pipes_struct *p,
 		      struct PNP_SetHwProf *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -717,7 +717,7 @@
 WERROR _PNP_QueryArbitratorFreeData(struct pipes_struct *p,
 				    struct PNP_QueryArbitratorFreeData *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -727,7 +727,7 @@
 WERROR _PNP_QueryArbitratorFreeSize(struct pipes_struct *p,
 				    struct PNP_QueryArbitratorFreeSize *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -737,7 +737,7 @@
 WERROR _PNP_RunDetection(struct pipes_struct *p,
 			 struct PNP_RunDetection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -747,7 +747,7 @@
 WERROR _PNP_RegisterNotification(struct pipes_struct *p,
 				 struct PNP_RegisterNotification *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -757,7 +757,7 @@
 WERROR _PNP_UnregisterNotification(struct pipes_struct *p,
 				   struct PNP_UnregisterNotification *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -767,7 +767,7 @@
 WERROR _PNP_GetCustomDevProp(struct pipes_struct *p,
 			     struct PNP_GetCustomDevProp *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -777,7 +777,7 @@
 WERROR _PNP_GetVersionInternal(struct pipes_struct *p,
 			       struct PNP_GetVersionInternal *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -787,7 +787,7 @@
 WERROR _PNP_GetBlockedDriverInfo(struct pipes_struct *p,
 				 struct PNP_GetBlockedDriverInfo *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -797,6 +797,6 @@
 WERROR _PNP_GetServerSideDeviceInstallFlags(struct pipes_struct *p,
 					    struct PNP_GetServerSideDeviceInstallFlags *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/rpc_ep_setup.c samba3/source3/rpc_server/rpc_ep_setup.c
--- samba3/source3/rpc_server/rpc_ep_setup.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/rpc_ep_setup.c	2024-08-04 17:52:53.000000000 +0200
@@ -409,6 +409,7 @@
 	return true;
 }
 
+#ifdef WINREG_SUPPORT
 static bool winreg_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -456,6 +457,7 @@
 
 	return true;
 }
+#endif
 
 static bool srvsvc_init_cb(void *ptr)
 {
@@ -506,6 +508,7 @@
 	return true;
 }
 
+#ifdef LSA_SUPPORT
 static bool lsarpc_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -554,7 +557,9 @@
 
 	return true;
 }
+#endif
 
+#ifdef SAMR_SUPPORT
 static bool samr_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -603,7 +608,9 @@
 
 	return true;
 }
+#endif
 
+#ifdef NETLOGON_SUPPORT
 static bool netlogon_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -652,6 +659,7 @@
 
 	return true;
 }
+#endif
 
 static bool spoolss_init_cb(void *ptr)
 {
@@ -697,6 +705,7 @@
 	return true;
 }
 
+#ifdef EXTRA_SERVICES
 static bool svcctl_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -709,10 +718,12 @@
 					   "epmapper",
 					   "none");
 
+#ifdef WINREG_SUPPORT
 	ok = svcctl_init_winreg(ep_ctx->msg_ctx);
 	if (!ok) {
 		return false;
 	}
+#endif
 
 	/* initialize the control hooks */
 	init_service_op_table();
@@ -733,6 +744,7 @@
 
 	return true;
 }
+#endif
 
 static bool svcctl_shutdown_cb(void *ptr)
 {
@@ -741,6 +753,8 @@
 	return true;
 }
 
+#ifdef EXTRA_SERVICES
+
 static bool ntsvcs_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -781,10 +795,12 @@
 					   "epmapper",
 					   "none");
 
+#ifdef WINREG_SUPPORT
 	ok = eventlog_init_winreg(ep_ctx->msg_ctx);
 	if (!ok) {
 		return false;
 	}
+#endif
 
 	if (StrCaseCmp(rpcsrv_type, "embedded") == 0 ||
 	    StrCaseCmp(rpcsrv_type, "daemon") == 0) {
@@ -802,6 +818,7 @@
 
 	return true;
 }
+#endif
 
 static bool initshutdown_init_cb(void *ptr)
 {
@@ -870,6 +887,7 @@
 
 #endif
 
+#ifdef DFS_SUPPORT
 static bool netdfs_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -917,7 +935,9 @@
 
 	return true;
 }
+#endif
 
+#ifdef ACTIVE_DIRECTORY
 static bool dssetup_init_cb(void *ptr)
 {
 	struct dcesrv_ep_context *ep_ctx =
@@ -966,6 +986,7 @@
 
 	return true;
 }
+#endif
 
 static bool wkssvc_init_cb(void *ptr)
 {
@@ -1070,12 +1091,14 @@
 		}
 	}
 
+#ifdef WINREG_SUPPORT
 	winreg_cb.init         = winreg_init_cb;
 	winreg_cb.shutdown     = NULL;
 	winreg_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_winreg_init(&winreg_cb))) {
 		return false;
 	}
+#endif
 
 	srvsvc_cb.init         = srvsvc_init_cb;
 	srvsvc_cb.shutdown     = NULL;
@@ -1085,31 +1108,42 @@
 	}
 
 
+#ifdef LSA_SUPPORT
 	lsarpc_cb.init         = lsarpc_init_cb;
 	lsarpc_cb.shutdown     = NULL;
 	lsarpc_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_lsarpc_init(&lsarpc_cb))) {
 		return false;
 	}
+#endif
 
+#ifdef SAMR_SUPPORT
 	samr_cb.init         = samr_init_cb;
 	samr_cb.shutdown     = NULL;
 	samr_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_samr_init(&samr_cb))) {
 		return false;
 	}
+#endif
 
+#ifdef NETLOGON_SUPPORT
 	netlogon_cb.init         = netlogon_init_cb;
 	netlogon_cb.shutdown     = NULL;
 	netlogon_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_netlogon_init(&netlogon_cb))) {
 		return false;
 	}
+#endif
+
 
 	rpcsrv_type = lp_parm_const_string(GLOBAL_SECTION_SNUM,
 					   "rpc_server",
 					   "spoolss",
 					   "embedded");
+#ifndef PRINTER_SUPPORT
+	if (1) {
+	} else
+#endif
 	if (StrCaseCmp(rpcsrv_type, "embedded") == 0) {
 		spoolss_cb.init         = spoolss_init_cb;
 		spoolss_cb.shutdown     = spoolss_shutdown_cb;
@@ -1124,6 +1158,7 @@
 		}
 	}
 
+#ifdef EXTRA_SERVICES
 	svcctl_cb.init         = svcctl_init_cb;
 	svcctl_cb.shutdown     = svcctl_shutdown_cb;
 	svcctl_cb.private_data = ep_ctx;
@@ -1144,6 +1179,7 @@
 	if (!NT_STATUS_IS_OK(rpc_eventlog_init(&eventlog_cb))) {
 		return false;
 	}
+#endif
 
 	initshutdown_cb.init         = initshutdown_init_cb;
 	initshutdown_cb.shutdown     = NULL;
@@ -1152,12 +1188,14 @@
 		return false;
 	}
 
+#ifdef DFS_SUPPORT
 	netdfs_cb.init         = netdfs_init_cb;
 	netdfs_cb.shutdown     = NULL;
 	netdfs_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_netdfs_init(&netdfs_cb))) {
 		return false;
 	}
+#endif
 
 #ifdef DEVELOPER
 	rpcecho_cb.init         = rpcecho_init_cb;
@@ -1168,12 +1206,14 @@
 	}
 #endif
 
+#ifdef ACTIVE_DIRECTORY
 	dssetup_cb.init         = dssetup_init_cb;
 	dssetup_cb.shutdown     = NULL;
 	dssetup_cb.private_data = ep_ctx;
 	if (!NT_STATUS_IS_OK(rpc_dssetup_init(&dssetup_cb))) {
 		return false;
 	}
+#endif
 
 	wkssvc_cb.init         = wkssvc_init_cb;
 	wkssvc_cb.shutdown     = NULL;
diff -daurN samba3/source3/rpc_server/rpc_handles.c samba3/source3/rpc_server/rpc_handles.c
--- samba3/source3/rpc_server/rpc_handles.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/rpc_handles.c	2024-08-04 17:52:53.000000000 +0200
@@ -59,8 +59,14 @@
 
 static bool is_samr_lsa_pipe(const struct ndr_syntax_id *syntax)
 {
-	return (ndr_syntax_id_equal(syntax, &ndr_table_samr.syntax_id)
-		|| ndr_syntax_id_equal(syntax, &ndr_table_lsarpc.syntax_id));
+	return
+#ifdef SAMR_SUPPORT
+		ndr_syntax_id_equal(syntax, &ndr_table_samr.syntax_id) ||
+#endif
+#ifdef LSA_SUPPORT
+		ndr_syntax_id_equal(syntax, &ndr_table_lsarpc.syntax_id) ||
+#endif
+		false;
 }
 
 size_t num_pipe_handles(struct pipes_struct *p)
@@ -242,7 +248,7 @@
 	DEBUG(4,("Policy not found: "));
 	dump_data(4, (uint8_t *)hnd, sizeof(*hnd));
 
-	p->bad_handle_fault_state = true;
+	p->fault_state = DCERPC_FAULT_CONTEXT_MISMATCH;
 
 	return NULL;
 }
diff -daurN samba3/source3/rpc_server/rpc_ncacn_np.c samba3/source3/rpc_server/rpc_ncacn_np.c
--- samba3/source3/rpc_server/rpc_ncacn_np.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/rpc_ncacn_np.c	2024-08-04 17:52:53.000000000 +0200
@@ -171,6 +171,7 @@
 
 	p->syntax = *syntax;
 	p->transport = NCALRPC;
+	p->allow_bind = true;
 
 	DEBUG(4,("Created internal pipe %s (pipes_open=%d)\n",
 		 get_pipe_name_from_syntax(talloc_tos(), syntax), pipes_open));
@@ -216,24 +217,13 @@
 	}
 
 	if (p->fault_state) {
-		p->fault_state = false;
-		data_blob_free(&p->out_data.rdata);
-		talloc_free_children(p->mem_ctx);
-		return NT_STATUS_RPC_CALL_FAILED;
-	}
-
-	if (p->bad_handle_fault_state) {
-		p->bad_handle_fault_state = false;
-		data_blob_free(&p->out_data.rdata);
-		talloc_free_children(p->mem_ctx);
-		return NT_STATUS_RPC_SS_CONTEXT_MISMATCH;
-	}
+		NTSTATUS status;
 
-	if (p->rng_fault_state) {
-		p->rng_fault_state = false;
+		status = NT_STATUS(p->fault_state);
+		p->fault_state = 0;
 		data_blob_free(&p->out_data.rdata);
 		talloc_free_children(p->mem_ctx);
-		return NT_STATUS_RPC_PROCNUM_OUT_OF_RANGE;
+		return status;
 	}
 
 	*out_data = p->out_data.rdata;
@@ -791,6 +781,7 @@
 	}
 	result->auth->auth_type = DCERPC_AUTH_TYPE_NONE;
 	result->auth->auth_level = DCERPC_AUTH_LEVEL_NONE;
+	result->auth->auth_context_id = 0;
 
 	status = rpccli_anon_bind_data(result, &auth);
 	if (!NT_STATUS_IS_OK(status)) {
diff -daurN samba3/source3/rpc_server/rpc_server.c samba3/source3/rpc_server/rpc_server.c
--- samba3/source3/rpc_server/rpc_server.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/rpc_server.c	2024-08-04 17:52:53.000000000 +0200
@@ -102,6 +102,7 @@
 	p->syntax = id;
 	p->transport = transport;
 	p->ncalrpc_as_system = ncalrpc_as_system;
+	p->allow_bind = true;
 
 	p->mem_ctx = talloc_named(p, 0, "pipe %s %p", pipe_name, p);
 	if (!p->mem_ctx) {
@@ -663,6 +664,12 @@
 		goto fail;
 	}
 
+	if (npc->p->fault_state != 0) {
+		DEBUG(2, ("Disconnect after fault\n"));
+		sys_errno = EINVAL;
+		goto fail;
+	}
+
 	/* clear out any data that may have been left around */
 	npc->count = 0;
 	TALLOC_FREE(npc->iov);
@@ -1391,6 +1398,12 @@
 		goto fail;
 	}
 
+	if (ncacn_conn->p->fault_state != 0) {
+		DEBUG(2, ("Disconnect after fault\n"));
+		sys_errno = EINVAL;
+		goto fail;
+	}
+
 	/* clear out any data that may have been left around */
 	ncacn_conn->count = 0;
 	TALLOC_FREE(ncacn_conn->iov);
diff -daurN samba3/source3/rpc_server/samr/srv_samr_nt.c samba3/source3/rpc_server/samr/srv_samr_nt.c
--- samba3/source3/rpc_server/samr/srv_samr_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/samr/srv_samr_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -6628,6 +6628,11 @@
 	struct samr_GetDomPwInfo pw;
 	struct samr_PwInfo dom_pw_info;
 
+	if (p->auth.auth_level != DCERPC_AUTH_LEVEL_PRIVACY) {
+		p->fault_state = DCERPC_FAULT_ACCESS_DENIED;
+		return NT_STATUS_ACCESS_DENIED;
+	}
+
 	if (r->in.level < 1 || r->in.level > 3) {
 		return NT_STATUS_INVALID_INFO_CLASS;
 	}
@@ -6682,7 +6687,7 @@
 NTSTATUS _samr_Shutdown(struct pipes_struct *p,
 			struct samr_Shutdown *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6692,7 +6697,7 @@
 NTSTATUS _samr_SetMemberAttributesOfGroup(struct pipes_struct *p,
 					  struct samr_SetMemberAttributesOfGroup *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6702,6 +6707,7 @@
 NTSTATUS _samr_TestPrivateFunctionsDomain(struct pipes_struct *p,
 					  struct samr_TestPrivateFunctionsDomain *r)
 {
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6711,6 +6717,7 @@
 NTSTATUS _samr_TestPrivateFunctionsUser(struct pipes_struct *p,
 					struct samr_TestPrivateFunctionsUser *r)
 {
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6720,7 +6727,7 @@
 NTSTATUS _samr_AddMultipleMembersToAlias(struct pipes_struct *p,
 					 struct samr_AddMultipleMembersToAlias *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6730,7 +6737,7 @@
 NTSTATUS _samr_RemoveMultipleMembersFromAlias(struct pipes_struct *p,
 					      struct samr_RemoveMultipleMembersFromAlias *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6740,7 +6747,7 @@
 NTSTATUS _samr_SetBootKeyInformation(struct pipes_struct *p,
 				     struct samr_SetBootKeyInformation *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6750,7 +6757,7 @@
 NTSTATUS _samr_GetBootKeyInformation(struct pipes_struct *p,
 				     struct samr_GetBootKeyInformation *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -6760,6 +6767,6 @@
 NTSTATUS _samr_SetDsrmPassword(struct pipes_struct *p,
 			       struct samr_SetDsrmPassword *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
diff -daurN samba3/source3/rpc_server/spoolss/srv_spoolss_nt.c samba3/source3/rpc_server/spoolss/srv_spoolss_nt.c
--- samba3/source3/rpc_server/spoolss/srv_spoolss_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/spoolss/srv_spoolss_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -2480,7 +2480,7 @@
 		"", /* username */
 		"", /* domain */
 		"", /* password */
-		0, lp_client_signing());
+		0, False);
 
 	if ( !NT_STATUS_IS_OK( ret ) ) {
 		DEBUG(2,("spoolss_connect_to_client: connection to [%s] failed!\n",
@@ -10156,7 +10156,7 @@
 WERROR _spoolss_GetPrinterDriver(struct pipes_struct *p,
 				 struct spoolss_GetPrinterDriver *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10167,7 +10167,7 @@
 WERROR _spoolss_ReadPrinter(struct pipes_struct *p,
 			    struct spoolss_ReadPrinter *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10178,7 +10178,7 @@
 WERROR _spoolss_WaitForPrinterChange(struct pipes_struct *p,
 				     struct spoolss_WaitForPrinterChange *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10189,7 +10189,7 @@
 WERROR _spoolss_ConfigurePort(struct pipes_struct *p,
 			      struct spoolss_ConfigurePort *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10200,7 +10200,7 @@
 WERROR _spoolss_DeletePort(struct pipes_struct *p,
 			   struct spoolss_DeletePort *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10211,7 +10211,7 @@
 WERROR _spoolss_CreatePrinterIC(struct pipes_struct *p,
 				struct spoolss_CreatePrinterIC *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10222,7 +10222,7 @@
 WERROR _spoolss_PlayGDIScriptOnPrinterIC(struct pipes_struct *p,
 					 struct spoolss_PlayGDIScriptOnPrinterIC *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10233,7 +10233,7 @@
 WERROR _spoolss_DeletePrinterIC(struct pipes_struct *p,
 				struct spoolss_DeletePrinterIC *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10244,7 +10244,7 @@
 WERROR _spoolss_AddPrinterConnection(struct pipes_struct *p,
 				     struct spoolss_AddPrinterConnection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10255,7 +10255,7 @@
 WERROR _spoolss_DeletePrinterConnection(struct pipes_struct *p,
 					struct spoolss_DeletePrinterConnection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10266,7 +10266,7 @@
 WERROR _spoolss_PrinterMessageBox(struct pipes_struct *p,
 				  struct spoolss_PrinterMessageBox *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10277,7 +10277,7 @@
 WERROR _spoolss_AddMonitor(struct pipes_struct *p,
 			   struct spoolss_AddMonitor *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10288,7 +10288,7 @@
 WERROR _spoolss_DeleteMonitor(struct pipes_struct *p,
 			      struct spoolss_DeleteMonitor *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10299,7 +10299,7 @@
 WERROR _spoolss_DeletePrintProcessor(struct pipes_struct *p,
 				     struct spoolss_DeletePrintProcessor *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10310,7 +10310,7 @@
 WERROR _spoolss_AddPrintProvidor(struct pipes_struct *p,
 				 struct spoolss_AddPrintProvidor *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10321,7 +10321,7 @@
 WERROR _spoolss_DeletePrintProvidor(struct pipes_struct *p,
 				    struct spoolss_DeletePrintProvidor *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10332,7 +10332,7 @@
 WERROR _spoolss_FindFirstPrinterChangeNotification(struct pipes_struct *p,
 						   struct spoolss_FindFirstPrinterChangeNotification *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10343,7 +10343,7 @@
 WERROR _spoolss_FindNextPrinterChangeNotification(struct pipes_struct *p,
 						  struct spoolss_FindNextPrinterChangeNotification *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10354,7 +10354,7 @@
 WERROR _spoolss_RouterFindFirstPrinterChangeNotificationOld(struct pipes_struct *p,
 							    struct spoolss_RouterFindFirstPrinterChangeNotificationOld *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10365,7 +10365,7 @@
 WERROR _spoolss_ReplyOpenPrinter(struct pipes_struct *p,
 				 struct spoolss_ReplyOpenPrinter *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10376,7 +10376,7 @@
 WERROR _spoolss_RouterReplyPrinter(struct pipes_struct *p,
 				   struct spoolss_RouterReplyPrinter *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10387,7 +10387,7 @@
 WERROR _spoolss_ReplyClosePrinter(struct pipes_struct *p,
 				  struct spoolss_ReplyClosePrinter *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10398,7 +10398,7 @@
 WERROR _spoolss_AddPortEx(struct pipes_struct *p,
 			  struct spoolss_AddPortEx *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10409,7 +10409,7 @@
 WERROR _spoolss_RouterFindFirstPrinterChangeNotification(struct pipes_struct *p,
 							 struct spoolss_RouterFindFirstPrinterChangeNotification *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10420,7 +10420,7 @@
 WERROR _spoolss_SpoolerInit(struct pipes_struct *p,
 			    struct spoolss_SpoolerInit *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10431,7 +10431,7 @@
 WERROR _spoolss_ResetPrinterEx(struct pipes_struct *p,
 			       struct spoolss_ResetPrinterEx *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10442,7 +10442,7 @@
 WERROR _spoolss_RouterReplyPrinterEx(struct pipes_struct *p,
 				     struct spoolss_RouterReplyPrinterEx *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10453,7 +10453,7 @@
 WERROR _spoolss_44(struct pipes_struct *p,
 		   struct spoolss_44 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10464,7 +10464,7 @@
 WERROR _spoolss_SetPort(struct pipes_struct *p,
 			struct spoolss_SetPort *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10475,7 +10475,7 @@
 WERROR _spoolss_4a(struct pipes_struct *p,
 		   struct spoolss_4a *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10486,7 +10486,7 @@
 WERROR _spoolss_4b(struct pipes_struct *p,
 		   struct spoolss_4b *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10497,7 +10497,7 @@
 WERROR _spoolss_4c(struct pipes_struct *p,
 		   struct spoolss_4c *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10508,7 +10508,7 @@
 WERROR _spoolss_53(struct pipes_struct *p,
 		   struct spoolss_53 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10519,7 +10519,7 @@
 WERROR _spoolss_AddPerMachineConnection(struct pipes_struct *p,
 					struct spoolss_AddPerMachineConnection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10530,7 +10530,7 @@
 WERROR _spoolss_DeletePerMachineConnection(struct pipes_struct *p,
 					   struct spoolss_DeletePerMachineConnection *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10541,7 +10541,7 @@
 WERROR _spoolss_EnumPerMachineConnections(struct pipes_struct *p,
 					  struct spoolss_EnumPerMachineConnections *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10552,7 +10552,7 @@
 WERROR _spoolss_5a(struct pipes_struct *p,
 		   struct spoolss_5a *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10563,7 +10563,7 @@
 WERROR _spoolss_5b(struct pipes_struct *p,
 		   struct spoolss_5b *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10574,7 +10574,7 @@
 WERROR _spoolss_5c(struct pipes_struct *p,
 		   struct spoolss_5c *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10585,7 +10585,7 @@
 WERROR _spoolss_5d(struct pipes_struct *p,
 		   struct spoolss_5d *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10596,7 +10596,7 @@
 WERROR _spoolss_5e(struct pipes_struct *p,
 		   struct spoolss_5e *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10607,7 +10607,7 @@
 WERROR _spoolss_5f(struct pipes_struct *p,
 		   struct spoolss_5f *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10618,7 +10618,7 @@
 WERROR _spoolss_60(struct pipes_struct *p,
 		   struct spoolss_60 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10629,7 +10629,7 @@
 WERROR _spoolss_61(struct pipes_struct *p,
 		   struct spoolss_61 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10640,7 +10640,7 @@
 WERROR _spoolss_62(struct pipes_struct *p,
 		   struct spoolss_62 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10651,7 +10651,7 @@
 WERROR _spoolss_63(struct pipes_struct *p,
 		   struct spoolss_63 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10662,7 +10662,7 @@
 WERROR _spoolss_64(struct pipes_struct *p,
 		   struct spoolss_64 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10673,7 +10673,7 @@
 WERROR _spoolss_65(struct pipes_struct *p,
 		   struct spoolss_65 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10684,7 +10684,7 @@
 WERROR _spoolss_GetCorePrinterDrivers(struct pipes_struct *p,
 				      struct spoolss_GetCorePrinterDrivers *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10695,7 +10695,7 @@
 WERROR _spoolss_67(struct pipes_struct *p,
 		   struct spoolss_67 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10706,7 +10706,7 @@
 WERROR _spoolss_GetPrinterDriverPackagePath(struct pipes_struct *p,
 					    struct spoolss_GetPrinterDriverPackagePath *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10717,7 +10717,7 @@
 WERROR _spoolss_69(struct pipes_struct *p,
 		   struct spoolss_69 *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10728,7 +10728,7 @@
 WERROR _spoolss_6a(struct pipes_struct *p,
 		   struct spoolss_6a *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10739,7 +10739,7 @@
 WERROR _spoolss_6b(struct pipes_struct *p,
 		   struct spoolss_6b *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10750,7 +10750,7 @@
 WERROR _spoolss_6c(struct pipes_struct *p,
 		   struct spoolss_6c *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -10761,6 +10761,6 @@
 WERROR _spoolss_6d(struct pipes_struct *p,
 		   struct spoolss_6d *r)
 {
-	p->rng_fault_state = true;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/srv_pipe.c samba3/source3/rpc_server/srv_pipe.c
--- samba3/source3/rpc_server/srv_pipe.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/srv_pipe.c	2024-08-04 17:52:53.000000000 +0200
@@ -42,6 +42,13 @@
 #include "auth.h"
 #include "ntdomain.h"
 #include "rpc_server/srv_pipe.h"
+#include "../librpc/gen_ndr/ndr_dcerpc.h"
+#include "../librpc/ndr/ndr_dcerpc.h"
+#include "../librpc/gen_ndr/ndr_samr.h"
+#include "../librpc/gen_ndr/ndr_lsa.h"
+#include "../librpc/gen_ndr/ndr_netlogon.h"
+#include "../librpc/gen_ndr/ndr_epmapper.h"
+#include "../librpc/gen_ndr/ndr_echo.h"
 
 #undef DBGC_CLASS
 #define DBGC_CLASS DBGC_RPC_SRV
@@ -202,7 +209,7 @@
 	 * the pipe gets closed. JRA.
 	 */
 	if (p->fault_state) {
-		setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_OP_RNG_ERROR));
+		setup_fault_pdu(p, NT_STATUS(p->fault_state));
 		return true;
 	}
 
@@ -269,10 +276,14 @@
 	p->out_data.data_sent_length = 0;
 	p->out_data.current_pdu_sent = 0;
 
+	set_incoming_fault(p);
 	TALLOC_FREE(p->auth.auth_ctx);
 	p->auth.auth_level = DCERPC_AUTH_LEVEL_NONE;
 	p->auth.auth_type = DCERPC_AUTH_TYPE_NONE;
 	p->pipe_bound = False;
+	p->allow_bind = false;
+	p->allow_alter = false;
+	p->allow_auth3 = false;
 
 	return True;
 }
@@ -334,30 +345,116 @@
 			   uint32 context_id)
 {
 	struct pipe_rpc_fns *context_fns;
+	const char *interface_name = NULL;
+	bool ok;
 
 	DEBUG(3,("check_bind_req for %s\n",
-		 get_pipe_name_from_syntax(talloc_tos(), &p->syntax)));
+		 get_pipe_name_from_syntax(talloc_tos(), abstract)));
+
+	ok = ndr_syntax_id_equal(transfer, &ndr_transfer_syntax);
+	if (!ok) {
+		DEBUG(1,("check_bind_req unknown transfer syntax for "
+			 "%s context_id=%u\n",
+			 get_pipe_name_from_syntax(talloc_tos(), abstract),
+			 (unsigned)context_id));
+		return false;
+	}
+
+	for (context_fns = p->contexts;
+	     context_fns != NULL;
+	     context_fns = context_fns->next)
+	{
+		if (context_fns->context_id != context_id) {
+			continue;
+		}
+
+		ok = ndr_syntax_id_equal(&context_fns->syntax,
+					 abstract);
+		if (ok) {
+			return true;
+		}
+
+		DEBUG(1,("check_bind_req: changing abstract syntax for "
+			 "%s context_id=%u into %s not supported\n",
+			 get_pipe_name_from_syntax(talloc_tos(), &context_fns->syntax),
+			 (unsigned)context_id,
+			 get_pipe_name_from_syntax(talloc_tos(), abstract)));
+		return false;
+	}
 
 	/* we have to check all now since win2k introduced a new UUID on the lsaprpc pipe */
-	if (rpc_srv_pipe_exists_by_id(abstract) &&
-	   ndr_syntax_id_equal(transfer, &ndr_transfer_syntax)) {
-		DEBUG(3, ("check_bind_req: \\PIPE\\%s -> \\PIPE\\%s\n",
-			rpc_srv_get_pipe_cli_name(abstract),
-			rpc_srv_get_pipe_srv_name(abstract)));
-	} else {
+	if (!rpc_srv_pipe_exists_by_id(abstract)) {
 		return false;
 	}
 
+	DEBUG(3, ("check_bind_req: %s -> %s rpc service\n",
+		  rpc_srv_get_pipe_cli_name(abstract),
+		  rpc_srv_get_pipe_srv_name(abstract)));
+
 	context_fns = SMB_MALLOC_P(struct pipe_rpc_fns);
 	if (context_fns == NULL) {
 		DEBUG(0,("check_bind_req: malloc() failed!\n"));
 		return False;
 	}
 
+	interface_name = get_pipe_name_from_syntax(talloc_tos(),
+						   abstract);
+
+	SMB_ASSERT(interface_name != NULL);
+
 	context_fns->next = context_fns->prev = NULL;
 	context_fns->n_cmds = rpc_srv_get_pipe_num_cmds(abstract);
 	context_fns->cmds = rpc_srv_get_pipe_cmds(abstract);
 	context_fns->context_id = context_id;
+	context_fns->syntax = *abstract;
+
+	context_fns->allow_connect = lp_allow_dcerpc_auth_level_connect();
+#ifdef SAMR_SUPPORT
+	/*
+	 * for the samr and the lsarpc interfaces we don't allow "connect"
+	 * auth_level by default.
+	 */
+	ok = ndr_syntax_id_equal(abstract, &ndr_table_samr.syntax_id);
+	if (ok) {
+		context_fns->allow_connect = false;
+	}
+#endif
+#ifdef LSA_SUPPORT
+	ok = ndr_syntax_id_equal(abstract, &ndr_table_lsarpc.syntax_id);
+	if (ok) {
+		context_fns->allow_connect = false;
+	}
+#endif
+#ifdef NETLOGON_SUPPORT
+	ok = ndr_syntax_id_equal(abstract, &ndr_table_netlogon.syntax_id);
+	if (ok) {
+		context_fns->allow_connect = false;
+	}
+#endif
+	/*
+	 * for the epmapper and echo interfaces we allow "connect"
+	 * auth_level by default.
+	 */
+	ok = ndr_syntax_id_equal(abstract, &ndr_table_epmapper.syntax_id);
+	if (ok) {
+		context_fns->allow_connect = true;
+	}
+#ifdef DEVELOPER
+	ok = ndr_syntax_id_equal(abstract, &ndr_table_rpcecho.syntax_id);
+	if (ok) {
+		context_fns->allow_connect = true;
+	}
+#endif
+	/*
+	 * every interface can be modified to allow "connect" auth_level by
+	 * using a parametric option like:
+	 * allow dcerpc auth level connect:<interface>
+	 * e.g.
+	 * allow dcerpc auth level connect:samr = yes
+	 */
+	context_fns->allow_connect = lp_parm_bool(-1,
+		"allow dcerpc auth level connect",
+		interface_name, context_fns->allow_connect);
 
 	/* add to the list of open contexts */
 
@@ -384,6 +481,11 @@
 		pipename += 1;
 	}
 
+	if (strchr(pipename, '/')) {
+		DEBUG(1, ("Refusing open on pipe %s\n", pipename));
+		return false;
+	}
+
 	if (lp_disable_spoolss() && strequal(pipename, "spoolss")) {
 		DEBUG(10, ("refusing spoolss access\n"));
 		return false;
@@ -445,6 +547,7 @@
 
 	p->auth.auth_ctx = spnego_ctx;
 	p->auth.auth_type = DCERPC_AUTH_TYPE_SPNEGO;
+	p->auth.auth_context_id = auth_info->auth_context_id;
 
 	DEBUG(10, ("SPNEGO auth started\n"));
 
@@ -555,6 +658,7 @@
 	/* We're finished with this bind - no more packets. */
 	p->auth.auth_ctx = schannel_auth;
 	p->auth.auth_type = DCERPC_AUTH_TYPE_SCHANNEL;
+	p->auth.auth_context_id = auth_info->auth_context_id;
 
 	p->pipe_bound = True;
 
@@ -599,6 +703,7 @@
 
 	p->auth.auth_ctx = ntlmssp_state;
 	p->auth.auth_type = DCERPC_AUTH_TYPE_NTLMSSP;
+	p->auth.auth_context_id = auth_info->auth_context_id;
 
 	DEBUG(10, (__location__ ": NTLMSSP auth started\n"));
 
@@ -774,6 +879,11 @@
 	void *mech_ctx;
 	NTSTATUS status;
 
+	if (p->auth.auth_type == DCERPC_AUTH_TYPE_NONE) {
+		p->pipe_bound = true;
+		return NT_STATUS_OK;
+	}
+
 	switch (p->auth.auth_type) {
 	case DCERPC_AUTH_TYPE_NTLMSSP:
 		ntlmssp_ctx = talloc_get_type_abort(p->auth.auth_ctx,
@@ -865,16 +975,37 @@
 	DATA_BLOB auth_resp = data_blob_null;
 	DATA_BLOB auth_blob = data_blob_null;
 
-	/* No rebinds on a bound pipe - use alter context. */
-	if (p->pipe_bound) {
-		DEBUG(2,("api_pipe_bind_req: rejecting bind request on bound "
-			 "pipe %s.\n",
-			 get_pipe_name_from_syntax(talloc_tos(), &p->syntax)));
+	if (!p->allow_bind) {
+		DEBUG(2,("Pipe not in allow bind state\n"));
 		return setup_bind_nak(p, pkt);
 	}
+	p->allow_bind = false;
+
+	status = dcerpc_verify_ncacn_packet_header(pkt,
+			DCERPC_PKT_BIND,
+			pkt->u.bind.auth_info.length,
+			0, /* required flags */
+			DCERPC_PFC_FLAG_FIRST |
+			DCERPC_PFC_FLAG_LAST |
+			DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN |
+			0x08 | /* this is not defined, but should be ignored */
+			DCERPC_PFC_FLAG_CONC_MPX |
+			DCERPC_PFC_FLAG_DID_NOT_EXECUTE |
+			DCERPC_PFC_FLAG_MAYBE |
+			DCERPC_PFC_FLAG_OBJECT_UUID);
+	if (!NT_STATUS_IS_OK(status)) {
+		DEBUG(1, ("api_pipe_bind_req: invalid pdu: %s\n",
+			  nt_errstr(status)));
+		goto err_exit;
+	}
 
 	if (pkt->u.bind.num_contexts == 0) {
-		DEBUG(0, ("api_pipe_bind_req: no rpc contexts around\n"));
+		DEBUG(1, ("api_pipe_bind_req: no rpc contexts around\n"));
+		goto err_exit;
+	}
+
+	if (pkt->u.bind.ctx_list[0].num_transfer_syntaxes == 0) {
+		DEBUG(1, ("api_pipe_bind_req: no transfer syntaxes around\n"));
 		goto err_exit;
 	}
 
@@ -958,25 +1089,12 @@
 	 * Check if this is an authenticated bind request.
 	 */
 	if (pkt->auth_length) {
-		/* Quick length check. Won't catch a bad auth footer,
-		 * prevents overrun. */
-
-		if (pkt->frag_length < RPC_HEADER_LEN +
-					DCERPC_AUTH_TRAILER_LENGTH +
-					pkt->auth_length) {
-			DEBUG(0,("api_pipe_bind_req: auth_len (%u) "
-				"too long for fragment %u.\n",
-				(unsigned int)pkt->auth_length,
-				(unsigned int)pkt->frag_length));
-			goto err_exit;
-		}
-
 		/*
 		 * Decode the authentication verifier.
 		 */
-		status = dcerpc_pull_dcerpc_auth(pkt,
-						 &pkt->u.bind.auth_info,
-						 &auth_info, p->endian);
+		status = dcerpc_pull_auth_trailer(pkt, pkt,
+						  &pkt->u.bind.auth_info,
+						  &auth_info, NULL, true);
 		if (!NT_STATUS_IS_OK(status)) {
 			DEBUG(0, ("Unable to unmarshall dcerpc_auth.\n"));
 			goto err_exit;
@@ -1070,6 +1188,7 @@
 		p->pipe_bound = True;
 		/* The session key was initialized from the SMB
 		 * session in make_internal_rpc_pipe_p */
+		p->auth.auth_context_id = 0;
 	}
 
 	ZERO_STRUCT(u.bind_ack);
@@ -1111,15 +1230,15 @@
 	if (!NT_STATUS_IS_OK(status)) {
 		DEBUG(0, ("Failed to marshall bind_ack packet. (%s)\n",
 			  nt_errstr(status)));
+		goto err_exit;
 	}
 
 	if (auth_resp.length) {
-
 		status = dcerpc_push_dcerpc_auth(pkt,
 						 auth_type,
 						 auth_info.auth_level,
-						 0,
-						 1, /* auth_context_id */
+						 0, /* pad_len */
+						 p->auth.auth_context_id,
 						 &auth_resp,
 						 &auth_blob);
 		if (!NT_STATUS_IS_OK(status)) {
@@ -1150,6 +1269,22 @@
 	p->out_data.current_pdu_sent = 0;
 
 	TALLOC_FREE(auth_blob.data);
+
+	if (bind_ack_ctx.result == 0) {
+		p->allow_alter = true;
+		p->allow_auth3 = true;
+		if (p->auth.auth_type == DCERPC_AUTH_TYPE_NONE) {
+			status = pipe_auth_verify_final(p);
+			if (!NT_STATUS_IS_OK(status)) {
+				DEBUG(0, ("pipe_auth_verify_final failed: %s\n",
+					  nt_errstr(status)));
+				goto err_exit;
+			}
+		}
+	} else {
+		goto err_exit;
+	}
+
 	return True;
 
   err_exit:
@@ -1174,18 +1309,38 @@
 
 	DEBUG(5, ("api_pipe_bind_auth3: decode request. %d\n", __LINE__));
 
-	if (pkt->auth_length == 0) {
-		DEBUG(0, ("No auth field sent for bind request!\n"));
+	if (!p->allow_auth3) {
+		DEBUG(1, ("Pipe not in allow auth3 state.\n"));
 		goto err;
 	}
 
-	/* Ensure there's enough data for an authenticated request. */
-	if (pkt->frag_length < RPC_HEADER_LEN
-				+ DCERPC_AUTH_TRAILER_LENGTH
-				+ pkt->auth_length) {
-			DEBUG(0,("api_pipe_ntlmssp_auth_process: auth_len "
-				"%u is too large.\n",
-                        (unsigned int)pkt->auth_length));
+	status = dcerpc_verify_ncacn_packet_header(pkt,
+			DCERPC_PKT_AUTH3,
+			pkt->u.auth3.auth_info.length,
+			0, /* required flags */
+			DCERPC_PFC_FLAG_FIRST |
+			DCERPC_PFC_FLAG_LAST |
+			DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN |
+			0x08 | /* this is not defined, but should be ignored */
+			DCERPC_PFC_FLAG_CONC_MPX |
+			DCERPC_PFC_FLAG_DID_NOT_EXECUTE |
+			DCERPC_PFC_FLAG_MAYBE |
+			DCERPC_PFC_FLAG_OBJECT_UUID);
+	if (!NT_STATUS_IS_OK(status)) {
+		DEBUG(1, ("api_pipe_bind_auth3: invalid pdu: %s\n",
+			  nt_errstr(status)));
+		goto err;
+	}
+
+	/* We can only finish if the pipe is unbound for now */
+	if (p->pipe_bound) {
+		DEBUG(0, (__location__ ": Pipe already bound, "
+			  "AUTH3 not supported!\n"));
+		goto err;
+	}
+
+	if (pkt->auth_length == 0) {
+		DEBUG(1, ("No auth field sent for auth3 request!\n"));
 		goto err;
 	}
 
@@ -1193,9 +1348,9 @@
 	 * Decode the authentication verifier response.
 	 */
 
-	status = dcerpc_pull_dcerpc_auth(pkt,
-					 &pkt->u.auth3.auth_info,
-					 &auth_info, p->endian);
+	status = dcerpc_pull_auth_trailer(pkt, pkt,
+					  &pkt->u.auth3.auth_info,
+					  &auth_info, NULL, true);
 	if (!NT_STATUS_IS_OK(status)) {
 		DEBUG(0, ("Failed to unmarshall dcerpc_auth.\n"));
 		goto err;
@@ -1213,6 +1368,21 @@
 		goto err;
 	}
 
+	if (auth_info.auth_level != p->auth.auth_level) {
+		DEBUG(1, ("Auth level mismatch! Client sent %d, "
+			  "but auth was started as level %d!\n",
+			  auth_info.auth_level, p->auth.auth_level));
+		goto err;
+	}
+
+	if (auth_info.auth_context_id != p->auth.auth_context_id) {
+		DEBUG(0, ("Auth context id mismatch! Client sent %u, "
+			  "but auth was started as level %u!\n",
+			  (unsigned)auth_info.auth_context_id,
+			  (unsigned)p->auth.auth_context_id));
+		goto err;
+	}
+
 	switch (auth_info.auth_type) {
 	case DCERPC_AUTH_TYPE_NTLMSSP:
 		ntlmssp_ctx = talloc_get_type_abort(p->auth.auth_ctx,
@@ -1265,6 +1435,10 @@
 	return true;
 
 err:
+	p->pipe_bound = false;
+	p->allow_bind = false;
+	p->allow_alter = false;
+	p->allow_auth3 = false;
 
 	TALLOC_FREE(p->auth.auth_ctx);
 	return false;
@@ -1282,7 +1456,7 @@
 	uint16 assoc_gid;
 	NTSTATUS status;
 	union dcerpc_payload u;
-	struct dcerpc_ack_ctx bind_ack_ctx;
+	struct dcerpc_ack_ctx alter_ack_ctx;
 	DATA_BLOB auth_resp = data_blob_null;
 	DATA_BLOB auth_blob = data_blob_null;
 	int pad_len = 0;
@@ -1292,8 +1466,41 @@
 
 	DEBUG(5,("api_pipe_alter_context: make response. %d\n", __LINE__));
 
-	if (pkt->u.bind.assoc_group_id != 0) {
-		assoc_gid = pkt->u.bind.assoc_group_id;
+	if (!p->allow_alter) {
+		DEBUG(1, ("Pipe not in allow alter state.\n"));
+		goto err_exit;
+	}
+
+	status = dcerpc_verify_ncacn_packet_header(pkt,
+			DCERPC_PKT_ALTER,
+			pkt->u.alter.auth_info.length,
+			0, /* required flags */
+			DCERPC_PFC_FLAG_FIRST |
+			DCERPC_PFC_FLAG_LAST |
+			DCERPC_PFC_FLAG_SUPPORT_HEADER_SIGN |
+			0x08 | /* this is not defined, but should be ignored */
+			DCERPC_PFC_FLAG_CONC_MPX |
+			DCERPC_PFC_FLAG_DID_NOT_EXECUTE |
+			DCERPC_PFC_FLAG_MAYBE |
+			DCERPC_PFC_FLAG_OBJECT_UUID);
+	if (!NT_STATUS_IS_OK(status)) {
+		DEBUG(1, ("api_pipe_alter_context: invalid pdu: %s\n",
+			  nt_errstr(status)));
+		goto err_exit;
+	}
+
+	if (pkt->u.alter.num_contexts == 0) {
+		DEBUG(1, ("api_pipe_alter_context: no rpc contexts around\n"));
+		goto err_exit;
+	}
+
+	if (pkt->u.alter.ctx_list[0].num_transfer_syntaxes == 0) {
+		DEBUG(1, ("api_pipe_alter_context: no transfer syntaxes around\n"));
+		goto err_exit;
+	}
+
+	if (pkt->u.alter.assoc_group_id != 0) {
+		assoc_gid = pkt->u.alter.assoc_group_id;
 	} else {
 		assoc_gid = 0x53f0;
 	}
@@ -1303,59 +1510,45 @@
 	 */
 
 	/* If the requested abstract synt uuid doesn't match our client pipe,
-		reject the bind_ack & set the transfer interface synt to all 0's,
+		reject the alter_ack & set the transfer interface synt to all 0's,
 		ver 0 (observed when NT5 attempts to bind to abstract interfaces
 		unknown to NT4)
 		Needed when adding entries to a DACL from NT5 - SK */
 
 	if (check_bind_req(p,
-			&pkt->u.bind.ctx_list[0].abstract_syntax,
-			&pkt->u.bind.ctx_list[0].transfer_syntaxes[0],
-			pkt->u.bind.ctx_list[0].context_id)) {
+			&pkt->u.alter.ctx_list[0].abstract_syntax,
+			&pkt->u.alter.ctx_list[0].transfer_syntaxes[0],
+			pkt->u.alter.ctx_list[0].context_id)) {
 
-		bind_ack_ctx.result = 0;
-		bind_ack_ctx.reason = 0;
-		bind_ack_ctx.syntax = pkt->u.bind.ctx_list[0].transfer_syntaxes[0];
+		alter_ack_ctx.result = 0;
+		alter_ack_ctx.reason = 0;
+		alter_ack_ctx.syntax = pkt->u.alter.ctx_list[0].transfer_syntaxes[0];
 	} else {
-		p->pipe_bound = False;
 		/* Rejection reason: abstract syntax not supported */
-		bind_ack_ctx.result = DCERPC_BIND_PROVIDER_REJECT;
-		bind_ack_ctx.reason = DCERPC_BIND_REASON_ASYNTAX;
-		bind_ack_ctx.syntax = null_ndr_syntax_id;
+		alter_ack_ctx.result = DCERPC_BIND_PROVIDER_REJECT;
+		alter_ack_ctx.reason = DCERPC_BIND_REASON_ASYNTAX;
+		alter_ack_ctx.syntax = null_ndr_syntax_id;
 	}
 
 	/*
 	 * Check if this is an authenticated alter context request.
 	 */
 	if (pkt->auth_length) {
-		/* Quick length check. Won't catch a bad auth footer,
-		 * prevents overrun. */
-
-		if (pkt->frag_length < RPC_HEADER_LEN +
-					DCERPC_AUTH_TRAILER_LENGTH +
-					pkt->auth_length) {
-			DEBUG(0,("api_pipe_alter_context: auth_len (%u) "
-				"too long for fragment %u.\n",
-				(unsigned int)pkt->auth_length,
-				(unsigned int)pkt->frag_length ));
+		/* We can only finish if the pipe is unbound for now */
+		if (p->pipe_bound) {
+			DEBUG(0, (__location__ ": Pipe already bound, "
+				  "Altering Context not yet supported!\n"));
 			goto err_exit;
 		}
 
-		status = dcerpc_pull_dcerpc_auth(pkt,
-						 &pkt->u.bind.auth_info,
-						 &auth_info, p->endian);
+		status = dcerpc_pull_auth_trailer(pkt, pkt,
+						  &pkt->u.alter.auth_info,
+						  &auth_info, NULL, true);
 		if (!NT_STATUS_IS_OK(status)) {
 			DEBUG(0, ("Unable to unmarshall dcerpc_auth.\n"));
 			goto err_exit;
 		}
 
-		/* We can only finish if the pipe is unbound for now */
-		if (p->pipe_bound) {
-			DEBUG(0, (__location__ ": Pipe already bound, "
-				  "Altering Context not yet supported!\n"));
-			goto err_exit;
-		}
-
 		if (auth_info.auth_type != p->auth.auth_type) {
 			DEBUG(0, ("Auth type mismatch! Client sent %d, "
 				  "but auth was started as type %d!\n",
@@ -1363,6 +1556,20 @@
 			goto err_exit;
 		}
 
+		if (auth_info.auth_level != p->auth.auth_level) {
+			DEBUG(0, ("Auth level mismatch! Client sent %d, "
+				  "but auth was started as level %d!\n",
+				  auth_info.auth_level, p->auth.auth_level));
+			goto err_exit;
+		}
+
+		if (auth_info.auth_context_id != p->auth.auth_context_id) {
+			DEBUG(0, ("Auth context id mismatch! Client sent %u, "
+				  "but auth was started as level %u!\n",
+				  (unsigned)auth_info.auth_context_id,
+				  (unsigned)p->auth.auth_context_id));
+			goto err_exit;
+		}
 
 		switch (auth_info.auth_type) {
 		case DCERPC_AUTH_TYPE_SPNEGO:
@@ -1429,7 +1636,7 @@
 	u.alter_resp.secondary_address_size = 1;
 
 	u.alter_resp.num_results = 1;
-	u.alter_resp.ctx_list = &bind_ack_ctx;
+	u.alter_resp.ctx_list = &alter_ack_ctx;
 
 	/* NOTE: We leave the auth_info empty so we can calculate the padding
 	 * later and then append the auth_info --simo */
@@ -1449,8 +1656,9 @@
 					  &u,
 					  &p->out_data.frag);
 	if (!NT_STATUS_IS_OK(status)) {
-		DEBUG(0, ("Failed to marshall bind_ack packet. (%s)\n",
+		DEBUG(0, ("Failed to marshall alter_resp packet. (%s)\n",
 			  nt_errstr(status)));
+		goto err_exit;
 	}
 
 	if (auth_resp.length) {
@@ -1467,7 +1675,7 @@
 						 auth_info.auth_type,
 						 auth_info.auth_level,
 						 pad_len,
-						 1, /* auth_context_id */
+						 p->auth.auth_context_id,
 						 &auth_resp,
 						 &auth_blob);
 		if (!NT_STATUS_IS_OK(status)) {
@@ -1541,7 +1749,42 @@
 }
 
 static bool api_rpcTNP(struct pipes_struct *p, struct ncacn_packet *pkt,
-		       const struct api_struct *api_rpc_cmds, int n_cmds);
+		       const struct api_struct *api_rpc_cmds, int n_cmds,
+		       const struct ndr_syntax_id *syntax);
+
+static bool srv_pipe_check_verification_trailer(struct pipes_struct *p,
+						struct ncacn_packet *pkt,
+						struct pipe_rpc_fns *pipe_fns)
+{
+	TALLOC_CTX *frame = talloc_stackframe();
+	struct dcerpc_sec_verification_trailer *vt = NULL;
+	const uint32_t bitmask1 = 0;
+	const struct dcerpc_sec_vt_pcontext pcontext = {
+		.abstract_syntax = pipe_fns->syntax,
+		.transfer_syntax = ndr_transfer_syntax,
+	};
+	const struct dcerpc_sec_vt_header2 header2 =
+	       dcerpc_sec_vt_header2_from_ncacn_packet(pkt);
+	struct ndr_pull *ndr;
+	enum ndr_err_code ndr_err;
+	bool ret = false;
+
+	ndr = ndr_pull_init_blob(&p->in_data.data, frame);
+	if (ndr == NULL) {
+		goto done;
+	}
+
+	ndr_err = ndr_pop_dcerpc_sec_verification_trailer(ndr, frame, &vt);
+	if (!NDR_ERR_CODE_IS_SUCCESS(ndr_err)) {
+		goto done;
+	}
+
+	ret = dcerpc_sec_verification_trailer_check(vt, &bitmask1,
+						    &pcontext, &header2);
+done:
+	TALLOC_FREE(frame);
+	return ret;
+}
 
 /****************************************************************************
  Find the correct RPC function to call for this request.
@@ -1552,46 +1795,83 @@
 static bool api_pipe_request(struct pipes_struct *p,
 				struct ncacn_packet *pkt)
 {
+	TALLOC_CTX *frame = talloc_stackframe();
 	bool ret = False;
-	bool changed_user = False;
 	PIPE_RPC_FNS *pipe_fns;
+	const char *interface_name = NULL;
 
-	if (p->pipe_bound &&
-	    ((p->auth.auth_type == DCERPC_AUTH_TYPE_NTLMSSP) ||
-	     (p->auth.auth_type == DCERPC_AUTH_TYPE_KRB5) ||
-	     (p->auth.auth_type == DCERPC_AUTH_TYPE_SPNEGO))) {
-		if(!become_authenticated_pipe_user(p->session_info)) {
-			data_blob_free(&p->out_data.rdata);
-			return False;
-		}
-		changed_user = True;
+	if (!p->pipe_bound) {
+		DEBUG(1, ("Pipe not bound!\n"));
+		data_blob_free(&p->out_data.rdata);
+		TALLOC_FREE(frame);
+		return false;
 	}
 
-	DEBUG(5, ("Requested \\PIPE\\%s\n",
-		  get_pipe_name_from_syntax(talloc_tos(), &p->syntax)));
-
 	/* get the set of RPC functions for this context */
 
 	pipe_fns = find_pipe_fns_by_context(p->contexts,
 					    pkt->u.request.context_id);
-
-	if ( pipe_fns ) {
-		TALLOC_CTX *frame = talloc_stackframe();
-		ret = api_rpcTNP(p, pkt, pipe_fns->cmds, pipe_fns->n_cmds);
+	if (pipe_fns == NULL) {
+		DEBUG(0, ("No rpc function table associated with context "
+			  "[%d]\n",
+			  pkt->u.request.context_id));
+		data_blob_free(&p->out_data.rdata);
 		TALLOC_FREE(frame);
+		return false;
 	}
-	else {
-		DEBUG(0, ("No rpc function table associated with context "
-			  "[%d] on pipe [%s]\n",
-			  pkt->u.request.context_id,
-			  get_pipe_name_from_syntax(talloc_tos(),
-						    &p->syntax)));
+
+	interface_name = get_pipe_name_from_syntax(talloc_tos(),
+						   &pipe_fns->syntax);
+
+	SMB_ASSERT(interface_name != NULL);
+
+	DEBUG(5, ("Requested \\PIPE\\%s\n",
+		  interface_name));
+
+	switch (p->auth.auth_level) {
+	case DCERPC_AUTH_LEVEL_NONE:
+	case DCERPC_AUTH_LEVEL_INTEGRITY:
+	case DCERPC_AUTH_LEVEL_PRIVACY:
+		break;
+	default:
+		if (!pipe_fns->allow_connect) {
+			DEBUG(1, ("%s: restrict auth_level_connect access "
+				  "to [%s] with auth[type=0x%x,level=0x%x] "
+				  "on [%s] from [%s]\n",
+				  __func__, interface_name,
+				  p->auth.auth_type,
+				  p->auth.auth_level,
+				  derpc_transport_string_by_transport(p->transport),
+				  p->client_id->name));
+
+			setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_ACCESS_DENIED));
+			TALLOC_FREE(frame);
+			return true;
+		}
+		break;
 	}
 
-	if (changed_user) {
-		unbecome_authenticated_pipe_user();
+	if (!srv_pipe_check_verification_trailer(p, pkt, pipe_fns)) {
+		DEBUG(1, ("srv_pipe_check_verification_trailer: failed\n"));
+		set_incoming_fault(p);
+		setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_ACCESS_DENIED));
+		data_blob_free(&p->out_data.rdata);
+		TALLOC_FREE(frame);
+		return true;
+	}
+
+	if (!become_authenticated_pipe_user(p->session_info)) {
+		DEBUG(1, ("Failed to become pipe user!\n"));
+		data_blob_free(&p->out_data.rdata);
+		TALLOC_FREE(frame);
+		return false;
 	}
 
+	ret = api_rpcTNP(p, pkt, pipe_fns->cmds, pipe_fns->n_cmds,
+			 &pipe_fns->syntax);
+	unbecome_authenticated_pipe_user();
+
+	TALLOC_FREE(frame);
 	return ret;
 }
 
@@ -1600,20 +1880,21 @@
  ********************************************************************/
 
 static bool api_rpcTNP(struct pipes_struct *p, struct ncacn_packet *pkt,
-		       const struct api_struct *api_rpc_cmds, int n_cmds)
+		       const struct api_struct *api_rpc_cmds, int n_cmds,
+		       const struct ndr_syntax_id *syntax)
 {
 	int fn_num;
 	uint32_t offset1;
 
 	/* interpret the command */
 	DEBUG(4,("api_rpcTNP: %s op 0x%x - ",
-		 get_pipe_name_from_syntax(talloc_tos(), &p->syntax),
+		 get_pipe_name_from_syntax(talloc_tos(), syntax),
 		 pkt->u.request.opnum));
 
 	if (DEBUGLEVEL >= 50) {
 		fstring name;
 		slprintf(name, sizeof(name)-1, "in_%s",
-			 get_pipe_name_from_syntax(talloc_tos(), &p->syntax));
+			 get_pipe_name_from_syntax(talloc_tos(), syntax));
 		dump_pdu_region(name, pkt->u.request.opnum,
 				&p->in_data.data, 0,
 				p->in_data.data.length);
@@ -1646,37 +1927,30 @@
 	/* do the actual command */
 	if(!api_rpc_cmds[fn_num].fn(p)) {
 		DEBUG(0,("api_rpcTNP: %s: %s failed.\n",
-			 get_pipe_name_from_syntax(talloc_tos(), &p->syntax),
+			 get_pipe_name_from_syntax(talloc_tos(), syntax),
 			 api_rpc_cmds[fn_num].name));
 		data_blob_free(&p->out_data.rdata);
 		return False;
 	}
 
-	if (p->bad_handle_fault_state) {
-		DEBUG(4,("api_rpcTNP: bad handle fault return.\n"));
-		p->bad_handle_fault_state = False;
-		setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_CONTEXT_MISMATCH));
-		return True;
-	}
-
-	if (p->rng_fault_state) {
-		DEBUG(4, ("api_rpcTNP: rng fault return\n"));
-		p->rng_fault_state = False;
-		setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_OP_RNG_ERROR));
-		return True;
+	if (p->fault_state) {
+		DEBUG(4,("api_rpcTNP: fault(%d) return.\n", p->fault_state));
+		setup_fault_pdu(p, NT_STATUS(p->fault_state));
+		p->fault_state = 0;
+		return true;
 	}
 
 	if (DEBUGLEVEL >= 50) {
 		fstring name;
 		slprintf(name, sizeof(name)-1, "out_%s",
-			 get_pipe_name_from_syntax(talloc_tos(), &p->syntax));
+			 get_pipe_name_from_syntax(talloc_tos(), syntax));
 		dump_pdu_region(name, pkt->u.request.opnum,
 				&p->out_data.rdata, offset1,
 				p->out_data.rdata.length);
 	}
 
 	DEBUG(5,("api_rpcTNP: called %s successfully\n",
-		 get_pipe_name_from_syntax(talloc_tos(), &p->syntax)));
+		 get_pipe_name_from_syntax(talloc_tos(), syntax)));
 
 	/* Check for buffer underflow in rpc parsing */
 	if ((DEBUGLEVEL >= 10) &&
@@ -1718,9 +1992,13 @@
 	data_blob_free(&p->in_data.data);
 	p->in_data.pdu_needed_len = 0;
 	p->in_data.pdu.length = 0;
-	p->fault_state = True;
-	DEBUG(10, ("set_incoming_fault: Setting fault state on pipe %s\n",
-		   get_pipe_name_from_syntax(talloc_tos(), &p->syntax)));
+	p->fault_state = DCERPC_NCA_S_PROTO_ERROR;
+
+	p->allow_alter = false;
+	p->allow_auth3 = false;
+	p->pipe_bound = false;
+
+	DEBUG(10, ("Setting fault state\n"));
 }
 
 static NTSTATUS dcesrv_auth_request(struct pipe_auth_data *auth,
@@ -1729,7 +2007,6 @@
 {
 	NTSTATUS status;
 	size_t hdr_size = DCERPC_REQUEST_LENGTH;
-	size_t pad_len;
 
 	DEBUG(10, ("Checking request auth.\n"));
 
@@ -1740,25 +2017,11 @@
 	/* in case of sealing this function will unseal the data in place */
 	status = dcerpc_check_auth(auth, pkt,
 				   &pkt->u.request.stub_and_verifier,
-				   hdr_size, raw_pkt,
-				   &pad_len);
+				   hdr_size, raw_pkt);
 	if (!NT_STATUS_IS_OK(status)) {
 		return status;
 	}
 
-
-	/* remove padding and auth trailer,
-	 * this way the caller will get just the data */
-	if (pkt->auth_length) {
-		size_t trail_len = pad_len
-					+ DCERPC_AUTH_TRAILER_LENGTH
-					+ pkt->auth_length;
-		if (pkt->u.request.stub_and_verifier.length < trail_len) {
-			return NT_STATUS_INFO_LENGTH_MISMATCH;
-		}
-		pkt->u.request.stub_and_verifier.length -= trail_len;
-	}
-
 	return NT_STATUS_OK;
 }
 
@@ -1778,6 +2041,28 @@
 		return False;
 	}
 
+	/*
+	 * We don't ignore DCERPC_PFC_FLAG_PENDING_CANCEL.
+	 * TODO: we can reject it with DCERPC_FAULT_NO_CALL_ACTIVE later.
+	 */
+	status = dcerpc_verify_ncacn_packet_header(pkt,
+			DCERPC_PKT_REQUEST,
+			pkt->u.request.stub_and_verifier.length,
+			0, /* required_flags */
+			DCERPC_PFC_FLAG_FIRST |
+			DCERPC_PFC_FLAG_LAST |
+			0x08 | /* this is not defined, but should be ignored */
+			DCERPC_PFC_FLAG_CONC_MPX |
+			DCERPC_PFC_FLAG_DID_NOT_EXECUTE |
+			DCERPC_PFC_FLAG_MAYBE |
+			DCERPC_PFC_FLAG_OBJECT_UUID);
+	if (!NT_STATUS_IS_OK(status)) {
+		DEBUG(1, ("process_request_pdu: invalid pdu: %s\n",
+			  nt_errstr(status)));
+		set_incoming_fault(p);
+		return false;
+	}
+
 	/* Store the opnum */
 	p->opnum = pkt->u.request.opnum;
 
@@ -2027,7 +2312,7 @@
 			 "pipe %s\n", get_pipe_name_from_syntax(talloc_tos(),
 								&p->syntax)));
 		set_incoming_fault(p);
-		setup_fault_pdu(p, NT_STATUS(DCERPC_FAULT_OP_RNG_ERROR));
+		setup_fault_pdu(p, NT_STATUS(DCERPC_NCA_S_PROTO_ERROR));
 		TALLOC_FREE(pkt);
 	} else {
 		/*
diff -daurN samba3/source3/rpc_server/srvsvc/srv_srvsvc_nt.c samba3/source3/rpc_server/srvsvc/srv_srvsvc_nt.c
--- samba3/source3/rpc_server/srvsvc/srv_srvsvc_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/srvsvc/srv_srvsvc_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -1533,6 +1533,10 @@
 	TALLOC_CTX *ctx = p->mem_ctx;
 	union srvsvc_NetShareInfo *info = r->in.info;
 
+#ifndef FULL_SRVSVC
+	return WERR_ACCESS_DENIED;
+#endif
+
 	DEBUG(5,("_srvsvc_NetShareSetInfo: %d\n", __LINE__));
 
 	if (!r->in.share_name) {
@@ -1763,6 +1767,10 @@
 	int max_connections = 0;
 	TALLOC_CTX *ctx = p->mem_ctx;
 
+#ifndef FULL_SRVSVC
+	return WERR_ACCESS_DENIED;
+#endif
+
 	DEBUG(5,("_srvsvc_NetShareAdd: %d\n", __LINE__));
 
 	if (r->out.parm_error) {
@@ -1945,6 +1953,10 @@
 	struct share_params *params;
 	TALLOC_CTX *ctx = p->mem_ctx;
 
+#ifndef FULL_SRVSVC
+	return WERR_ACCESS_DENIED;
+#endif
+
 	DEBUG(5,("_srvsvc_NetShareDel: %d\n", __LINE__));
 
 	if (!r->in.share_name) {
@@ -2548,244 +2560,244 @@
 WERROR _srvsvc_NetCharDevEnum(struct pipes_struct *p,
 			      struct srvsvc_NetCharDevEnum *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevGetInfo(struct pipes_struct *p,
 				 struct srvsvc_NetCharDevGetInfo *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevControl(struct pipes_struct *p,
 				 struct srvsvc_NetCharDevControl *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevQEnum(struct pipes_struct *p,
 			       struct srvsvc_NetCharDevQEnum *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevQGetInfo(struct pipes_struct *p,
 				  struct srvsvc_NetCharDevQGetInfo *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevQSetInfo(struct pipes_struct *p,
 				  struct srvsvc_NetCharDevQSetInfo *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevQPurge(struct pipes_struct *p,
 				struct srvsvc_NetCharDevQPurge *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetCharDevQPurgeSelf(struct pipes_struct *p,
 				    struct srvsvc_NetCharDevQPurgeSelf *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetFileGetInfo(struct pipes_struct *p,
 			      struct srvsvc_NetFileGetInfo *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetShareCheck(struct pipes_struct *p,
 			     struct srvsvc_NetShareCheck *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetServerStatisticsGet(struct pipes_struct *p,
 				      struct srvsvc_NetServerStatisticsGet *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetTransportAdd(struct pipes_struct *p,
 			       struct srvsvc_NetTransportAdd *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetTransportEnum(struct pipes_struct *p,
 				struct srvsvc_NetTransportEnum *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetTransportDel(struct pipes_struct *p,
 			       struct srvsvc_NetTransportDel *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetSetServiceBits(struct pipes_struct *p,
 				 struct srvsvc_NetSetServiceBits *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetPathType(struct pipes_struct *p,
 			   struct srvsvc_NetPathType *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetPathCanonicalize(struct pipes_struct *p,
 				   struct srvsvc_NetPathCanonicalize *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetPathCompare(struct pipes_struct *p,
 			      struct srvsvc_NetPathCompare *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRPRNAMECANONICALIZE(struct pipes_struct *p,
 				      struct srvsvc_NETRPRNAMECANONICALIZE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetPRNameCompare(struct pipes_struct *p,
 				struct srvsvc_NetPRNameCompare *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetShareDelStart(struct pipes_struct *p,
 				struct srvsvc_NetShareDelStart *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetShareDelCommit(struct pipes_struct *p,
 				 struct srvsvc_NetShareDelCommit *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetServerTransportAddEx(struct pipes_struct *p,
 				       struct srvsvc_NetServerTransportAddEx *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NetServerSetServiceBitsEx(struct pipes_struct *p,
 					 struct srvsvc_NetServerSetServiceBitsEx *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSGETVERSION(struct pipes_struct *p,
 				 struct srvsvc_NETRDFSGETVERSION *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSCREATELOCALPARTITION(struct pipes_struct *p,
 					   struct srvsvc_NETRDFSCREATELOCALPARTITION *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSDELETELOCALPARTITION(struct pipes_struct *p,
 					   struct srvsvc_NETRDFSDELETELOCALPARTITION *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSSETLOCALVOLUMESTATE(struct pipes_struct *p,
 					  struct srvsvc_NETRDFSSETLOCALVOLUMESTATE *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSSETSERVERINFO(struct pipes_struct *p,
 				    struct srvsvc_NETRDFSSETSERVERINFO *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSCREATEEXITPOINT(struct pipes_struct *p,
 				      struct srvsvc_NETRDFSCREATEEXITPOINT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSDELETEEXITPOINT(struct pipes_struct *p,
 				      struct srvsvc_NETRDFSDELETEEXITPOINT *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSMODIFYPREFIX(struct pipes_struct *p,
 				   struct srvsvc_NETRDFSMODIFYPREFIX *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSFIXLOCALVOLUME(struct pipes_struct *p,
 				     struct srvsvc_NETRDFSFIXLOCALVOLUME *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRDFSMANAGERREPORTSITEINFO(struct pipes_struct *p,
 					    struct srvsvc_NETRDFSMANAGERREPORTSITEINFO *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _srvsvc_NETRSERVERTRANSPORTDELEX(struct pipes_struct *p,
 					struct srvsvc_NETRSERVERTRANSPORTDELEX *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/svcctl/srv_svcctl_nt.c samba3/source3/rpc_server/svcctl/srv_svcctl_nt.c
--- samba3/source3/rpc_server/svcctl/srv_svcctl_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/svcctl/srv_svcctl_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -85,17 +85,23 @@
 
 	/* add builtin services */
 
+#ifdef PRINTER_SUPPORT
 	svcctl_ops[i].name = talloc_strdup( svcctl_ops, "Spooler" );
 	svcctl_ops[i].ops  = &spoolss_svc_ops;
 	i++;
+#endif
 
+#ifdef NETLOGON_SUPPORT
 	svcctl_ops[i].name = talloc_strdup( svcctl_ops, "NETLOGON" );
 	svcctl_ops[i].ops  = &netlogon_svc_ops;
 	i++;
+#endif
 
+#ifdef WINREG_SUPPORT
 	svcctl_ops[i].name = talloc_strdup( svcctl_ops, "RemoteRegistry" );
 	svcctl_ops[i].ops  = &winreg_svc_ops;
 	i++;
+#endif
 
 	svcctl_ops[i].name = talloc_strdup( svcctl_ops, "WINS" );
 	svcctl_ops[i].ops  = &wins_svc_ops;
@@ -1004,195 +1010,195 @@
 WERROR _svcctl_DeleteService(struct pipes_struct *p,
 			     struct svcctl_DeleteService *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_SetServiceStatus(struct pipes_struct *p,
 				struct svcctl_SetServiceStatus *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_NotifyBootConfigStatus(struct pipes_struct *p,
 				      struct svcctl_NotifyBootConfigStatus *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_SCSetServiceBitsW(struct pipes_struct *p,
 				 struct svcctl_SCSetServiceBitsW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_ChangeServiceConfigW(struct pipes_struct *p,
 				    struct svcctl_ChangeServiceConfigW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_CreateServiceW(struct pipes_struct *p,
 			      struct svcctl_CreateServiceW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_QueryServiceLockStatusW(struct pipes_struct *p,
 				       struct svcctl_QueryServiceLockStatusW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_GetServiceKeyNameW(struct pipes_struct *p,
 				  struct svcctl_GetServiceKeyNameW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_SCSetServiceBitsA(struct pipes_struct *p,
 				 struct svcctl_SCSetServiceBitsA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_ChangeServiceConfigA(struct pipes_struct *p,
 				    struct svcctl_ChangeServiceConfigA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_CreateServiceA(struct pipes_struct *p,
 			      struct svcctl_CreateServiceA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_EnumDependentServicesA(struct pipes_struct *p,
 				      struct svcctl_EnumDependentServicesA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_EnumServicesStatusA(struct pipes_struct *p,
 				   struct svcctl_EnumServicesStatusA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_OpenSCManagerA(struct pipes_struct *p,
 			      struct svcctl_OpenSCManagerA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_OpenServiceA(struct pipes_struct *p,
 			    struct svcctl_OpenServiceA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_QueryServiceConfigA(struct pipes_struct *p,
 				   struct svcctl_QueryServiceConfigA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_QueryServiceLockStatusA(struct pipes_struct *p,
 				       struct svcctl_QueryServiceLockStatusA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_StartServiceA(struct pipes_struct *p,
 			     struct svcctl_StartServiceA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_GetServiceDisplayNameA(struct pipes_struct *p,
 				      struct svcctl_GetServiceDisplayNameA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_GetServiceKeyNameA(struct pipes_struct *p,
 				  struct svcctl_GetServiceKeyNameA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_GetCurrentGroupeStateW(struct pipes_struct *p,
 				      struct svcctl_GetCurrentGroupeStateW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_EnumServiceGroupW(struct pipes_struct *p,
 				 struct svcctl_EnumServiceGroupW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_ChangeServiceConfig2A(struct pipes_struct *p,
 				     struct svcctl_ChangeServiceConfig2A *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_ChangeServiceConfig2W(struct pipes_struct *p,
 				     struct svcctl_ChangeServiceConfig2W *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_QueryServiceConfig2A(struct pipes_struct *p,
 				    struct svcctl_QueryServiceConfig2A *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _EnumServicesStatusExA(struct pipes_struct *p,
 			      struct EnumServicesStatusExA *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _EnumServicesStatusExW(struct pipes_struct *p,
 			      struct EnumServicesStatusExW *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
 WERROR _svcctl_SCSendTSMessage(struct pipes_struct *p,
 			       struct svcctl_SCSendTSMessage *r)
 {
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/winreg/srv_winreg_nt.c samba3/source3/rpc_server/winreg/srv_winreg_nt.c
--- samba3/source3/rpc_server/winreg/srv_winreg_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/winreg/srv_winreg_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -760,7 +760,7 @@
 	/* fill in your code here if you think this call should
 	   do anything */
 
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -948,7 +948,7 @@
 	/* fill in your code here if you think this call should
 	   do anything */
 
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -962,7 +962,7 @@
 	/* fill in your code here if you think this call should
 	   do anything */
 
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -976,7 +976,7 @@
 	/* fill in your code here if you think this call should
 	   do anything */
 
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1139,6 +1139,6 @@
 	/* fill in your code here if you think this call should
 	   do anything */
 
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/rpc_server/wkssvc/srv_wkssvc_nt.c samba3/source3/rpc_server/wkssvc/srv_wkssvc_nt.c
--- samba3/source3/rpc_server/wkssvc/srv_wkssvc_nt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/rpc_server/wkssvc/srv_wkssvc_nt.c	2024-08-04 17:52:53.000000000 +0200
@@ -405,7 +405,7 @@
 			       struct wkssvc_NetWkstaSetInfo *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -608,7 +608,7 @@
 				    struct wkssvc_NetrWkstaUserGetInfo *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -619,7 +619,7 @@
 				    struct wkssvc_NetrWkstaUserSetInfo *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -630,7 +630,7 @@
 				     struct wkssvc_NetWkstaTransportEnum *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -641,7 +641,7 @@
 				     struct wkssvc_NetrWkstaTransportAdd *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -652,7 +652,7 @@
 				     struct wkssvc_NetrWkstaTransportDel *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -663,7 +663,7 @@
 			  struct wkssvc_NetrUseAdd *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -674,7 +674,7 @@
 			      struct wkssvc_NetrUseGetInfo *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -685,7 +685,7 @@
 			  struct wkssvc_NetrUseDel *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -696,7 +696,7 @@
 			   struct wkssvc_NetrUseEnum *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -707,7 +707,7 @@
 				     struct wkssvc_NetrMessageBufferSend *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -718,7 +718,7 @@
 					    struct wkssvc_NetrWorkstationStatisticsGet *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -729,7 +729,7 @@
 				      struct wkssvc_NetrLogonDomainNameAdd *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -740,7 +740,7 @@
 				      struct wkssvc_NetrLogonDomainNameDel *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -751,7 +751,7 @@
 			      struct wkssvc_NetrJoinDomain *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -762,7 +762,7 @@
 				struct wkssvc_NetrUnjoinDomain *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -773,7 +773,7 @@
 					 struct wkssvc_NetrRenameMachineInDomain *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -784,7 +784,7 @@
 				struct wkssvc_NetrValidateName *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -795,7 +795,7 @@
 				      struct wkssvc_NetrGetJoinInformation *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -806,7 +806,7 @@
 				  struct wkssvc_NetrGetJoinableOus *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -824,6 +824,10 @@
 	WERROR werr;
 	struct security_token *token = p->session_info->security_token;
 
+#ifndef NETLOGON_SUPPORT
+	return WERR_NOT_SUPPORTED;
+#endif
+
 	if (!r->in.domain_name) {
 		return WERR_INVALID_PARAM;
 	}
@@ -901,6 +905,10 @@
 	WERROR werr;
 	struct security_token *token = p->session_info->security_token;
 
+#ifndef NETLOGON_SUPPORT
+	return WERR_NOT_SUPPORTED;
+#endif
+
 	if (!r->in.account || !r->in.encrypted_password) {
 		return WERR_INVALID_PARAM;
 	}
@@ -962,6 +970,7 @@
 					  struct wkssvc_NetrRenameMachineInDomain2 *r)
 {
 	/* for now just return not supported */
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -972,7 +981,7 @@
 				 struct wkssvc_NetrValidateName2 *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -983,7 +992,7 @@
 				   struct wkssvc_NetrGetJoinableOus2 *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -994,7 +1003,7 @@
 					    struct wkssvc_NetrAddAlternateComputerName *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1005,7 +1014,7 @@
 					       struct wkssvc_NetrRemoveAlternateComputerName *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1016,7 +1025,7 @@
 					  struct wkssvc_NetrSetPrimaryComputername *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
 
@@ -1027,6 +1036,6 @@
 					  struct wkssvc_NetrEnumerateComputerNames *r)
 {
 	/* FIXME: Add implementation code here */
-	p->rng_fault_state = True;
+	p->fault_state = DCERPC_FAULT_OP_RNG_ERROR;
 	return WERR_NOT_SUPPORTED;
 }
diff -daurN samba3/source3/script/tests/test_rpcclient.sh samba3/source3/script/tests/test_rpcclient.sh
--- samba3/source3/script/tests/test_rpcclient.sh	1970-01-01 01:00:00.000000000 +0100
+++ samba3/source3/script/tests/test_rpcclient.sh	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,19 @@
+#!/bin/sh
+
+if [ $# -lt 1 ]; then
+cat <<EOF
+Usage: test_rpcclient.sh ccache binding <rpcclient commands>
+EOF
+exit 1;
+fi
+
+KRB5CCNAME=$1
+shift 1
+export KRB5CCNAME
+ADDARGS="$*"
+
+incdir=`dirname $0`/../../../testprogs/blackbox
+. $incdir/subunit.sh
+testit "rpcclient" $VALGRIND $BINDIR/rpcclient -c 'getusername' $ADDARGS || failed=`expr $failed + 1`
+
+testok $0 $failed
diff -daurN samba3/source3/selftest/knownfail samba3/source3/selftest/knownfail
--- samba3/source3/selftest/knownfail	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/selftest/knownfail	2024-08-04 17:52:53.000000000 +0200
@@ -18,3 +18,5 @@
 samba3.*rap.sam.*.useradd # Not provided by Samba 3
 samba3.*rap.sam.*.userdelete # Not provided by Samba 3
 samba3.*rap.basic.*.netsessiongetinfo # Not provided by Samba 3
+samba3.blackbox.rpcclient.over.ncacn_np.with.*connect.* # we don't allow auth_level_connect anymore
+samba3.posix_s3.rpc.lsa.lookupsids.*ncacn_ip_tcp.*connect.* # we don't allow auth_level_connect anymore
diff -daurN samba3/source3/selftest/skip samba3/source3/selftest/skip
--- samba3/source3/selftest/skip	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/selftest/skip	2024-08-04 17:52:53.000000000 +0200
@@ -22,3 +22,8 @@
 samba3.*raw.qfileinfo
 samba3.*raw.qfsinfo
 samba3.*raw.sfileinfo.base
+# skip, don't work for badlock backports
+samba3.posix_s3.raw.eas
+samba3.posix_s3.raw.rename
+samba3.posix_s3.raw.search
+samba3.posix_s3.raw.streams
diff -daurN samba3/source3/selftest/tests.py samba3/source3/selftest/tests.py
--- samba3/source3/selftest/tests.py	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/selftest/tests.py	2024-08-04 17:52:53.000000000 +0200
@@ -201,6 +201,8 @@
             plansmbtorturetestsuite(t, "s3dc", '//$SERVER_IP/tmpguest -U$USERNAME%$PASSWORD')
         elif t == "raw.samba3posixtimedlock":
             plansmbtorturetestsuite(t, "s3dc", '//$SERVER_IP/tmpguest -U$USERNAME%$PASSWORD --option=torture:localdir=$SELFTEST_PREFIX/dc/share')
+        elif t == "rpc.samr.passwords.validate":
+            plansmbtorturetestsuite(t, "s3dc", 'ncacn_np:$SERVER_IP[seal] -U$USERNAME%$PASSWORD', 'over ncacn_np ')
         else:
             plansmbtorturetestsuite(t, "s3dc", '//$SERVER_IP/tmp -U$USERNAME%$PASSWORD')
 
@@ -208,7 +210,7 @@
             plansmbtorturetestsuite(t, "s3dc", '//$SERVER_IP/tmpcase -U$USERNAME%$PASSWORD')
 
     test = 'rpc.lsa.lookupsids'
-    auth_options = ["", "ntlm", "spnego" ]
+    auth_options = ["", "ntlm", "spnego", "spnego,ntlm" ]
     signseal_options = ["", ",connect", ",sign", ",seal"]
     smb_options = ["", ",smb2"]
     endianness_options = ["", ",bigendian"]
@@ -219,6 +221,9 @@
                     binding_string = "ncacn_np:$SERVER_IP[%s%s%s%s]" % (a, s, z, e)
                     options = binding_string + " -U$USERNAME%$PASSWORD"
                     plansmbtorturetestsuite(test, "s3dc", options, 'over ncacn_np with [%s%s%s%s] ' % (a, s, z, e))
+                    plantestsuite("samba3.blackbox.rpcclient over ncacn_np with [%s%s%s%s] " % (a, s, z, e), "s3dc:local", [os.path.join(samba3srcdir, "script/tests/test_rpcclient.sh"),
+                                                                 "none", options, configuration])
+
     for e in endianness_options:
         for a in auth_options:
             for s in signseal_options:
diff -daurN samba3/source3/services/svc_winreg_glue.c samba3/source3/services/svc_winreg_glue.c
--- samba3/source3/services/svc_winreg_glue.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/services/svc_winreg_glue.c	2024-08-04 17:52:53.000000000 +0200
@@ -88,6 +88,10 @@
 	NTSTATUS status;
 	WERROR result = WERR_OK;
 
+#ifndef WINREG_SUPPORT
+	return NULL;
+#endif
+
 	key = talloc_asprintf(mem_ctx,
 			      "%s\\%s\\Security",
 			      TOP_LEVEL_SERVICES_KEY, name);
@@ -161,6 +165,10 @@
 	NTSTATUS status;
 	WERROR result = WERR_OK;
 
+#ifndef WINREG_SUPPORT
+	return false;
+#endif
+
 	tmp_ctx = talloc_stackframe();
 	if (tmp_ctx == NULL) {
 		return false;
@@ -272,6 +280,10 @@
 	NTSTATUS status;
 	WERROR result = WERR_OK;
 
+#ifndef WINREG_SUPPORT
+	return NULL;
+#endif
+
 	tmp_ctx = talloc_stackframe();
 	if (tmp_ctx == NULL) {
 		return NULL;
diff -daurN samba3/source3/smbd/close.c samba3/source3/smbd/close.c
--- samba3/source3/smbd/close.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/close.c	2024-08-04 17:52:53.000000000 +0200
@@ -643,6 +643,9 @@
 	status = ntstatus_keeperror(status, tmp);
 
 	if (fsp->print_file) {
+#ifndef PRINTER_SUPPORT
+		return NT_STATUS_OK;
+#endif
 		/* FIXME: return spool errors */
 		print_spool_end(fsp, close_type);
 		file_free(req, fsp);
diff -daurN samba3/source3/smbd/conn.c samba3/source3/smbd/conn.c
--- samba3/source3/smbd/conn.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/conn.c	2024-08-04 17:52:53.000000000 +0200
@@ -23,6 +23,7 @@
 #include "smbd/smbd.h"
 #include "smbd/globals.h"
 #include "rpc_server/rpc_ncacn_np.h"
+#include "lib/util/bitmap.h"
 
 /* The connections bitmap is expanded in increments of BITMAP_BLOCK_SZ. The
  * maximum size of the bitmap is the largest positive integer, but you will hit
diff -daurN samba3/source3/smbd/dir.c samba3/source3/smbd/dir.c
--- samba3/source3/smbd/dir.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/dir.c	2024-08-04 17:52:53.000000000 +0200
@@ -23,6 +23,7 @@
 #include "smbd/smbd.h"
 #include "smbd/globals.h"
 #include "libcli/security/security.h"
+#include "lib/util/bitmap.h"
 
 /*
    This module implements directory related functions for Samba.
diff -daurN samba3/source3/smbd/fileio.c samba3/source3/smbd/fileio.c
--- samba3/source3/smbd/fileio.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/fileio.c	2024-08-04 17:52:53.000000000 +0200
@@ -298,6 +298,10 @@
 		uint32_t t;
 		int ret;
 
+#ifndef PRINTER_SUPPORT
+		return -1;
+#endif
+
 		ret = print_spool_write(fsp, data, n, pos, &t);
 		if (ret) {
 			errno = ret;
diff -daurN samba3/source3/smbd/files.c samba3/source3/smbd/files.c
--- samba3/source3/smbd/files.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/files.c	2024-08-04 17:52:53.000000000 +0200
@@ -22,6 +22,7 @@
 #include "smbd/globals.h"
 #include "libcli/security/security.h"
 #include "util_tdb.h"
+#include "lib/util/bitmap.h"
 
 #define VALID_FNUM(fnum)   (((fnum) >= 0) && ((fnum) < real_max_open_files))
 
diff -daurN samba3/source3/smbd/lanman.c samba3/source3/smbd/lanman.c
--- samba3/source3/smbd/lanman.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/lanman.c	2024-08-04 17:52:53.000000000 +0200
@@ -784,6 +784,10 @@
 	union spoolss_JobInfo *job_info = NULL;
 	union spoolss_PrinterInfo printer_info;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -999,6 +1003,10 @@
 	union spoolss_DriverInfo *driver_info;
 	union spoolss_JobInfo **job_info;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!param_format || !output_format1 || !p) {
 		return False;
 	}
@@ -2189,6 +2197,10 @@
 	struct srvsvc_NetShareInfo2 info2;
 	struct dcerpc_binding_handle *b;
 
+#ifndef SRVSVC_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -2345,6 +2357,10 @@
 	NTSTATUS status, result;
 	struct dcerpc_binding_handle *b;
 
+#ifndef SAMR_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -2533,6 +2549,10 @@
 	NTSTATUS status, result;
 	struct dcerpc_binding_handle *b;
 
+#ifndef SAMR_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !UserName || !p) {
 		return False;
 	}
@@ -2733,6 +2753,10 @@
 
 	struct dcerpc_binding_handle *b;
 
+#ifndef SAMR_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -2971,6 +2995,10 @@
 	int bufsize;
 	struct dcerpc_binding_handle *b;
 
+#ifndef SAMR_SUPPORT
+	return False;
+#endif
+
 	*rparam_len = 4;
 	*rparam = smb_realloc_limit(*rparam,*rparam_len);
 	if (!*rparam) {
@@ -3105,6 +3133,10 @@
 	struct spoolss_DevmodeContainer devmode_ctr;
 	enum spoolss_JobControl command;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -3238,6 +3270,10 @@
 	struct sec_desc_buf secdesc_ctr;
 	enum spoolss_PrinterControl command;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !QueueName) {
 		return False;
 	}
@@ -3404,6 +3440,10 @@
 	union spoolss_JobInfo info;
 	struct spoolss_SetJobInfo1 info1;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -3553,10 +3593,7 @@
 	NTSTATUS status;
 	WERROR werr;
 	TALLOC_CTX *mem_ctx = talloc_tos();
-	struct rpc_pipe_client *cli = NULL;
-	union srvsvc_NetSrvInfo info;
 	int errcode;
-	struct dcerpc_binding_handle *b;
 
 	if (!str1 || !str2 || !p) {
 		return False;
@@ -3619,66 +3656,16 @@
 	p = *rdata;
 	p2 = p + struct_len;
 
-	status = rpc_pipe_open_interface(mem_ctx, &ndr_table_srvsvc.syntax_id,
-					conn->session_info,
-					&conn->sconn->client_id,
-					conn->sconn->msg_ctx,
-					&cli);
-	if (!NT_STATUS_IS_OK(status)) {
-		DEBUG(0,("api_RNetServerGetInfo: could not connect to srvsvc: %s\n",
-			  nt_errstr(status)));
-		errcode = W_ERROR_V(ntstatus_to_werror(status));
-		goto out;
-	}
-
-	b = cli->binding_handle;
-
-	status = dcerpc_srvsvc_NetSrvGetInfo(b, mem_ctx,
-					     NULL,
-					     101,
-					     &info,
-					     &werr);
-	if (!NT_STATUS_IS_OK(status)) {
-		errcode = W_ERROR_V(ntstatus_to_werror(status));
-		goto out;
-	}
-	if (!W_ERROR_IS_OK(werr)) {
-		errcode = W_ERROR_V(werr);
-		goto out;
-	}
-
-	if (info.info101 == NULL) {
-		errcode = W_ERROR_V(WERR_INVALID_PARAM);
-		goto out;
-	}
-
 	if (uLevel != 20) {
-		srvstr_push(NULL, 0, p, info.info101->server_name, 16,
+		srvstr_push(NULL, 0, p, global_myname(), 16,
 			STR_ASCII|STR_UPPER|STR_TERMINATE);
-  	}
+	}
 	p += 16;
 	if (uLevel > 0) {
-		SCVAL(p,0,info.info101->version_major);
-		SCVAL(p,1,info.info101->version_minor);
-		SIVAL(p,2,info.info101->server_type);
-
-		if (mdrcnt == struct_len) {
-			SIVAL(p,6,0);
-		} else {
-			SIVAL(p,6,PTR_DIFF(p2,*rdata));
-			if (mdrcnt - struct_len <= 0) {
-				return false;
-			}
-			push_ascii(p2,
-				info.info101->comment,
-				MIN(mdrcnt - struct_len,
-					MAX_SERVER_STRING_LENGTH),
-				STR_TERMINATE);
-			p2 = skip_string(*rdata,*rdata_len,p2);
-			if (!p2) {
-				return False;
-			}
-		}
+		SCVAL(p,0,lp_major_announce_version());
+		SCVAL(p,1,lp_minor_announce_version());
+		SIVAL(p,2,lp_default_server_announce());
+		SIVAL(p,6,0);
 	}
 
 	if (uLevel > 1) {
@@ -4000,6 +3987,10 @@
 	union samr_UserInfo *info;
 	struct dcerpc_binding_handle *b = NULL;
 
+#ifndef SAMR_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !UserName || !p) {
 		return False;
 	}
@@ -4547,6 +4538,10 @@
 	struct spoolss_DevmodeContainer devmode_ctr;
 	union spoolss_JobInfo info;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -4685,6 +4680,10 @@
 	uint32_t count = 0;
 	union spoolss_JobInfo *info;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -4890,6 +4889,10 @@
 	struct spoolss_DevmodeContainer devmode_ctr;
 	union spoolss_PrinterInfo info;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -5026,6 +5029,10 @@
 	union spoolss_PrinterInfo *info;
 	uint32_t count;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -5129,6 +5136,10 @@
 	int succnt;
 	struct pack_desc desc;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -5193,6 +5204,10 @@
 	int succnt;
 	struct pack_desc desc;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -5257,6 +5272,10 @@
 	int succnt;
 	struct pack_desc desc;
 
+#ifndef PRINTER_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
@@ -5337,6 +5356,10 @@
 	uint32_t totalentries, resume_handle = 0;
 	uint32_t count = 0;
 
+#ifndef SRVSVC_SUPPORT
+	return False;
+#endif
+
 	if (!str1 || !str2 || !p) {
 		return False;
 	}
diff -daurN samba3/source3/smbd/open.c samba3/source3/smbd/open.c
--- samba3/source3/smbd/open.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/open.c	2024-08-04 17:52:53.000000000 +0200
@@ -1608,6 +1608,9 @@
 		 * Most of the passed parameters are ignored.
 		 */
 
+#ifndef PRINTER_SUPPORT
+		return NT_STATUS_ACCESS_DENIED;
+#endif
 		if (pinfo) {
 			*pinfo = FILE_WAS_CREATED;
 		}
diff -daurN samba3/source3/smbd/process.c samba3/source3/smbd/process.c
--- samba3/source3/smbd/process.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/process.c	2024-08-04 17:52:53.000000000 +0200
@@ -2423,14 +2423,18 @@
 
 	change_to_root_user();
 
+#ifdef PRINTER_SUPPORT
 	/* update printer queue caches if necessary */
 	update_monitored_printq_cache(sconn->msg_ctx);
+#endif
 
 	/* check if we need to reload services */
 	check_reload(sconn, time_mono(NULL));
 
+#ifdef NETLOGON_SUPPORT
 	/* Change machine password if neccessary. */
 	attempt_machine_password_change();
+#endif
 
         /*
 	 * Force a log file check.
diff -daurN samba3/source3/smbd/reply.c samba3/source3/smbd/reply.c
--- samba3/source3/smbd/reply.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/reply.c	2024-08-04 17:52:53.000000000 +0200
@@ -4161,6 +4161,7 @@
 	connection_struct *conn = req->conn;
 	ssize_t nwritten = -1;
 	size_t numtowrite;
+	size_t remaining;
 	SMB_OFF_T startpos;
 	const char *data;
 	NTSTATUS status = NT_STATUS_OK;
@@ -4193,6 +4194,17 @@
 	startpos = IVAL_TO_SMB_OFF_T(req->vwv+2, 0);
 	data = (const char *)req->buf + 3;
 
+	/*
+	 * Ensure client isn't asking us to write more than
+	 * they sent. CVE-2017-12163.
+	 */
+	remaining = smbreq_bufrem(req, data);
+	if (numtowrite > remaining) {
+		reply_nterror(req, NT_STATUS_INVALID_PARAMETER);
+		END_PROFILE(SMBwriteunlock);
+		return;
+	}
+
 	if (!fsp->print_file && numtowrite > 0) {
 		init_strict_lock_struct(fsp, (uint64_t)req->smbpid,
 		    (uint64_t)startpos, (uint64_t)numtowrite, WRITE_LOCK,
@@ -4274,6 +4286,7 @@
 {
 	connection_struct *conn = req->conn;
 	size_t numtowrite;
+	size_t remaining;
 	ssize_t nwritten = -1;
 	SMB_OFF_T startpos;
 	const char *data;
@@ -4314,6 +4327,17 @@
 	startpos = IVAL_TO_SMB_OFF_T(req->vwv+2, 0);
 	data = (const char *)req->buf + 3;
 
+	/*
+	 * Ensure client isn't asking us to write more than
+	 * they sent. CVE-2017-12163.
+	 */
+	remaining = smbreq_bufrem(req, data);
+	if (numtowrite > remaining) {
+		reply_nterror(req, NT_STATUS_INVALID_PARAMETER);
+		END_PROFILE(SMBwrite);
+		return;
+	}
+
 	if (!fsp->print_file) {
 		init_strict_lock_struct(fsp, (uint64_t)req->smbpid,
 			(uint64_t)startpos, (uint64_t)numtowrite, WRITE_LOCK,
@@ -4895,6 +4919,7 @@
 	connection_struct *conn = req->conn;
 	size_t numtowrite;
 	ssize_t nwritten = -1;
+	size_t remaining;
 	NTSTATUS close_status = NT_STATUS_OK;
 	SMB_OFF_T startpos;
 	const char *data;
@@ -4927,6 +4952,17 @@
 	mtime = convert_time_t_to_timespec(srv_make_unix_date3(req->vwv+4));
 	data = (const char *)req->buf + 1;
 
+	/*
+	 * Ensure client isn't asking us to write more than
+	 * they sent. CVE-2017-12163.
+	 */
+	remaining = smbreq_bufrem(req, data);
+	if (numtowrite > remaining) {
+		reply_nterror(req, NT_STATUS_INVALID_PARAMETER);
+		END_PROFILE(SMBwriteclose);
+		return;
+	}
+
 	if (!fsp->print_file) {
 		init_strict_lock_struct(fsp, (uint64_t)req->smbpid,
 		    (uint64_t)startpos, (uint64_t)numtowrite, WRITE_LOCK,
@@ -5208,7 +5244,11 @@
 		return;
 	}
 
-	if (!CAN_PRINT(conn)) {
+
+#ifdef PRINTER_SUPPORT
+	if (!CAN_PRINT(conn))
+#endif
+	{
 		reply_nterror(req, NT_STATUS_ACCESS_DENIED);
 		END_PROFILE(SMBsplopen);
 		return;
@@ -5314,7 +5354,10 @@
 	   is really quite gross and only worked when there was only
 	   one printer - I think we should now only accept it if they
 	   get it right (tridge) */
-	if (!CAN_PRINT(conn)) {
+#ifdef PRINTER_SUPPORT
+	if (!CAN_PRINT(conn))
+#endif
+	{
 		reply_nterror(req, NT_STATUS_ACCESS_DENIED);
 		END_PROFILE(SMBsplretq);
 		return;
diff -daurN samba3/source3/smbd/server.c samba3/source3/smbd/server.c
--- samba3/source3/smbd/server.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/server.c	2024-08-04 17:52:53.000000000 +0200
@@ -123,7 +123,9 @@
 {
 	struct tevent_context *ev_ctx =
 		talloc_get_type_abort(private_data, struct tevent_context);
-
+#ifndef PRINTER_SUPPORT
+	return;
+#endif
 	DEBUG(10,("Got message saying pcap was updated. Reloading.\n"));
 	change_to_root_user();
 	reload_printers(ev_ctx, msg);
@@ -1228,8 +1230,10 @@
 		exit(1);
 	}
 
+#ifdef REGISTRY_BACKEND
 	if (!W_ERROR_IS_OK(registry_init_full()))
 		exit(1);
+#endif
 
 	/* Open the share_info.tdb here, so we don't have to open
 	   after the fork on every single connection.  This is a small
@@ -1277,6 +1281,7 @@
 	 * The print backend init also migrates the printing tdb's,
 	 * this requires a winreg pipe.
 	 */
+#ifdef PRINTER_SUPPORT
 	if (!print_backend_init(smbd_messaging_context()))
 		exit(1);
 
@@ -1315,7 +1320,7 @@
 				       smbd_messaging_context());
 		}
 	}
-
+#endif
 	if (!is_daemon) {
 		/* inetd mode */
 		TALLOC_FREE(frame);
diff -daurN samba3/source3/smbd/server_exit.c samba3/source3/smbd/server_exit.c
--- samba3/source3/smbd/server_exit.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/server_exit.c	2024-08-04 17:52:53.000000000 +0200
@@ -132,23 +132,39 @@
 
 	if (am_parent) {
 		rpc_wkssvc_shutdown();
+#ifdef ACTIVE_DIRECTORY
 		rpc_dssetup_shutdown();
+#endif
 #ifdef DEVELOPER
 		rpc_rpcecho_shutdown();
 #endif
+#ifdef DFS_SUPPORT
 		rpc_netdfs_shutdown();
+#endif
 		rpc_initshutdown_shutdown();
+#ifdef EXTRA_SERVICES
 		rpc_eventlog_shutdown();
-		rpc_ntsvcs_shutdown();
 		rpc_svcctl_shutdown();
+		rpc_ntsvcs_shutdown();
+#endif
+#ifdef PRINTER_SUPPORT
 		rpc_spoolss_shutdown();
+#endif
 
 		rpc_srvsvc_shutdown();
+#ifdef WINREG_SUPPORT
 		rpc_winreg_shutdown();
+#endif
 
+#ifdef NETLOGON_SUPPORT
 		rpc_netlogon_shutdown();
+#endif
+#ifdef SAMR_SUPPORT
 		rpc_samr_shutdown();
+#endif
+#ifdef LSA_SUPPORT
 		rpc_lsarpc_shutdown();
+#endif
 	}
 
 	/*
diff -daurN samba3/source3/smbd/smb2_create.c samba3/source3/smbd/smb2_create.c
--- samba3/source3/smbd/smb2_create.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/smb2_create.c	2024-08-04 17:52:53.000000000 +0200
@@ -486,7 +486,10 @@
 		info = FILE_WAS_OPENED;
 	} else if (CAN_PRINT(smb1req->conn)) {
 		status = file_new(smb1req, smb1req->conn, &result);
-		if(!NT_STATUS_IS_OK(status)) {
+#ifdef PRINTER_SUPPORT
+		if(!NT_STATUS_IS_OK(status))
+#endif
+		{
 			tevent_req_nterror(req, status);
 			return tevent_req_post(req, ev);
 		}
diff -daurN samba3/source3/smbd/smb2_server.c samba3/source3/smbd/smb2_server.c
--- samba3/source3/smbd/smb2_server.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/smb2_server.c	2024-08-04 17:52:53.000000000 +0200
@@ -26,6 +26,7 @@
 #include "../lib/tsocket/tsocket.h"
 #include "../lib/util/tevent_ntstatus.h"
 #include "smbprofile.h"
+#include "../lib/util/bitmap.h"
 
 #define OUTVEC_ALLOC_SIZE (SMB2_HDR_BODY + 9)
 
diff -daurN samba3/source3/smbd/srvstr.c samba3/source3/smbd/srvstr.c
--- samba3/source3/smbd/srvstr.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/smbd/srvstr.c	2024-08-04 17:52:53.000000000 +0200
@@ -70,6 +70,20 @@
 		DEBUG(0, ("srvstr_push failed\n"));
 		return -1;
 	}
+
+	/*
+	 * Ensure we clear out the extra data we have
+	 * grown the buffer by, but not written to.
+	 */
+	if (buf_size + result < buf_size) {
+		return -1;
+	}
+	if (grow_size < result) {
+		return -1;
+	}
+
+	memset(tmp + buf_size + result, '\0', grow_size - result);
+
 	set_message_bcc((char *)tmp, smb_buflen(tmp) + result);
 
 	*outbuf = tmp;
diff -daurN samba3/source3/utils/net_rpc.c samba3/source3/utils/net_rpc.c
--- samba3/source3/utils/net_rpc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/utils/net_rpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -7841,6 +7841,10 @@
 		{NULL, NULL, 0, NULL, NULL}
 	};
 
+#ifndef PRINTER_SUPPORT
+	return 0;
+#endif
+
 	if (argc == 0) {
 		if (c->display_usage) {
 			d_printf(_("Usage:\n"));
diff -daurN samba3/source3/utils/owrt_smbpasswd.c samba3/source3/utils/owrt_smbpasswd.c
--- samba3/source3/utils/owrt_smbpasswd.c	1970-01-01 01:00:00.000000000 +0100
+++ samba3/source3/utils/owrt_smbpasswd.c	2024-08-04 17:52:53.000000000 +0200
@@ -0,0 +1,225 @@
+/*
+ * Copyright (C) 2012 Felix Fietkau <nbd@openwrt.org>
+ * Copyright (C) 2008 John Crispin <blogic@openwrt.org>
+ *
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the
+ * Free Software Foundation; either version 2 of the License, or (at your
+ * option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
+ * more details.
+ *
+ * You should have received a copy of the GNU General Public License along with
+ * this program; if not, write to the Free Software Foundation, Inc., 675
+ * Mass Ave, Cambridge, MA 02139, USA.  */
+
+#include "includes.h"
+#include <endian.h>
+#include <stdio.h>
+#include <sys/stat.h>
+
+static char buf[256];
+
+static const char smbpasswd[] = "/etc/samba/smbpasswd";
+
+static void md4hash(const char *passwd, uchar p16[16])
+{
+	int len;
+	smb_ucs2_t wpwd[129];
+	int i;
+
+	len = strlen(passwd);
+	for (i = 0; i < len; i++) {
+#if __BYTE_ORDER == __LITTLE_ENDIAN
+		wpwd[i] = (unsigned char)passwd[i];
+#else
+		wpwd[i] = (unsigned char)passwd[i] << 8;
+#endif
+	}
+	wpwd[i] = 0;
+
+	len = len * sizeof(int16);
+	mdfour(p16, (unsigned char *)wpwd, len);
+	ZERO_STRUCT(wpwd);
+}
+
+
+static bool find_passwd_line(FILE *fp, const char *user, char **next)
+{
+	char *p1;
+
+	while (!feof(fp)) {
+		if(!fgets(buf, sizeof(buf) - 1, fp))
+			continue;
+
+		p1 = strchr(buf, ':');
+
+		if (p1 - buf != strlen(user))
+			continue;
+
+		if (strncmp(buf, user, p1 - buf) != 0)
+			continue;
+
+		if (next)
+			*next = p1;
+		return true;
+	}
+	return false;
+}
+
+/* returns -1 if user is not present in /etc/passwd*/
+static int find_uid_for_user(const char *user)
+{
+	FILE *fp;
+	char *p1, *p2, *p3;
+	int ret = -1;
+
+	fp = fopen("/etc/passwd", "r");
+	if (!fp) {
+		printf("failed to open /etc/passwd");
+		goto out;
+	}
+
+	if (!find_passwd_line(fp, user, &p1)) {
+		printf("User %s not found or invalid in /etc/passwd\n", user);
+		goto out;
+	}
+
+	p2 = strchr(p1 + 1, ':');
+	if (!p2)
+		goto out;
+
+	p2++;
+	p3 = strchr(p2, ':');
+	if (!p1)
+		goto out;
+
+	*p3 = '\0';
+	ret = atoi(p2);
+
+out:
+	if(fp)
+		fclose(fp);
+	return ret;
+}
+
+static void smbpasswd_write_user(FILE *fp, const char *user, int uid, const char *password)
+{
+	static uchar nt_p16[NT_HASH_LEN];
+	int len = 0;
+	int i;
+
+	md4hash(strdup(password), nt_p16);
+
+	len += snprintf(buf + len, sizeof(buf) - len, "%s:%u:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:", user, uid);
+	for(i = 0; i < NT_HASH_LEN; i++)
+		len += snprintf(buf + len, sizeof(buf) - len, "%02X", nt_p16[i]);
+
+	snprintf(buf + len, sizeof(buf) - len, ":[U          ]:LCT-00000001:\n");
+	fputs(buf, fp);
+}
+
+static void smbpasswd_delete_user(FILE *fp)
+{
+	fpos_t r_pos, w_pos;
+	int len = strlen(buf);
+
+	fgetpos(fp, &r_pos);
+	fseek(fp, -len, SEEK_CUR);
+	fgetpos(fp, &w_pos);
+	fsetpos(fp, &r_pos);
+
+	while (fgets(buf, sizeof(buf) - 1, fp)) {
+		int cur_len = strlen(buf);
+
+		fsetpos(fp, &w_pos);
+		fputs(buf, fp);
+		fgetpos(fp, &w_pos);
+
+		fsetpos(fp, &r_pos);
+		fseek(fp, cur_len, SEEK_CUR);
+		fgetpos(fp, &r_pos);
+	}
+
+	fsetpos(fp, &w_pos);
+	ftruncate(fileno(fp), ftello(fp));
+}
+
+static int usage(const char *progname)
+{
+	fprintf(stderr,
+		"Usage: %s [options] <username>\n"
+		"\n"
+		"Options:\n"
+		"  -s		read password from stdin\n"
+		"  -a		add user\n"
+		"  -x		delete user\n",
+		progname);
+	return 1;
+}
+
+int main(int argc, char **argv)
+{
+	const char *prog = argv[0];
+	const char *user;
+	char *pswd;
+	FILE *fp;
+	bool add = false, delete = false, get_stdin = false, found;
+	int ch;
+	int uid;
+	struct stat st;
+
+	TALLOC_CTX *frame = talloc_stackframe();
+
+	if(argc != 3)
+	{
+		printf("usage for smbpasswd - \n\t%s USERNAME PASSWD\n\t%s -del USERNAME\n", argv[0], argv[0]);
+		exit(1);
+	}
+
+	if(strcmp(argv[1], "-del") == 0) {
+		delete = true;
+		user = argv[2];
+		uid = find_uid_for_user(user);
+		if (uid < 0) {
+			fprintf(stderr, "Could not find user '%s' in /etc/passwd\n", user);
+			return 2;
+		}
+	} else {
+		add = true;
+		user = argv[1];
+	}
+
+	fp = fopen(smbpasswd, (stat(smbpasswd, &st) == 0) && (!S_ISDIR(st.st_mode)) ? "r+" : "w+");
+	if(!fp) {
+		fprintf(stderr, "Failed to open %s\n", smbpasswd);
+		return 3;
+	}
+
+	found = find_passwd_line(fp, user, NULL);
+	if (!add && !found) {
+		fprintf(stderr, "Could not find user '%s' in %s\n", smbpasswd, user);
+		return 3;
+	}
+
+	if (delete) {
+		smbpasswd_delete_user(fp);
+		goto out;
+	}
+
+	if (found)
+		fseek(fp, -strlen(buf), SEEK_CUR);
+
+	pswd = strdup(argv[2]);
+	smbpasswd_write_user(fp, user, uid, pswd);
+	free(pswd);
+out:
+
+	fclose(fp);
+	TALLOC_FREE(frame);
+
+	return 0;
+}
diff -daurN samba3/source3/winbindd/winbindd_cm.c samba3/source3/winbindd/winbindd_cm.c
--- samba3/source3/winbindd/winbindd_cm.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source3/winbindd/winbindd_cm.c	2024-08-04 17:52:53.000000000 +0200
@@ -2384,6 +2384,15 @@
 	TALLOC_FREE(conn->samr_pipe);
 
  anonymous:
+	if (lp_winbind_sealed_pipes() && (IS_DC || domain->primary)) {
+		status = NT_STATUS_DOWNGRADE_DETECTED;
+		DEBUG(1, ("Unwilling to make SAMR connection to domain %s "
+			  "without connection level security, "
+			  "must set 'winbind sealed pipes = false' "
+			  "to proceed: %s\n",
+			  domain->name, nt_errstr(status)));
+		goto done;
+	}
 
 	/* Finally fall back to anonymous. */
 	status = cli_rpc_pipe_open_noauth(conn->cli, &ndr_table_samr.syntax_id,
@@ -2610,6 +2619,16 @@
 
  anonymous:
 
+	if (lp_winbind_sealed_pipes() && (IS_DC || domain->primary)) {
+		result = NT_STATUS_DOWNGRADE_DETECTED;
+		DEBUG(1, ("Unwilling to make LSA connection to domain %s "
+			  "without connection level security, "
+			  "must set 'winbind sealed pipes = false' "
+			  "to proceed: %s\n",
+			  domain->name, nt_errstr(result)));
+		goto done;
+	}
+
 	result = cli_rpc_pipe_open_noauth(conn->cli,
 					  &ndr_table_lsarpc.syntax_id,
 					  &conn->lsa_pipe);
@@ -2749,7 +2768,18 @@
 
  no_schannel:
 	if ((lp_client_schannel() == False) ||
-			((neg_flags & NETLOGON_NEG_SCHANNEL) == 0)) {
+		((neg_flags & NETLOGON_NEG_SCHANNEL) == 0)) {
+		if (lp_winbind_sealed_pipes() && (IS_DC || domain->primary)) {
+			result = NT_STATUS_DOWNGRADE_DETECTED;
+			DEBUG(1, ("Unwilling to make connection to domain %s "
+				  "without connection level security, "
+				  "must set 'winbind sealed pipes = false' "
+				  "to proceed: %s\n",
+				  domain->name, nt_errstr(result)));
+			TALLOC_FREE(netlogon_pipe);
+			invalidate_cm_connection(conn);
+			return result;
+		}
 		/*
 		 * NetSamLogonEx only works for schannel
 		 */
diff -daurN samba3/source4/heimdal/cf/make-proto.pl samba3/source4/heimdal/cf/make-proto.pl
--- samba3/source4/heimdal/cf/make-proto.pl	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/heimdal/cf/make-proto.pl	2024-08-04 17:52:53.000000000 +0200
@@ -1,8 +1,8 @@
 # Make prototypes from .c files
 # $Id$
 
-##use Getopt::Std;
-require 'getopts.pl';
+use Getopt::Std;
+#require 'getopts.pl';
 
 my $comment = 0;
 my $if_0 = 0;
@@ -12,7 +12,7 @@
 my $oproto = 1;
 my $private_func_re = "^_";
 
-Getopts('x:m:o:p:dqE:R:P:') || die "foo";
+getopts('x:m:o:p:dqE:R:P:') || die "foo";
 
 if($opt_d) {
     $debug = 1;
diff -daurN samba3/source4/lib/ldb/wscript samba3/source4/lib/ldb/wscript
--- samba3/source4/lib/ldb/wscript	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/lib/ldb/wscript	2024-08-04 17:52:53.000000000 +0200
@@ -135,9 +135,7 @@
                           pc_files=ldb_pc_files,
                           vnum=VERSION,
                           private_library=private_library,
-                          manpages='man/ldb.3',
-                          abi_directory = 'ABI',
-                          abi_match = abi_match)
+                          manpages='man/ldb.3')
 
         # generate a include/ldb_version.h
         t = bld.SAMBA_GENERATOR('ldb_version.h',
diff -daurN samba3/source4/librpc/rpc/dcerpc.c samba3/source4/librpc/rpc/dcerpc.c
--- samba3/source4/librpc/rpc/dcerpc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/librpc/rpc/dcerpc.c	2024-08-04 17:52:53.000000000 +0200
@@ -701,6 +701,14 @@
 		return NT_STATUS_INVALID_LEVEL;
 	}
 
+	if (pkt->auth_length == 0) {
+		return NT_STATUS_INVALID_NETWORK_RESPONSE;
+	}
+
+	if (c->security_state.generic_state == NULL) {
+		return NT_STATUS_INTERNAL_ERROR;
+	}
+
 	status = dcerpc_pull_auth_trailer(pkt, mem_ctx,
 					  &pkt->u.response.stub_and_verifier,
 					  &auth, &auth_length, false);
@@ -1074,7 +1082,7 @@
 	}
 
 	/* the bind_ack might contain a reply set of credentials */
-	if (conn->security_state.auth_info && pkt->u.bind_ack.auth_info.length) {
+	if (conn->security_state.auth_info && pkt->auth_length) {
 		NTSTATUS status;
 		uint32_t auth_length;
 		status = dcerpc_pull_auth_trailer(pkt, conn, &pkt->u.bind_ack.auth_info,
@@ -1847,8 +1855,7 @@
 	}
 
 	/* the alter_resp might contain a reply set of credentials */
-	if (recv_pipe->conn->security_state.auth_info &&
-	    pkt->u.alter_resp.auth_info.length) {
+	if (recv_pipe->conn->security_state.auth_info && pkt->auth_length) {
 		struct dcecli_connection *conn = recv_pipe->conn;
 		NTSTATUS status;
 		uint32_t auth_length;
diff -daurN samba3/source4/librpc/rpc/dcerpc_util.c samba3/source4/librpc/rpc/dcerpc_util.c
--- samba3/source4/librpc/rpc/dcerpc_util.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/librpc/rpc/dcerpc_util.c	2024-08-04 17:52:53.000000000 +0200
@@ -593,15 +593,15 @@
 
 	/* Perform an authenticated DCE-RPC bind
 	 */
-	if (!(conn->flags & (DCERPC_SIGN|DCERPC_SEAL))) {
+	if (!(conn->flags & (DCERPC_CONNECT|DCERPC_SEAL))) {
 		/*
 		  we are doing an authenticated connection,
-		  but not using sign or seal. We must force
-		  the CONNECT dcerpc auth type as a NONE auth
-		  type doesn't allow authentication
-		  information to be passed.
+		  which needs to use [connect], [sign] or [seal].
+		  If nothing is specified, we default to [sign] now.
+		  This give roughly the same protection as
+		  ncacn_np with smb signing.
 		*/
-		conn->flags |= DCERPC_CONNECT;
+		conn->flags |= DCERPC_SIGN;
 	}
 
 	if (s->binding->flags & DCERPC_AUTH_SPNEGO) {
diff -daurN samba3/source4/rpc_server/dcesrv_auth.c samba3/source4/rpc_server/dcesrv_auth.c
--- samba3/source4/rpc_server/dcesrv_auth.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/rpc_server/dcesrv_auth.c	2024-08-04 17:52:53.000000000 +0200
@@ -46,7 +46,7 @@
 	NTSTATUS status;
 	uint32_t auth_length;
 
-	if (pkt->u.bind.auth_info.length == 0) {
+	if (pkt->auth_length == 0) {
 		dce_conn->auth_state.auth_info = NULL;
 		return true;
 	}
@@ -108,7 +108,7 @@
 	struct dcesrv_connection *dce_conn = call->conn;
 	NTSTATUS status;
 
-	if (!call->conn->auth_state.gensec_security) {
+	if (call->pkt.auth_length == 0) {
 		return NT_STATUS_OK;
 	}
 
@@ -155,10 +155,16 @@
 	NTSTATUS status;
 	uint32_t auth_length;
 
-	/* We can't work without an existing gensec state, and an new blob to feed it */
-	if (!dce_conn->auth_state.auth_info ||
-	    !dce_conn->auth_state.gensec_security ||
-	    pkt->u.auth3.auth_info.length == 0) {
+	if (pkt->auth_length == 0) {
+		return false;
+	}
+
+	if (!dce_conn->auth_state.auth_info) {
+		return false;
+	}
+
+	/* We can't work without an existing gensec state */
+	if (!dce_conn->auth_state.gensec_security) {
 		return false;
 	}
 
@@ -203,7 +209,7 @@
 	uint32_t auth_length;
 
 	/* on a pure interface change there is no auth blob */
-	if (pkt->u.alter.auth_info.length == 0) {
+	if (pkt->auth_length == 0) {
 		return true;
 	}
 
@@ -238,8 +244,7 @@
 
 	/* on a pure interface change there is no auth_info structure
 	   setup */
-	if (!call->conn->auth_state.auth_info ||
-	    dce_conn->auth_state.auth_info->credentials.length == 0) {
+	if (call->pkt.auth_length == 0) {
 		return NT_STATUS_OK;
 	}
 
@@ -315,6 +320,11 @@
 		return false;
 	}
 
+	if (pkt->auth_length == 0) {
+		DEBUG(1,("dcesrv_auth_request: unexpected auth_length of 0\n"));
+		return false;
+	}
+
 	status = dcerpc_pull_auth_trailer(pkt, call,
 					  &pkt->u.request.stub_and_verifier,
 					  &auth, &auth_length, false);
diff -daurN samba3/source4/torture/basic/base.c samba3/source4/torture/basic/base.c
--- samba3/source4/torture/basic/base.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/basic/base.c	2024-08-04 17:52:54.000000000 +0200
@@ -1476,6 +1476,7 @@
 static bool torture_samba3_errorpaths(struct torture_context *tctx)
 {
 	bool nt_status_support;
+	bool client_ntlmv2_auth;
 	struct smbcli_state *cli_nt = NULL, *cli_dos = NULL;
 	bool result = false;
 	int fnum;
@@ -1485,18 +1486,27 @@
 	NTSTATUS status;
 
 	nt_status_support = lpcfg_nt_status_support(tctx->lp_ctx);
+	client_ntlmv2_auth = lpcfg_client_ntlmv2_auth(tctx->lp_ctx);
 
 	if (!lpcfg_set_cmdline(tctx->lp_ctx, "nt status support", "yes")) {
 		torture_comment(tctx, "Could not set 'nt status support = yes'\n");
 		goto fail;
 	}
+	if (!lpcfg_set_cmdline(tctx->lp_ctx, "client ntlmv2 auth", "yes")) {
+		torture_result(tctx, TORTURE_FAIL, "Could not set 'client ntlmv2 auth = yes'\n");
+		goto fail;
+	}
 
 	if (!torture_open_connection(&cli_nt, tctx, 0)) {
 		goto fail;
 	}
 
 	if (!lpcfg_set_cmdline(tctx->lp_ctx, "nt status support", "no")) {
-		torture_comment(tctx, "Could not set 'nt status support = yes'\n");
+		torture_result(tctx, TORTURE_FAIL, "Could not set 'nt status support = no'\n");
+		goto fail;
+	}
+	if (!lpcfg_set_cmdline(tctx->lp_ctx, "client ntlmv2 auth", "no")) {
+		torture_result(tctx, TORTURE_FAIL, "Could not set 'client ntlmv2 auth = no'\n");
 		goto fail;
 	}
 
@@ -1506,7 +1516,12 @@
 
 	if (!lpcfg_set_cmdline(tctx->lp_ctx, "nt status support",
 			    nt_status_support ? "yes":"no")) {
-		torture_comment(tctx, "Could not reset 'nt status support = yes'");
+		torture_result(tctx, TORTURE_FAIL, "Could not reset 'nt status support'");
+		goto fail;
+	}
+	if (!lpcfg_set_cmdline(tctx->lp_ctx, "client ntlmv2 auth",
+			       client_ntlmv2_auth ? "yes":"no")) {
+		torture_result(tctx, TORTURE_FAIL, "Could not reset 'client ntlmv2 auth'");
 		goto fail;
 	}
 
diff -daurN samba3/source4/torture/ndr/dfsblob.c samba3/source4/torture/ndr/dfsblob.c
--- samba3/source4/torture/ndr/dfsblob.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/dfsblob.c	2024-08-04 17:52:54.000000000 +0200
@@ -74,11 +74,11 @@
 {
 	struct torture_suite *suite = torture_suite_create(ctx, "dfsblob");
 
-	torture_suite_add_ndr_pull_fn_test(suite, dfs_GetDFSReferral_in, dfs_get_ref_in, NDR_IN, NULL);
+	torture_suite_add_ndr_pull_test(suite, dfs_GetDFSReferral_in, dfs_get_ref_in, NULL);
 
-	torture_suite_add_ndr_pull_fn_test(suite, dfs_referral_resp, dfs_get_ref_out2, NDR_BUFFERS|NDR_SCALARS, NULL);
+	torture_suite_add_ndr_pull_test(suite, dfs_referral_resp, dfs_get_ref_out2, NULL);
 
-	torture_suite_add_ndr_pull_fn_test(suite, dfs_referral_resp, dfs_get_ref_out, NDR_BUFFERS|NDR_SCALARS,dfs_referral_out_check);
+	torture_suite_add_ndr_pull_test(suite, dfs_referral_resp, dfs_get_ref_out,dfs_referral_out_check);
 
 	return suite;
 }
diff -daurN samba3/source4/torture/ndr/drsblobs.c samba3/source4/torture/ndr/drsblobs.c
--- samba3/source4/torture/ndr/drsblobs.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/drsblobs.c	2024-08-04 17:52:54.000000000 +0200
@@ -115,6 +115,34 @@
 	0x38, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00
 };
 
+/* these are taken from the trust objects of a w2k8r2 forest, with a
+ * trust relationship between the forest parent and a child domain
+ */
+static const char *trustAuthIncoming =
+"AQAAAAwAAAAcAQAASuQ+RXJdzAECAAAAAAEAAMOWL6UVfVKiJOUsGcT03H"
+"jHxr2ACsMMOV5ynM617Tp7idNC+c4egdqk4S9YEpvR2YvHmdZdymL6F7QKm8OkXazYZF2r/gZ/bI+"
+"jkWbsn4O8qyAc3OUKQRZwBbf+lxBW+vM4O3ZpUjz5BSKCcFQgM+MY91yVU8Nji3HNnvGnDquobFAZ"
+"hxjL+S1l5+QZgkfyfv5mQScGRbU1Lar1xg9G3JznUb7S6pvrBO2nwK8g+KZBfJy5UeULigDH4IWo/"
+"JmtaEGkKE2uiKIjdsEQd/uwnkouW26XzRc0ulfJnPFftGnT9KIcShPf7DLj/tstmQAAceRMFHJTY3"
+"PmxoowoK8HUyBK5D5Fcl3MAQIAAAAAAQAAw5YvpRV9UqIk5SwZxPTceMfGvYAKwww5XnKczrXtOnu"
+"J00L5zh6B2qThL1gSm9HZi8eZ1l3KYvoXtAqbw6RdrNhkXav+Bn9sj6ORZuyfg7yrIBzc5QpBFnAF"
+"t/6XEFb68zg7dmlSPPkFIoJwVCAz4xj3XJVTw2OLcc2e8acOq6hsUBmHGMv5LWXn5BmCR/J+/mZBJ"
+"wZFtTUtqvXGD0bcnOdRvtLqm+sE7afAryD4pkF8nLlR5QuKAMfghaj8ma1oQaQoTa6IoiN2wRB3+7"
+"CeSi5bbpfNFzS6V8mc8V+0adP0ohxKE9/sMuP+2y2ZAABx5EwUclNjc+bGijCgrwdTIA==";
+
+static const char *trustAuthOutgoing =
+"AQAAAAwAAAAcAQAASuQ+RXJdzAECAAAAAAEAAMOWL6UVfVKiJOUsGcT03H"
+"jHxr2ACsMMOV5ynM617Tp7idNC+c4egdqk4S9YEpvR2YvHmdZdymL6F7QKm8OkXazYZF2r/gZ/bI+"
+"jkWbsn4O8qyAc3OUKQRZwBbf+lxBW+vM4O3ZpUjz5BSKCcFQgM+MY91yVU8Nji3HNnvGnDquobFAZ"
+"hxjL+S1l5+QZgkfyfv5mQScGRbU1Lar1xg9G3JznUb7S6pvrBO2nwK8g+KZBfJy5UeULigDH4IWo/"
+"JmtaEGkKE2uiKIjdsEQd/uwnkouW26XzRc0ulfJnPFftGnT9KIcShPf7DLj/tstmQAAceRMFHJTY3"
+"PmxoowoK8HUyBK5D5Fcl3MAQIAAAAAAQAAw5YvpRV9UqIk5SwZxPTceMfGvYAKwww5XnKczrXtOnu"
+"J00L5zh6B2qThL1gSm9HZi8eZ1l3KYvoXtAqbw6RdrNhkXav+Bn9sj6ORZuyfg7yrIBzc5QpBFnAF"
+"t/6XEFb68zg7dmlSPPkFIoJwVCAz4xj3XJVTw2OLcc2e8acOq6hsUBmHGMv5LWXn5BmCR/J+/mZBJ"
+"wZFtTUtqvXGD0bcnOdRvtLqm+sE7afAryD4pkF8nLlR5QuKAMfghaj8ma1oQaQoTa6IoiN2wRB3+7"
+"CeSi5bbpfNFzS6V8mc8V+0adP0ohxKE9/sMuP+2y2ZAABx5EwUclNjc+bGijCgrwdTIA==";
+
+
 static bool trust_domain_passwords_check_in(struct torture_context *tctx,
 					    struct trustDomainPasswords *r)
 {
@@ -154,8 +182,20 @@
 {
 	struct torture_suite *suite = torture_suite_create(ctx, "drsblobs");
 
-	torture_suite_add_ndr_pull_fn_test(suite, ForestTrustInfo, forest_trust_info_data_out, NDR_IN, forest_trust_info_check_out);
-	torture_suite_add_ndr_pull_fn_test(suite, trustDomainPasswords, trust_domain_passwords_in, NDR_IN, trust_domain_passwords_check_in);
+	torture_suite_add_ndr_pull_test(suite, ForestTrustInfo, forest_trust_info_data_out, forest_trust_info_check_out);
+	torture_suite_add_ndr_pull_test(suite, trustDomainPasswords, trust_domain_passwords_in, trust_domain_passwords_check_in);
+
+#if 0
+	torture_suite_add_ndr_pullpush_test(suite,
+					    trustAuthInOutBlob,
+					    base64_decode_data_blob_talloc(suite, trustAuthIncoming),
+					    NULL);
+
+	torture_suite_add_ndr_pullpush_test(suite,
+					    trustAuthInOutBlob,
+					    base64_decode_data_blob_talloc(suite, trustAuthOutgoing),
+					    NULL);
+#endif
 
 	return suite;
 }
diff -daurN samba3/source4/torture/ndr/nbt.c samba3/source4/torture/ndr/nbt.c
--- samba3/source4/torture/ndr/nbt.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/nbt.c	2024-08-04 17:52:54.000000000 +0200
@@ -62,9 +62,9 @@
 {
 	struct torture_suite *suite = torture_suite_create(ctx, "nbt");
 
-	torture_suite_add_ndr_pull_fn_test(suite, nbt_netlogon_packet, netlogon_logon_request_req_data, NDR_IN, netlogon_logon_request_req_check);
+	torture_suite_add_ndr_pull_test(suite, nbt_netlogon_packet, netlogon_logon_request_req_data, netlogon_logon_request_req_check);
 
-	torture_suite_add_ndr_pull_fn_test(suite, nbt_netlogon_response2, netlogon_logon_request_resp_data, NDR_IN, netlogon_logon_request_resp_check);
+	torture_suite_add_ndr_pull_test(suite, nbt_netlogon_response2, netlogon_logon_request_resp_data, netlogon_logon_request_resp_check);
 
 	return suite;
 }
diff -daurN samba3/source4/torture/ndr/ndr.c samba3/source4/torture/ndr/ndr.c
--- samba3/source4/torture/ndr/ndr.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/ndr.c	2024-08-04 17:52:54.000000000 +0200
@@ -29,40 +29,65 @@
 	DATA_BLOB data_context;
 	size_t struct_size;
 	ndr_pull_flags_fn_t pull_fn;
+	ndr_push_flags_fn_t push_fn;
 	int ndr_flags;
+	int flags;
 };
 
-static bool wrap_ndr_pull_test(struct torture_context *tctx,
-			       struct torture_tcase *tcase,
-			       struct torture_test *test)
+static bool wrap_ndr_pullpush_test(struct torture_context *tctx,
+				   struct torture_tcase *tcase,
+				   struct torture_test *test)
 {
 	bool (*check_fn) (struct torture_context *ctx, void *data) = test->fn;
 	const struct ndr_pull_test_data *data = (const struct ndr_pull_test_data *)test->data;
-	void *ds = talloc_zero_size(tctx, data->struct_size);
 	struct ndr_pull *ndr = ndr_pull_init_blob(&(data->data), tctx);
+	void *ds = talloc_zero_size(ndr, data->struct_size);
+	bool ret;
+	uint32_t highest_ofs;
+
+	ndr->flags |= data->flags;
 
 	ndr->flags |= LIBNDR_FLAG_REF_ALLOC;
 
 	torture_assert_ndr_success(tctx, data->pull_fn(ndr, data->ndr_flags, ds),
 				   "pulling");
 
-	torture_assert(tctx, ndr->offset == ndr->data_size,
+	if (ndr->offset > ndr->relative_highest_offset) {
+		highest_ofs = ndr->offset;
+	} else {
+		highest_ofs = ndr->relative_highest_offset;
+	}
+
+	torture_assert(tctx, highest_ofs == ndr->data_size,
 				   talloc_asprintf(tctx,
-					   "%d unread bytes", ndr->data_size - ndr->offset));
+					   "%d unread bytes", ndr->data_size - highest_ofs));
 
-	if (check_fn != NULL)
-		return check_fn(tctx, ds);
-	else
-		return true;
+	if (check_fn != NULL) {
+		ret = check_fn(tctx, ds);
+	} else {
+		ret = true;
+	}
+
+	if (data->push_fn != NULL) {
+		DATA_BLOB outblob;
+		torture_assert_ndr_success(tctx, ndr_push_struct_blob(&outblob, ndr, ds, data->push_fn), "pushing");
+		torture_assert_data_blob_equal(tctx, outblob, data->data, "ndr push compare");
+	}
+
+	talloc_free(ndr);
+	return ret;
 }
 
-_PUBLIC_ struct torture_test *_torture_suite_add_ndr_pull_test(
-					struct torture_suite *suite,
-					const char *name, ndr_pull_flags_fn_t pull_fn,
-					DATA_BLOB db,
-					size_t struct_size,
-					int ndr_flags,
-					bool (*check_fn) (struct torture_context *ctx, void *data))
+_PUBLIC_ struct torture_test *_torture_suite_add_ndr_pullpush_test(
+	struct torture_suite *suite,
+	const char *name,
+	ndr_pull_flags_fn_t pull_fn,
+	ndr_push_flags_fn_t push_fn,
+	DATA_BLOB db,
+	size_t struct_size,
+	int ndr_flags,
+	int flags,
+	bool (*check_fn) (struct torture_context *ctx, void *data))
 {
 	struct torture_test *test;
 	struct torture_tcase *tcase;
@@ -74,12 +99,16 @@
 
 	test->name = talloc_strdup(test, name);
 	test->description = NULL;
-	test->run = wrap_ndr_pull_test;
+	test->run = wrap_ndr_pullpush_test;
+
 	data = talloc(test, struct ndr_pull_test_data);
 	data->data = db;
 	data->ndr_flags = ndr_flags;
+	data->flags = flags;
 	data->struct_size = struct_size;
 	data->pull_fn = pull_fn;
+	data->push_fn = push_fn;
+
 	test->data = data;
 	test->fn = check_fn;
 	test->dangerous = false;
@@ -89,6 +118,7 @@
 	return test;
 }
 
+
 static bool wrap_ndr_inout_pull_test(struct torture_context *tctx,
 				     struct torture_tcase *tcase,
 				     struct torture_test *test)
@@ -97,6 +127,7 @@
 	const struct ndr_pull_test_data *data = (const struct ndr_pull_test_data *)test->data;
 	void *ds = talloc_zero_size(tctx, data->struct_size);
 	struct ndr_pull *ndr;
+	uint32_t highest_ofs;
 
 	/* handle NDR_IN context */
 
@@ -109,8 +140,14 @@
 		data->pull_fn(ndr, NDR_IN, ds),
 		"ndr pull of context failed");
 
-	torture_assert(tctx, ndr->offset == ndr->data_size,
-		talloc_asprintf(tctx, "%d unread bytes", ndr->data_size - ndr->offset));
+	if (ndr->offset > ndr->relative_highest_offset) {
+		highest_ofs = ndr->offset;
+	} else {
+		highest_ofs = ndr->relative_highest_offset;
+	}
+
+	torture_assert(tctx, highest_ofs == ndr->data_size,
+		talloc_asprintf(tctx, "%d unread bytes", ndr->data_size - highest_ofs));
 
 	talloc_free(ndr);
 
@@ -125,8 +162,14 @@
 		data->pull_fn(ndr, NDR_OUT, ds),
 		"ndr pull failed");
 
-	torture_assert(tctx, ndr->offset == ndr->data_size,
-		talloc_asprintf(tctx, "%d unread bytes", ndr->data_size - ndr->offset));
+	if (ndr->offset > ndr->relative_highest_offset) {
+		highest_ofs = ndr->offset;
+	} else {
+		highest_ofs = ndr->relative_highest_offset;
+	}
+
+	torture_assert(tctx, highest_ofs == ndr->data_size,
+		talloc_asprintf(tctx, "%d unread bytes", ndr->data_size - highest_ofs));
 
 	talloc_free(ndr);
 
diff -daurN samba3/source4/torture/ndr/ndr.h samba3/source4/torture/ndr/ndr.h
--- samba3/source4/torture/ndr/ndr.h	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/ndr.h	2024-08-04 17:52:54.000000000 +0200
@@ -24,12 +24,15 @@
 #include "librpc/ndr/libndr.h"
 #include "libcli/security/security.h"
 
-_PUBLIC_ struct torture_test *_torture_suite_add_ndr_pull_test(
+_PUBLIC_ struct torture_test *_torture_suite_add_ndr_pullpush_test(
 					struct torture_suite *suite,
-					const char *name, ndr_pull_flags_fn_t fn,
+					const char *name,
+					ndr_pull_flags_fn_t pull_fn,
+					ndr_push_flags_fn_t push_fn,
 					DATA_BLOB db,
 					size_t struct_size,
 					int ndr_flags,
+					int flags,
 					bool (*check_fn) (struct torture_context *, void *data));
 
 _PUBLIC_ struct torture_test *_torture_suite_add_ndr_pull_inout_test(
@@ -41,20 +44,32 @@
 					bool (*check_fn) (struct torture_context *ctx, void *data));
 
 #define torture_suite_add_ndr_pull_test(suite,name,data,check_fn) \
-		_torture_suite_add_ndr_pull_test(suite, #name, \
-			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, data_blob_talloc(suite, data, sizeof(data)), \
-			 sizeof(struct name), NDR_SCALARS|NDR_BUFFERS, (bool (*) (struct torture_context *, void *)) check_fn);
+		_torture_suite_add_ndr_pullpush_test(suite, #name, \
+			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, NULL, data_blob_const(data, sizeof(data)), \
+			 sizeof(struct name), NDR_SCALARS|NDR_BUFFERS, 0, (bool (*) (struct torture_context *, void *)) check_fn);
 
 #define torture_suite_add_ndr_pull_fn_test(suite,name,data,flags,check_fn) \
-		_torture_suite_add_ndr_pull_test(suite, #name "_" #flags, \
-			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, data_blob_talloc(suite, data, sizeof(data)), \
-			 sizeof(struct name), flags, (bool (*) (struct torture_context *, void *)) check_fn);
+		_torture_suite_add_ndr_pullpush_test(suite, #name "_" #flags, \
+			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, NULL, data_blob_const(data, sizeof(data)), \
+			 sizeof(struct name), flags, 0, (bool (*) (struct torture_context *, void *)) check_fn);
+
+#define torture_suite_add_ndr_pull_fn_test_flags(suite,name,data,flags,flags2,check_fn) \
+		_torture_suite_add_ndr_pullpush_test(suite, #name "_" #flags "_" #flags2, \
+			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, NULL, data_blob_const(data, sizeof(data)), \
+			 sizeof(struct name), flags, flags2, (bool (*) (struct torture_context *, void *)) check_fn);
+
+#define torture_suite_add_ndr_pullpush_test(suite,name,data_blob,check_fn) \
+		_torture_suite_add_ndr_pullpush_test(suite, #name, \
+			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, \
+			 (ndr_push_flags_fn_t)ndr_push_ ## name, \
+			 data_blob, \
+			 sizeof(struct name), NDR_SCALARS|NDR_BUFFERS, 0, (bool (*) (struct torture_context *, void *)) check_fn);
 
 #define torture_suite_add_ndr_pull_io_test(suite,name,data_in,data_out,check_fn_out) \
 		_torture_suite_add_ndr_pull_inout_test(suite, #name "_INOUT", \
 			 (ndr_pull_flags_fn_t)ndr_pull_ ## name, \
-			 data_blob_talloc(suite, data_in, sizeof(data_in)), \
-			 data_blob_talloc(suite, data_out, sizeof(data_out)), \
+			 data_blob_const(data_in, sizeof(data_in)), \
+			 data_blob_const(data_out, sizeof(data_out)), \
 			 sizeof(struct name), \
 			 (bool (*) (struct torture_context *, void *)) check_fn_out);
 
diff -daurN samba3/source4/torture/ndr/ntlmssp.c samba3/source4/torture/ndr/ntlmssp.c
--- samba3/source4/torture/ndr/ntlmssp.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/ndr/ntlmssp.c	2024-08-04 17:52:54.000000000 +0200
@@ -111,9 +111,10 @@
 {
 	struct torture_suite *suite = torture_suite_create(ctx, "ntlmssp");
 
-	torture_suite_add_ndr_pull_fn_test(suite, NEGOTIATE_MESSAGE, ntlmssp_NEGOTIATE_MESSAGE_data, NDR_IN, ntlmssp_NEGOTIATE_MESSAGE_check);
-	/* torture_suite_add_ndr_pull_fn_test(suite, CHALLENGE_MESSAGE, ntlmssp_CHALLENGE_MESSAGE_data, NDR_IN, ntlmssp_CHALLENGE_MESSAGE_check);
-	torture_suite_add_ndr_pull_fn_test(suite, AUTHENTICATE_MESSAGE, ntlmssp_AUTHENTICATE_MESSAGE_data, NDR_IN, ntlmssp_AUTHENTICATE_MESSAGE_check); */
-
+	torture_suite_add_ndr_pull_test(suite, NEGOTIATE_MESSAGE, ntlmssp_NEGOTIATE_MESSAGE_data, ntlmssp_NEGOTIATE_MESSAGE_check);
+#if 0
+	torture_suite_add_ndr_pull_test(suite, CHALLENGE_MESSAGE, ntlmssp_CHALLENGE_MESSAGE_data, ntlmssp_CHALLENGE_MESSAGE_check);
+	torture_suite_add_ndr_pull_test(suite, AUTHENTICATE_MESSAGE, ntlmssp_AUTHENTICATE_MESSAGE_data, ntlmssp_AUTHENTICATE_MESSAGE_check);
+#endif
 	return suite;
 }
diff -daurN samba3/source4/torture/raw/samba3misc.c samba3/source4/torture/raw/samba3misc.c
--- samba3/source4/torture/raw/samba3misc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/raw/samba3misc.c	2024-08-04 17:52:54.000000000 +0200
@@ -340,6 +340,7 @@
 	bool ret = true;
 	TALLOC_CTX *mem_ctx;
 	bool nt_status_support;
+	bool client_ntlmv2_auth;
 
 	if (!(mem_ctx = talloc_init("torture_samba3_badpath"))) {
 		d_printf("talloc_init failed\n");
@@ -347,20 +348,17 @@
 	}
 
 	nt_status_support = lpcfg_nt_status_support(torture->lp_ctx);
+	client_ntlmv2_auth = lpcfg_client_ntlmv2_auth(torture->lp_ctx);
 
-	if (!lpcfg_set_cmdline(torture->lp_ctx, "nt status support", "yes")) {
-		printf("Could not set 'nt status support = yes'\n");
-		goto fail;
-	}
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "nt status support", "yes"), ret, fail, "Could not set 'nt status support = yes'\n");
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "client ntlmv2 auth", "yes"), ret, fail, "Could not set 'client ntlmv2 auth = yes'\n");
 
 	if (!torture_open_connection(&cli_nt, torture, 0)) {
 		goto fail;
 	}
 
-	if (!lpcfg_set_cmdline(torture->lp_ctx, "nt status support", "no")) {
-		printf("Could not set 'nt status support = yes'\n");
-		goto fail;
-	}
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "nt status support", "no"), ret, fail, "Could not set 'nt status support = no'\n");
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "client ntlmv2 auth", "no"), ret, fail, "Could not set 'client ntlmv2 auth = no'\n");
 
 	if (!torture_open_connection(&cli_dos, torture, 1)) {
 		goto fail;
@@ -373,6 +371,12 @@
 	}
 
 	smbcli_deltree(cli_nt->tree, dirname);
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "nt status support",
+						       nt_status_support ? "yes":"no"),
+			    ret, fail, "Could not set 'nt status support' back to where it was\n");
+	torture_assert_goto(torture, lpcfg_set_cmdline(torture->lp_ctx, "client ntlmv2 auth",
+						       client_ntlmv2_auth ? "yes":"no"),
+			    ret, fail, "Could not set 'client ntlmv2 auth' back to where it was\n");
 
 	status = smbcli_mkdir(cli_nt->tree, dirname);
 	if (!NT_STATUS_IS_OK(status)) {
diff -daurN samba3/source4/torture/rpc/rpc.c samba3/source4/torture/rpc/rpc.c
--- samba3/source4/torture/rpc/rpc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/rpc/rpc.c	2024-08-04 17:52:54.000000000 +0200
@@ -501,6 +501,7 @@
 	torture_suite_add_suite(suite, torture_rpc_samr_passwords_pwdlastset(suite));
 	torture_suite_add_suite(suite, torture_rpc_samr_passwords_badpwdcount(suite));
 	torture_suite_add_suite(suite, torture_rpc_samr_passwords_lockout(suite));
+	torture_suite_add_suite(suite, torture_rpc_samr_passwords_validate(suite));
 	torture_suite_add_suite(suite, torture_rpc_samr_user_privileges(suite));
 	torture_suite_add_suite(suite, torture_rpc_samr_large_dc(suite));
 	torture_suite_add_suite(suite, torture_rpc_epmapper(suite));
diff -daurN samba3/source4/torture/rpc/samba3rpc.c samba3/source4/torture/rpc/samba3rpc.c
--- samba3/source4/torture/rpc/samba3rpc.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/rpc/samba3rpc.c	2024-08-04 17:52:54.000000000 +0200
@@ -1122,8 +1122,8 @@
 		generate_random_buffer(chal.data, chal.length);
 		names_blob = NTLMv2_generate_names_blob(
 			mem_ctx,
-			cli_credentials_get_workstation(user_creds),
-			cli_credentials_get_domain(user_creds));
+			cli_credentials_get_workstation(wks_creds),
+			cli_credentials_get_domain(wks_creds));
 		status = cli_credentials_get_ntlm_response(
 			user_creds, mem_ctx, &flags, chal, names_blob,
 			&lm_resp, &nt_resp, NULL, NULL);
diff -daurN samba3/source4/torture/rpc/samr.c samba3/source4/torture/rpc/samr.c
--- samba3/source4/torture/rpc/samr.c	2015-02-22 15:11:32.000000000 +0100
+++ samba3/source4/torture/rpc/samr.c	2024-08-04 17:52:54.000000000 +0200
@@ -7938,8 +7938,8 @@
 }
 
 
-static bool test_samr_ValidatePassword(struct dcerpc_pipe *p,
-				       struct torture_context *tctx)
+static bool test_samr_ValidatePassword(struct torture_context *tctx,
+				       struct dcerpc_pipe *p)
 {
 	struct samr_ValidatePassword r;
 	union samr_ValidatePasswordReq req;
@@ -7951,6 +7951,10 @@
 
 	torture_comment(tctx, "Testing samr_ValidatePassword\n");
 
+	if (p->conn->transport.transport != NCACN_IP_TCP) {
+		torture_comment(tctx, "samr_ValidatePassword only should succeed over NCACN_IP_TCP!\n");
+	}
+
 	ZERO_STRUCT(r);
 	r.in.level = NetValidatePasswordReset;
 	r.in.req = &req;
@@ -8074,8 +8078,6 @@
 
 	ret &= test_samr_handle_Close(b, torture, &ctx->handle);
 
-	ret &= test_samr_ValidatePassword(p, torture);
-
 	return ret;
 }
 
@@ -8370,4 +8372,15 @@
 	return suite;
 }
 
+struct torture_suite *torture_rpc_samr_passwords_validate(TALLOC_CTX *mem_ctx)
+{
+	struct torture_suite *suite = torture_suite_create(mem_ctx, "samr.passwords.validate");
+	struct torture_rpc_tcase *tcase;
+
+	tcase = torture_suite_add_rpc_iface_tcase(suite, "samr",
+						  &ndr_table_samr);
+	torture_rpc_tcase_add_test(tcase, "validate",
+				   test_samr_ValidatePassword);
 
+	return suite;
+}
